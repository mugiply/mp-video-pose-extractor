(self.webpackChunkmp_video_pose_extractor=self.webpackChunkmp_video_pose_extractor||[]).push([[179],{534:function(){(function(){"use strict";function cn(z){var f=0;return function(){return f<z.length?{done:!1,value:z[f++]}:{done:!0}}}var ye="function"==typeof Object.defineProperties?Object.defineProperty:function(z,f,b){return z==Array.prototype||z==Object.prototype||(z[f]=b.value),z},ie=function Re(z){z=["object"==typeof globalThis&&globalThis,z,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<z.length;++f){var b=z[f];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}(this);function ce(z,f){if(f)e:{var b=ie;z=z.split(".");for(var w=0;w<z.length-1;w++){var T=z[w];if(!(T in b))break e;b=b[T]}(f=f(w=b[z=z[z.length-1]]))!=w&&null!=f&&ye(b,z,{configurable:!0,writable:!0,value:f})}}function j(z){var f=typeof Symbol<"u"&&Symbol.iterator&&z[Symbol.iterator];return f?f.call(z):{next:cn(z)}}var J="function"==typeof Object.assign?Object.assign:function(z,f){for(var b=1;b<arguments.length;b++){var w=arguments[b];if(w)for(var T in w)Object.prototype.hasOwnProperty.call(w,T)&&(z[T]=w[T])}return z};function K(z){return z||Array.prototype.fill}ce("Object.assign",function(z){return z||J}),ce("Array.prototype.fill",function(z){return z||function(f,b,w){var T=this.length||0;for(0>b&&(b=Math.max(0,T+b)),(null==w||w>T)&&(w=T),0>(w=Number(w))&&(w=Math.max(0,T+w)),b=Number(b||0);b<w;b++)this[b]=f;return this}}),ce("Int8Array.prototype.fill",K),ce("Uint8Array.prototype.fill",K),ce("Uint8ClampedArray.prototype.fill",K),ce("Int16Array.prototype.fill",K),ce("Uint16Array.prototype.fill",K),ce("Int32Array.prototype.fill",K),ce("Uint32Array.prototype.fill",K),ce("Float32Array.prototype.fill",K),ce("Float64Array.prototype.fill",K);var xe=this||self;function E(z,f){z=z.split(".");var w,b=xe;z[0]in b||typeof b.execScript>"u"||b.execScript("var "+z[0]);for(;z.length&&(w=z.shift());)z.length||void 0===f?b=b[w]&&b[w]!==Object.prototype[w]?b[w]:b[w]={}:b[w]=f}var pe={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function te(z){return z=z||{},Object.assign(Object.assign(Object.assign({},pe),{fillColor:z.color}),z)}function Z(z,f){return z instanceof Function?z(f):z}function Y(z,f,b){return Math.max(Math.min(f,b),Math.min(Math.max(f,b),z))}E("clamp",Y),E("drawLandmarks",function(z,f,b){if(f){b=te(b),z.save();for(var w=z.canvas,T=0,R=(f=j(f)).next();!R.done;R=f.next())if(void 0!==(R=R.value)&&(void 0===R.visibility||R.visibility>b.visibilityMin)){z.fillStyle=Z(b.fillColor,{index:T,from:R}),z.strokeStyle=Z(b.color,{index:T,from:R}),z.lineWidth=Z(b.lineWidth,{index:T,from:R});var H=new Path2D;H.arc(R.x*w.width,R.y*w.height,Z(b.radius,{index:T,from:R}),0,2*Math.PI),z.fill(H),z.stroke(H),++T}z.restore()}}),E("drawConnectors",function(z,f,b,w){if(f&&b){w=te(w),z.save();for(var T=z.canvas,R=0,H=(b=j(b)).next();!H.done;H=b.next()){var L=H.value;z.beginPath(),H=f[L[0]],L=f[L[1]],H&&L&&(void 0===H.visibility||H.visibility>w.visibilityMin)&&(void 0===L.visibility||L.visibility>w.visibilityMin)&&(z.strokeStyle=Z(w.color,{index:R,from:H,to:L}),z.lineWidth=Z(w.lineWidth,{index:R,from:H,to:L}),z.moveTo(H.x*T.width,H.y*T.height),z.lineTo(L.x*T.width,L.y*T.height)),++R,z.stroke()}z.restore()}}),E("drawRectangle",function(z,f,b){b=te(b),z.save();var w=z.canvas;z.beginPath(),z.lineWidth=Z(b.lineWidth,{}),z.strokeStyle=Z(b.color,{}),z.fillStyle=Z(b.fillColor,{}),z.translate(f.xCenter*w.width,f.yCenter*w.height),z.rotate(f.rotation*Math.PI/180),z.rect(-f.width/2*w.width,-f.height/2*w.height,f.width*w.width,f.height*w.height),z.translate(-f.xCenter*w.width,-f.yCenter*w.height),z.stroke(),z.fill(),z.restore()}),E("lerp",function(z,f,b,w,T){return Y(w*(1-(z-f)/(b-f))+T*(1-(b-z)/(b-f)),w,T)})}).call(this)},796:function(){(function(){"use strict";var cn;function ye(k){var U=0;return function(){return U<k.length?{done:!1,value:k[U++]}:{done:!0}}}var Re="function"==typeof Object.defineProperties?Object.defineProperty:function(k,U,F){return k==Array.prototype||k==Object.prototype||(k[U]=F.value),k},ce=function ie(k){k=["object"==typeof globalThis&&globalThis,k,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var U=0;U<k.length;++U){var F=k[U];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}(this);function j(k,U){if(U)e:{var F=ce;k=k.split(".");for(var ge=0;ge<k.length-1;ge++){var Fe=k[ge];if(!(Fe in F))break e;F=F[Fe]}(U=U(ge=F[k=k[k.length-1]]))!=ge&&null!=U&&Re(F,k,{configurable:!0,writable:!0,value:U})}}function J(k){return(k={next:k})[Symbol.iterator]=function(){return this},k}function K(k){var U=typeof Symbol<"u"&&Symbol.iterator&&k[Symbol.iterator];return U?U.call(k):{next:ye(k)}}function xe(k){if(!(k instanceof Array)){k=K(k);for(var U,F=[];!(U=k.next()).done;)F.push(U.value);k=F}return k}j("Symbol",function(k){function F(Ke,Pe){this.g=Ke,Re(this,"description",{configurable:!0,writable:!0,value:Pe})}if(k)return k;F.prototype.toString=function(){return this.g};var ge="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Fe=0;return function U(Ke){if(this instanceof U)throw new TypeError("Symbol is not a constructor");return new F(ge+(Ke||"")+"_"+Fe++,Ke)}}),j("Symbol.iterator",function(k){if(k)return k;k=Symbol("Symbol.iterator");for(var U="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),F=0;F<U.length;F++){var ge=ce[U[F]];"function"==typeof ge&&"function"!=typeof ge.prototype[k]&&Re(ge.prototype,k,{configurable:!0,writable:!0,value:function(){return J(ye(this))}})}return k});var pe,E="function"==typeof Object.create?Object.create:function(k){function U(){}return U.prototype=k,new U};if("function"==typeof Object.setPrototypeOf)pe=Object.setPrototypeOf;else{var te;e:{var Y={};try{Y.__proto__={a:!0},te=Y.a;break e}catch{}te=!1}pe=te?function(k,U){if(k.__proto__=U,k.__proto__!==U)throw new TypeError(k+" is not extensible");return k}:null}var z=pe;function f(k,U){if(k.prototype=E(U.prototype),k.prototype.constructor=k,z)z(k,U);else for(var F in U)if("prototype"!=F)if(Object.defineProperties){var ge=Object.getOwnPropertyDescriptor(U,F);ge&&Object.defineProperty(k,F,ge)}else k[F]=U[F];k.da=U.prototype}function b(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function w(k){if(k.l)throw new TypeError("Generator is already running");k.l=!0}function T(k,U){k.j={U,V:!0},k.g=k.m||k.s}function R(k,U,F){return k.g=F,{value:U}}function H(k){this.g=new b,this.h=k}function oe(k,U,F,ge){try{var Fe=U.call(k.g.i,F);if(!(Fe instanceof Object))throw new TypeError("Iterator result "+Fe+" is not an object");if(!Fe.done)return k.g.l=!1,Fe;var Ke=Fe.value}catch(Pe){return k.g.i=null,T(k.g,Pe),ve(k)}return k.g.i=null,ge.call(k.g,Ke),ve(k)}function ve(k){for(;k.g.g;)try{var U=k.h(k.g);if(U)return k.g.l=!1,{value:U.value,done:!1}}catch(F){k.g.h=void 0,T(k.g,F)}if(k.g.l=!1,k.g.j){if(U=k.g.j,k.g.j=null,U.V)throw U.U;return{value:U.return,done:!0}}return{value:void 0,done:!0}}function we(k){this.next=function(U){return w(k.g),k.g.i?U=oe(k,k.g.i.next,U,k.g.o):(k.g.o(U),U=ve(k)),U},this.throw=function(U){return w(k.g),k.g.i?U=oe(k,k.g.i.throw,U,k.g.o):(T(k.g,U),U=ve(k)),U},this.return=function(U){return function L(k,U){w(k.g);var F=k.g.i;return F?oe(k,"return"in F?F.return:function(ge){return{value:ge,done:!0}},U,k.g.return):(k.g.return(U),ve(k))}(k,U)},this[Symbol.iterator]=function(){return this}}function ke(k){return function de(k){function U(ge){return k.next(ge)}function F(ge){return k.throw(ge)}return new Promise(function(ge,Fe){!function Ke(Pe){Pe.done?ge(Pe.value):Promise.resolve(Pe.value).then(U,F).then(Ke,Fe)}(k.next())})}(new we(new H(k)))}b.prototype.o=function(k){this.h=k},b.prototype.return=function(k){this.j={return:k},this.g=this.s},j("Promise",function(k){function U(Pe){this.h=0,this.i=void 0,this.g=[],this.o=!1;var gt=this.j();try{Pe(gt.resolve,gt.reject)}catch(lt){gt.reject(lt)}}function F(){this.g=null}function ge(Pe){return Pe instanceof U?Pe:new U(function(gt){gt(Pe)})}if(k)return k;F.prototype.h=function(Pe){if(null==this.g){this.g=[];var gt=this;this.i(function(){gt.l()})}this.g.push(Pe)};var Fe=ce.setTimeout;F.prototype.i=function(Pe){Fe(Pe,0)},F.prototype.l=function(){for(;this.g&&this.g.length;){var Pe=this.g;this.g=[];for(var gt=0;gt<Pe.length;++gt){var lt=Pe[gt];Pe[gt]=null;try{lt()}catch(At){this.j(At)}}}this.g=null},F.prototype.j=function(Pe){this.i(function(){throw Pe})},U.prototype.j=function(){function Pe(At){return function(vn){lt||(lt=!0,At.call(gt,vn))}}var gt=this,lt=!1;return{resolve:Pe(this.C),reject:Pe(this.l)}},U.prototype.C=function(Pe){if(Pe===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(Pe instanceof U)this.F(Pe);else{e:switch(typeof Pe){case"object":var gt=null!=Pe;break e;case"function":gt=!0;break e;default:gt=!1}gt?this.v(Pe):this.m(Pe)}},U.prototype.v=function(Pe){var gt=void 0;try{gt=Pe.then}catch(lt){return void this.l(lt)}"function"==typeof gt?this.G(gt,Pe):this.m(Pe)},U.prototype.l=function(Pe){this.s(2,Pe)},U.prototype.m=function(Pe){this.s(1,Pe)},U.prototype.s=function(Pe,gt){if(0!=this.h)throw Error("Cannot settle("+Pe+", "+gt+"): Promise already settled in state"+this.h);this.h=Pe,this.i=gt,2===this.h&&this.D(),this.A()},U.prototype.D=function(){var Pe=this;Fe(function(){if(Pe.B()){var gt=ce.console;typeof gt<"u"&&gt.error(Pe.i)}},1)},U.prototype.B=function(){if(this.o)return!1;var Pe=ce.CustomEvent,gt=ce.Event,lt=ce.dispatchEvent;return typeof lt>"u"||("function"==typeof Pe?Pe=new Pe("unhandledrejection",{cancelable:!0}):"function"==typeof gt?Pe=new gt("unhandledrejection",{cancelable:!0}):(Pe=ce.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,Pe),Pe.promise=this,Pe.reason=this.i,lt(Pe))},U.prototype.A=function(){if(null!=this.g){for(var Pe=0;Pe<this.g.length;++Pe)Ke.h(this.g[Pe]);this.g=null}};var Ke=new F;return U.prototype.F=function(Pe){var gt=this.j();Pe.J(gt.resolve,gt.reject)},U.prototype.G=function(Pe,gt){var lt=this.j();try{Pe.call(gt,lt.resolve,lt.reject)}catch(At){lt.reject(At)}},U.prototype.then=function(Pe,gt){function lt(wn,on){return"function"==typeof wn?function(ee){try{At(wn(ee))}catch(Cn){vn(Cn)}}:on}var At,vn,Dn=new U(function(wn,on){At=wn,vn=on});return this.J(lt(Pe,At),lt(gt,vn)),Dn},U.prototype.catch=function(Pe){return this.then(void 0,Pe)},U.prototype.J=function(Pe,gt){function lt(){switch(At.h){case 1:Pe(At.i);break;case 2:gt(At.i);break;default:throw Error("Unexpected state: "+At.h)}}var At=this;null==this.g?Ke.h(lt):this.g.push(lt),this.o=!0},U.resolve=ge,U.reject=function(Pe){return new U(function(gt,lt){lt(Pe)})},U.race=function(Pe){return new U(function(gt,lt){for(var At=K(Pe),vn=At.next();!vn.done;vn=At.next())ge(vn.value).J(gt,lt)})},U.all=function(Pe){var gt=K(Pe),lt=gt.next();return lt.done?ge([]):new U(function(At,vn){function Dn(ee){return function(Cn){wn[ee]=Cn,0==--on&&At(wn)}}var wn=[],on=0;do{wn.push(void 0),on++,ge(lt.value).J(Dn(wn.length-1),vn),lt=gt.next()}while(!lt.done)})},U});var De="function"==typeof Object.assign?Object.assign:function(k,U){for(var F=1;F<arguments.length;F++){var ge=arguments[F];if(ge)for(var Fe in ge)Object.prototype.hasOwnProperty.call(ge,Fe)&&(k[Fe]=ge[Fe])}return k};j("Object.assign",function(k){return k||De}),j("Object.is",function(k){return k||function(U,F){return U===F?0!==U||1/U==1/F:U!=U&&F!=F}}),j("Array.prototype.includes",function(k){return k||function(U,F){var ge=this;ge instanceof String&&(ge=String(ge));var Fe=ge.length;for(0>(F=F||0)&&(F=Math.max(F+Fe,0));F<Fe;F++){var Ke=ge[F];if(Ke===U||Object.is(Ke,U))return!0}return!1}}),j("String.prototype.includes",function(k){return k||function(U,F){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(U instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(U,F||0)}}),j("Array.prototype.keys",function(k){return k||function(){return function ae(k,U){k instanceof String&&(k+="");var F=0,ge=!1,Fe={next:function(){if(!ge&&F<k.length){var Ke=F++;return{value:U(Ke,k[Ke]),done:!1}}return ge=!0,{done:!0,value:void 0}}};return Fe[Symbol.iterator]=function(){return Fe},Fe}(this,function(U){return U})}});var $=this||self;function Ee(k,U){k=k.split(".");var ge,F=$;k[0]in F||typeof F.execScript>"u"||F.execScript("var "+k[0]);for(;k.length&&(ge=k.shift());)k.length||void 0===U?F=F[ge]&&F[ge]!==Object.prototype[ge]?F[ge]:F[ge]={}:F[ge]=U}function Be(k){!function ht(k){$.setTimeout(function(){throw k},0)}(k)}function kt(k,U){Be(Error("Invalid wire type: "+k+" (at position "+U+")"))}function Ve(){Be(Error("Failed to read varint, encoding is invalid."))}function pt(k,U){return U=String.fromCharCode.apply(null,U),null==k?U:k+U}var ze,Jt,Ge=typeof TextDecoder<"u",zt=typeof TextEncoder<"u";function Le(k){if(zt)k=(Jt||(Jt=new TextEncoder)).encode(k);else{var U=void 0;U=void 0!==U&&U;for(var F=0,ge=new Uint8Array(3*k.length),Fe=0;Fe<k.length;Fe++){var Ke=k.charCodeAt(Fe);if(128>Ke)ge[F++]=Ke;else{if(2048>Ke)ge[F++]=Ke>>6|192;else{if(55296<=Ke&&57343>=Ke){if(56319>=Ke&&Fe<k.length){var Pe=k.charCodeAt(++Fe);if(56320<=Pe&&57343>=Pe){ge[F++]=(Ke=1024*(Ke-55296)+Pe-56320+65536)>>18|240,ge[F++]=Ke>>12&63|128,ge[F++]=Ke>>6&63|128,ge[F++]=63&Ke|128;continue}Fe--}if(U)throw Error("Found an unpaired surrogate");Ke=65533}ge[F++]=Ke>>12|224,ge[F++]=Ke>>6&63|128}ge[F++]=63&Ke|128}}k=ge.subarray(0,F)}return k}var Di={},dn=null;function en(k){var U;void 0===U&&(U=0),Pt(),U=Di[U];for(var F=Array(Math.floor(k.length/3)),ge=U[64]||"",Fe=0,Ke=0;Fe<k.length-2;Fe+=3){var Pe=k[Fe],gt=k[Fe+1],lt=k[Fe+2],At=U[Pe>>2];F[Ke++]=At+(Pe=U[(3&Pe)<<4|gt>>4])+(gt=U[(15&gt)<<2|lt>>6])+(lt=U[63&lt])}switch(At=0,lt=ge,k.length-Fe){case 2:lt=U[(15&(At=k[Fe+1]))<<2]||ge;case 1:F[Ke]=U[(k=k[Fe])>>2]+U[(3&k)<<4|At>>4]+lt+ge}return F.join("")}function pn(k){var U=k.length,F=3*U/4;F%3?F=Math.floor(F):-1!="=.".indexOf(k[U-1])&&(F=-1!="=.".indexOf(k[U-2])?F-2:F-1);var ge=new Uint8Array(F),Fe=0;return function fr(k,U){function F(lt){for(;ge<k.length;){var At=k.charAt(ge++),vn=dn[At];if(null!=vn)return vn;if(!/^[\s\xa0]*$/.test(At))throw Error("Unknown base64 encoding at char: "+At)}return lt}Pt();for(var ge=0;;){var Fe=F(-1),Ke=F(0),Pe=F(64),gt=F(64);if(64===gt&&-1===Fe)break;U(Fe<<2|Ke>>4),64!=Pe&&(U(Ke<<4&240|Pe>>2),64!=gt&&U(Pe<<6&192|gt))}}(k,function(Ke){ge[Fe++]=Ke}),ge.subarray(0,Fe)}function Pt(){if(!dn){dn={};for(var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),U=["+/=","+/","-_=","-_.","-_"],F=0;5>F;F++){var ge=k.concat(U[F].split(""));Di[F]=ge;for(var Fe=0;Fe<ge.length;Fe++){var Ke=ge[Fe];void 0===dn[Ke]&&(dn[Ke]=Fe)}}}}var zr,or="function"==typeof Uint8Array;function q(k){if(this.g=k,null!==k&&0===k.length)throw Error("ByteString should be constructed with non-empty values")}q.prototype.toJSON=function(){if(null==this.g)var k="";else k=this.g=null==(k=this.g)||"string"==typeof k?k:or&&k instanceof Uint8Array?en(k):null;return k};var mt="function"==typeof Uint8Array.prototype.slice;function tt(k,U,F){return U===F?zr||(zr=new Uint8Array(0)):mt?k.slice(U,F):new Uint8Array(k.subarray(U,F))}var Se=0;function _t(k,U){U=void 0!==(U=void 0===U?{}:U).u&&U.u,this.h=null,this.g=this.i=this.m=0,this.l=!1,this.u=U,k&&xt(this,k)}function xt(k,U){k.h=function Oe(k){if(k.constructor===Uint8Array)return k;if(k.constructor===ArrayBuffer)return new Uint8Array(k);if(k.constructor===Array)return new Uint8Array(k);if(k.constructor===String)return pn(k);if(k.constructor===q){if(null==k.g)var U=zr||(zr=new Uint8Array(0));else{U=Uint8Array;var F=k.g;F=null==F||or&&null!=F&&F instanceof Uint8Array?F:"string"==typeof F?pn(F):null,U=new U(k=k.g=F)}return U}if(k instanceof Uint8Array)return new Uint8Array(k.buffer,k.byteOffset,k.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(U),k.m=0,k.i=k.h.length,k.g=k.m}function We(k){for(var U=128,F=0,ge=0,Fe=0;4>Fe&&128<=U;Fe++)F|=(127&(U=k.h[k.g++]))<<7*Fe;if(128<=U&&(F|=(127&(U=k.h[k.g++]))<<28,ge|=(127&U)>>4),128<=U)for(Fe=0;5>Fe&&128<=U;Fe++)ge|=(127&(U=k.h[k.g++]))<<7*Fe+3;if(128>U)return k=F>>>0,(ge=2147483648&(U=ge>>>0))&&(U=~U>>>0,0==(k=1+~k>>>0)&&(U=U+1>>>0)),k=4294967296*U+(k>>>0),ge?-k:k;k.l=!0,Ve()}function qe(k){k.g>k.i&&(k.l=!0,Be(Error("Tried to read past the end of the data "+k.g+" > "+k.i)))}_t.prototype.reset=function(){this.g=this.m},_t.prototype.j=function(){var k=this.h,U=k[this.g],F=127&U;return 128>U?(this.g+=1,qe(this),F):(F|=(127&(U=k[this.g+1]))<<7,128>U?(this.g+=2,qe(this),F):(F|=(127&(U=k[this.g+2]))<<14,128>U?(this.g+=3,qe(this),F):(F|=(127&(U=k[this.g+3]))<<21,128>U?(this.g+=4,qe(this),F):(F|=(15&(U=k[this.g+4]))<<28,128>U?(this.g+=5,qe(this),F>>>0):(this.g+=5,128<=k[this.g++]&&128<=k[this.g++]&&128<=k[this.g++]&&128<=k[this.g++]&&128<=k[this.g++]?(this.l=!0,Ve(),F):(qe(this),F))))))},_t.prototype.o=function(){var k=this.h[this.g],U=this.h[this.g+1],F=this.h[this.g+2],ge=this.h[this.g+3];return this.g+=4,qe(this),k=2*((F=(k<<0|U<<8|F<<16|ge<<24)>>>0)>>31)+1,U=F>>>23&255,F&=8388607,255==U?F?NaN:1/0*k:0==U?k*Math.pow(2,-149)*F:k*Math.pow(2,U-150)*(F+Math.pow(2,23))};var Yt=[];function It(){this.g=new Uint8Array(64),this.h=0}function sn(k,U){if(!(k.h+1<k.g.length)){var F=k.g;k.g=new Uint8Array(Math.ceil(1+2*k.g.length)),k.g.set(F)}k.g[k.h++]=U}function pi(k,U){for(;127<U;)sn(k,127&U|128),U>>>=7;sn(k,U)}function Nn(k){var U={},F=void 0!==U.N&&U.N;this.m={u:void 0!==U.u&&U.u},this.N=F,U=this.m,Yt.length?(F=Yt.pop(),U&&(F.u=U.u),k&&xt(F,k),k=F):k=new _t(k,U),this.g=k,this.l=this.g.g,this.h=this.i=-1,this.j=!1}function po(k){var U=k.g;if((U=U.g==U.i)||(U=k.j)||(U=(U=k.g).l||0>U.g||U.g>U.i),U)return!1;k.l=k.g.g;var F=k.g.j();return U=F>>>3,0<=(F&=7)&&5>=F?(k.i=U,k.h=F,!0):(k.j=!0,kt(F,k.l),!1)}function Io(k){switch(k.h){case 0:if(0!=k.h)Io(k);else e:{for(var U=(k=k.g).g,F=0;10>F;F++){if(0==(128&k.h[U])){k.g=U+1,qe(k);break e}U++}k.l=!0,Ve()}break;case 1:(k=k.g).g+=8,qe(k);break;case 2:2!=k.h?Io(k):(U=k.g.j(),(k=k.g).g+=U,qe(k));break;case 5:(k=k.g).g+=4,qe(k);break;case 3:for(U=k.i;;){if(!po(k)){k.j=!0,Be(Error("Unmatched start-group tag: stream EOF"));break}if(4==k.h){k.i!=U&&(k.j=!0,Be(Error("Unmatched end-group tag")));break}Io(k)}break;default:k.j=!0,kt(k.h,k.l)}}function Ao(k,U,F){k.N||(k=tt(k.g.h,F,k.g.g),(F=U.o)?F.push(k):U.o=[k])}function Ma(k,U,F){var ge=k.g.i,Fe=k.g.j(),Ke=k.g.g+Fe;if(k.g.i=Ke,F(U,k),0!=(F=Ke-k.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+Fe+" bytes, instead read "+(Fe-F)+" bytes, either the data ended unexpectedly or the message misreported its own length");return k.g.g=Ke,k.g.i=ge,U}function Bi(k,U,F){var ge=k.g.j();for(ge=k.g.g+ge;k.g.g<ge;)F.push(U.call(k.g))}It.prototype.length=function(){return this.h},It.prototype.end=function(){var k=this.g,U=this.h;return this.h=0,tt(k,0,U)},Nn.prototype.reset=function(){this.g.reset(),this.h=this.i=-1};var Xr=[];function Je(){this.h=[],this.i=0,this.g=new It}function Ro(k,U){0!==U.length&&(k.h.push(U),k.i+=U.length)}function ki(k,U,F){pi(k.g,8*U+2),pi(k.g,F.length),Ro(k,k.g.end()),Ro(k,F)}var er,dl="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol(void 0):void 0;function As(k,U){Object.isFrozen(k)||(dl?k[dl]|=U:void 0!==k.g?k.g|=U:Object.defineProperties(k,{g:{value:U,configurable:!0,writable:!0,enumerable:!1}}))}function Rs(k){return k?(dl?k[dl]:k.g)??0:0}function Ta(k){return Array.isArray(k)&&As(k,1),k}function Ia(k){if(!Array.isArray(k))throw Error("cannot mark non-array as immutable");As(k,2)}function da(k){return null!==k&&"object"==typeof k&&k.constructor===Object}function A_(k){switch(typeof k){case"number":return isFinite(k)?k:String(k);case"object":return or&&null!=k&&k instanceof Uint8Array?en(k):k;default:return k}}function dr(k,U){if(null!=k)return Array.isArray(k)||da(k)?kc(k,U):U(k)}function kc(k,U){if(Array.isArray(k)){for(var F=Array(k.length),ge=0;ge<k.length;ge++)F[ge]=dr(k[ge],U);return 1&Rs(k)&&Ta(F),F}for(ge in F={},k)F[ge]=dr(k[ge],U);return F}function xr(k,U,F){var ge=er;if(er=null,k||(k=ge),ge=this.constructor.ba,k||(k=ge?[ge]:[]),this.j=(ge?0:-1)-(this.constructor.$||0),this.m=this.g=null,this.h=k,k=(ge=this.h.length)-1,ge&&da(ge=this.h[k])?(this.l=k-this.j,this.i=ge):void 0!==U&&-1<U?(this.l=Math.max(U,k+1-this.j),this.i=null):this.l=Number.MAX_VALUE,F)for(U=0;U<F.length;U++)(k=F[U])<this.l?(ge=this.h[k+=this.j])?Ta(ge):this.h[k]=Ir:(Xd(this),(ge=this.i[k])?Ta(ge):this.i[k]=Ir)}var Ic,Ir=Object.freeze(Ta([]));function Xd(k){var U=k.l+k.j;k.h[U]||(k.i=k.h[U]={})}function ar(k,U,F){return-1===U?null:void 0!==F&&F||U>=k.l?k.i?k.i[U]:void 0:k.h[U+k.j]}function ul(k,U,F){F=void 0===F||F;var ge=void 0!==ge&&ge,Fe=ar(k,U,ge);return null==Fe&&(Fe=Ir),Fe===Ir?Ai(k,U,Fe=Ta([]),ge):F&&Array.isArray(Fe)&&2&Rs(Fe)&&Ai(k,U,Fe=Fe.slice(),ge),Fe}function Bf(k){var U=ul(k,3,!1);if(k.m||(k.m={}),!k.m[3]){for(var F=0;F<U.length;F++)U[F]=+U[F];k.m[3]=!0}return U}function Ie(k,U,F){return(k=ar(k,U))??F}function Aa(k,U,F){return(k=null==(k=ar(k,U))?k:+k)??(void 0===F?0:F)}function Ai(k,U,F,ge){void 0!==ge&&ge||U>=k.l?(Xd(k),k.i[U]=F):k.h[U+k.j]=F}function Fo(k,U,F){if(-1===F)return null;k.g||(k.g={});var ge=k.g[F];if(ge)return ge;var Fe=ar(k,F,!1);return null==Fe?ge:(U=new U(Fe),k.g[F]=U)}function fo(k,U,F){k.g||(k.g={});var ge=k.g[F];if(!ge){var Fe=ul(k,F,!1);ge=[];for(var Ke=!!Array.isArray(Fe)&&!!(2&Rs(Fe)),Pe=0;Pe<Fe.length;Pe++)ge[Pe]=new U(Fe[Pe]),Ke&&Ia(ge[Pe].h);Ke&&(Ia(ge),Object.freeze(ge)),k.g[F]=ge}return ge}function Mi(k,U,F,ge,Fe){var Ke=fo(k,ge,U);F=F||new ge,k=ul(k,U),null!=Fe?(Ke.splice(Fe,0,F),k.splice(Fe,0,Vr(F))):(Ke.push(F),k.push(Vr(F)))}function Vr(k){if(k.g)for(var U in k.g){var F=k.g[U];if(Array.isArray(F))for(var ge=0;ge<F.length;ge++)F[ge]&&Vr(F[ge]);else F&&Vr(F)}return k.h}function Oo(k,U){if(k=k.o){Ro(U,U.g.end());for(var F=0;F<k.length;F++)Ro(U,k[F])}}function R_(k){var U=k[0];switch(k.length){case 2:var F=k[1];return function(lt,At,vn){return U(lt,At,vn,F)};case 3:var ge=k[1],Fe=k[2];return function(lt,At,vn){return U(lt,At,vn,ge,Fe)};case 4:var Ke=k[1],Pe=k[2],gt=k[3];return function(lt,At,vn){return U(lt,At,vn,Ke,Pe,gt)};default:throw Error("unsupported number of parameters, expected [2-4], got "+k.length)}}function Zr(k,U,F){for(;po(U)&&4!=U.h;){var ge=U.i,Fe=F[ge];if(Fe){if(Array.isArray(Fe)&&(Fe=F[ge]=R_(Fe)),!Fe(U,k,ge)){Fe=k;var Ke=(ge=U).l;Io(ge),Ao(ge,Fe,Ke)}}else Fe=k,Ke=(ge=U).l,Io(ge),Ao(ge,Fe,Ke)}return k}function Mc(k,U){var F=new Je;if(U(k,F),0===(k=F.i+F.g.length()))F=new Uint8Array(0);else{k=new Uint8Array(k);for(var ge=F.h,Fe=ge.length,Ke=U=0;Ke<Fe;Ke++){var Pe=ge[Ke];0!==Pe.length&&(k.set(Pe,U),U+=Pe.length)}0!==(Fe=(ge=F.g).h)&&(k.set(ge.g.subarray(0,Fe),U),ge.h=0),F.h=[k],F=k}return F}function ds(k,U,F){if(Xr.length){var ge=Xr.pop();k&&(xt(ge.g,k),ge.i=-1,ge.h=-1),k=ge}else k=new Nn(k);try{return F(new U,k)}finally{(U=k.g).h=null,U.m=0,U.i=0,U.g=0,U.l=!1,U.u=!1,k.i=-1,k.h=-1,k.j=!1,100>Xr.length&&Xr.push(k)}}function ro(k,U,F){if(null!=(U=ar(U,F))){pi(k.g,8*F+5),k=k.g;var ge=U;0===(ge=(F=0>ge?1:0)?-ge:ge)?Se=0<1/ge?0:2147483648:isNaN(ge)?Se=2147483647:34028234663852886e22<ge?Se=(F<<31|2139095040)>>>0:11754943508222875e-54>ge?(ge=Math.round(ge/Math.pow(2,-149)),Se=(F<<31|ge)>>>0):(U=Math.floor(Math.log(ge)/Math.LN2),ge*=Math.pow(2,-U),16777216<=(ge=Math.round(8388608*ge))&&++U,Se=(F<<31|U+127<<23|8388607&ge)>>>0),sn(k,(F=Se)>>>0&255),sn(k,F>>>8&255),sn(k,F>>>16&255),sn(k,F>>>24&255)}}function Ar(k,U,F){return 5===k.h&&(Ai(U,F,k.g.o()),!0)}function Zd(k,U,F){return(5===k.h||2===k.h)&&(U=ul(U,F),2==k.h?Bi(k,_t.prototype.o,U):U.push(k.g.o()),!0)}function Zt(k,U,F){return 0===k.h&&(Ai(U,F,We(k.g)),!0)}function Qd(k,U,F){return 0===k.h&&(Ai(U,F,k.g.j()),!0)}function zf(k,U,F){if(2!==k.h)return!1;var Ke,ge=k.g.j(),Fe=(k=k.g).g;if(k.g+=ge,qe(k),k=k.h,Ge)(Ke=ze)||(Ke=ze=new TextDecoder("utf-8",{fatal:!1})),Ke=Ke.decode(k.subarray(Fe,Fe+ge));else{ge=Fe+ge;for(var lt,At,vn,Pe=[],gt=null;Fe<ge;)128>(lt=k[Fe++])?Pe.push(lt):224>lt?Fe>=ge?Pe.push(65533):(At=k[Fe++],194>lt||128!=(192&At)?(Fe--,Pe.push(65533)):Pe.push((31&lt)<<6|63&At)):240>lt?Fe>=ge-1?Pe.push(65533):128!=(192&(At=k[Fe++]))||224===lt&&160>At||237===lt&&160<=At||128!=(192&(Ke=k[Fe++]))?(Fe--,Pe.push(65533)):Pe.push((15&lt)<<12|(63&At)<<6|63&Ke):244>=lt?Fe>=ge-2?Pe.push(65533):128!=(192&(At=k[Fe++]))||At-144+(lt<<28)>>30!=0||128!=(192&(Ke=k[Fe++]))||128!=(192&(vn=k[Fe++]))?(Fe--,Pe.push(65533)):(lt=(7&lt)<<18|(63&At)<<12|(63&Ke)<<6|63&vn,Pe.push(55296+((lt-=65536)>>10&1023),56320+(1023&lt))):Pe.push(65533),8192<=Pe.length&&(gt=pt(gt,Pe),Pe.length=0);Ke=pt(gt,Pe)}return Ai(U,F,Ke),!0}function Ih(k,U,F,ge,Fe){if(2!==k.h)return!1;k=Ma(k,new ge,Fe);var Ke=void 0!==Ke&&Ke;return U.g||(U.g={}),ge=k&&Vr(k),U.g[F]=k,Ai(U,F,ge,Ke),!0}function Ah(k,U,F,ge,Fe){return 2===k.h&&(Mi(U,F,k=Ma(k,new ge,Fe),ge,void 0),!0)}function Jd(k,U,F){return(0===k.h||2===k.h)&&(U=ul(U,F),2==k.h?Bi(k,_t.prototype.j,U):U.push(k.g.j()),!0)}function Tc(k,U,F){return 0===k.h&&(Ai(U,F,We(k.g)),!0)}function Fs(k){xr.call(this,k,-1,Ra)}function tr(k,U){return Zr(k,U,Ic||(Ic={1:Qd,2:Qd,3:Zd,4:Tc}))}xr.prototype.toJSON=function(){return kc(Vr(this),A_)},xr.prototype.toString=function(){return Vr(this).toString()},f(Fs,xr),Fs.prototype.getRows=function(){return ar(this,1)},Fs.prototype.getCols=function(){return ar(this,2)},Fs.prototype.getPackedDataList=function(){return Bf(this)},Fs.prototype.getLayout=function(){return Ie(this,4,0)};var Ac,Rc,Ra=[3];function hl(k){xr.call(this,k)}function Ri(k,U){var F=ar(k,1);if(null!=F&&null!=F){pi(U.g,8);var ge=U.g;if(0<=F)pi(ge,F);else{for(var Fe=0;9>Fe;Fe++)sn(ge,127&F|128),F>>=7;sn(ge,1)}}ro(U,k,2),null!=(ge=ar(k,3))&&ki(U,3,Le(ge)),null!=(ge=ar(k,4))&&ki(U,4,Le(ge)),Oo(k,U)}function eu(k,U){return Zr(k,U,Ac||(Ac={1:Qd,2:Ar,3:zf,4:zf}))}function Fi(k){xr.call(this,k,-1,Yn)}function Vf(k,U){return Zr(k,U,Rc||(Rc={1:[Ah,hl,eu]}))}f(hl,xr),f(Fi,xr),Fi.prototype.addClassification=function(k,U){return Mi(this,1,k,hl,U),this};var Fc,ot,Yn=[1];function _n(k){xr.call(this,k)}function tu(k,U){ro(U,k,1),ro(U,k,2),ro(U,k,3),ro(U,k,4),ro(U,k,5),Oo(k,U)}function F_(k,U){return Zr(k,U,Fc||(Fc={1:Ar,2:Ar,3:Ar,4:Ar,5:Ar}))}function zl(k){xr.call(this,k,-1,An)}function Vl(k,U){return Zr(k,U,ot||(ot={1:[Ah,_n,F_]}))}f(_n,xr),f(zl,xr);var qa,Qr,An=[1];function Ei(k){xr.call(this,k)}function O_(k,U){ro(U,k,1),ro(U,k,2),ro(U,k,3),ro(U,k,4),ro(U,k,5);var F=ar(k,6);if(null!=F&&null!=F){pi(U.g,48);var ge=U.g,Fe=F;F=0>Fe;var Ke=(Fe=Math.abs(Fe))>>>0;for(Fe=Math.floor((Fe-Ke)/4294967296),Fe>>>=0,F&&(Fe=~Fe>>>0,4294967295<(Ke=1+(~Ke>>>0))&&(Ke=0,4294967295<++Fe&&(Fe=0))),F=Se=Ke,Ke=Fe;0<Ke||127<F;)sn(ge,127&F|128),F=(F>>>7|Ke<<25)>>>0,Ke>>>=7;sn(ge,F)}Oo(k,U)}function Oc(k,U){return Zr(k,U,qa||(qa={1:Ar,2:Ar,3:Ar,4:Ar,5:Ar,6:Zt}))}function No(k){xr.call(this,k,-1,nu)}function N_(k,U){return Zr(k,U,Qr||(Qr={1:Tc,2:Tc,3:Zd,4:Jd}))}f(Ei,xr),f(No,xr),No.prototype.getVertexType=function(){return Ie(this,1,0)},No.prototype.getPrimitiveType=function(){return Ie(this,2,0)},No.prototype.getVertexBufferList=function(){return Bf(this)},No.prototype.getIndexBufferList=function(){return ul(this,4)};var Ya,nu=[3,4];function pl(k){xr.call(this,k)}function P_(k,U){return Zr(k,U,Ya||(Ya={1:[Ih,No,N_],2:[Ih,Fs,tr]}))}f(pl,xr),pl.prototype.getMesh=function(){return Fo(this,No,1)},pl.prototype.getPoseTransformMatrix=function(){return Fo(this,Fs,2)};var Uf=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Fa=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Rh=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Fh=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Hf=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],iu=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],L_=[].concat(xe(Uf),xe(Fa),xe(Rh),xe(Fh),xe(Hf),xe(iu));function Wo(k,U,F){if(F=k.createShader(0===F?k.VERTEX_SHADER:k.FRAGMENT_SHADER),k.shaderSource(F,U),k.compileShader(F),!k.getShaderParameter(F,k.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+k.getShaderInfoLog(F));return F}function Lt(k){return fo(k,hl,1).map(function(U){return{index:Ie(U,1,0),score:Aa(U,2),label:null!=ar(U,3)?Ie(U,3,""):void 0,displayName:null!=ar(U,4)?Ie(U,4,""):void 0}})}function Rx(k){return{x:Aa(k,1),y:Aa(k,2),z:Aa(k,3),visibility:null!=ar(k,4)?Aa(k,4):void 0}}function Nc(k){return fo(ds(k,zl,Vl),_n,1).map(Rx)}function jf(k,U){this.h=k,this.g=U,this.l=0}function St(k,U,F){return function Fx(k,U){var F=k.g;if(void 0===k.m){var ge=Wo(F,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),Fe=Wo(F,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),Ke=F.createProgram();if(F.attachShader(Ke,ge),F.attachShader(Ke,Fe),F.linkProgram(Ke),!F.getProgramParameter(Ke,F.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+F.getProgramInfoLog(Ke));ge=k.m=Ke,F.useProgram(ge),Fe=F.getUniformLocation(ge,"sampler0"),k.j={I:F.getAttribLocation(ge,"aVertex"),H:F.getAttribLocation(ge,"aTex"),ca:Fe},k.s=F.createBuffer(),F.bindBuffer(F.ARRAY_BUFFER,k.s),F.enableVertexAttribArray(k.j.I),F.vertexAttribPointer(k.j.I,2,F.FLOAT,!1,0,0),F.bufferData(F.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),F.STATIC_DRAW),F.bindBuffer(F.ARRAY_BUFFER,null),k.o=F.createBuffer(),F.bindBuffer(F.ARRAY_BUFFER,k.o),F.enableVertexAttribArray(k.j.H),F.vertexAttribPointer(k.j.H,2,F.FLOAT,!1,0,0),F.bufferData(F.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),F.STATIC_DRAW),F.bindBuffer(F.ARRAY_BUFFER,null),F.uniform1i(Fe,0)}ge=k.j,F.useProgram(k.m),F.canvas.width=U.width,F.canvas.height=U.height,F.viewport(0,0,U.width,U.height),F.activeTexture(F.TEXTURE0),k.h.bindTexture2d(U.glName),F.enableVertexAttribArray(ge.I),F.bindBuffer(F.ARRAY_BUFFER,k.s),F.vertexAttribPointer(ge.I,2,F.FLOAT,!1,0,0),F.enableVertexAttribArray(ge.H),F.bindBuffer(F.ARRAY_BUFFER,k.o),F.vertexAttribPointer(ge.H,2,F.FLOAT,!1,0,0),F.bindFramebuffer(F.DRAW_FRAMEBUFFER?F.DRAW_FRAMEBUFFER:F.FRAMEBUFFER,null),F.clearColor(0,0,0,0),F.clear(F.COLOR_BUFFER_BIT),F.colorMask(!0,!0,!0,!0),F.drawArrays(F.TRIANGLE_FAN,0,4),F.disableVertexAttribArray(ge.I),F.disableVertexAttribArray(ge.H),F.bindBuffer(F.ARRAY_BUFFER,null),k.h.bindTexture2d(0)}(k,U),"function"==typeof k.g.canvas.transferToImageBitmap?Promise.resolve(k.g.canvas.transferToImageBitmap()):F?Promise.resolve(k.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(k.g.canvas):(void 0===k.i&&(k.i=document.createElement("canvas")),new Promise(function(ge){k.i.height=k.g.canvas.height,k.i.width=k.g.canvas.width,k.i.getContext("2d",{}).drawImage(k.g.canvas,0,0,k.g.canvas.width,k.g.canvas.height),ge(k.i)}))}function $t(k){this.g=k}var fl=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function B_(k,U){return U+k}function $e(k,U){window[k]=U}function ru(k){if(this.g=k,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=k&&k.locateFile||B_,"object"==typeof window)var U=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(!(typeof location<"u"))throw Error("solutions can only be loaded on a web page or in a web worker");U=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=U,k.options)for(var F=(U=K(Object.keys(k.options))).next();!F.done;F=U.next()){var ge=k.options[F=F.value].default;void 0!==ge&&(this.j[F]="function"==typeof ge?ge():ge)}}function Nh(k,U){var F,ge;return ke(function(Fe){return U in k.F?Fe.return(k.F[U]):(F=k.locateFile(U,""),ge=fetch(F).then(function(Ke){return Ke.arrayBuffer()}),k.F[U]=ge,Fe.return(ge))})}function z_(k,U){for(var F=U.name||"$",ge=[].concat(xe(U.wants)),Fe=new k.h.StringList,Ke=K(U.wants),Pe=Ke.next();!Pe.done;Pe=Ke.next())Fe.push_back(Pe.value);Ke=k.h.PacketListener.implement({onResults:function(gt){for(var lt={},At=0;At<U.wants.length;++At)lt[ge[At]]=gt.get(At);var vn=k.listeners[F];vn&&(k.C=function kn(k,U,F){var ge,Fe,Ke,Pe,lt,At,vn,Dn,wn,on,Cn,Ft;return ke(function(Xn){switch(Xn.g){case 1:if(!F)return Xn.return(U);for(ge={},Fe=0,Ke=K(Object.keys(F)),Pe=Ke.next();!Pe.done;Pe=Ke.next())"string"!=typeof(lt=F[Pe.value])&&"texture"===lt.type&&void 0!==U[lt.stream]&&++Fe;1<Fe&&(k.G=!1),At=K(Object.keys(F)),Pe=At.next();case 2:if(Pe.done){Xn.g=4;break}if("string"==typeof(Dn=F[vn=Pe.value]))return Cn=ge,Ft=vn,R(Xn,function Ph(k,U,F){var ge;return ke(function(Fe){return"number"==typeof F||F instanceof Uint8Array||F instanceof k.h.Uint8BlobList?Fe.return(F):F instanceof k.h.Texture2dDataOut?((ge=k.s[U])||(ge=new jf(k.h,k.D),k.s[U]=ge),Fe.return(St(ge,F,k.G))):Fe.return(void 0)})}(k,vn,U[Dn]),14);if(wn=U[Dn.stream],"detection_list"===Dn.type){if(wn){for(var ei=wn.getRectList(),sr=wn.getLandmarksList(),Nt=wn.getClassificationsList(),Pn=[],qi=0;qi<ei.size();++qi){var Jr=ds(ei.get(qi),Ei,Oc);Jr={T:{X:Aa(Jr,1),Y:Aa(Jr,2),height:Aa(Jr,3),width:Aa(Jr,4),rotation:Aa(Jr,5,0),W:Ie(Jr,6,0)},O:Nc(sr.get(qi)),M:Lt(ds(Nt.get(qi),Fi,Vf))},Pn.push(Jr)}ei=Pn}else ei=[];ge[vn]=ei,Xn.g=7;break}if("proto_list"===Dn.type){if(wn){for(ei=Array(wn.size()),sr=0;sr<wn.size();sr++)ei[sr]=wn.get(sr);wn.delete()}else ei=[];ge[vn]=ei,Xn.g=7;break}if(void 0===wn){Xn.g=3;break}if("float_list"===Dn.type){ge[vn]=wn,Xn.g=7;break}if("proto"===Dn.type){ge[vn]=wn,Xn.g=7;break}if("texture"!==Dn.type)throw Error("Unknown output config type: '"+Dn.type+"'");return(on=k.s[vn])||(on=new jf(k.h,k.D),k.s[vn]=on),R(Xn,St(on,wn,k.G),13);case 13:ge[vn]=Xn.h;case 7:Dn.transform&&ge[vn]&&(ge[vn]=Dn.transform(ge[vn])),Xn.g=3;break;case 14:Cn[Ft]=Xn.h;case 3:Pe=At.next(),Xn.g=2;break;case 4:return Xn.return(ge)}})}(k,lt,U.outs).then(function(Dn){Dn=vn(Dn);for(var wn=0;wn<U.wants.length;++wn){var on=lt[ge[wn]];"object"==typeof on&&on.hasOwnProperty&&on.hasOwnProperty("delete")&&on.delete()}Dn&&(k.C=Dn)}))}}),k.i.attachMultiListener(Fe,Ke),Fe.delete()}function Go(k){return k.map(Gf)}function Gf(k){var U=(k=ds(k,pl,P_)).getMesh();if(!U)return k;var F=new Float32Array(U.getVertexBufferList());U.getVertexBufferList=function(){return F};var ge=new Uint32Array(U.getIndexBufferList());return U.getIndexBufferList=function(){return ge},k}function Lh(k){var U=this;this.g=new ru({locateFile:(k=k||{}).locateFile,files:[{url:"holistic_solution_packed_assets_loader.js"},{simd:!1,url:"holistic_solution_wasm_bin.js"},{simd:!0,url:"holistic_solution_simd_wasm_bin.js"}],graph:{url:"holistic.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:"left_hand_landmarks right_hand_landmarks face_landmarks pose_landmarks world_landmarks segmentation_mask image_transformed multi_face_geometry".split(" "),outs:{image:{type:"texture",stream:"image_transformed"},leftHandLandmarks:{type:"proto",stream:"left_hand_landmarks",transform:Nc},rightHandLandmarks:{type:"proto",stream:"right_hand_landmarks",transform:Nc},faceLandmarks:{type:"proto",stream:"face_landmarks",transform:Nc},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Nc},ea:{type:"proto",stream:"world_landmarks",transform:Nc},segmentationMask:{type:"texture",stream:"segmentation_mask"},multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:Go}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,default:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(F){var ge,Fe,Ke;return ke(function(gt){if(1==gt.g){switch(ge="",F){case 1:ge="pose_landmark_full.tflite";break;case 2:ge="pose_landmark_heavy.tflite";break;default:ge="pose_landmark_lite.tflite"}return Fe="third_party/mediapipe/modules/pose_landmark/"+ge,Ke=U.g.locateFile(ge,""),R(gt,fetch(Ke),3)}return 2!=gt.g?R(gt,gt.h.arrayBuffer(),2):(U.g.overrideFile(Fe,gt.h),R(gt,U.g.reset(),0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},refineFaceLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineFaceLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}})}(cn=ru.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},cn.reset=function(){var k=this;return ke(function(U){k.i&&(k.i.reset(),k.m={},k.s={}),U.g=0})},cn.setOptions=function(k,U){var F=this;if(U=U||this.g.options){for(var ge=[],Fe=[],Ke={},Pe=K(Object.keys(k)),gt=Pe.next();!gt.done;Ke={K:Ke.K,L:Ke.L},gt=Pe.next()){var lt=gt.value;lt in this.j&&this.j[lt]===k[lt]||(this.j[lt]=k[lt],void 0!==(gt=U[lt])&&(gt.onChange&&(Ke.K=gt.onChange,Ke.L=k[lt],ge.push(function(At){return function(){return ke(function(Dn){if(1==Dn.g)return R(Dn,At.K(At.L),2);!0===Dn.h&&(F.o=!0),Dn.g=0})}}(Ke))),gt.graphOptionXref&&(lt={valueNumber:1===gt.type?k[lt]:0,valueBoolean:0===gt.type&&k[lt],valueString:2===gt.type?k[lt]:""},gt=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),gt.graphOptionXref),lt),Fe.push(gt))))}(0!==ge.length||0!==Fe.length)&&(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(Fe),this.v=(void 0===this.v?[]:this.v).concat(ge))}},cn.initialize=function(){var k=this;return ke(function(U){return 1==U.g?R(U,function ou(k){var U,F,ge,Fe,Ke,Pe,gt,lt,At,vn,Dn;return ke(function(wn){switch(wn.g){case 1:return k.R?(U=void 0===k.g.files?[]:"function"==typeof k.g.files?k.g.files(k.j):k.g.files,R(wn,function Ka(){return ke(function(k){switch(k.g){case 1:return k.m=2,R(k,WebAssembly.instantiate(fl),4);case 4:k.g=3,k.m=0;break;case 2:return k.m=0,k.j=null,k.return(!1);case 3:return k.return(!0)}})}(),2)):wn.return();case 2:if(F=wn.h,"object"==typeof window)return $e("createMediapipeSolutionsWasm",{locateFile:k.locateFile}),$e("createMediapipeSolutionsPackedAssets",{locateFile:k.locateFile}),Pe=U.filter(function(on){return void 0!==on.data}),gt=U.filter(function(on){return void 0===on.data}),lt=Promise.all(Pe.map(function(on){var ee=Nh(k,on.url);if(void 0!==on.path){var Cn=on.path;ee=ee.then(function(Ft){return k.overrideFile(Cn,Ft),Promise.resolve(Ft)})}return ee})),At=Promise.all(gt.map(function(on){return void 0===on.simd||on.simd&&F||!on.simd&&!F?function Kn(k){var U=document.createElement("script");return U.setAttribute("src",k),U.setAttribute("crossorigin","anonymous"),new Promise(function(F){U.addEventListener("load",function(){F()},!1),U.addEventListener("error",function(){F()},!1),document.body.appendChild(U)})}(k.locateFile(on.url,k.S)):Promise.resolve()})).then(function(){var on,ee,Cn;return ke(function(Ft){if(1==Ft.g)return on=window.createMediapipeSolutionsWasm,ee=window.createMediapipeSolutionsPackedAssets,Cn=k,R(Ft,on(ee),2);Cn.h=Ft.h,Ft.g=0})}),vn=ke(function(on){return k.g.graph&&k.g.graph.url?on=R(on,Nh(k,k.g.graph.url),0):(on.g=0,on=void 0),on}),R(wn,Promise.all([At,lt,vn]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return ge=U.filter(function(on){return void 0===on.simd||on.simd&&F||!on.simd&&!F}).map(function(on){return k.locateFile(on.url,k.S)}),importScripts.apply(null,xe(ge)),Fe=k,R(wn,createMediapipeSolutionsWasm(Module),6);case 6:Fe.h=wn.h,k.l=new OffscreenCanvas(1,1),k.h.canvas=k.l,Ke=k.h.GL.createContext(k.l,{antialias:!1,alpha:!1,aa:typeof WebGL2RenderingContext<"u"?2:1}),k.h.GL.makeContextCurrent(Ke),wn.g=4;break;case 7:if(k.l=document.createElement("canvas"),!(Dn=k.l.getContext("webgl2",{}))&&!(Dn=k.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),wn.return();k.D=Dn,k.h.canvas=k.l,k.h.createContext(k.l,!0,!0,{});case 4:k.i=new k.h.SolutionWasm,k.R=!1,wn.g=0}})}(k),2):3!=U.g?R(U,function Oh(k){var F,ge,Fe,Ke,Pe,lt;return ke(function(At){if(1==At.g)return k.g.graph&&k.g.graph.url&&k.P===k.g.graph.url?At.return():(k.o=!0,k.g.graph&&k.g.graph.url?(k.P=k.g.graph.url,R(At,Nh(k,k.g.graph.url),3)):void(At.g=2));for(2!=At.g&&k.i.loadGraph(At.h),F=K(Object.keys(k.B)),ge=F.next();!ge.done;ge=F.next())k.i.overrideFile(Fe=ge.value,k.B[Fe]);if(k.B={},k.g.listeners)for(Ke=K(k.g.listeners),Pe=Ke.next();!Pe.done;Pe=Ke.next())z_(k,Pe.value);lt=k.j,k.j={},k.setOptions(lt),At.g=0})}(k),3):R(U,function Wf(k){var U,F,Fe,Ke,Pe;return ke(function(lt){switch(lt.g){case 1:if(!k.o)return lt.return();if(!k.v){lt.g=2;break}U=K(k.v),F=U.next();case 3:if(F.done){lt.g=5;break}return R(lt,(0,F.value)(),4);case 4:F=U.next(),lt.g=3;break;case 5:k.v=void 0;case 2:if(k.A){for(Fe=new k.h.GraphOptionChangeRequestList,Ke=K(k.A),Pe=Ke.next();!Pe.done;Pe=Ke.next())Fe.push_back(Pe.value);k.i.changeOptions(Fe),Fe.delete(),k.A=void 0}k.o=!1,lt.g=0}})}(k),0)})},cn.overrideFile=function(k,U){this.i?this.i.overrideFile(k,U):this.B[k]=U},cn.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},cn.send=function(k,U){var ge,Fe,Ke,Pe,gt,lt,At,vn,Dn,F=this;return ke(function(wn){switch(wn.g){case 1:return F.g.inputs?(ge=1e3*(U??performance.now()),R(wn,F.C,2)):wn.return();case 2:return R(wn,F.initialize(),3);case 3:for(Fe=new F.h.PacketDataList,Ke=K(Object.keys(k)),Pe=Ke.next();!Pe.done;Pe=Ke.next())if(lt=F.g.inputs[gt=Pe.value]){e:{var on=k[gt];switch(lt.type){case"video":var ee=F.m[lt.stream];if(ee||(ee=new jf(F.h,F.D),F.m[lt.stream]=ee),0===ee.l&&(ee.l=ee.h.createTexture()),typeof HTMLVideoElement<"u"&&on instanceof HTMLVideoElement)var Cn=on.videoWidth,Ft=on.videoHeight;else typeof HTMLImageElement<"u"&&on instanceof HTMLImageElement?(Cn=on.naturalWidth,Ft=on.naturalHeight):(Cn=on.width,Ft=on.height);Ft={glName:ee.l,width:Cn,height:Ft},(Cn=ee.g).canvas.width=Ft.width,Cn.canvas.height=Ft.height,Cn.activeTexture(Cn.TEXTURE0),ee.h.bindTexture2d(ee.l),Cn.texImage2D(Cn.TEXTURE_2D,0,Cn.RGBA,Cn.RGBA,Cn.UNSIGNED_BYTE,on),ee.h.bindTexture2d(0),ee=Ft;break e;case"detections":for((ee=F.m[lt.stream])||(ee=new $t(F.h),F.m[lt.stream]=ee),ee.data||(ee.data=new ee.g.DetectionListData),ee.data.reset(on.length),Ft=0;Ft<on.length;++Ft){var Xn=ee.data,ei=Xn.setBoundingBox,sr=Ft,Nt=(Cn=on[Ft]).T,Pn=new Ei;if(Ai(Pn,1,Nt.X),Ai(Pn,2,Nt.Y),Ai(Pn,3,Nt.height),Ai(Pn,4,Nt.width),Ai(Pn,5,Nt.rotation),Ai(Pn,6,Nt.W),Nt=Mc(Pn,O_),ei.call(Xn,sr,Nt),Cn.O)for(Xn=0;Xn<Cn.O.length;++Xn){var qi=!!(Pn=Cn.O[Xn]).visibility;sr=(ei=ee.data).addNormalizedLandmark,Nt=Ft,Pn=Object.assign(Object.assign({},Pn),{visibility:qi?Pn.visibility:0}),Ai(qi=new _n,1,Pn.x),Ai(qi,2,Pn.y),Ai(qi,3,Pn.z),Pn.visibility&&Ai(qi,4,Pn.visibility),Pn=Mc(qi,tu),sr.call(ei,Nt,Pn)}if(Cn.M)for(Xn=0;Xn<Cn.M.length;++Xn)sr=(ei=ee.data).addClassification,Nt=Ft,Pn=Cn.M[Xn],Ai(qi=new hl,2,Pn.score),Pn.index&&Ai(qi,1,Pn.index),Pn.label&&Ai(qi,3,Pn.label),Pn.displayName&&Ai(qi,4,Pn.displayName),Pn=Mc(qi,Ri),sr.call(ei,Nt,Pn)}ee=ee.data;break e;default:ee={}}}switch(At=ee,vn=lt.stream,lt.type){case"video":Fe.pushTexture2d(Object.assign(Object.assign({},At),{stream:vn,timestamp:ge}));break;case"detections":(Dn=At).stream=vn,Dn.timestamp=ge,Fe.pushDetectionList(Dn);break;default:throw Error("Unknown input config type: '"+lt.type+"'")}}return F.i.send(Fe),R(wn,F.C,4);case 4:Fe.delete(),wn.g=0}})},cn.onResults=function(k,U){this.listeners[U||"$"]=k},Ee("Solution",ru),Ee("OptionType",{BOOL:0,NUMBER:1,Z:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(cn=Lh.prototype).close=function(){return this.g.close(),Promise.resolve()},cn.onResults=function(k){this.g.onResults(k)},cn.initialize=function(){var k=this;return ke(function(U){return R(U,k.g.initialize(),0)})},cn.reset=function(){this.g.reset()},cn.send=function(k){var U=this;return ke(function(F){return R(F,U.g.send(k),0)})},cn.setOptions=function(k){this.g.setOptions(k)},Ee("Holistic",Lh),Ee("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),Ee("FACEMESH_LIPS",Uf),Ee("FACEMESH_LEFT_EYE",Fa),Ee("FACEMESH_LEFT_EYEBROW",Rh),Ee("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),Ee("FACEMESH_RIGHT_EYE",Fh),Ee("FACEMESH_RIGHT_EYEBROW",Hf),Ee("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),Ee("FACEMESH_FACE_OVAL",iu),Ee("FACEMESH_CONTOURS",L_),Ee("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),Ee("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),Ee("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),Ee("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),Ee("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),Ee("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),Ee("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),Ee("matrixDataToMatrix",function(k){for(var U=k.getCols(),F=k.getRows(),ge=k.getPackedDataList(),Fe=[],Ke=0;Ke<F;Ke++)Fe.push(Array(U));for(Ke=0;Ke<F;Ke++)for(var Pe=0;Pe<U;Pe++){var gt=1===k.getLayout()?Ke*U+Pe:Pe*F+Ke;Fe[Ke][Pe]=ge[gt]}return Fe}),Ee("VERSION","0.5.1635989137")}).call(this)},208:(cn,ye,Re)=>{"use strict";function ie(n){return"function"==typeof n}function ce(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const j=ce(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,l)=>`${l+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function J(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class K{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const d of e)d.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(ie(r))try{r()}catch(d){t=d instanceof j?d.errors:[d]}const{_finalizers:l}=this;if(l){this._finalizers=null;for(const d of l)try{pe(d)}catch(h){t=t??[],h instanceof j?t=[...t,...h.errors]:t.push(h)}}if(t)throw new j(t)}}add(t){var e;if(t&&t!==this)if(this.closed)pe(t);else{if(t instanceof K){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&J(e,t)}remove(t){const{_finalizers:e}=this;e&&J(e,t),t instanceof K&&t._removeParent(this)}}K.EMPTY=(()=>{const n=new K;return n.closed=!0,n})();const xe=K.EMPTY;function E(n){return n instanceof K||n&&"closed"in n&&ie(n.remove)&&ie(n.add)&&ie(n.unsubscribe)}function pe(n){ie(n)?n():n.unsubscribe()}const te={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Z={setTimeout(n,t,...e){const{delegate:r}=Z;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=Z;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Y(n){Z.setTimeout(()=>{const{onUnhandledError:t}=te;if(!t)throw n;t(n)})}function z(){}const f=T("C",void 0,void 0);function T(n,t,e){return{kind:n,value:t,error:e}}let R=null;function H(n){if(te.useDeprecatedSynchronousErrorHandling){const t=!R;if(t&&(R={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=R;if(R=null,e)throw r}}else n()}class oe extends K{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,E(t)&&t.add(this)):this.destination=Ee}static create(t,e,r){return new ke(t,e,r)}next(t){this.isStopped?$(function w(n){return T("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?$(function b(n){return T("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?$(f,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ve=Function.prototype.bind;function we(n,t){return ve.call(n,t)}class de{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){ae(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){ae(r)}else ae(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){ae(e)}}}class ke extends oe{constructor(t,e,r){let l;if(super(),ie(t)||!t)l={next:t??void 0,error:e??void 0,complete:r??void 0};else{let d;this&&te.useDeprecatedNextContext?(d=Object.create(t),d.unsubscribe=()=>this.unsubscribe(),l={next:t.next&&we(t.next,d),error:t.error&&we(t.error,d),complete:t.complete&&we(t.complete,d)}):l=t}this.destination=new de(l)}}function ae(n){te.useDeprecatedSynchronousErrorHandling?function L(n){te.useDeprecatedSynchronousErrorHandling&&R&&(R.errorThrown=!0,R.error=n)}(n):Y(n)}function $(n,t){const{onStoppedNotification:e}=te;e&&Z.setTimeout(()=>e(n,t))}const Ee={closed:!0,next:z,error:function De(n){throw n},complete:z},ht="function"==typeof Symbol&&Symbol.observable||"@@observable";function Be(n){return n}function Ve(n){return 0===n.length?Be:1===n.length?n[0]:function(e){return n.reduce((r,l)=>l(r),e)}}let pt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,l){const d=function Jt(n){return n&&n instanceof oe||function Ge(n){return n&&ie(n.next)&&ie(n.error)&&ie(n.complete)}(n)&&E(n)}(e)?e:new ke(e,r,l);return H(()=>{const{operator:h,source:_}=this;d.add(h?h.call(d,_):_?this._subscribe(d):this._trySubscribe(d))}),d}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=ze(r))((l,d)=>{const h=new ke({next:_=>{try{e(_)}catch(x){d(x),h.unsubscribe()}},error:d,complete:l});this.subscribe(h)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[ht](){return this}pipe(...e){return Ve(e)(this)}toPromise(e){return new(e=ze(e))((r,l)=>{let d;this.subscribe(h=>d=h,h=>l(h),()=>r(d))})}}return n.create=t=>new n(t),n})();function ze(n){var t;return null!==(t=n??te.Promise)&&void 0!==t?t:Promise}const zt=ce(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Le=(()=>{class n extends pt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new Di(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new zt}next(e){H(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){H(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){H(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:l,observers:d}=this;return r||l?xe:(this.currentObservers=null,d.push(e),new K(()=>{this.currentObservers=null,J(d,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:l,isStopped:d}=this;r?e.error(l):d&&e.complete()}asObservable(){const e=new pt;return e.source=this,e}}return n.create=(t,e)=>new Di(t,e),n})();class Di extends Le{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:xe}}function dn(n){return ie(n?.lift)}function en(n){return t=>{if(dn(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function pn(n,t,e,r,l){return new fr(n,t,e,r,l)}class fr extends oe{constructor(t,e,r,l,d,h){super(t),this.onFinalize=d,this.shouldUnsubscribe=h,this._next=e?function(_){try{e(_)}catch(x){t.error(x)}}:super._next,this._error=l?function(_){try{l(_)}catch(x){t.error(x)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(_){t.error(_)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function Pt(n,t){return en((e,r)=>{let l=0;e.subscribe(pn(r,d=>{r.next(n.call(t,d,l++))}))})}function Nn(n){return this instanceof Nn?(this.v=n,this):new Nn(n)}function po(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,r=e.apply(n,t||[]),d=[];return l={},h("next"),h("throw"),h("return"),l[Symbol.asyncIterator]=function(){return this},l;function h(ne){r[ne]&&(l[ne]=function(he){return new Promise(function(Ce,Ae){d.push([ne,he,Ce,Ae])>1||_(ne,he)})})}function _(ne,he){try{!function x(ne){ne.value instanceof Nn?Promise.resolve(ne.value.v).then(D,I):V(d[0][2],ne)}(r[ne](he))}catch(Ce){V(d[0][3],Ce)}}function D(ne){_("next",ne)}function I(ne){_("throw",ne)}function V(ne,he){ne(he),d.shift(),d.length&&_(d[0][0],d[0][1])}}function Ao(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function qe(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(d){e[d]=n[d]&&function(h){return new Promise(function(_,x){!function l(d,h,_,x){Promise.resolve(x).then(function(D){d({value:D,done:_})},h)}(_,x,(h=n[d](h)).done,h.value)})}}}const As=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Rs(n){return ie(n?.then)}function Ta(n){return ie(n[ht])}function Ia(n){return Symbol.asyncIterator&&ie(n?.[Symbol.asyncIterator])}function da(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const dr=function A_(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function kc(n){return ie(n?.[dr])}function er(n){return po(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:l}=yield Nn(e.read());if(l)return yield Nn(void 0);yield yield Nn(r)}}finally{e.releaseLock()}})}function xr(n){return ie(n?.getReader)}function Ir(n){if(n instanceof pt)return n;if(null!=n){if(Ta(n))return function Xd(n){return new pt(t=>{const e=n[ht]();if(ie(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(As(n))return function ar(n){return new pt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Rs(n))return function ul(n){return new pt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Y)})}(n);if(Ia(n))return Ie(n);if(kc(n))return function Bf(n){return new pt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(xr(n))return function Aa(n){return Ie(er(n))}(n)}throw da(n)}function Ie(n){return new pt(t=>{(function Ai(n,t){var e,r,l,d;return function Oe(n,t,e,r){return new(e||(e=Promise))(function(d,h){function _(I){try{D(r.next(I))}catch(V){h(V)}}function x(I){try{D(r.throw(I))}catch(V){h(V)}}function D(I){I.done?d(I.value):function l(d){return d instanceof e?d:new e(function(h){h(d)})}(I.value).then(_,x)}D((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Ao(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(h){l={error:h}}finally{try{r&&!r.done&&(d=e.return)&&(yield d.call(e))}finally{if(l)throw l.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Fo(n,t,e,r=0,l=!1){const d=t.schedule(function(){e(),l?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(d),!l)return d}function Mi(n,t,e=1/0){return ie(t)?Mi((r,l)=>Pt((d,h)=>t(r,d,l,h))(Ir(n(r,l))),e):("number"==typeof t&&(e=t),en((r,l)=>function fo(n,t,e,r,l,d,h,_){const x=[];let D=0,I=0,V=!1;const ne=()=>{V&&!x.length&&!D&&t.complete()},he=Ae=>D<r?Ce(Ae):x.push(Ae),Ce=Ae=>{d&&t.next(Ae),D++;let He=!1;Ir(e(Ae,I++)).subscribe(pn(t,rt=>{l?.(rt),d?he(rt):t.next(rt)},()=>{He=!0},void 0,()=>{if(He)try{for(D--;x.length&&D<r;){const rt=x.shift();h?Fo(t,h,()=>Ce(rt)):Ce(rt)}ne()}catch(rt){t.error(rt)}}))};return n.subscribe(pn(t,he,()=>{V=!0,ne()})),()=>{_?.()}}(r,l,n,e)))}function Vr(n=1/0){return Mi(Be,n)}const Oo=new pt(n=>n.complete());function Mc(n){return n&&ie(n.schedule)}function ds(n){return n[n.length-1]}function ro(n){return ie(ds(n))?n.pop():void 0}function Ar(n){return Mc(ds(n))?n.pop():void 0}function Zt(n,t=0){return en((e,r)=>{e.subscribe(pn(r,l=>Fo(r,n,()=>r.next(l),t),()=>Fo(r,n,()=>r.complete(),t),l=>Fo(r,n,()=>r.error(l),t)))})}function Qd(n,t=0){return en((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function Tc(n,t){if(!n)throw new Error("Iterable cannot be null");return new pt(e=>{Fo(e,t,()=>{const r=n[Symbol.asyncIterator]();Fo(e,t,()=>{r.next().then(l=>{l.done?e.complete():e.next(l.value)})},0,!0)})})}function tr(n,t){return t?function Ic(n,t){if(null!=n){if(Ta(n))return function zf(n,t){return Ir(n).pipe(Qd(t),Zt(t))}(n,t);if(As(n))return function Ah(n,t){return new pt(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(Rs(n))return function Ih(n,t){return Ir(n).pipe(Qd(t),Zt(t))}(n,t);if(Ia(n))return Tc(n,t);if(kc(n))return function Jd(n,t){return new pt(e=>{let r;return Fo(e,t,()=>{r=n[dr](),Fo(e,t,()=>{let l,d;try{({value:l,done:d}=r.next())}catch(h){return void e.error(h)}d?e.complete():e.next(l)},0,!0)}),()=>ie(r?.return)&&r.return()})}(n,t);if(xr(n))return function Fs(n,t){return Tc(er(n),t)}(n,t)}throw da(n)}(n,t):Ir(n)}function Ra(...n){const t=Ar(n),e=function Zd(n,t){return"number"==typeof ds(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?Ir(r[0]):Vr(e)(tr(r,t)):Oo}function hl(n={}){const{connector:t=(()=>new Le),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:l=!0}=n;return d=>{let h,_,x,D=0,I=!1,V=!1;const ne=()=>{_?.unsubscribe(),_=void 0},he=()=>{ne(),h=x=void 0,I=V=!1},Ce=()=>{const Ae=h;he(),Ae?.unsubscribe()};return en((Ae,He)=>{D++,!V&&!I&&ne();const rt=x=x??t();He.add(()=>{D--,0===D&&!V&&!I&&(_=Ac(Ce,l))}),rt.subscribe(He),!h&&D>0&&(h=new ke({next:Tt=>rt.next(Tt),error:Tt=>{V=!0,ne(),_=Ac(he,e,Tt),rt.error(Tt)},complete:()=>{I=!0,ne(),_=Ac(he,r),rt.complete()}}),Ir(Ae).subscribe(h))})(d)}}function Ac(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new ke({next:()=>{r.unsubscribe(),n()}});return t(...e).subscribe(r)}function Ri(n){for(let t in n)if(n[t]===Ri)return t;throw Error("Could not find renamed property on target object.")}function eu(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Fi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Fi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function Rc(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Vf=Ri({__forward_ref__:Ri});function Yn(n){return n.__forward_ref__=Yn,n.toString=function(){return Fi(this())},n}function _n(n){return Fc(n)?n():n}function Fc(n){return"function"==typeof n&&n.hasOwnProperty(Vf)&&n.__forward_ref__===Yn}function tu(n){return n&&!!n.\u0275providers}const zl="https://g.co/ng/security#xss";class ot extends Error{constructor(t,e){super(function Vl(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function An(n){return"string"==typeof n?n:null==n?"":String(n)}function No(n,t){throw new ot(-201,!1)}function Wo(n,t){null==n&&function Lt(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}(t,n,null,"!=")}function St(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function $t(n){return{providers:n.providers||[],imports:n.imports||[]}}function fl(n){return $e(n,ou)||$e(n,Wf)}function $e(n,t){return n.hasOwnProperty(t)?n[t]:null}function ru(n){return n&&(n.hasOwnProperty(Oh)||n.hasOwnProperty(Nh))?n[Oh]:null}const ou=Ri({\u0275prov:Ri}),Oh=Ri({\u0275inj:Ri}),Wf=Ri({ngInjectableDef:Ri}),Nh=Ri({ngInjectorDef:Ri});var kn=(()=>((kn=kn||{})[kn.Default=0]="Default",kn[kn.Host=1]="Host",kn[kn.Self=2]="Self",kn[kn.SkipSelf=4]="SkipSelf",kn[kn.Optional=8]="Optional",kn))();let Ph;function Go(n){const t=Ph;return Ph=n,t}function Gf(n,t,e){const r=fl(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&kn.Optional?null:void 0!==t?t:void No(Fi(n))}const k=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Fe={},Ke="__NG_DI_FLAG__",Pe="ngTempTokenPath",lt=/\n/gm,vn="__source";let Dn;function wn(n){const t=Dn;return Dn=n,t}function on(n,t=kn.Default){if(void 0===Dn)throw new ot(-203,!1);return null===Dn?Gf(n,void 0,t):Dn.get(n,t&kn.Optional?null:void 0,t)}function ee(n,t=kn.Default){return(function z_(){return Ph}()||on)(_n(n),t)}function Ft(n,t=kn.Default){return ee(n,Xn(t))}function Xn(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function ei(n){const t=[];for(let e=0;e<n.length;e++){const r=_n(n[e]);if(Array.isArray(r)){if(0===r.length)throw new ot(900,!1);let l,d=kn.Default;for(let h=0;h<r.length;h++){const _=r[h],x=Nt(_);"number"==typeof x?-1===x?l=_.token:d|=x:l=_}t.push(ee(l,d))}else t.push(ee(r))}return t}function sr(n,t){return n[Ke]=t,n.prototype[Ke]=t,n}function Nt(n){return n[Ke]}function Jr(n){return{toString:n}.toString()}var oo=(()=>((oo=oo||{})[oo.OnPush=0]="OnPush",oo[oo.Default=1]="Default",oo))(),Oa=(()=>{return(n=Oa||(Oa={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Oa;var n})();const ao={},fn=[],ml=Ri({\u0275cmp:Ri}),Bh=Ri({\u0275dir:Ri}),au=Ri({\u0275pipe:Ri}),ua=Ri({\u0275mod:Ri}),$n=Ri({\u0275fac:Ri}),Ur=Ri({__NG_ELEMENT_ID__:Ri});let V_=0;function Mn(n){return Jr(()=>{const e=!0===n.standalone,r={},l={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===oo.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||fn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Oa.Emulated,id:"c"+V_++,styles:n.styles||fn,_:null,setInput:null,schemas:n.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},d=n.dependencies,h=n.features;return l.inputs=Ox(n.inputs,r),l.outputs=Ox(n.outputs),h&&h.forEach(_=>_(l)),l.directiveDefs=d?()=>("function"==typeof d?d():d).map($f).filter(Os):null,l.pipeDefs=d?()=>("function"==typeof d?d():d).map(Rr).filter(Os):null,l})}function $f(n){return Gi(n)||Po(n)}function Os(n){return null!==n}function Vt(n){return Jr(()=>({type:n.type,bootstrap:n.bootstrap||fn,declarations:n.declarations||fn,imports:n.imports||fn,exports:n.exports||fn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Ox(n,t){if(null==n)return ao;const e={};for(const r in n)if(n.hasOwnProperty(r)){let l=n[r],d=l;Array.isArray(l)&&(d=l[1],l=l[0]),e[l]=r,t&&(t[l]=d)}return e}const Ze=Mn;function ha(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Gi(n){return n[ml]||null}function Po(n){return n[Bh]||null}function Rr(n){return n[au]||null}function $o(n,t){const e=n[ua]||null;if(!e&&!0===t)throw new Error(`Type ${Fi(n)} does not have '\u0275mod' property.`);return e}function Bo(n){return Array.isArray(n)&&"object"==typeof n[1]}function fa(n){return Array.isArray(n)&&!0===n[1]}function qf(n){return 0!=(4&n.flags)}function cu(n){return n.componentOffset>-1}function zh(n){return 1==(1&n.flags)}function es(n){return null!==n.template}function G_(n){return 0!=(256&n[2])}function vl(n,t){return n.hasOwnProperty($n)?n[$n]:null}class Qe{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function Ki(){return Fr}function Fr(n){return n.type.prototype.ngOnChanges&&(n.setInput=uu),_i}function _i(){const n=bl(this),t=n?.current;if(t){const e=n.previous;if(e===ao)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function uu(n,t,e,r){const l=this.declaredInputs[e],d=bl(n)||function Uh(n,t){return n[hu]=t}(n,{previous:ao,current:null}),h=d.current||(d.current={}),_=d.previous,x=_[l];h[l]=new Qe(x&&x.currentValue,t,_===ao),n[r]=t}Ki.ngInherit=!0;const hu="__ngSimpleChanges__";function bl(n){return n[hu]||null}function _r(n){for(;Array.isArray(n);)n=n[0];return n}function jc(n,t){return _r(t[n])}function Yo(n,t){return _r(t[n.index])}function Zf(n,t){return n.data[t]}function fu(n,t){return n[t]}function Ko(n,t){const e=t[n];return Bo(e)?e:e[0]}function Qf(n){return 64==(64&n[2])}function Ps(n,t){return null==t?null:n[t]}function Ux(n){n[18]=0}function Jf(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const jn={lFrame:$x(null),bindingsEnabled:!0};function K_(){return jn.bindingsEnabled}function vt(){return jn.lFrame.lView}function wi(){return jn.lFrame.tView}function ts(n){return jn.lFrame.contextLView=n,n[8]}function hs(n){return jn.lFrame.contextLView=null,n}function wr(){let n=X_();for(;null!==n&&64===n.type;)n=n.parent;return n}function X_(){return jn.lFrame.currentTNode}function Ls(n,t){const e=jn.lFrame;e.currentTNode=n,e.isParent=t}function Z_(){return jn.lFrame.isParent}function Q_(){jn.lFrame.isParent=!1}function Hr(){const n=jn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function mu(){return jn.lFrame.bindingIndex++}function yl(n){const t=jn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function _k(n,t){const e=jn.lFrame;e.bindingIndex=e.bindingRootIndex=n,em(t)}function em(n){jn.lFrame.currentDirectiveIndex=n}function Gh(n){const t=jn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}function tm(){return jn.lFrame.currentQueryIndex}function nm(n){jn.lFrame.currentQueryIndex=n}function Gx(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function vr(n,t,e){if(e&kn.SkipSelf){let l=t,d=n;for(;!(l=l.parent,null!==l||e&kn.Host||(l=Gx(d),null===l||(d=d[15],10&l.type))););if(null===l)return!1;t=l,n=d}const r=jn.lFrame=Bs();return r.currentTNode=t,r.lView=n,!0}function im(n){const t=Bs(),e=n[1];jn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Bs(){const n=jn.lFrame,t=null===n?null:n.child;return null===t?$x(n):t}function $x(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function qx(){const n=jn.lFrame;return jn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Yx=qx;function J_(){const n=qx();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Xo(){return jn.lFrame.selectedIndex}function Gc(n){jn.lFrame.selectedIndex=n}function br(){const n=jn.lFrame;return Zf(n.tView,n.selectedIndex)}function Yh(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const d=n.data[e].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:_,ngAfterViewInit:x,ngAfterViewChecked:D,ngOnDestroy:I}=d;h&&(n.contentHooks||(n.contentHooks=[])).push(-e,h),_&&((n.contentHooks||(n.contentHooks=[])).push(e,_),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,_)),x&&(n.viewHooks||(n.viewHooks=[])).push(-e,x),D&&((n.viewHooks||(n.viewHooks=[])).push(e,D),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,D)),null!=I&&(n.destroyHooks||(n.destroyHooks=[])).push(e,I)}}function om(n,t,e){Zx(n,t,3,e)}function am(n,t,e,r){(3&n[2])===e&&Zx(n,t,e,r)}function sm(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function Zx(n,t,e,r){const d=r??-1,h=t.length-1;let _=0;for(let x=void 0!==r?65535&n[18]:0;x<h;x++)if("number"==typeof t[x+1]){if(_=t[x],null!=r&&_>=r)break}else t[x]<0&&(n[18]+=65536),(_<d||-1==d)&&(wk(n,e,t,x),n[18]=(4294901760&n[18])+x+2),x++}function wk(n,t,e,r){const l=e[r]<0,d=e[r+1],_=n[l?-e[r]:e[r]];if(l){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{d.call(_)}finally{}}}else try{d.call(_)}finally{}}class Kh{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function tv(n,t,e){let r=0;for(;r<e.length;){const l=e[r];if("number"==typeof l){if(0!==l)break;r++;const d=e[r++],h=e[r++],_=e[r++];n.setAttribute(t,h,_,d)}else{const d=l,h=e[++r];Jx(d)?n.setProperty(t,d,h):n.setAttribute(t,d,h),r++}}return r}function Qx(n){return 3===n||4===n||6===n}function Jx(n){return 64===n.charCodeAt(0)}function Xh(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const l=t[r];"number"==typeof l?e=l:0===e||nv(n,e,l,null,-1===e||2===e?t[++r]:null)}}return n}function nv(n,t,e,r,l){let d=0,h=n.length;if(-1===t)h=-1;else for(;d<n.length;){const _=n[d++];if("number"==typeof _){if(_===t){h=-1;break}if(_>t){h=d-1;break}}}for(;d<n.length;){const _=n[d];if("number"==typeof _)break;if(_===e){if(null===r)return void(null!==l&&(n[d+1]=l));if(r===n[d+1])return void(n[d+2]=l)}d++,null!==r&&d++,null!==l&&d++}-1!==h&&(n.splice(h,0,t),d=h+1),n.splice(d++,0,e),null!==r&&n.splice(d++,0,r),null!==l&&n.splice(d++,0,l)}function iv(n){return-1!==n}function Zh(n){return 32767&n}function Jh(n,t){let e=function Qh(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let lm=!0;function ep(n){const t=lm;return lm=n,t}let ew=0;const ps={};function tp(n,t){const e=av(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,cm(r.data,n),cm(t,null),cm(r.blueprint,null));const l=dm(n,t),d=n.injectorIndex;if(iv(l)){const h=Zh(l),_=Jh(l,t),x=_[1].data;for(let D=0;D<8;D++)t[d+D]=_[h+D]|x[h+D]}return t[d+8]=l,d}function cm(n,t){n.push(0,0,0,0,0,0,0,0,t)}function av(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function dm(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,l=t;for(;null!==l;){if(r=lw(l),null===r)return-1;if(e++,l=l[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function sv(n,t,e){!function tw(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Ur)&&(r=e[Ur]),null==r&&(r=e[Ur]=ew++);const l=255&r;t.data[n+(l>>5)]|=1<<l}(n,t,e)}function lv(n,t,e){if(e&kn.Optional||void 0!==n)return n;No()}function iw(n,t,e,r){if(e&kn.Optional&&void 0===r&&(r=null),0==(e&(kn.Self|kn.Host))){const l=n[9],d=Go(void 0);try{return l?l.get(t,r,e&kn.Optional):Gf(t,r,e&kn.Optional)}finally{Go(d)}}return lv(r,0,e)}function rw(n,t,e,r=kn.Default,l){if(null!==n){if(1024&t[2]){const h=function dv(n,t,e,r,l){let d=n,h=t;for(;null!==d&&null!==h&&1024&h[2]&&!(256&h[2]);){const _=ow(d,h,e,r|kn.Self,ps);if(_!==ps)return _;let x=d.parent;if(!x){const D=h[21];if(D){const I=D.get(e,ps,r);if(I!==ps)return I}x=lw(h),h=h[15]}d=x}return l}(n,t,e,r,ps);if(h!==ps)return h}const d=ow(n,t,e,r,ps);if(d!==ps)return d}return iw(t,e,r,l)}function ow(n,t,e,r,l){const d=function cv(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Ur)?n[Ur]:void 0;return"number"==typeof t?t>=0?255&t:Tk:t}(e);if("function"==typeof d){if(!vr(t,n,r))return r&kn.Host?lv(l,0,r):iw(t,e,r,l);try{const h=d(r);if(null!=h||r&kn.Optional)return h;No()}finally{Yx()}}else if("number"==typeof d){let h=null,_=av(n,t),x=-1,D=r&kn.Host?t[16][6]:null;for((-1===_||r&kn.SkipSelf)&&(x=-1===_?dm(n,t):t[_+8],-1!==x&&sw(r,!1)?(h=t[1],_=Zh(x),t=Jh(x,t)):_=-1);-1!==_;){const I=t[1];if(aw(d,_,I.data)){const V=Mk(_,t,e,h,r,D);if(V!==ps)return V}x=t[_+8],-1!==x&&sw(r,t[1].data[_+8]===D)&&aw(d,_,t)?(h=I,_=Zh(x),t=Jh(x,t)):_=-1}}return l}function Mk(n,t,e,r,l,d){const h=t[1],_=h.data[n+8],I=um(_,h,e,null==r?cu(_)&&lm:r!=h&&0!=(3&_.type),l&kn.Host&&d===_);return null!==I?$c(t,h,I,_):ps}function um(n,t,e,r,l){const d=n.providerIndexes,h=t.data,_=1048575&d,x=n.directiveStart,I=d>>20,ne=l?_+I:n.directiveEnd;for(let he=r?_:_+I;he<ne;he++){const Ce=h[he];if(he<x&&e===Ce||he>=x&&Ce.type===e)return he}if(l){const he=h[x];if(he&&es(he)&&he.type===e)return x}return null}function $c(n,t,e,r){let l=n[e];const d=t.data;if(function Ck(n){return n instanceof Kh}(l)){const h=l;h.resolving&&function qa(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new ot(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Ei(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():An(n)}(d[e]));const _=ep(h.canSeeViewProviders);h.resolving=!0;const x=h.injectImpl?Go(h.injectImpl):null;vr(n,r,kn.Default);try{l=n[e]=h.factory(void 0,d,n,r),t.firstCreatePass&&e>=r.directiveStart&&function Xx(n,t,e){const{ngOnChanges:r,ngOnInit:l,ngDoCheck:d}=t.type.prototype;if(r){const h=Fr(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,h),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,h)}l&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,l),d&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,d),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,d))}(e,d[e],t)}finally{null!==x&&Go(x),ep(_),h.resolving=!1,Yx()}}return l}function aw(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function sw(n,t){return!(n&kn.Self||n&kn.Host&&t)}class _u{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return rw(this._tNode,this._lView,t,Xn(r),e)}}function Tk(){return new _u(wr(),vt())}function Fn(n){return Jr(()=>{const t=n.prototype.constructor,e=t[$n]||np(t),r=Object.prototype;let l=Object.getPrototypeOf(n.prototype).constructor;for(;l&&l!==r;){const d=l[$n]||np(l);if(d&&d!==e)return d;l=Object.getPrototypeOf(l)}return d=>new d})}function np(n){return Fc(n)?()=>{const t=np(_n(n));return t&&t()}:vl(n)}function lw(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function va(n){return function nw(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let l=0;for(;l<r;){const d=e[l];if(Qx(d))break;if(0===d)l+=2;else if("number"==typeof d)for(l++;l<r&&"string"==typeof e[l];)l++;else{if(d===t)return e[l+1];l+=2}}}return null}(wr(),n)}const bu="__parameters__";function xu(n,t,e){return Jr(()=>{const r=function uv(n){return function(...e){if(n){const r=n(...e);for(const l in r)this[l]=r[l]}}}(t);function l(...d){if(this instanceof l)return r.apply(this,d),this;const h=new l(...d);return _.annotation=h,_;function _(x,D,I){const V=x.hasOwnProperty(bu)?x[bu]:Object.defineProperty(x,bu,{value:[]})[bu];for(;V.length<=I;)V.push(null);return(V[I]=V[I]||[]).push(h),x}}return e&&(l.prototype=Object.create(e.prototype)),l.prototype.ngMetadataName=n,l.annotationCls=l,l})}class Ye{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=St({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Yc(n,t){n.forEach(e=>Array.isArray(e)?Yc(e,t):t(e))}function hv(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function rp(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Cu(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function ba(n,t,e){let r=Kc(n,t);return r>=0?n[1|r]=e:(r=~r,function pw(n,t,e,r){let l=n.length;if(l==t)n.push(e,r);else if(1===l)n.push(r,n[0]),n[0]=e;else{for(l--,n.push(n[l-1],n[l]);l>t;)n[l]=n[l-2],l--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function hm(n,t){const e=Kc(n,t);if(e>=0)return n[1|e]}function Kc(n,t){return function fw(n,t,e){let r=0,l=n.length>>e;for(;l!==r;){const d=r+(l-r>>1),h=n[d<<e];if(t===h)return d<<e;h>t?l=d:r=d+1}return~(l<<e)}(n,t,1)}const op=sr(xu("Inject",n=>({token:n})),-1),Vo=sr(xu("Optional"),8),Uo=sr(xu("SkipSelf"),4);var Qo=(()=>((Qo=Qo||{})[Qo.Important=1]="Important",Qo[Qo.DashCase=2]="DashCase",Qo))();const xm=new Map;let yw=0;const ku="__ngContext__";function vo(n,t){Bo(t)?(n[ku]=t[20],function ww(n){xm.set(n[20],n)}(t)):n[ku]=t}function Sm(n,t){return undefined(n,t)}function Mu(n){const t=n[3];return fa(t)?t[3]:t}function Kl(n){return km(n[13])}function Em(n){return km(n[4])}function km(n){for(;null!==n&&!fa(n);)n=n[4];return n}function Qc(n,t,e,r,l){if(null!=r){let d,h=!1;fa(r)?d=r:Bo(r)&&(h=!0,r=r[0]);const _=_r(r);0===n&&null!==e?null==l?Nv(t,e,_):Xl(t,e,_,l||null,!0):1===n&&null!==e?Xl(t,e,_,l||null,!0):2===n?function Pm(n,t,e){const r=Vs(n,t);r&&function Tw(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}(t,_,h):3===n&&t.destroyNode(_),null!=d&&function Aw(n,t,e,r,l){const d=e[7];d!==_r(e)&&Qc(t,n,r,d,l);for(let _=10;_<e.length;_++){const x=e[_];ya(x[1],x,n,t,r,d)}}(t,n,d,e,l)}}function Mm(n,t,e){return n.createElement(t,e)}function Ov(n,t){const e=n[9],r=e.indexOf(t),l=t[3];512&t[2]&&(t[2]&=-513,Jf(l,-1)),e.splice(r,1)}function Tm(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const l=r[17];null!==l&&l!==n&&Ov(l,r),t>0&&(n[e-1][4]=r[4]);const d=rp(n,10+t);!function Tu(n,t){ya(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const h=d[19];null!==h&&h.detachView(d[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function ed(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&ya(n,t,e,3,null,null),function Ew(n){let t=n[13];if(!t)return Im(n[1],n);for(;t;){let e=null;if(Bo(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)Bo(t)&&Im(t[1],t),t=t[3];null===t&&(t=n),Bo(t)&&Im(t[1],t),e=t&&t[4]}t=e}}(t)}}function Im(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function Mw(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const l=t[e[r]];if(!(l instanceof Kh)){const d=e[r+1];if(Array.isArray(d))for(let h=0;h<d.length;h+=2){const _=l[d[h]],x=d[h+1];try{x.call(_)}finally{}}else try{d.call(l)}finally{}}}}(n,t),function kw(n,t){const e=n.cleanup,r=t[7];let l=-1;if(null!==e)for(let d=0;d<e.length-1;d+=2)if("string"==typeof e[d]){const h=e[d+3];h>=0?r[l=h]():r[l=-h].unsubscribe(),d+=2}else{const h=r[l=e[d+1]];e[d].call(h)}if(null!==r){for(let d=l+1;d<r.length;d++)(0,r[d])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&fa(t[3])){e!==t[3]&&Ov(e,t);const r=t[19];null!==r&&r.detachView(n)}!function Dv(n){xm.delete(n[20])}(t)}}function td(n,t,e){return function Am(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];{const{componentOffset:l}=r;if(l>-1){const{encapsulation:d}=n.data[r.directiveStart+l];if(d===Oa.None||d===Oa.Emulated)return null}return Yo(r,e)}}(n,t.parent,e)}function Xl(n,t,e,r,l){n.insertBefore(t,e,r,l)}function Nv(n,t,e){n.appendChild(t,e)}function Rm(n,t,e,r,l){null!==r?Xl(n,t,e,r,l):Nv(n,t,e)}function Vs(n,t){return n.parentNode(t)}function Om(n,t,e){return nd(n,t,e)}let rd,od,ad,nd=function Lv(n,t,e){return 40&n.type?Yo(n,e):null};function Iu(n,t,e,r){const l=td(n,r,t),d=t[11],_=Om(r.parent||t[6],r,t);if(null!=l)if(Array.isArray(e))for(let x=0;x<e.length;x++)Rm(d,l,e[x],_,!1);else Rm(d,l,e,_,!1)}function id(n,t){if(null!==t){const e=t.type;if(3&e)return Yo(t,n);if(4&e)return Au(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return id(n,r);{const l=n[t.index];return fa(l)?Au(-1,l):_r(l)}}if(32&e)return Sm(t,n)()||_r(n[t.index]);{const r=zv(n,t);return null!==r?Array.isArray(r)?r[0]:id(Mu(n[16]),r):id(n,t.next)}}return null}function zv(n,t){return null!==t?n[16][6].projection[t.projection]:null}function Au(n,t){const e=10+n+1;if(e<t.length){const r=t[e],l=r[1].firstChild;if(null!==l)return id(r,l)}return t[7]}function Lm(n,t,e,r,l,d,h){for(;null!=e;){const _=r[e.index],x=e.type;if(h&&0===t&&(_&&vo(_r(_),r),e.flags|=2),32!=(32&e.flags))if(8&x)Lm(n,t,e.child,r,l,d,!1),Qc(t,n,l,_,d);else if(32&x){const D=Sm(e,r);let I;for(;I=D();)Qc(t,n,l,I,d);Qc(t,n,l,_,d)}else 16&x?Vv(n,t,r,e,l,d):Qc(t,n,l,_,d);e=h?e.projectionNext:e.next}}function ya(n,t,e,r,l,d){Lm(e,r,n.firstChild,t,l,d,!1)}function Vv(n,t,e,r,l,d){const h=e[16],x=h[6].projection[r.projection];if(Array.isArray(x))for(let D=0;D<x.length;D++)Qc(t,n,l,x[D],d);else Lm(n,t,x,h[3],l,d,!0)}function Uv(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function _p(n,t,e){const{mergedAttrs:r,classes:l,styles:d}=e;null!==r&&tv(n,t,r),null!==l&&Uv(n,t,l),null!==d&&function Fw(n,t,e){n.setAttribute(t,"style",e)}(n,t,d)}function Us(n){return function Bm(){if(void 0===rd&&(rd=null,k.trustedTypes))try{rd=k.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return rd}()?.createHTML(n)||n}function jv(n){return function sd(){if(void 0===ad&&(ad=null,k.trustedTypes))try{ad=k.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ad}()?.createScriptURL(n)||n}class xa{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${zl})`}}class Or extends xa{getTypeName(){return"HTML"}}class jm extends xa{getTypeName(){return"Style"}}class vp extends xa{getTypeName(){return"Script"}}class wa extends xa{getTypeName(){return"URL"}}class Wm extends xa{getTypeName(){return"ResourceURL"}}function so(n){return n instanceof xa?n.changingThisBreaksApplicationSecurity:n}function La(n,t){const e=function Gm(n){return n instanceof xa&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${zl})`)}return e===t}class Ow{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Us(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class Nw{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Us(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=Us(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let l=e.length-1;0<l;l--){const h=e.item(l).name;("xmlns:ns1"===h||0===h.indexOf("ns1:"))&&t.removeAttribute(h)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const $v=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Ou(n){return(n=String(n)).match($v)?n:"unsafe:"+n}function ms(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function xl(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const ld=ms("area,br,col,hr,img,wbr"),Nu=ms("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),bp=ms("rp,rt"),Ym=xl(ld,xl(Nu,ms("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),xl(bp,ms("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),xl(bp,Nu)),yp=ms("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Km=xl(yp,ms("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ms("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Xm=ms("script,style,template");class Kv{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let l=this.checkClobberedElement(e,e.nextSibling);if(l){e=l;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Ym.hasOwnProperty(e))return this.sanitizedSomething=!0,!Xm.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let l=0;l<r.length;l++){const d=r.item(l),h=d.name,_=h.toLowerCase();if(!Km.hasOwnProperty(_)){this.sanitizedSomething=!0;continue}let x=d.value;yp[_]&&(x=Ou(x)),this.buf.push(" ",h,'="',Xv(x),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Ym.hasOwnProperty(e)&&!ld.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Xv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const Bw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,yo=/([^\#-~ |!])/g;function Xv(n){return n.replace(/&/g,"&amp;").replace(Bw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(yo,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Zm;function Hs(n,t){let e=null;try{Zm=Zm||function qm(n){const t=new Nw(n);return function Pw(){try{return!!(new window.DOMParser).parseFromString(Us(""),"text/html")}catch{return!1}}()?new Ow(t):t}(n);let r=t?String(t):"";e=Zm.getInertBodyElement(r);let l=5,d=r;do{if(0===l)throw new Error("Failed to sanitize html because the input is unstable");l--,r=d,d=e.innerHTML,e=Zm.getInertBodyElement(r)}while(r!==d);return Us((new Kv).sanitizeChildren(Zv(e)||e))}finally{if(e){const r=Zv(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function Zv(n){return"content"in n&&function Gk(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var zi=(()=>((zi=zi||{})[zi.NONE=0]="NONE",zi[zi.HTML=1]="HTML",zi[zi.STYLE=2]="STYLE",zi[zi.SCRIPT=3]="SCRIPT",zi[zi.URL=4]="URL",zi[zi.RESOURCE_URL=5]="RESOURCE_URL",zi))();function Qm(n){const t=xp();return t?t.sanitize(zi.URL,n)||"":La(n,"URL")?so(n):Ou(An(n))}function zw(n){const t=xp();if(t)return jv(t.sanitize(zi.RESOURCE_URL,n)||"");if(La(n,"ResourceURL"))return jv(so(n));throw new ot(904,!1)}function xp(){const n=vt();return n&&n[12]}const eg=new Ye("ENVIRONMENT_INITIALIZER"),Hw=new Ye("INJECTOR",-1),jw=new Ye("INJECTOR_DEF_TYPES");class Ql{get(t,e=Fe){if(e===Fe){const r=new Error(`NullInjectorError: No provider for ${Fi(t)}!`);throw r.name="NullInjectorError",r}return e}}function Qv(...n){return{\u0275providers:tg(0,n),\u0275fromNgModule:!0}}function tg(n,...t){const e=[],r=new Set;let l;return Yc(t,d=>{const h=d;Jv(h,e,[],r)&&(l||(l=[]),l.push(h))}),void 0!==l&&ng(l,e),e}function ng(n,t){for(let e=0;e<n.length;e++){const{providers:l}=n[e];eb(l,d=>{t.push(d)})}}function Jv(n,t,e,r){if(!(n=_n(n)))return!1;let l=null,d=ru(n);const h=!d&&Gi(n);if(d||h){if(h&&!h.standalone)return!1;l=n}else{const x=n.ngModule;if(d=ru(x),!d)return!1;l=x}const _=r.has(l);if(h){if(_)return!1;if(r.add(l),h.dependencies){const x="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const D of x)Jv(D,t,e,r)}}else{if(!d)return!1;{if(null!=d.imports&&!_){let D;r.add(l);try{Yc(d.imports,I=>{Jv(I,t,e,r)&&(D||(D=[]),D.push(I))})}finally{}void 0!==D&&ng(D,t)}if(!_){const D=vl(l)||(()=>new l);t.push({provide:l,useFactory:D,deps:fn},{provide:jw,useValue:l,multi:!0},{provide:eg,useValue:()=>ee(l),multi:!0})}const x=d.providers;null==x||_||eb(x,I=>{t.push(I)})}}return l!==n&&void 0!==n.providers}function eb(n,t){for(let e of n)tu(e)&&(e=e.\u0275providers),Array.isArray(e)?eb(e,t):t(e)}const Pu=Ri({provide:String,useValue:Ri});function tb(n){return null!==n&&"object"==typeof n&&Pu in n}function cd(n){return"function"==typeof n}const wp=new Ye("Set Injector scope."),rg={},Qk={};let Cp;function dd(){return void 0===Cp&&(Cp=new Ql),Cp}class js{}class Gw extends js{constructor(t,e,r,l){super(),this.parent=e,this.source=r,this.scopes=l,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Bu(t,h=>this.processProvider(h)),this.records.set(Hw,Ws(void 0,this)),l.has("environment")&&this.records.set(js,Ws(void 0,this));const d=this.records.get(wp);null!=d&&"string"==typeof d.value&&this.scopes.add(d.value),this.injectorDefTypes=new Set(this.get(jw.multi,fn,kn.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=wn(this),r=Go(void 0);try{return t()}finally{wn(e),Go(r)}}get(t,e=Fe,r=kn.Default){this.assertNotDestroyed(),r=Xn(r);const l=wn(this),d=Go(void 0);try{if(!(r&kn.SkipSelf)){let _=this.records.get(t);if(void 0===_){const x=function Jl(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ye}(t)&&fl(t);_=x&&this.injectableDefInScope(x)?Ws(Sp(t),rg):null,this.records.set(t,_)}if(null!=_)return this.hydrate(t,_)}return(r&kn.Self?dd():this.parent).get(t,e=r&kn.Optional&&e===Fe?null:e)}catch(h){if("NullInjectorError"===h.name){if((h[Pe]=h[Pe]||[]).unshift(Fi(t)),l)throw h;return function Pn(n,t,e,r){const l=n[Pe];throw t[vn]&&l.unshift(t[vn]),n.message=function qi(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let l=Fi(t);if(Array.isArray(t))l=t.map(Fi).join(" -> ");else if("object"==typeof t){let d=[];for(let h in t)if(t.hasOwnProperty(h)){let _=t[h];d.push(h+":"+("string"==typeof _?JSON.stringify(_):Fi(_)))}l=`{${d.join(", ")}}`}return`${e}${r?"("+r+")":""}[${l}]: ${n.replace(lt,"\n  ")}`}("\n"+n.message,l,e,r),n.ngTokenPath=l,n[Pe]=null,n}(h,t,"R3InjectorError",this.source)}throw h}finally{Go(d),wn(l)}}resolveInjectorInitializers(){const t=wn(this),e=Go(void 0);try{const r=this.get(eg.multi,fn,kn.Self);for(const l of r)l()}finally{wn(t),Go(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(Fi(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ot(205,!1)}processProvider(t){let e=cd(t=_n(t))?t:_n(t&&t.provide);const r=function nb(n){return tb(n)?Ws(void 0,n.useValue):Ws(ib(n),rg)}(t);if(cd(t)||!0!==t.multi)this.records.get(e);else{let l=this.records.get(e);l||(l=Ws(void 0,rg,!0),l.factory=()=>ei(l.multi),this.records.set(e,l)),e=t,l.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===rg&&(e.value=Qk,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Lu(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=_n(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Sp(n){const t=fl(n),e=null!==t?t.factory:vl(n);if(null!==e)return e;if(n instanceof Ye)throw new ot(204,!1);if(n instanceof Function)return function $w(n){const t=n.length;if(t>0)throw Cu(t,"?"),new ot(204,!1);const e=function Kn(n){const t=n&&(n[ou]||n[Wf]);if(t){const e=function Ka(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new ot(204,!1)}function ib(n,t,e){let r;if(cd(n)){const l=_n(n);return vl(l)||Sp(l)}if(tb(n))r=()=>_n(n.useValue);else if(function ig(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...ei(n.deps||[]));else if(function wt(n){return!(!n||!n.useExisting)}(n))r=()=>ee(_n(n.useExisting));else{const l=_n(n&&(n.useClass||n.provide));if(!function Ba(n){return!!n.deps}(n))return vl(l)||Sp(l);r=()=>new l(...ei(n.deps))}return r}function Ws(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Bu(n,t){for(const e of n)Array.isArray(e)?Bu(e,t):e&&tu(e)?Bu(e.\u0275providers,t):t(e)}class qw{}class ec{}class zu{resolveComponentFactory(t){throw function tc(n){const t=Error(`No component factory found for ${Fi(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let nc=(()=>{class n{}return n.NULL=new zu,n})();function Jk(){return Ca(wr(),vt())}function Ca(n,t){return new Ut(Yo(n,t))}let Ut=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=Jk,n})();function Kw(n){return n instanceof Ut?n.nativeElement:n}class Dp{}let wl=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function eM(){const n=vt(),e=Ko(wr().index,n);return(Bo(e)?e:n)[11]}(),n})(),tM=(()=>{class n{}return n.\u0275prov=St({token:n,providedIn:"root",factory:()=>null}),n})();class ic{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const nM=new ic("15.0.4"),rc={};function ob(n){return n.ngOriginalError}class Cl{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&ob(t);for(;e&&ob(e);)e=ob(e);return e||null}}function gs(n){return n instanceof Function?n():n}function n1(n,t,e){let r=n.length;for(;;){const l=n.indexOf(t,e);if(-1===l)return l;if(0===l||n.charCodeAt(l-1)<=32){const d=t.length;if(l+d===r||n.charCodeAt(l+d)<=32)return l}e=l+1}}const r1="ng-template";function o1(n,t,e){let r=0;for(;r<n.length;){let l=n[r++];if(e&&"class"===l){if(l=n[r],-1!==n1(l.toLowerCase(),t,0))return!0}else if(1===l){for(;r<n.length&&"string"==typeof(l=n[r++]);)if(l.toLowerCase()===t)return!0;return!1}}return!1}function lb(n){return 4===n.type&&n.value!==r1}function a1(n,t,e){return t===(4!==n.type||e?n.value:r1)}function oc(n,t,e){let r=4;const l=n.attrs||[],d=function ub(n){for(let t=0;t<n.length;t++)if(Qx(n[t]))return t;return n.length}(l);let h=!1;for(let _=0;_<t.length;_++){const x=t[_];if("number"!=typeof x){if(!h)if(4&r){if(r=2|1&r,""!==x&&!a1(n,x,e)||""===x&&1===t.length){if(bt(r))return!1;h=!0}}else{const D=8&r?x:t[++_];if(8&r&&null!==n.attrs){if(!o1(n.attrs,D,e)){if(bt(r))return!1;h=!0}continue}const V=aM(8&r?"class":x,l,lb(n),e);if(-1===V){if(bt(r))return!1;h=!0;continue}if(""!==D){let ne;ne=V>d?"":l[V+1].toLowerCase();const he=8&r?ne:null;if(he&&-1!==n1(he,D,0)||2&r&&D!==ne){if(bt(r))return!1;h=!0}}}}else{if(!h&&!bt(r)&&!bt(x))return!1;if(h&&bt(x))continue;h=!1,r=x|1&r}}return bt(r)||h}function bt(n){return 0==(1&n)}function aM(n,t,e,r){if(null===t)return-1;let l=0;if(r||!e){let d=!1;for(;l<t.length;){const h=t[l];if(h===n)return l;if(3===h||6===h)d=!0;else{if(1===h||2===h){let _=t[++l];for(;"string"==typeof _;)_=t[++l];continue}if(4===h)break;if(0===h){l+=4;continue}}l+=d?1:2}return-1}return function hb(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function cb(n,t,e=!1){for(let r=0;r<t.length;r++)if(oc(n,t[r],e))return!0;return!1}function sM(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let l=0;l<n.length;l++)if(n[l]!==r[l])continue e;return!0}}return!1}function pb(n,t){return n?":not("+t.trim()+")":t}function lM(n){let t=n[0],e=1,r=2,l="",d=!1;for(;e<n.length;){let h=n[e];if("string"==typeof h)if(2&r){const _=n[++e];l+="["+h+(_.length>0?'="'+_+'"':"")+"]"}else 8&r?l+="."+h:4&r&&(l+=" "+h);else""!==l&&!bt(h)&&(t+=pb(d,l),l=""),r=h,d=d||!bt(r);e++}return""!==l&&(t+=pb(d,l)),t}const Un={};function Ct(n){ag(wi(),vt(),Xo()+n,!1)}function ag(n,t,e,r){if(!r)if(3==(3&t[2])){const d=n.preOrderCheckHooks;null!==d&&om(t,d,e)}else{const d=n.preOrderHooks;null!==d&&am(t,d,0,e)}Gc(e)}function lg(n,t=null,e=null,r){const l=Vu(n,t,e,r);return l.resolveInjectorInitializers(),l}function Vu(n,t=null,e=null,r,l=new Set){const d=[e||fn,Qv(n)];return r=r||("object"==typeof n?void 0:Fi(n)),new Gw(d,t||dd(),r||null,l)}let nn=(()=>{class n{static create(e,r){if(Array.isArray(e))return lg({name:""},r,e,"");{const l=e.name??"";return lg({name:l},e.parent,e.providers,l)}}}return n.THROW_IF_NOT_FOUND=Fe,n.NULL=new Ql,n.\u0275prov=St({token:n,providedIn:"any",factory:()=>ee(Hw)}),n.__NG_ELEMENT_ID__=-1,n})();function re(n,t=kn.Default){const e=vt();return null===e?ee(n,t):rw(wr(),e,_n(n),t)}function $s(){throw new Error("invalid")}function yb(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const l=e[r],d=e[r+1];if(-1!==d){const h=n.data[d];nm(l),h.contentQueries(2,t[d],d)}}}function Oi(n,t,e,r,l,d,h,_,x,D,I){const V=t.blueprint.slice();return V[0]=l,V[2]=76|r,(null!==I||n&&1024&n[2])&&(V[2]|=1024),Ux(V),V[3]=V[15]=n,V[8]=e,V[10]=h||n&&n[10],V[11]=_||n&&n[11],V[12]=x||n&&n[12]||null,V[9]=D||n&&n[9]||null,V[6]=d,V[20]=function xw(){return yw++}(),V[21]=I,V[16]=2==t.type?n[16]:V,V}function _d(n,t,e,r,l){let d=n.data[t];if(null===d)d=function Dr(n,t,e,r,l){const d=X_(),h=Z_(),x=n.data[t]=function g1(n,t,e,r,l,d){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:l,attrs:d,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?d:d&&d.parent,e,t,r,l);return null===n.firstChild&&(n.firstChild=x),null!==d&&(h?null==d.child&&null!==x.parent&&(d.child=x):null===d.next&&(d.next=x)),x}(n,t,e,r,l),function gk(){return jn.lFrame.inI18n}()&&(d.flags|=32);else if(64&d.type){d.type=e,d.value=r,d.attrs=l;const h=function jh(){const n=jn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();d.injectorIndex=null===h?-1:h.injectorIndex}return Ls(d,!0),d}function Mp(n,t,e,r){if(0===e)return-1;const l=t.length;for(let d=0;d<e;d++)t.push(r),n.blueprint.push(r),n.data.push(null);return l}function xb(n,t,e){im(t);try{const r=n.viewQuery;null!==r&&Ob(1,r,e);const l=n.template;null!==l&&f1(n,t,l,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&yb(n,t),n.staticViewQueries&&Ob(2,n.viewQuery,e);const d=n.components;null!==d&&function p1(n,t){for(let e=0;e<t.length;e++)bM(n,t[e])}(t,d)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,J_()}}function ug(n,t,e,r){const l=t[2];if(128!=(128&l)){im(t);try{Ux(t),function jx(n){return jn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&f1(n,t,e,2,r);const h=3==(3&l);if(h){const D=n.preOrderCheckHooks;null!==D&&om(t,D,null)}else{const D=n.preOrderHooks;null!==D&&am(t,D,0,null),sm(t,0)}if(function Ap(n){for(let t=Kl(n);null!==t;t=Em(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const l=e[r],d=l[3];0==(512&l[2])&&Jf(d,1),l[2]|=512}}}(t),function v1(n){for(let t=Kl(n);null!==t;t=Em(t))for(let e=10;e<t.length;e++){const r=t[e],l=r[1];Qf(r)&&ug(l,r,l.template,r[8])}}(t),null!==n.contentQueries&&yb(n,t),h){const D=n.contentCheckHooks;null!==D&&om(t,D)}else{const D=n.contentHooks;null!==D&&am(t,D,1),sm(t,1)}!function u1(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const l=e[r];if(l<0)Gc(~l);else{const d=l,h=e[++r],_=e[++r];_k(h,d),_(2,t[d])}}}finally{Gc(-1)}}(n,t);const _=n.components;null!==_&&function h1(n,t){for(let e=0;e<t.length;e++)Rb(n,t[e])}(t,_);const x=n.viewQuery;if(null!==x&&Ob(2,x,r),h){const D=n.viewCheckHooks;null!==D&&om(t,D)}else{const D=n.viewHooks;null!==D&&am(t,D,2),sm(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,Jf(t[3],-1))}finally{J_()}}}function f1(n,t,e,r,l){const d=Xo(),h=2&r;try{Gc(-1),h&&t.length>22&&ag(n,t,22,!1),e(r,l)}finally{Gc(d)}}function wb(n,t,e){if(qf(t)){const l=t.directiveEnd;for(let d=t.directiveStart;d<l;d++){const h=n.data[d];h.contentQueries&&h.contentQueries(1,e[d],d)}}}function Cb(n,t,e){!K_()||(function sc(n,t,e,r){const l=e.directiveStart,d=e.directiveEnd;cu(e)&&function hg(n,t,e){const r=Yo(t,n),l=m1(e),d=n[10],h=Rp(n,Oi(n,l,null,e.onPush?32:16,r,t,d,d.createRenderer(r,e),null,null,null));n[t.index]=h}(t,e,n.data[l+e.componentOffset]),n.firstCreatePass||tp(e,t),vo(r,t);const h=e.initialInputs;for(let _=l;_<d;_++){const x=n.data[_],D=$c(t,n,_,e);vo(D,t),null!==h&&Ab(0,_-l,D,x,0,h),es(x)&&(Ko(e.index,t)[8]=$c(t,n,_,e))}}(n,t,e,Yo(e,t)),64==(64&e.flags)&&is(n,t,e))}function Sb(n,t,e=Yo){const r=t.localNames;if(null!==r){let l=t.index+1;for(let d=0;d<r.length;d+=2){const h=r[d+1],_=-1===h?e(t,n):n[h];n[l++]=_}}}function m1(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=Db(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function Db(n,t,e,r,l,d,h,_,x,D){const I=22+r,V=I+l,ne=function Hu(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:Un);return e}(I,V),he="function"==typeof D?D():D;return ne[1]={type:n,blueprint:ne,template:e,queries:null,viewQuery:_,declTNode:t,data:ne.slice().fill(null,I),bindingStartIndex:I,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof d?d():d,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:x,consts:he,incompleteFirstPass:!1}}function Ua(n,t,e,r){const l=b1(t);null===e?l.push(r):(l.push(e),n.firstCreatePass&&rs(n).push(r,l.length-1))}function ju(n,t,e,r){for(let l in n)if(n.hasOwnProperty(l)){e=null===e?{}:e;const d=n[l];null===r?Eb(e,t,l,d):r.hasOwnProperty(l)&&Eb(e,t,r[l],d)}return e}function Eb(n,t,e,r){n.hasOwnProperty(e)?n[e].push(t,r):n[e]=[t,r]}function Da(n,t,e,r,l,d,h,_){const x=Yo(t,e);let I,D=t.inputs;!_&&null!=D&&(I=D[r])?(gg(n,e,I,r,l),cu(t)&&kb(e,t.index)):3&t.type&&(r=function fM(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),l=null!=h?h(l,t.value||"",r):l,d.setProperty(x,r,l))}function kb(n,t){const e=Ko(t,n);16&e[2]||(e[2]|=32)}function Mb(n,t,e,r){let l=!1;if(K_()){const d=null===r?null:{"":-1},h=function Ip(n,t){const e=n.directiveRegistry;let r=null,l=null;if(e)for(let d=0;d<e.length;d++){const h=e[d];if(cb(t,h.selectors,!1))if(r||(r=[]),es(h))if(null!==h.findHostDirectiveDefs){const _=[];l=l||new Map,h.findHostDirectiveDefs(h,_,l),r.unshift(..._,h),Tb(n,t,_.length)}else r.unshift(h),Tb(n,t,0);else l=l||new Map,h.findHostDirectiveDefs?.(h,r,l),r.push(h)}return null===r?null:[r,l]}(n,e);let _,x;null===h?_=x=null:[_,x]=h,null!==_&&(l=!0,kl(n,t,e,_,d,x)),d&&function _M(n,t,e){if(t){const r=n.localNames=[];for(let l=0;l<t.length;l+=2){const d=e[t[l+1]];if(null==d)throw new ot(-301,!1);r.push(t[l],d)}}}(e,r,d)}return e.mergedAttrs=Xh(e.mergedAttrs,e.attrs),l}function kl(n,t,e,r,l,d){for(let D=0;D<r.length;D++)sv(tp(e,t),n,r[D].type);!function bd(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}(e,n.data.length,r.length);for(let D=0;D<r.length;D++){const I=r[D];I.providersResolver&&I.providersResolver(I)}let h=!1,_=!1,x=Mp(n,t,r.length,null);for(let D=0;D<r.length;D++){const I=r[D];e.mergedAttrs=Xh(e.mergedAttrs,I.hostAttrs),Ib(n,e,t,x,I),vM(x,I,l),null!==I.contentQueries&&(e.flags|=4),(null!==I.hostBindings||null!==I.hostAttrs||0!==I.hostVars)&&(e.flags|=64);const V=I.type.prototype;!h&&(V.ngOnChanges||V.ngOnInit||V.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),h=!0),!_&&(V.ngOnChanges||V.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),_=!0),x++}!function vd(n,t,e){const l=t.directiveEnd,d=n.data,h=t.attrs,_=[];let x=null,D=null;for(let I=t.directiveStart;I<l;I++){const V=d[I],ne=e?e.get(V):null,Ce=ne?ne.outputs:null;x=ju(V.inputs,I,x,ne?ne.inputs:null),D=ju(V.outputs,I,D,Ce);const Ae=null===x||null===h||lb(t)?null:fg(x,I,h);_.push(Ae)}null!==x&&(x.hasOwnProperty("class")&&(t.flags|=8),x.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=_,t.inputs=x,t.outputs=D}(n,e,d)}function is(n,t,e){const r=e.directiveStart,l=e.directiveEnd,d=e.index,h=function vk(){return jn.lFrame.currentDirectiveIndex}();try{Gc(d);for(let _=r;_<l;_++){const x=n.data[_],D=t[_];em(_),(null!==x.hostBindings||0!==x.hostVars||null!==x.hostAttrs)&&Tp(x,D)}}finally{Gc(-1),em(h)}}function Tp(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function Tb(n,t,e){t.componentOffset=e,(n.components||(n.components=[])).push(t.index)}function vM(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;es(t)&&(e[""]=n)}}function Ib(n,t,e,r,l){n.data[r]=l;const d=l.factory||(l.factory=vl(l.type)),h=new Kh(d,es(l),re);n.blueprint[r]=h,e[r]=h,function _1(n,t,e,r,l){const d=l.hostBindings;if(d){let h=n.hostBindingOpCodes;null===h&&(h=n.hostBindingOpCodes=[]);const _=~t.index;(function Wu(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(h)!=_&&h.push(_),h.push(e,r,d)}}(n,t,r,Mp(n,e,l.hostVars,Un),l)}function _s(n,t,e,r,l,d){const h=Yo(n,t);!function pg(n,t,e,r,l,d,h){if(null==d)n.removeAttribute(t,l,e);else{const _=null==h?An(d):h(d,r||"",l);n.setAttribute(t,l,_,e)}}(t[11],h,d,n.value,e,r,l)}function Ab(n,t,e,r,l,d){const h=d[t];if(null!==h){const _=r.setInput;for(let x=0;x<h.length;){const D=h[x++],I=h[x++],V=h[x++];null!==_?r.setInput(e,V,D,I):e[I]=V}}}function fg(n,t,e){let r=null,l=0;for(;l<e.length;){const d=e[l];if(0!==d)if(5!==d){if("number"==typeof d)break;if(n.hasOwnProperty(d)){null===r&&(r=[]);const h=n[d];for(let _=0;_<h.length;_+=2)if(h[_]===t){r.push(d,h[_+1],e[l+1]);break}}l+=2}else l+=2;else l+=4}return r}function qs(n,t,e,r){return[n,!0,!1,t,null,0,r,e,null,null]}function Rb(n,t){const e=Ko(t,n);if(Qf(e)){const r=e[1];48&e[2]?ug(r,e,r.template,e[8]):e[5]>0&&vs(e)}}function vs(n){for(let r=Kl(n);null!==r;r=Em(r))for(let l=10;l<r.length;l++){const d=r[l];if(Qf(d))if(512&d[2]){const h=d[1];ug(h,d,h.template,d[8])}else d[5]>0&&vs(d)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const l=Ko(e[r],n);Qf(l)&&l[5]>0&&vs(l)}}function bM(n,t){const e=Ko(t,n),r=e[1];(function yM(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),xb(r,e,e[8])}function Rp(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function Fb(n){for(;n;){n[2]|=32;const t=Mu(n);if(G_(n)&&!t)return n;n=t}return null}function Ml(n,t,e,r=!0){const l=t[10];l.begin&&l.begin();try{ug(n,t,n.template,e)}catch(h){throw r&&mg(t,h),h}finally{l.end&&l.end()}}function Ob(n,t,e){nm(0),t(n,e)}function b1(n){return n[7]||(n[7]=[])}function rs(n){return n.cleanup||(n.cleanup=[])}function Nb(n,t,e){return(null===n||es(n))&&(e=function qo(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(e[t.index])),e[11]}function mg(n,t){const e=n[9],r=e?e.get(Cl,null):null;r&&r.handleError(t)}function gg(n,t,e,r,l){for(let d=0;d<e.length;){const h=e[d++],_=e[d++],x=t[h],D=n.data[h];null!==D.setInput?D.setInput(x,l,r,_):x[_]=l}}function Ys(n,t,e){const r=jc(t,n);!function Av(n,t,e){n.setValue(t,e)}(n[11],r,e)}function Fp(n,t,e){let r=e?n.styles:null,l=e?n.classes:null,d=0;if(null!==t)for(let h=0;h<t.length;h++){const _=t[h];"number"==typeof _?d=_:1==d?l=Rc(l,_):2==d&&(r=Rc(r,_+": "+t[++h]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=l:n.classesWithoutHost=l}function Op(n,t,e,r,l=!1){for(;null!==e;){const d=t[e.index];if(null!==d&&r.push(_r(d)),fa(d))for(let _=10;_<d.length;_++){const x=d[_],D=x[1].firstChild;null!==D&&Op(x[1],x,D,r)}const h=e.type;if(8&h)Op(n,t,e.child,r);else if(32&h){const _=Sm(e,t);let x;for(;x=_();)r.push(x)}else if(16&h){const _=zv(t,e);if(Array.isArray(_))r.push(..._);else{const x=Mu(t[16]);Op(x[1],x,_,r,!0)}}e=l?e.projectionNext:e.next}return r}class Gu{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Op(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(fa(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(Tm(t,r),rp(e,r))}this._attachedToViewContainer=!1}ed(this._lView[1],this._lView)}onDestroy(t){Ua(this._lView[1],this._lView,null,t)}markForCheck(){Fb(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Ml(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ot(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Dw(n,t){ya(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ot(902,!1);this._appRef=t}}class xM extends Gu{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Ml(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class ea extends nc{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Gi(t);return new yd(e,this.ngModule)}}function _g(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class Lb{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){r=Xn(r);const l=this.injector.get(t,rc,r);return l!==rc||e===rc?l:this.parentInjector.get(t,e,r)}}class yd extends ec{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function Sl(n){return n.map(lM).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return _g(this.componentDef.inputs)}get outputs(){return _g(this.componentDef.outputs)}create(t,e,r,l){let d=(l=l||this.ngModule)instanceof js?l:l?.injector;d&&null!==this.componentDef.getStandaloneInjector&&(d=this.componentDef.getStandaloneInjector(d)||d);const h=d?new Lb(t,d):t,_=h.get(Dp,null);if(null===_)throw new ot(407,!1);const x=h.get(tM,null),D=_.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",V=r?function Wr(n,t,e){return n.selectRootElement(t,e===Oa.ShadowDom)}(D,r,this.componentDef.encapsulation):Mm(D,I,function Pb(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(I)),ne=this.componentDef.onPush?288:272,he=Db(0,null,null,1,0,null,null,null,null,null),Ce=Oi(null,he,null,ne,null,null,_,D,x,h,null);let Ae,He;im(Ce);try{const rt=this.componentDef;let Tt,st=null;rt.findHostDirectiveDefs?(Tt=[],st=new Map,rt.findHostDirectiveDefs(rt,Tt,st),Tt.push(rt)):Tt=[rt];const an=function x1(n,t){const e=n[1];return n[22]=t,_d(e,22,2,"#host",null)}(Ce,V),Li=function w1(n,t,e,r,l,d,h,_){const x=l[1];!function C1(n,t,e,r){for(const l of n)t.mergedAttrs=Xh(t.mergedAttrs,l.hostAttrs);null!==t.mergedAttrs&&(Fp(t,t.mergedAttrs,!0),null!==e&&_p(r,e,t))}(r,n,t,h);const D=d.createRenderer(t,e),I=Oi(l,m1(e),null,e.onPush?32:16,l[n.index],n,d,D,_||null,null,null);return x.firstCreatePass&&Tb(x,n,r.length-1),Rp(l,I),l[n.index]=I}(an,V,rt,Tt,Ce,_,D);He=Zf(he,22),V&&function lr(n,t,e,r){if(r)tv(n,e,["ng-version",nM.full]);else{const{attrs:l,classes:d}=function fb(n){const t=[],e=[];let r=1,l=2;for(;r<n.length;){let d=n[r];if("string"==typeof d)2===l?""!==d&&t.push(d,n[++r]):8===l&&e.push(d);else{if(!bt(l))break;l=d}r++}return{attrs:t,classes:e}}(t.selectors[0]);l&&tv(n,e,l),d&&d.length>0&&Uv(n,e,d.join(" "))}}(D,rt,V,r),void 0!==e&&function wM(n,t,e){const r=n.projection=[];for(let l=0;l<t.length;l++){const d=e[l];r.push(null!=d?Array.from(d):null)}}(He,this.ngContentSelectors,e),Ae=function Ii(n,t,e,r,l,d){const h=wr(),_=l[1],x=Yo(h,l);kl(_,l,h,e,null,r);for(let I=0;I<e.length;I++)vo($c(l,_,h.directiveStart+I,h),l);is(_,l,h),x&&vo(x,l);const D=$c(l,_,h.directiveStart+h.componentOffset,h);if(n[8]=l[8]=D,null!==d)for(const I of d)I(D,t);return wb(_,h,n),D}(Li,rt,Tt,st,Ce,[CM]),xb(he,Ce,null)}finally{J_()}return new Bb(this.componentType,Ae,Ca(He,Ce),Ce,He)}}class Bb extends qw{constructor(t,e,r,l,d){super(),this.location=r,this._rootLView=l,this._tNode=d,this.instance=e,this.hostView=this.changeDetectorRef=new xM(l),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let l;if(null!==r&&(l=r[t])){const d=this._rootLView;gg(d[1],d,l,t,e),kb(d,this._tNode.index)}}get injector(){return new _u(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function CM(){const n=wr();Yh(vt()[1],n)}function Et(n){let t=function S1(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let l;if(es(n))l=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new ot(903,!1);l=t.\u0275dir}if(l){if(e){r.push(l);const h=n;h.inputs=zb(n.inputs),h.declaredInputs=zb(n.declaredInputs),h.outputs=zb(n.outputs);const _=l.hostBindings;_&&kM(n,_);const x=l.viewQuery,D=l.contentQueries;if(x&&DM(n,x),D&&EM(n,D),eu(n.inputs,l.inputs),eu(n.declaredInputs,l.declaredInputs),eu(n.outputs,l.outputs),es(l)&&l.data.animation){const I=n.data;I.animation=(I.animation||[]).concat(l.data.animation)}}const d=l.features;if(d)for(let h=0;h<d.length;h++){const _=d[h];_&&_.ngInherit&&_(n),_===Et&&(e=!1)}}t=Object.getPrototypeOf(t)}!function SM(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const l=n[r];l.hostVars=t+=l.hostVars,l.hostAttrs=Xh(l.hostAttrs,e=Xh(e,l.hostAttrs))}}(r)}function zb(n){return n===ao?{}:n===fn?[]:n}function DM(n,t){const e=n.viewQuery;n.viewQuery=e?(r,l)=>{t(r,l),e(r,l)}:t}function EM(n,t){const e=n.contentQueries;n.contentQueries=e?(r,l,d)=>{t(r,l,d),e(r,l,d)}:t}function kM(n,t){const e=n.hostBindings;n.hostBindings=e?(r,l)=>{t(r,l),e(r,l)}:t}let xd=null;function Ks(){if(!xd){const n=k.Symbol;if(n&&n.iterator)xd=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(xd=r)}}}return xd}function lc(n){return!!$u(n)&&(Array.isArray(n)||!(n instanceof Map)&&Ks()in n)}function $u(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function bs(n,t,e){return n[t]=e}function lo(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function On(n,t,e,r){const l=vt();return lo(l,mu(),t)&&(wi(),_s(br(),l,n,t,e,r)),On}function qu(n,t,e,r){return lo(n,mu(),e)?t+An(e)+r:Un}function ii(n,t,e,r,l,d){const _=function Tl(n,t,e,r){const l=lo(n,t,e);return lo(n,t+1,r)||l}(n,function _a(){return jn.lFrame.bindingIndex}(),e,l);return yl(2),_?t+An(e)+r+An(l)+d:Un}function Bt(n,t,e,r,l,d,h,_){const x=vt(),D=wi(),I=n+22,V=D.firstCreatePass?function R1(n,t,e,r,l,d,h,_,x){const D=t.consts,I=_d(t,n,4,h||null,Ps(D,_));Mb(t,e,I,Ps(D,x)),Yh(t,I);const V=I.tViews=Db(2,I,r,l,d,t.directiveRegistry,t.pipeRegistry,null,t.schemas,D);return null!==t.queries&&(t.queries.template(t,I),V.queries=t.queries.embeddedTView(I)),I}(I,D,x,t,e,r,l,d,h):D.data[I];Ls(V,!1);const ne=x[11].createComment("");Iu(D,x,ne,V),vo(ne,x),Rp(x,x[I]=qs(ne,x,ne,V)),zh(V)&&Cb(D,x,V),null!=h&&Sb(x,V,_)}function Gr(n){return fu(function Wc(){return jn.lFrame.contextLView}(),22+n)}function Dt(n,t,e){const r=vt();return lo(r,mu(),t)&&Da(wi(),br(),r,n,t,r[11],e,!1),Dt}function cc(n,t,e,r,l){const h=l?"class":"style";gg(n,e,t.inputs[h],h,r)}function ct(n,t,e,r){const l=vt(),d=wi(),h=22+n,_=l[11],x=l[h]=Mm(_,t,function xk(){return jn.lFrame.currentNamespace}()),D=d.firstCreatePass?function FM(n,t,e,r,l,d,h){const _=t.consts,D=_d(t,n,2,l,Ps(_,d));return Mb(t,e,D,Ps(_,h)),null!==D.attrs&&Fp(D,D.attrs,!1),null!==D.mergedAttrs&&Fp(D,D.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,D),D}(h,d,l,0,t,e,r):d.data[h];return Ls(D,!0),_p(_,x,D),32!=(32&D.flags)&&Iu(d,l,x,D),0===function pk(){return jn.lFrame.elementDepthCount}()&&vo(x,l),function fk(){jn.lFrame.elementDepthCount++}(),zh(D)&&(Cb(d,l,D),wb(d,D,l)),null!==r&&Sb(l,D),ct}function dt(){let n=wr();Z_()?Q_():(n=n.parent,Ls(n,!1));const t=n;!function mk(){jn.lFrame.elementDepthCount--}();const e=wi();return e.firstCreatePass&&(Yh(e,n),qf(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Sk(n){return 0!=(8&n.flags)}(t)&&cc(e,t,vt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Dk(n){return 0!=(16&n.flags)}(t)&&cc(e,t,vt(),t.stylesWithoutHost,!1),dt}function yn(n,t,e,r){return ct(n,t,e,r),dt(),yn}function $r(n,t,e){const r=vt(),l=wi(),d=n+22,h=l.firstCreatePass?function OM(n,t,e,r,l){const d=t.consts,h=Ps(d,r),_=_d(t,n,8,"ng-container",h);return null!==h&&Fp(_,h,!0),Mb(t,e,_,Ps(d,l)),null!==t.queries&&t.queries.elementStart(t,_),_}(d,l,r,t,e):l.data[d];Ls(h,!0);const _=r[d]=r[11].createComment("");return Iu(l,r,_,h),vo(_,r),zh(h)&&(Cb(l,r,h),wb(l,h,r)),null!=e&&Sb(r,h),$r}function to(){let n=wr();const t=wi();return Z_()?Q_():(n=n.parent,Ls(n,!1)),t.firstCreatePass&&(Yh(t,n),qf(n)&&t.queries.elementEnd(n)),to}function Zs(){return vt()}function Pp(n){return!!n&&"function"==typeof n.then}const Lp=function F1(n){return!!n&&"function"==typeof n.subscribe};function bn(n,t,e,r){const l=vt(),d=wi(),h=wr();return bg(d,l,l[11],h,n,t,r),bn}function Bp(n,t){const e=wr(),r=vt(),l=wi();return bg(l,r,Nb(Gh(l.data),e,r),e,n,t),Bp}function bg(n,t,e,r,l,d,h){const _=zh(r),D=n.firstCreatePass&&rs(n),I=t[8],V=b1(t);let ne=!0;if(3&r.type||h){const Ae=Yo(r,t),He=h?h(Ae):Ae,rt=V.length,Tt=h?an=>h(_r(an[r.index])):r.index;let st=null;if(!h&&_&&(st=function $b(n,t,e,r){const l=n.cleanup;if(null!=l)for(let d=0;d<l.length-1;d+=2){const h=l[d];if(h===e&&l[d+1]===r){const _=t[7],x=l[d+2];return _.length>x?_[x]:null}"string"==typeof h&&(d+=2)}return null}(n,t,l,r.index)),null!==st)(st.__ngLastListenerFn__||st).__ngNextListenerFn__=d,st.__ngLastListenerFn__=d,ne=!1;else{d=O1(r,t,I,d,!1);const an=e.listen(He,l,d);V.push(d,an),D&&D.push(l,Tt,rt,rt+1)}}else d=O1(r,t,I,d,!1);const he=r.outputs;let Ce;if(ne&&null!==he&&(Ce=he[l])){const Ae=Ce.length;if(Ae)for(let He=0;He<Ae;He+=2){const Li=t[Ce[He]][Ce[He+1]].subscribe(d),$i=V.length;V.push(d,Li),D&&D.push(l,r.index,$i,-($i+1))}}}function qb(n,t,e,r){try{return!1!==e(r)}catch(l){return mg(n,l),!1}}function O1(n,t,e,r,l){return function d(h){if(h===Function)return r;Fb(n.componentOffset>-1?Ko(n.index,t):t);let x=qb(t,0,r,h),D=d.__ngNextListenerFn__;for(;D;)x=qb(t,0,D,h)&&x,D=D.__ngNextListenerFn__;return l&&!1===x&&(h.preventDefault(),h.returnValue=!1),x}}function qn(n=1){return function bk(n){return(jn.lFrame.contextLView=function rm(n,t){for(;n>0;)t=t[15],n--;return t}(n,jn.lFrame.contextLView))[8]}(n)}function N1(n,t){let e=null;const r=function db(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let l=0;l<t.length;l++){const d=t[l];if("*"!==d){if(null===r?cb(n,d,!0):sM(r,d))return l}else e=l}return e}function cr(n){const t=vt()[16][6];if(!t.projection){const r=t.projection=Cu(n?n.length:1,null),l=r.slice();let d=t.child;for(;null!==d;){const h=n?N1(d,n):0;null!==h&&(l[h]?l[h].projectionNext=d:r[h]=d,l[h]=d),d=d.next}}}function Sn(n,t=0,e){const r=vt(),l=wi(),d=_d(l,22+n,16,null,e||null);null===d.projection&&(d.projection=t),Q_(),32!=(32&d.flags)&&function Iw(n,t,e){Vv(t[11],0,t,e,td(n,e,t),Om(e.parent||t[6],e,t))}(l,r,d)}function yg(n,t,e){return Yb(n,"",t,"",e),yg}function Yb(n,t,e,r,l){const d=vt(),h=qu(d,t,e,r);return h!==Un&&Da(wi(),br(),d,n,h,d[11],l,!1),Yb}function Ed(n,t){return n<<17|t<<2}function dc(n){return n>>17&32767}function Cg(n){return 2|n}function uc(n){return(131068&n)>>2}function zp(n,t){return-131069&n|t<<2}function Xb(n){return 1|n}function Qb(n,t,e,r,l){const d=n[e+1],h=null===t;let _=r?dc(d):uc(d),x=!1;for(;0!==_&&(!1===x||h);){const I=n[_+1];Vp(n[_],t)&&(x=!0,n[_+1]=r?Xb(I):Cg(I)),_=r?dc(I):uc(I)}x&&(n[e+1]=r?Cg(d):Xb(d))}function Vp(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Kc(n,t)>=0}function Qs(n,t,e){return xs(n,t,e,!1),Qs}function Wn(n,t){return xs(n,t,null,!0),Wn}function xs(n,t,e,r){const l=vt(),d=wi(),h=yl(2);d.firstUpdatePass&&function Y1(n,t,e,r){const l=n.data;if(null===l[e+1]){const d=l[Xo()],h=function q1(n,t){return t>=n.expandoStartIndex}(n,e);(function X1(n,t){return 0!=(n.flags&(t?8:16))})(d,r)&&null===t&&!h&&(t=!1),t=function ey(n,t,e,r){const l=Gh(n);let d=r?t.residualClasses:t.residualStyles;if(null===l)0===(r?t.classBindings:t.styleBindings)&&(e=jp(e=iy(null,n,t,e,r),t.attrs,r),d=null);else{const h=t.directiveStylingLast;if(-1===h||n[h]!==l)if(e=iy(l,n,t,e,r),null===d){let x=function Hp(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==uc(r))return n[dc(r)]}(n,t,r);void 0!==x&&Array.isArray(x)&&(x=iy(null,n,t,x[1],r),x=jp(x,t.attrs,r),function ty(n,t,e,r){n[dc(e?t.classBindings:t.styleBindings)]=r}(n,t,r,x))}else d=function ny(n,t,e){let r;const l=t.directiveEnd;for(let d=1+t.directiveStylingLast;d<l;d++)r=jp(r,n[d].hostAttrs,e);return jp(r,t.attrs,e)}(n,t,r)}return void 0!==d&&(r?t.residualClasses=d:t.residualStyles=d),e}(l,d,t,r),function LM(n,t,e,r,l,d){let h=d?t.classBindings:t.styleBindings,_=dc(h),x=uc(h);n[r]=e;let I,D=!1;if(Array.isArray(e)){const V=e;I=V[1],(null===I||Kc(V,I)>0)&&(D=!0)}else I=e;if(l)if(0!==x){const ne=dc(n[_+1]);n[r+1]=Ed(ne,_),0!==ne&&(n[ne+1]=zp(n[ne+1],r)),n[_+1]=function NM(n,t){return 131071&n|t<<17}(n[_+1],r)}else n[r+1]=Ed(_,0),0!==_&&(n[_+1]=zp(n[_+1],r)),_=r;else n[r+1]=Ed(x,0),0===_?_=r:n[x+1]=zp(n[x+1],r),x=r;D&&(n[r+1]=Cg(n[r+1])),Qb(n,I,r,!0),Qb(n,I,r,!1),function BM(n,t,e,r,l){const d=l?n.residualClasses:n.residualStyles;null!=d&&"string"==typeof t&&Kc(d,t)>=0&&(e[r+1]=Xb(e[r+1]))}(t,I,n,r,d),h=Ed(_,x),d?t.classBindings=h:t.styleBindings=h}(l,d,t,e,h,r)}}(d,n,h,r),t!==Un&&lo(l,h,t)&&function Dg(n,t,e,r,l,d,h,_){if(!(3&t.type))return;const x=n.data,D=x[_+1],I=function PM(n){return 1==(1&n)}(D)?ry(x,t,e,l,uc(D),h):void 0;Wp(I)||(Wp(d)||function wg(n){return 2==(2&n)}(D)&&(d=ry(x,null,e,l,_,h)),function Rw(n,t,e,r,l){if(t)l?n.addClass(e,r):n.removeClass(e,r);else{let d=-1===r.indexOf("-")?void 0:Qo.DashCase;null==l?n.removeStyle(e,r,d):("string"==typeof l&&l.endsWith("!important")&&(l=l.slice(0,-10),d|=Qo.Important),n.setStyle(e,r,l,d))}}(r,h,jc(Xo(),e),l,d))}(d,d.data[Xo()],l,l[11],n,l[h+1]=function GM(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Fi(so(n)))),n}(t,e),r,h)}function iy(n,t,e,r,l){let d=null;const h=e.directiveEnd;let _=e.directiveStylingLast;for(-1===_?_=e.directiveStart:_++;_<h&&(d=t[_],r=jp(r,d.hostAttrs,l),d!==n);)_++;return null!==n&&(e.directiveStylingLast=_),r}function jp(n,t,e){const r=e?1:2;let l=-1;if(null!==t)for(let d=0;d<t.length;d++){const h=t[d];"number"==typeof h?l=h:l===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ba(n,h,!!e||t[++d]))}return void 0===n?null:n}function ry(n,t,e,r,l,d){const h=null===t;let _;for(;l>0;){const x=n[l],D=Array.isArray(x),I=D?x[1]:x,V=null===I;let ne=e[l+1];ne===Un&&(ne=V?fn:void 0);let he=V?hm(ne,r):I===r?ne:void 0;if(D&&!Wp(he)&&(he=hm(x,r)),Wp(he)&&(_=he,h))return _;const Ce=n[l+1];l=h?dc(Ce):uc(Ce)}if(null!==t){let x=d?t.residualClasses:t.residualStyles;null!=x&&(_=hm(x,r))}return _}function Wp(n){return void 0!==n}function gn(n,t=""){const e=vt(),r=wi(),l=n+22,d=r.firstCreatePass?_d(r,l,1,t,null):r.data[l],h=e[l]=function jr(n,t){return n.createText(t)}(e[11],t);Iu(r,e,h,d),Ls(d,!1)}function Gp(n){return ta("",n,""),Gp}function ta(n,t,e){const r=vt(),l=qu(r,n,t,e);return l!==Un&&Ys(r,Xo(),l),ta}function Rl(n,t,e,r,l){const d=vt(),h=ii(d,n,t,e,r,l);return h!==Un&&Ys(d,Xo(),h),Rl}function fi(n,t,e){const r=vt();return lo(r,mu(),t)&&Da(wi(),br(),r,n,t,r[11],e,!0),fi}function Mg(n,t,e){const r=vt();if(lo(r,mu(),t)){const d=wi(),h=br();Da(d,h,r,n,t,Nb(Gh(d.data),h,r),e,!0)}return Mg}const Ol="en-US";let dy=Ol;function Fy(n,t,e,r,l){if(n=_n(n),Array.isArray(n))for(let d=0;d<n.length;d++)Fy(n[d],t,e,r,l);else{const d=wi(),h=vt();let _=cd(n)?n:_n(n.provide),x=ib(n);const D=wr(),I=1048575&D.providerIndexes,V=D.directiveStart,ne=D.providerIndexes>>20;if(cd(n)||!n.multi){const he=new Kh(x,l,re),Ce=Ny(_,t,l?I:I+ne,V);-1===Ce?(sv(tp(D,h),d,_),Oy(d,n,t.length),t.push(_),D.directiveStart++,D.directiveEnd++,l&&(D.providerIndexes+=1048576),e.push(he),h.push(he)):(e[Ce]=he,h[Ce]=he)}else{const he=Ny(_,t,I+ne,V),Ce=Ny(_,t,I,I+ne),Ae=he>=0&&e[he],He=Ce>=0&&e[Ce];if(l&&!He||!l&&!Ae){sv(tp(D,h),d,_);const rt=function F2(n,t,e,r,l){const d=new Kh(n,e,re);return d.multi=[],d.index=t,d.componentProviders=0,LC(d,l,r&&!e),d}(l?R2:A2,e.length,l,r,x);!l&&He&&(e[Ce].providerFactory=rt),Oy(d,n,t.length,0),t.push(_),D.directiveStart++,D.directiveEnd++,l&&(D.providerIndexes+=1048576),e.push(rt),h.push(rt)}else Oy(d,n,he>-1?he:Ce,LC(e[l?Ce:he],x,!l&&r));!l&&r&&He&&e[Ce].componentProviders++}}}function Oy(n,t,e,r){const l=cd(t),d=function Zk(n){return!!n.useClass}(t);if(l||d){const x=(d?_n(t.useClass):t).prototype.ngOnDestroy;if(x){const D=n.destroyHooks||(n.destroyHooks=[]);if(!l&&t.multi){const I=D.indexOf(e);-1===I?D.push(e,[r,x]):D[I+1].push(r,x)}else D.push(e,x)}}}function LC(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function Ny(n,t,e,r){for(let l=e;l<r;l++)if(t[l]===n)return l;return-1}function A2(n,t,e,r){return Py(this.multi,[])}function R2(n,t,e,r){const l=this.multi;let d;if(this.providerFactory){const h=this.providerFactory.componentProviders,_=$c(e,e[1],this.providerFactory.index,r);d=_.slice(0,h),Py(l,d);for(let x=h;x<_.length;x++)d.push(_[x])}else d=[],Py(l,d);return d}function Py(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Ht(n,t=[]){return e=>{e.providersResolver=(r,l)=>function I2(n,t,e){const r=wi();if(r.firstCreatePass){const l=es(n);Fy(e,r.data,r.blueprint,l,!0),Fy(t,r.data,r.blueprint,l,!1)}}(r,l?l(n):n,t)}}class ah{}class BC{}class zC extends ah{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ea(this);const r=$o(t);this._bootstrapComponents=gs(r.bootstrap),this._r3Injector=Vu(t,e,[{provide:ah,useValue:this},{provide:nc,useValue:this.componentFactoryResolver}],Fi(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Ly extends BC{constructor(t){super(),this.moduleType=t}create(t){return new zC(this.moduleType,t)}}class N2 extends ah{constructor(t,e,r){super(),this.componentFactoryResolver=new ea(this),this.instance=null;const l=new Gw([...t,{provide:ah,useValue:this},{provide:nc,useValue:this.componentFactoryResolver}],e||dd(),r,new Set(["environment"]));this.injector=l,l.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Rg(n,t,e=null){return new N2(n,t,e).injector}let By=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=tg(0,e.type),l=r.length>0?Rg([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,l)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=St({token:n,providedIn:"environment",factory:()=>new n(ee(js))}),n})();function zy(n){n.getStandaloneInjector=t=>t.get(By).getOrCreateStandaloneInjector(n)}function WC(n,t,e,r,l,d){const h=t+e;return lo(n,h,l)?bs(n,h+1,d?r.call(d,l):r(l)):function Jp(n,t){const e=n[t];return e===Un?void 0:e}(n,h+1)}function jy(n){return t=>{setTimeout(n,void 0,t)}}const En=class rT extends Le{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let l=t,d=e||(()=>null),h=r;if(t&&"object"==typeof t){const x=t;l=x.next?.bind(x),d=x.error?.bind(x),h=x.complete?.bind(x)}this.__isAsync&&(d=jy(d),l&&(l=jy(l)),h&&(h=jy(h)));const _=super.subscribe({next:l,error:d,complete:h});return t instanceof K&&t.add(_),_}};function oT(){return this._results[Ks()]()}class sh{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Ks(),r=sh.prototype;r[e]||(r[e]=oT)}get changes(){return this._changes||(this._changes=new En)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const l=function Cr(n){return n.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function ti(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let l=n[r],d=t[r];if(e&&(l=e(l),d=e(d)),d!==l)return!1}return!0}(r._results,l,e))&&(r._results=l,r.length=l.length,r.last=l[this.length-1],r.first=l[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let qr=(()=>{class n{}return n.__NG_ELEMENT_ID__=lT,n})();const aT=qr,sT=class extends aT{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,l=Oi(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);l[17]=this._declarationLView[this._declarationTContainer.index];const h=this._declarationLView[19];return null!==h&&(l[19]=h.createEmbeddedView(r)),xb(r,l,t),new Gu(l)}};function lT(){return Ng(wr(),vt())}function Ng(n,t){return 4&n.type?new sT(t,n,Ca(n,t)):null}let Lr=(()=>{class n{}return n.__NG_ELEMENT_ID__=cT,n})();function cT(){return QC(wr(),vt())}const ZC=Lr,tf=class extends ZC{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return Ca(this._hostTNode,this._hostLView)}get injector(){return new _u(this._hostTNode,this._hostLView)}get parentInjector(){const t=dm(this._hostTNode,this._hostLView);if(iv(t)){const e=Jh(t,this._hostLView),r=Zh(t);return new _u(e[1].data[r+8],e)}return new _u(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Wy(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let l,d;"number"==typeof r?l=r:null!=r&&(l=r.index,d=r.injector);const h=t.createEmbeddedView(e||{},d);return this.insert(h,l),h}createComponent(t,e,r,l,d){const h=t&&!function qc(n){return"function"==typeof n}(t);let _;if(h)_=e;else{const V=e||{};_=V.index,r=V.injector,l=V.projectableNodes,d=V.environmentInjector||V.ngModuleRef}const x=h?t:new yd(Gi(t)),D=r||this.parentInjector;if(!d&&null==x.ngModule){const ne=(h?D:this.parentInjector).get(js,null);ne&&(d=ne)}const I=x.create(D,l,void 0,d);return this.insert(I.hostView,_),I}insert(t,e){const r=t._lView,l=r[1];if(function hk(n){return fa(n[3])}(r)){const I=this.indexOf(t);if(-1!==I)this.detach(I);else{const V=r[3],ne=new tf(V,V[6],V[3]);ne.detach(ne.indexOf(t))}}const d=this._adjustIndex(e),h=this._lContainer;!function Rv(n,t,e,r){const l=10+r,d=e.length;r>0&&(e[l-1][4]=t),r<d-10?(t[4]=e[l],hv(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const h=t[17];null!==h&&e!==h&&function Fv(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(h,t);const _=t[19];null!==_&&_.insertView(n),t[2]|=64}(l,r,h,d);const _=Au(d,h),x=r[11],D=Vs(x,h[7]);return null!==D&&function gp(n,t,e,r,l,d){r[0]=l,r[6]=t,ya(n,r,e,1,l,d)}(l,h[6],x,r,D,_),t.attachToViewContainerRef(),hv(Pg(h),d,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Wy(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=Tm(this._lContainer,e);r&&(rp(Pg(this._lContainer),e),ed(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=Tm(this._lContainer,e);return r&&null!=rp(Pg(this._lContainer),e)?new Gu(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function Wy(n){return n[8]}function Pg(n){return n[8]||(n[8]=[])}function QC(n,t){let e;const r=t[n.index];if(fa(r))e=r;else{let l;if(8&n.type)l=_r(r);else{const d=t[11];l=d.createComment("");const h=Yo(n,t);Xl(d,Vs(d,h),l,function Fm(n,t){return n.nextSibling(t)}(d,h),!1)}t[n.index]=e=qs(r,t,l,n),Rp(t,e)}return new tf(e,n,t)}class Gy{constructor(t){this.queryList=t,this.matches=null}clone(){return new Gy(this.queryList)}setDirty(){this.queryList.setDirty()}}class ws{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,l=[];for(let d=0;d<r;d++){const h=e.getByIndex(d);l.push(this.queries[h.indexInDeclarationView].clone())}return new ws(l)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==nS(t,e).matches&&this.queries[e].setDirty()}}class $y{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class nf{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const l=null!==e?e.length:0,d=this.getByIndex(r).embeddedTView(t,l);d&&(d.indexInDeclarationView=r,null!==e?e.push(d):e=[d])}return null!==e?new nf(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Nl{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Nl(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let l=0;l<r.length;l++){const d=r[l];this.matchTNodeWithReadOption(t,e,Td(e,d)),this.matchTNodeWithReadOption(t,e,um(e,t,d,!1,!1))}else r===qr?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,um(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const l=this.metadata.read;if(null!==l)if(l===Ut||l===Lr||l===qr&&4&e.type)this.addMatch(e.index,-2);else{const d=um(e,t,l,!1,!1);null!==d&&this.addMatch(e.index,d)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Td(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function dT(n,t,e,r){return-1===e?function qy(n,t){return 11&n.type?Ca(n,t):4&n.type?Ng(n,t):null}(t,n):-2===e?function JC(n,t,e){return e===Ut?Ca(t,n):e===qr?Ng(t,n):e===Lr?QC(t,n):void 0}(n,t,r):$c(n,n[1],e,t)}function eS(n,t,e,r){const l=t[19].queries[r];if(null===l.matches){const d=n.data,h=e.matches,_=[];for(let x=0;x<h.length;x+=2){const D=h[x];_.push(D<0?null:dT(t,d[D],h[x+1],e.metadata.read))}l.matches=_}return l.matches}function le(n,t,e,r){const l=n.queries.getByIndex(e),d=l.matches;if(null!==d){const h=eS(n,t,l,e);for(let _=0;_<d.length;_+=2){const x=d[_];if(x>0)r.push(h[_/2]);else{const D=d[_+1],I=t[-x];for(let V=10;V<I.length;V++){const ne=I[V];ne[17]===ne[3]&&le(ne[1],ne,D,r)}if(null!==I[9]){const V=I[9];for(let ne=0;ne<V.length;ne++){const he=V[ne];le(he[1],he,D,r)}}}}}return r}function Ot(n){const t=vt(),e=wi(),r=tm();nm(r+1);const l=nS(e,r);if(n.dirty&&function Vx(n){return 4==(4&n[2])}(t)===(2==(2&l.metadata.flags))){if(null===l.matches)n.reset([]);else{const d=l.crossesNgTemplate?le(e,t,r,[]):eS(e,t,l,r);n.reset(d,Kw),n.notifyOnChanges()}return!0}return!1}function Ti(n,t,e){const r=wi();r.firstCreatePass&&(tS(r,new $y(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),Lg(r,vt(),t)}function vi(n,t,e,r){const l=wi();if(l.firstCreatePass){const d=wr();tS(l,new $y(t,e,r),d.index),function uT(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(l,n),2==(2&e)&&(l.staticContentQueries=!0)}Lg(l,vt(),e)}function Kt(){return function rf(n,t){return n[19].queries[t].queryList}(vt(),tm())}function Lg(n,t,e){const r=new sh(4==(4&e));Ua(n,t,r,r.destroy),null===t[19]&&(t[19]=new ws),t[19].queries.push(new Gy(r))}function tS(n,t,e){null===n.queries&&(n.queries=new nf),n.queries.track(new Nl(t,e))}function nS(n,t){return n.queries.getByIndex(t)}function af(n,t){return Ng(n,t)}function Wg(...n){}const lf=new Ye("Application Initializer");let cf=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Wg,this.reject=Wg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,l)=>{this.resolve=r,this.reject=l})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let l=0;l<this.appInits.length;l++){const d=this.appInits[l]();if(Pp(d))e.push(d);else if(Lp(d)){const h=new Promise((_,x)=>{d.subscribe({complete:_,error:x})});e.push(h)}}Promise.all(e).then(()=>{r()}).catch(l=>{this.reject(l)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(ee(lf,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const dh=new Ye("AppId",{providedIn:"root",factory:function yS(){return`${Gg()}${Gg()}${Gg()}`}});function Gg(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const xS=new Ye("Platform Initializer"),n0=new Ye("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),wS=new Ye("appBootstrapListener"),no=new Ye("AnimationModuleType");let DT=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Cs=new Ye("LocaleId",{providedIn:"root",factory:()=>Ft(Cs,kn.Optional|kn.SkipSelf)||function CS(){return typeof $localize<"u"&&$localize.locale||Ol}()});class Id{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let SS=(()=>{class n{compileModuleSync(e){return new Ly(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),d=gs($o(e).declarations).reduce((h,_)=>{const x=Gi(_);return x&&h.push(new yd(x)),h},[]);return new Id(r,d)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kS=(()=>Promise.resolve(0))();function r0(n){typeof Zone>"u"?kS.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class ln{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new En(!1),this.onMicrotaskEmpty=new En(!1),this.onStable=new En(!1),this.onError=new En(!1),typeof Zone>"u")throw new ot(908,!1);Zone.assertZonePatched();const l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!r&&e,l.shouldCoalesceRunChangeDetection=r,l.lastRequestAnimationFrameId=-1,l.nativeRequestAnimationFrame=function $g(){let n=k.requestAnimationFrame,t=k.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function MT(n){const t=()=>{!function hh(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(k,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,o0(n),n.isCheckStableRunning=!0,qg(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),o0(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,l,d,h,_)=>{try{return TS(n),e.invokeTask(l,d,h,_)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===d.type||n.shouldCoalesceRunChangeDetection)&&t(),IS(n)}},onInvoke:(e,r,l,d,h,_,x)=>{try{return TS(n),e.invoke(l,d,h,_,x)}finally{n.shouldCoalesceRunChangeDetection&&t(),IS(n)}},onHasTask:(e,r,l,d)=>{e.hasTask(l,d),r===l&&("microTask"==d.change?(n._hasPendingMicrotasks=d.microTask,o0(n),qg(n)):"macroTask"==d.change&&(n.hasPendingMacrotasks=d.macroTask))},onHandleError:(e,r,l,d)=>(e.handleError(l,d),n.runOutsideAngular(()=>n.onError.emit(d)),!1)})}(l)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ln.isInAngularZone())throw new ot(909,!1)}static assertNotInAngularZone(){if(ln.isInAngularZone())throw new ot(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,l){const d=this._inner,h=d.scheduleEventTask("NgZoneEvent: "+l,t,MS,Wg,Wg);try{return d.runTask(h,e,r)}finally{d.cancelTask(h)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const MS={};function qg(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function o0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function TS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function IS(n){n._nesting--,qg(n)}class AS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new En,this.onMicrotaskEmpty=new En,this.onStable=new En,this.onError=new En}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,l){return t.apply(e,r)}}const RS=new Ye(""),df=new Ye("");let tl,uf=(()=>{class n{constructor(e,r,l){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,tl||(function TT(n){tl=n}(l),l.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ln.assertNotInAngularZone(),r0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())r0(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,l){let d=-1;r&&r>0&&(d=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==d),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:d,updateCb:l})}whenStable(e,r,l){if(l&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,l),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,l){return[]}}return n.\u0275fac=function(e){return new(e||n)(ee(ln),ee(a0),ee(df))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),a0=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return tl?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),nr=null;const FS=new Ye("AllowMultipleToken"),s0=new Ye("PlatformDestroyListeners");class OS{constructor(t,e){this.name=t,this.token=e}}function PS(n,t,e=[]){const r=`Platform: ${t}`,l=new Ye(r);return(d=[])=>{let h=c0();if(!h||h.injector.get(FS,!1)){const _=[...e,...d,{provide:l,useValue:!0}];n?n(_):function RT(n){if(nr&&!nr.get(FS,!1))throw new ot(400,!1);nr=n;const t=n.get(ph);(function l0(n){const t=n.get(xS,null);t&&t.forEach(e=>e())})(n)}(function BS(n=[],t){return nn.create({name:t,providers:[{provide:wp,useValue:"platform"},{provide:s0,useValue:new Set([()=>nr=null])},...n]})}(_,r))}return function LS(n){const t=c0();if(!t)throw new ot(401,!1);return t}()}}function c0(){return nr?.get(ph)??null}let ph=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const l=function zS(n,t){let e;return e="noop"===n?new AS:("zone.js"===n?void 0:n)||new ln(t),e}(r?.ngZone,function ia(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),d=[{provide:ln,useValue:l}];return l.run(()=>{const h=nn.create({providers:d,parent:this.injector,name:e.moduleType.name}),_=e.create(h),x=_.injector.get(Cl,null);if(!x)throw new ot(402,!1);return l.runOutsideAngular(()=>{const D=l.onError.subscribe({next:I=>{x.handleError(I)}});_.onDestroy(()=>{hf(this._modules,_),D.unsubscribe()})}),function VS(n,t,e){try{const r=e();return Pp(r)?r.catch(l=>{throw t.runOutsideAngular(()=>n.handleError(l)),l}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(x,l,()=>{const D=_.injector.get(cf);return D.runInitializers(),D.donePromise.then(()=>(function uy(n){Wo(n,"Expected localeId to be defined"),"string"==typeof n&&(dy=n.toLowerCase().replace(/_/g,"-"))}(_.injector.get(Cs,Ol)||Ol),this._moduleDoBootstrap(_),_))})})}bootstrapModule(e,r=[]){const l=US({},r);return function IT(n,t,e){const r=new Ly(e);return Promise.resolve(r)}(0,0,e).then(d=>this.bootstrapModuleFactory(d,l))}_moduleDoBootstrap(e){const r=e.injector.get(fh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(l=>r.bootstrap(l));else{if(!e.instance.ngDoBootstrap)throw new ot(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ot(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(s0,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(ee(nn))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function US(n,t){return Array.isArray(t)?t.reduce(US,n):{...n,...t}}let fh=(()=>{class n{constructor(e,r,l){this._zone=e,this._injector=r,this._exceptionHandler=l,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const d=new pt(_=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{_.next(this._stable),_.complete()})}),h=new pt(_=>{let x;this._zone.runOutsideAngular(()=>{x=this._zone.onStable.subscribe(()=>{ln.assertNotInAngularZone(),r0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,_.next(!0))})})});const D=this._zone.onUnstable.subscribe(()=>{ln.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{_.next(!1)}))});return()=>{x.unsubscribe(),D.unsubscribe()}});this.isStable=Ra(d,h.pipe(hl()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const l=e instanceof ec;if(!this._injector.get(cf).done)throw!l&&function gl(n){const t=Gi(n)||Po(n)||Rr(n);return null!==t&&t.standalone}(e),new ot(405,false);let h;h=l?e:this._injector.get(nc).resolveComponentFactory(e),this.componentTypes.push(h.componentType);const _=function AT(n){return n.isBoundToModule}(h)?void 0:this._injector.get(ah),D=h.create(nn.NULL,[],r||h.selector,_),I=D.location.nativeElement,V=D.injector.get(RS,null);return V?.registerApplication(I),D.onDestroy(()=>{this.detachView(D.hostView),hf(this.components,D),V?.unregisterApplication(I)}),this._loadComponent(D),D}tick(){if(this._runningTick)throw new ot(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;hf(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const r=this._injector.get(wS,[]);r.push(...this._bootstrapListeners),r.forEach(l=>l(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>hf(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ot(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(ee(ln),ee(js),ee(Cl))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hf(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let ir=(()=>{class n{}return n.__NG_ELEMENT_ID__=LT,n})();function LT(n){return function jS(n,t,e){if(cu(n)&&!e){const r=Ko(n.index,t);return new Gu(r,r)}return 47&n.type?new Gu(t[16],t):null}(wr(),vt(),16==(16&n))}class i{constructor(){}supports(t){return lc(t)}create(t){return new c(t)}}const a=(n,t)=>t;class c{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||a}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,l=0,d=null;for(;e||r;){const h=!r||e&&e.currentIndex<g(r,l,d)?e:r,_=g(h,l,d),x=h.currentIndex;if(h===r)l--,r=r._nextRemoved;else if(e=e._next,null==h.previousIndex)l++;else{d||(d=[]);const D=_-l,I=x-l;if(D!=I){for(let ne=0;ne<D;ne++){const he=ne<d.length?d[ne]:d[ne]=0,Ce=he+ne;I<=Ce&&Ce<D&&(d[ne]=he+1)}d[h.previousIndex]=I-D}}_!==x&&t(h,_,x)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!lc(t))throw new ot(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let l,d,h,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let _=0;_<this.length;_++)d=t[_],h=this._trackByFn(_,d),null!==e&&Object.is(e.trackById,h)?(r&&(e=this._verifyReinsertion(e,d,h,_)),Object.is(e.item,d)||this._addIdentityChange(e,d)):(e=this._mismatch(e,d,h,_),r=!0),e=e._next}else l=0,function Qi(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Ks()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,_=>{h=this._trackByFn(l,_),null!==e&&Object.is(e.trackById,h)?(r&&(e=this._verifyReinsertion(e,_,h,l)),Object.is(e.item,_)||this._addIdentityChange(e,_)):(e=this._mismatch(e,_,h,l),r=!0),e=e._next,l++}),this.length=l;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,l){let d;return null===t?d=this._itTail:(d=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,d,l)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,l))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,d,l)):t=this._addAfter(new u(e,r),d,l),t}_verifyReinsertion(t,e,r,l){let d=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==d?t=this._reinsertAfter(d,t._prev,l):t.currentIndex!=l&&(t.currentIndex=l,this._addToMoves(t,l)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const l=t._prevRemoved,d=t._nextRemoved;return null===l?this._removalsHead=d:l._nextRemoved=d,null===d?this._removalsTail=l:d._prevRemoved=l,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const l=null===e?this._itHead:e._next;return t._next=l,t._prev=e,null===l?this._itTail=t:l._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new m),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new m),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class u{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class p{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class m{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new p,this.map.set(e,r)),r.add(t)}get(t,e){const l=this.map.get(t);return l?l.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function g(n,t,e){const r=n.previousIndex;if(null===r)return r;let l=0;return e&&r<e.length&&(l=e[r]),r+t+l}class v{constructor(){}supports(t){return t instanceof Map||$u(t)}create(){return new y}}class y{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||$u(t)))throw new ot(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,l)=>{if(e&&e.key===l)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const d=this._getOrCreateRecordForKey(l,r);e=this._insertBeforeOrAppend(e,d)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const l=this._records.get(t);this._maybeAddToChanges(l,e);const d=l._prev,h=l._next;return d&&(d._next=h),h&&(h._prev=d),l._next=null,l._prev=null,l}const r=new C(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class C{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function S(){return new M([new i])}let M=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const l=r.factories.slice();e=e.concat(l)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||S()),deps:[[n,new Uo,new Vo]]}}find(e){const r=this.factories.find(l=>l.supports(e));if(null!=r)return r;throw new ot(901,!1)}}return n.\u0275prov=St({token:n,providedIn:"root",factory:S}),n})();function N(){return new P([new v])}let P=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const l=r.factories.slice();e=e.concat(l)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||N()),deps:[[n,new Uo,new Vo]]}}find(e){const r=this.factories.find(l=>l.supports(e));if(r)return r;throw new ot(901,!1)}}return n.\u0275prov=St({token:n,providedIn:"root",factory:N}),n})();const Q=PS(null,"core",[]);let se=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(ee(fh))},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();function ue(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let at=null;function yt(){return at}class Xt{}const Mt=new Ye("DocumentToken");let Tn=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(){return function Hn(){return ee(li)}()},providedIn:"platform"}),n})();const si=new Ye("Location Initialized");let li=(()=>{class n extends Tn{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return yt().getBaseHref(this._doc)}onPopState(e){const r=yt().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=yt().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,l){ci()?this._history.pushState(e,r,l):this.location.hash=l}replaceState(e,r,l){ci()?this._history.replaceState(e,r,l):this.location.hash=l}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:function(){return function hr(){return new li(ee(Mt))}()},providedIn:"platform"}),n})();function ci(){return!!window.history.pushState}function di(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function Ui(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Jn(n){return n&&"?"!==n[0]?"?"+n:n}let Gn=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(){return Ft(Hi)},providedIn:"root"}),n})();const Ji=new Ye("appBaseHref");let Hi=(()=>{class n extends Gn{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Ft(Mt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return di(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Jn(this._platformLocation.search),l=this._platformLocation.hash;return l&&e?`${r}${l}`:r}pushState(e,r,l,d){const h=this.prepareExternalUrl(l+Jn(d));this._platformLocation.pushState(e,r,h)}replaceState(e,r,l,d){const h=this.prepareExternalUrl(l+Jn(d));this._platformLocation.replaceState(e,r,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(ee(Tn),ee(Ji,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ra=(()=>{class n extends Gn{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=di(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,l,d){let h=this.prepareExternalUrl(l+Jn(d));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(e,r,h)}replaceState(e,r,l,d){let h=this.prepareExternalUrl(l+Jn(d));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(ee(Tn),ee(Ji,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),oa=(()=>{class n{constructor(e){this._subject=new En,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._basePath=function ss(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(Ui(Co(r))),this._locationStrategy.onPopState(l=>{this._subject.emit({url:this.path(!0),pop:!0,state:l.state,type:l.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Jn(r))}normalize(e){return n.stripTrailingSlash(function Wa(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._basePath,Co(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",l=null){this._locationStrategy.pushState(l,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Jn(r)),l)}replaceState(e,r="",l=null){this._locationStrategy.replaceState(l,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Jn(r)),l)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(l=>l(e,r))}subscribe(e,r,l){return this._subject.subscribe({next:e,error:r,complete:l})}}return n.normalizeQueryParams=Jn,n.joinWithSlash=di,n.stripTrailingSlash=Ui,n.\u0275fac=function(e){return new(e||n)(ee(Gn))},n.\u0275prov=St({token:n,factory:function(){return function aa(){return new oa(ee(Gn))}()},providedIn:"root"}),n})();function Co(n){return n.replace(/\/index.html$/,"")}let aO=(()=>{class n{constructor(e,r,l,d){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=l,this._renderer=d,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(lc(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Fi(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(l=>{r?this._renderer.addClass(this._ngEl.nativeElement,l):this._renderer.removeClass(this._ngEl.nativeElement,l)})}}return n.\u0275fac=function(e){return new(e||n)(re(M),re(P),re(Ut),re(wl))},n.\u0275dir=Ze({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class Cz{constructor(t,e,r,l){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=l}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let tD=(()=>{class n{constructor(e,r,l){this._viewContainer=e,this._template=r,this._differs=l,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((l,d,h)=>{if(null==l.previousIndex)r.createEmbeddedView(this._template,new Cz(l.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)r.remove(null===d?void 0:d);else if(null!==d){const _=r.get(d);r.move(_,h),cO(_,l)}});for(let l=0,d=r.length;l<d;l++){const _=r.get(l).context;_.index=l,_.count=d,_.ngForOf=this._ngForOf}e.forEachIdentityChange(l=>{cO(r.get(l.currentIndex),l)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(re(Lr),re(qr),re(M))},n.\u0275dir=Ze({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function cO(n,t){n.context.$implicit=t.item}let gc=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new Dz,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){dO("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){dO("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(re(Lr),re(qr))},n.\u0275dir=Ze({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class Dz{constructor(){this.$implicit=null,this.ngIf=null}}function dO(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Fi(t)}'.`)}class QT{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let C0=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const r=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let r=0;r<this._defaultViews.length;r++)this._defaultViews[r].enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),JT=(()=>{class n{constructor(e,r,l){this.ngSwitch=l,l._addCase(),this._view=new QT(e,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(re(Lr),re(qr),re(C0,9))},n.\u0275dir=Ze({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),eI=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:l,ngTemplateOutletContext:d,ngTemplateOutletInjector:h}=this;this._viewRef=r.createEmbeddedView(l,d,h?{injector:h}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(re(Lr))},n.\u0275dir=Ze({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Ki]}),n})(),hO=(()=>{class n{transform(e){return JSON.stringify(e,null,2)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ha({name:"json",type:n,pure:!1,standalone:!0}),n})(),Yr=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();const fO="browser";let tV=(()=>{class n{}return n.\u0275prov=St({token:n,providedIn:"root",factory:()=>new nV(ee(Mt),window)}),n})();class nV{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function iV(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let l=r.currentNode;for(;l;){const d=l.shadowRoot;if(d){const h=d.getElementById(t)||d.querySelector(`[name="${t}"]`);if(h)return h}l=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,l=e.top+this.window.pageYOffset,d=this.offset();this.window.scrollTo(r-d[0],l-d[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=mO(this.window.history)||mO(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function mO(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class AV extends Xt{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class oI extends AV{static makeCurrent(){!function Gt(n){at||(at=n)}(new oI)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function RV(){return D0=D0||document.querySelector("base"),D0?D0.getAttribute("href"):null}();return null==e?null:function FV(n){iD=iD||document.createElement("a"),iD.setAttribute("href",n);const t=iD.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){D0=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function xz(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[l,d]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(l.trim()===t)return decodeURIComponent(d)}return null}(document.cookie,t)}}let iD,D0=null;const xO=new Ye("TRANSITION_ID"),NV=[{provide:lf,useFactory:function OV(n,t,e){return()=>{e.get(cf).donePromise.then(()=>{const r=yt(),l=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let d=0;d<l.length;d++)r.remove(l[d])})}},deps:[xO,Mt,nn],multi:!0}];let LV=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const rD=new Ye("EventManagerPlugins");let oD=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(l=>l.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,l){return this._findPluginFor(r).addEventListener(e,r,l)}addGlobalEventListener(e,r,l){return this._findPluginFor(r).addGlobalEventListener(e,r,l)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const l=this._plugins;for(let d=0;d<l.length;d++){const h=l[d];if(h.supports(e))return this._eventNameToPlugin.set(e,h),h}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(ee(rD),ee(ln))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();class wO{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const l=yt().getGlobalEventTarget(this._doc,t);if(!l)throw new Error(`Unsupported event target ${l} for event ${e}`);return this.addEventListener(l,e,r)}}let CO=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(l=>{this._stylesSet.has(l)||(this._stylesSet.add(l),r.add(l))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),E0=(()=>{class n extends CO{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,l){e.forEach(d=>{const h=this._doc.createElement("style");h.textContent=d,l.push(r.appendChild(h))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(SO),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,l)=>{this._addStylesToHost(e,l,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(SO))}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();function SO(n){yt().remove(n)}const aI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},sI=/%COMP%/g;function lI(n,t){return t.flat(100).map(e=>e.replace(sI,n))}function kO(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let aD=(()=>{class n{constructor(e,r,l){this.eventManager=e,this.sharedStylesHost=r,this.appId=l,this.rendererByCompId=new Map,this.defaultRenderer=new cI(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case Oa.Emulated:{let l=this.rendererByCompId.get(r.id);return l||(l=new jV(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,l)),l.applyToHost(e),l}case 1:case Oa.ShadowDom:return new WV(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const l=lI(r.id,r.styles);this.sharedStylesHost.addStyles(l),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(ee(oD),ee(E0),ee(dh))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();class cI{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(aI[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(TO(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(TO(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,l){if(l){e=l+":"+e;const d=aI[l];d?t.setAttributeNS(d,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const l=aI[r];l?t.removeAttributeNS(l,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,l){l&(Qo.DashCase|Qo.Important)?t.style.setProperty(e,r,l&Qo.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&Qo.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,kO(r)):this.eventManager.addEventListener(t,e,kO(r))}}function TO(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class jV extends cI{constructor(t,e,r,l){super(t),this.component=r;const d=lI(l+"-"+r.id,r.styles);e.addStyles(d),this.contentAttr=function VV(n){return"_ngcontent-%COMP%".replace(sI,n)}(l+"-"+r.id),this.hostAttr=function UV(n){return"_nghost-%COMP%".replace(sI,n)}(l+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class WV extends cI{constructor(t,e,r,l){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const d=lI(l.id,l.styles);for(let h=0;h<d.length;h++){const _=document.createElement("style");_.textContent=d[h],this.shadowRoot.appendChild(_)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let GV=(()=>{class n extends wO{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,l){return e.addEventListener(r,l,!1),()=>this.removeEventListener(e,r,l)}removeEventListener(e,r,l){return e.removeEventListener(r,l)}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const IO=["alt","control","meta","shift"],$V={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qV={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let YV=(()=>{class n extends wO{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,l){const d=n.parseEventName(r),h=n.eventCallback(d.fullKey,l,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yt().onAndCancel(e,d.domEventName,h))}static parseEventName(e){const r=e.toLowerCase().split("."),l=r.shift();if(0===r.length||"keydown"!==l&&"keyup"!==l)return null;const d=n._normalizeKey(r.pop());let h="",_=r.indexOf("code");if(_>-1&&(r.splice(_,1),h="code."),IO.forEach(D=>{const I=r.indexOf(D);I>-1&&(r.splice(I,1),h+=D+".")}),h+=d,0!=r.length||0===d.length)return null;const x={};return x.domEventName=l,x.fullKey=h,x}static matchEventFullKeyCode(e,r){let l=$V[e.key]||e.key,d="";return r.indexOf("code.")>-1&&(l=e.code,d="code."),!(null==l||!l)&&(l=l.toLowerCase()," "===l?l="space":"."===l&&(l="dot"),IO.forEach(h=>{h!==l&&(0,qV[h])(e)&&(d+=h+".")}),d+=l,d===r)}static eventCallback(e,r,l){return d=>{n.matchEventFullKeyCode(d,e)&&l.runGuarded(()=>r(d))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const QV=PS(Q,"browser",[{provide:n0,useValue:fO},{provide:xS,useValue:function KV(){oI.makeCurrent()},multi:!0},{provide:Mt,useFactory:function ZV(){return function Ru(n){od=n}(document),document},deps:[]}]),FO=new Ye(""),OO=[{provide:df,useClass:class PV{addToWindow(t){k.getAngularTestability=(r,l=!0)=>{const d=t.findTestabilityInTree(r,l);if(null==d)throw new Error("Could not find testability for element.");return d},k.getAllAngularTestabilities=()=>t.getAllTestabilities(),k.getAllAngularRootElements=()=>t.getAllRootElements(),k.frameworkStabilizers||(k.frameworkStabilizers=[]),k.frameworkStabilizers.push(r=>{const l=k.getAllAngularTestabilities();let d=l.length,h=!1;const _=function(x){h=h||x,d--,0==d&&r(h)};l.forEach(function(x){x.whenStable(_)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?yt().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:RS,useClass:uf,deps:[ln,a0,df]},{provide:uf,useClass:uf,deps:[ln,a0,df]}],NO=[{provide:wp,useValue:"root"},{provide:Cl,useFactory:function XV(){return new Cl},deps:[]},{provide:rD,useClass:GV,multi:!0,deps:[Mt,ln,n0]},{provide:rD,useClass:YV,multi:!0,deps:[Mt]},{provide:aD,useClass:aD,deps:[oD,E0,dh]},{provide:Dp,useExisting:aD},{provide:CO,useExisting:E0},{provide:E0,useClass:E0,deps:[Mt]},{provide:oD,useClass:oD,deps:[rD,ln]},{provide:class rV{},useClass:LV,deps:[]},[]];let PO=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:dh,useValue:e.appId},{provide:xO,useExisting:dh},NV]}}}return n.\u0275fac=function(e){return new(e||n)(ee(FO,12))},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[...NO,...OO],imports:[Yr,se]}),n})(),LO=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:function(e){let r=null;return r=e?new e:function e5(){return new LO(ee(Mt))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let sD=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(e){let r=null;return r=e?new(e||n):ee(VO),r},providedIn:"root"}),n})(),VO=(()=>{class n extends sD{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case zi.NONE:return r;case zi.HTML:return La(r,"HTML")?so(r):Hs(this._doc,String(r)).toString();case zi.STYLE:return La(r,"Style")?so(r):r;case zi.SCRIPT:if(La(r,"Script"))return so(r);throw new Error("unsafe value used in a script context");case zi.URL:return La(r,"URL")?so(r):Ou(String(r));case zi.RESOURCE_URL:if(La(r,"ResourceURL"))return so(r);throw new Error(`unsafe value used in a resource URL context (see ${zl})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${zl})`)}}bypassSecurityTrustHtml(e){return function Zl(n){return new Or(n)}(e)}bypassSecurityTrustStyle(e){return function Wv(n){return new jm(n)}(e)}bypassSecurityTrustScript(e){return function $m(n){return new vp(n)}(e)}bypassSecurityTrustUrl(e){return function ur(n){return new wa(n)}(e)}bypassSecurityTrustResourceUrl(e){return function Gv(n){return new Wm(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:function(e){let r=null;return r=e?new e:function l5(n){return new VO(n.get(Mt))}(ee(nn)),r},providedIn:"root"}),n})();function hn(...n){return tr(n,Ar(n))}class ls extends Le{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const lD=ce(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:c5}=Array,{getPrototypeOf:d5,prototype:u5,keys:h5}=Object;function UO(n){if(1===n.length){const t=n[0];if(c5(t))return{args:t,keys:null};if(function p5(n){return n&&"object"==typeof n&&d5(n)===u5}(t)){const e=h5(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:f5}=Array;function hI(n){return Pt(t=>function m5(n,t){return f5(t)?n(...t):n(t)}(n,t))}function HO(n,t){return n.reduce((e,r,l)=>(e[r]=t[l],e),{})}function pI(...n){const t=Ar(n),e=ro(n),{args:r,keys:l}=UO(n);if(0===r.length)return tr([],t);const d=new pt(function g5(n,t,e=Be){return r=>{jO(t,()=>{const{length:l}=n,d=new Array(l);let h=l,_=l;for(let x=0;x<l;x++)jO(t,()=>{const D=tr(n[x],t);let I=!1;D.subscribe(pn(r,V=>{d[x]=V,I||(I=!0,_--),_||r.next(e(d.slice()))},()=>{--h||r.complete()}))},r)},r)}}(r,t,l?h=>HO(l,h):Be));return e?d.pipe(hI(e)):d}function jO(n,t,e){n?Fo(e,n,t):t()}function k0(...n){return function _5(){return Vr(1)}()(tr(n,Ar(n)))}function M0(n){return new pt(t=>{Ir(n()).subscribe(t)})}function Yg(n,t){const e=ie(n)?n:()=>n,r=l=>l.error(e());return new pt(t?l=>t.schedule(r,0,l):r)}function fI(){return en((n,t)=>{let e=null;n._refCount++;const r=pn(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const l=n._connection,d=e;e=null,l&&(!d||l===d)&&l.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class mI extends pt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,dn(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new K;const e=this.getSubject();t.add(this.source.subscribe(pn(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=K.EMPTY)}return t}refCount(){return fI()(this)}}function cs(n,t){return en((e,r)=>{let l=null,d=0,h=!1;const _=()=>h&&!l&&r.complete();e.subscribe(pn(r,x=>{l?.unsubscribe();let D=0;const I=d++;Ir(n(x,I)).subscribe(l=pn(r,V=>r.next(t?t(x,V,I,D++):V),()=>{l=null,_()}))},()=>{h=!0,_()}))})}function Kr(n){return n<=0?()=>Oo:en((t,e)=>{let r=0;t.subscribe(pn(e,l=>{++r<=n&&(e.next(l),n<=r&&e.complete())}))})}function _c(...n){const t=Ar(n);return en((e,r)=>{(t?k0(n,e,t):k0(n,e)).subscribe(r)})}function Eo(n,t){return en((e,r)=>{let l=0;e.subscribe(pn(r,d=>n.call(t,d,l++)&&r.next(d)))})}function cD(n){return en((t,e)=>{let r=!1;t.subscribe(pn(e,l=>{r=!0,e.next(l)},()=>{r||e.next(n),e.complete()}))})}function WO(n=v5){return en((t,e)=>{let r=!1;t.subscribe(pn(e,l=>{r=!0,e.next(l)},()=>r?e.complete():e.error(n())))})}function v5(){return new lD}function _h(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Eo((l,d)=>n(l,d,r)):Be,Kr(1),e?cD(t):WO(()=>new lD))}function vh(n,t){return ie(t)?Mi(n,t,1):Mi(n,1)}function io(n,t,e){const r=ie(n)||t||e?{next:n,error:t,complete:e}:n;return r?en((l,d)=>{var h;null===(h=r.subscribe)||void 0===h||h.call(r);let _=!0;l.subscribe(pn(d,x=>{var D;null===(D=r.next)||void 0===D||D.call(r,x),d.next(x)},()=>{var x;_=!1,null===(x=r.complete)||void 0===x||x.call(r),d.complete()},x=>{var D;_=!1,null===(D=r.error)||void 0===D||D.call(r,x),d.error(x)},()=>{var x,D;_&&(null===(x=r.unsubscribe)||void 0===x||x.call(r)),null===(D=r.finalize)||void 0===D||D.call(r)}))}):Be}function Rd(n){return en((t,e)=>{let d,r=null,l=!1;r=t.subscribe(pn(e,void 0,void 0,h=>{d=Ir(n(h,Rd(n)(t))),r?(r.unsubscribe(),r=null,d.subscribe(e)):l=!0})),l&&(r.unsubscribe(),r=null,d.subscribe(e))})}function b5(n,t,e,r,l){return(d,h)=>{let _=e,x=t,D=0;d.subscribe(pn(h,I=>{const V=D++;x=_?n(x,I,V):(_=!0,I),r&&h.next(x)},l&&(()=>{_&&h.next(x),h.complete()})))}}function GO(n,t){return en(b5(n,t,arguments.length>=2,!0))}function gI(n){return n<=0?()=>Oo:en((t,e)=>{let r=[];t.subscribe(pn(e,l=>{r.push(l),n<r.length&&r.shift()},()=>{for(const l of r)e.next(l);e.complete()},void 0,()=>{r=null}))})}function $O(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Eo((l,d)=>n(l,d,r)):Be,gI(1),e?cD(t):WO(()=>new lD))}function dD(n){return en((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const yi="primary",T0=Symbol("RouteTitle");class x5{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Kg(n){return new x5(n)}function w5(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const l={};for(let d=0;d<r.length;d++){const h=r[d],_=n[d];if(h.startsWith(":"))l[h.substring(1)]=_;else if(h!==_.path)return null}return{consumed:n.slice(0,r.length),posParams:l}}function vc(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let l;for(let d=0;d<e.length;d++)if(l=e[d],!YO(n[l],t[l]))return!1;return!0}function YO(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((l,d)=>r[d]===l)}return n===t}function KO(n){return Array.prototype.concat.apply([],n)}function XO(n){return n.length>0?n[n.length-1]:null}function sa(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function bh(n){return Lp(n)?n:Pp(n)?tr(Promise.resolve(n)):hn(n)}const uD=!1,S5={exact:function JO(n,t,e){if(!bf(n.segments,t.segments)||!hD(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!JO(n.children[r],t.children[r],e))return!1;return!0},subset:eN},ZO={exact:function D5(n,t){return vc(n,t)},subset:function E5(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>YO(n[e],t[e]))},ignored:()=>!0};function QO(n,t,e){return S5[e.paths](n.root,t.root,e.matrixParams)&&ZO[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function eN(n,t,e){return tN(n,t,t.segments,e)}function tN(n,t,e,r){if(n.segments.length>e.length){const l=n.segments.slice(0,e.length);return!(!bf(l,e)||t.hasChildren()||!hD(l,e,r))}if(n.segments.length===e.length){if(!bf(n.segments,e)||!hD(n.segments,e,r))return!1;for(const l in t.children)if(!n.children[l]||!eN(n.children[l],t.children[l],r))return!1;return!0}{const l=e.slice(0,n.segments.length),d=e.slice(n.segments.length);return!!(bf(n.segments,l)&&hD(n.segments,l,r)&&n.children[yi])&&tN(n.children[yi],t,d,r)}}function hD(n,t,e){return t.every((r,l)=>ZO[e](n[l].parameters,r.parameters))}class vf{constructor(t=new Ci([],{}),e={},r=null){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kg(this.queryParams)),this._queryParamMap}toString(){return T5.serialize(this)}}class Ci{constructor(t,e){this.segments=t,this.children=e,this.parent=null,sa(e,(r,l)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return pD(this)}}class I0{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Kg(this.parameters)),this._parameterMap}toString(){return rN(this)}}function bf(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let A0=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(){return new _I},providedIn:"root"}),n})();class _I{parse(t){const e=new B5(t);return new vf(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${R0(t.root,!0)}`,r=function R5(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(l=>`${fD(e)}=${fD(l)}`).join("&"):`${fD(e)}=${fD(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function I5(n){return encodeURI(n)}(t.fragment)}`:""}`}}const T5=new _I;function pD(n){return n.segments.map(t=>rN(t)).join("/")}function R0(n,t){if(!n.hasChildren())return pD(n);if(t){const e=n.children[yi]?R0(n.children[yi],!1):"",r=[];return sa(n.children,(l,d)=>{d!==yi&&r.push(`${d}:${R0(l,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function M5(n,t){let e=[];return sa(n.children,(r,l)=>{l===yi&&(e=e.concat(t(r,l)))}),sa(n.children,(r,l)=>{l!==yi&&(e=e.concat(t(r,l)))}),e}(n,(r,l)=>l===yi?[R0(n.children[yi],!1)]:[`${l}:${R0(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[yi]?`${pD(n)}/${e[0]}`:`${pD(n)}/(${e.join("//")})`}}function nN(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function fD(n){return nN(n).replace(/%3B/gi,";")}function vI(n){return nN(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function mD(n){return decodeURIComponent(n)}function iN(n){return mD(n.replace(/\+/g,"%20"))}function rN(n){return`${vI(n.path)}${function A5(n){return Object.keys(n).map(t=>`;${vI(t)}=${vI(n[t])}`).join("")}(n.parameters)}`}const F5=/^[^\/()?;=#]+/;function gD(n){const t=n.match(F5);return t?t[0]:""}const O5=/^[^=?&#]+/,P5=/^[^&#]+/;class B5{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ci([],{}):new Ci([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[yi]=new Ci(t,e)),r}parseSegment(){const t=gD(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new ot(4009,uD);return this.capture(t),new I0(mD(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=gD(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const l=gD(this.remaining);l&&(r=l,this.capture(r))}t[mD(e)]=mD(r)}parseQueryParam(t){const e=function N5(n){const t=n.match(O5);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const h=function L5(n){const t=n.match(P5);return t?t[0]:""}(this.remaining);h&&(r=h,this.capture(r))}const l=iN(e),d=iN(r);if(t.hasOwnProperty(l)){let h=t[l];Array.isArray(h)||(h=[h],t[l]=h),h.push(d)}else t[l]=d}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=gD(this.remaining),l=this.remaining[r.length];if("/"!==l&&")"!==l&&";"!==l)throw new ot(4010,uD);let d;r.indexOf(":")>-1?(d=r.slice(0,r.indexOf(":")),this.capture(d),this.capture(":")):t&&(d=yi);const h=this.parseChildren();e[d]=1===Object.keys(h).length?h[yi]:new Ci([],h),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new ot(4011,uD)}}function bI(n){return n.segments.length>0?new Ci([],{[yi]:n}):n}function _D(n){const t={};for(const r of Object.keys(n.children)){const d=_D(n.children[r]);(d.segments.length>0||d.hasChildren())&&(t[r]=d)}return function z5(n){if(1===n.numberOfChildren&&n.children[yi]){const t=n.children[yi];return new Ci(n.segments.concat(t.segments),t.children)}return n}(new Ci(n.segments,t))}function yf(n){return n instanceof vf}function H5(n,t,e,r,l){if(0===e.length)return Xg(t.root,t.root,t.root,r,l);const d=function sN(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new aN(!0,0,n);let t=0,e=!1;const r=n.reduce((l,d,h)=>{if("object"==typeof d&&null!=d){if(d.outlets){const _={};return sa(d.outlets,(x,D)=>{_[D]="string"==typeof x?x.split("/"):x}),[...l,{outlets:_}]}if(d.segmentPath)return[...l,d.segmentPath]}return"string"!=typeof d?[...l,d]:0===h?(d.split("/").forEach((_,x)=>{0==x&&"."===_||(0==x&&""===_?e=!0:".."===_?t++:""!=_&&l.push(_))}),l):[...l,d]},[]);return new aN(e,t,r)}(e);return d.toRoot()?Xg(t.root,t.root,new Ci([],{}),r,l):function h(x){const D=function W5(n,t,e,r){if(n.isAbsolute)return new Zg(t.root,!0,0);if(-1===r)return new Zg(e,e===t.root,0);return function lN(n,t,e){let r=n,l=t,d=e;for(;d>l;){if(d-=l,r=r.parent,!r)throw new ot(4005,!1);l=r.segments.length}return new Zg(r,!1,l-d)}(e,r+(F0(n.commands[0])?0:1),n.numberOfDoubleDots)}(d,t,n.snapshot?._urlSegment,x),I=D.processChildren?N0(D.segmentGroup,D.index,d.commands):xI(D.segmentGroup,D.index,d.commands);return Xg(t.root,D.segmentGroup,I,r,l)}(n.snapshot?._lastPathIndex)}function F0(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function O0(n){return"object"==typeof n&&null!=n&&n.outlets}function Xg(n,t,e,r,l){let h,d={};r&&sa(r,(x,D)=>{d[D]=Array.isArray(x)?x.map(I=>`${I}`):`${x}`}),h=n===t?e:oN(n,t,e);const _=bI(_D(h));return new vf(_,d,l)}function oN(n,t,e){const r={};return sa(n.children,(l,d)=>{r[d]=l===t?e:oN(l,t,e)}),new Ci(n.segments,r)}class aN{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&F0(r[0]))throw new ot(4003,!1);const l=r.find(O0);if(l&&l!==XO(r))throw new ot(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Zg{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function xI(n,t,e){if(n||(n=new Ci([],{})),0===n.segments.length&&n.hasChildren())return N0(n,t,e);const r=function $5(n,t,e){let r=0,l=t;const d={match:!1,pathIndex:0,commandIndex:0};for(;l<n.segments.length;){if(r>=e.length)return d;const h=n.segments[l],_=e[r];if(O0(_))break;const x=`${_}`,D=r<e.length-1?e[r+1]:null;if(l>0&&void 0===x)break;if(x&&D&&"object"==typeof D&&void 0===D.outlets){if(!dN(x,D,h))return d;r+=2}else{if(!dN(x,{},h))return d;r++}l++}return{match:!0,pathIndex:l,commandIndex:r}}(n,t,e),l=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const d=new Ci(n.segments.slice(0,r.pathIndex),{});return d.children[yi]=new Ci(n.segments.slice(r.pathIndex),n.children),N0(d,0,l)}return r.match&&0===l.length?new Ci(n.segments,{}):r.match&&!n.hasChildren()?wI(n,t,e):r.match?N0(n,0,l):wI(n,t,e)}function N0(n,t,e){if(0===e.length)return new Ci(n.segments,{});{const r=function G5(n){return O0(n[0])?n[0].outlets:{[yi]:n}}(e),l={};return sa(r,(d,h)=>{"string"==typeof d&&(d=[d]),null!==d&&(l[h]=xI(n.children[h],t,d))}),sa(n.children,(d,h)=>{void 0===r[h]&&(l[h]=d)}),new Ci(n.segments,l)}}function wI(n,t,e){const r=n.segments.slice(0,t);let l=0;for(;l<e.length;){const d=e[l];if(O0(d)){const x=q5(d.outlets);return new Ci(r,x)}if(0===l&&F0(e[0])){r.push(new I0(n.segments[t].path,cN(e[0]))),l++;continue}const h=O0(d)?d.outlets[yi]:`${d}`,_=l<e.length-1?e[l+1]:null;h&&_&&F0(_)?(r.push(new I0(h,cN(_))),l+=2):(r.push(new I0(h,{})),l++)}return new Ci(r,{})}function q5(n){const t={};return sa(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=wI(new Ci([],{}),0,e))}),t}function cN(n){const t={};return sa(n,(e,r)=>t[r]=`${e}`),t}function dN(n,t,e){return n==e.path&&vc(t,e.parameters)}class Fd{constructor(t,e){this.id=t,this.url=e}}class CI extends Fd{constructor(t,e,r="imperative",l=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=l}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class xf extends Fd{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class vD extends Fd{constructor(t,e,r,l){super(t,e),this.reason=r,this.code=l,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class uN extends Fd{constructor(t,e,r,l){super(t,e),this.error=r,this.target=l,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Y5 extends Fd{constructor(t,e,r,l){super(t,e),this.urlAfterRedirects=r,this.state=l,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class K5 extends Fd{constructor(t,e,r,l){super(t,e),this.urlAfterRedirects=r,this.state=l,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class X5 extends Fd{constructor(t,e,r,l,d){super(t,e),this.urlAfterRedirects=r,this.state=l,this.shouldActivate=d,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Z5 extends Fd{constructor(t,e,r,l){super(t,e),this.urlAfterRedirects=r,this.state=l,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Q5 extends Fd{constructor(t,e,r,l){super(t,e),this.urlAfterRedirects=r,this.state=l,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class J5{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class e8{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class t8{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class n8{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class r8{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class o8{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hN{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let s8=(()=>{class n{createUrlTree(e,r,l,d,h,_){return H5(e||r.root,l,d,h,_)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),l8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(t){return s8.\u0275fac(t)},providedIn:"root"}),n})();class pN{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=SI(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=SI(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=DI(t,this._root);return e.length<2?[]:e[e.length-2].children.map(l=>l.value).filter(l=>l!==t)}pathFromRoot(t){return DI(t,this._root).map(e=>e.value)}}function SI(n,t){if(n===t.value)return t;for(const e of t.children){const r=SI(n,e);if(r)return r}return null}function DI(n,t){if(n===t.value)return[t];for(const e of t.children){const r=DI(n,e);if(r.length)return r.unshift(t),r}return[]}class Od{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Qg(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class fN extends pN{constructor(t,e){super(t),this.snapshot=e,EI(this,t)}toString(){return this.snapshot.toString()}}function mN(n,t){const e=function c8(n,t){const h=new bD([],{},{},"",{},yi,t,null,n.root,-1,{});return new _N("",new Od(h,[]))}(n,t),r=new ls([new I0("",{})]),l=new ls({}),d=new ls({}),h=new ls({}),_=new ls(""),x=new Jg(r,l,h,_,d,yi,t,e.root);return x.snapshot=e.root,new fN(new Od(x,[]),e)}class Jg{constructor(t,e,r,l,d,h,_,x){this.url=t,this.params=e,this.queryParams=r,this.fragment=l,this.data=d,this.outlet=h,this.component=_,this.title=this.data?.pipe(Pt(D=>D[T0]))??hn(void 0),this._futureSnapshot=x}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Pt(t=>Kg(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Pt(t=>Kg(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function gN(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const l=e[r],d=e[r-1];if(l.routeConfig&&""===l.routeConfig.path)r--;else{if(d.component)break;r--}}return function d8(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class bD{constructor(t,e,r,l,d,h,_,x,D,I,V){this.url=t,this.params=e,this.queryParams=r,this.fragment=l,this.data=d,this.outlet=h,this.component=_,this.routeConfig=x,this._urlSegment=D,this._lastPathIndex=I,this._resolve=V}get title(){return this.data?.[T0]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Kg(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kg(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class _N extends pN{constructor(t,e){super(e),this.url=t,EI(this,e)}toString(){return vN(this._root)}}function EI(n,t){t.value._routerState=n,t.children.forEach(e=>EI(n,e))}function vN(n){const t=n.children.length>0?` { ${n.children.map(vN).join(", ")} } `:"";return`${n.value}${t}`}function kI(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,vc(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),vc(t.params,e.params)||n.params.next(e.params),function C5(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!vc(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),vc(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function MI(n,t){const e=vc(n.params,t.params)&&function k5(n,t){return bf(n,t)&&n.every((e,r)=>vc(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||MI(n.parent,t.parent))}function P0(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const l=function h8(n,t,e){return t.children.map(r=>{for(const l of e.children)if(n.shouldReuseRoute(r.value,l.value.snapshot))return P0(n,r,l);return P0(n,r)})}(n,t,e);return new Od(r,l)}{if(n.shouldAttach(t.value)){const d=n.retrieve(t.value);if(null!==d){const h=d.route;return h.value._futureSnapshot=t.value,h.children=t.children.map(_=>P0(n,_)),h}}const r=function p8(n){return new Jg(new ls(n.url),new ls(n.params),new ls(n.queryParams),new ls(n.fragment),new ls(n.data),n.outlet,n.component,n)}(t.value),l=t.children.map(d=>P0(n,d));return new Od(r,l)}}const TI="ngNavigationCancelingError";function bN(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=yf(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,l=yN(!1,0,t);return l.url=e,l.navigationBehaviorOptions=r,l}function yN(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[TI]=!0,r.cancellationCode=t,e&&(r.url=e),r}function xN(n){return wN(n)&&yf(n.url)}function wN(n){return n&&n[TI]}class f8{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new L0,this.attachRef=null}}let L0=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const l=this.getOrCreateContext(e);l.outlet=r,this.contexts.set(e,l)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new f8,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const yD=!1;let II=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=yi,this.activateEvents=new En,this.deactivateEvents=new En,this.attachEvents=new En,this.detachEvents=new En,this.parentContexts=Ft(L0),this.location=Ft(Lr),this.changeDetector=Ft(ir),this.environmentInjector=Ft(js)}ngOnChanges(e){if(e.name){const{firstChange:r,previousValue:l}=e.name;if(r)return;this.isTrackedInParentContexts(l)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(l)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ot(4012,yD);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ot(4012,yD);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ot(4012,yD);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new ot(4013,yD);this._activatedRoute=e;const l=this.location,h=e.snapshot.component,_=this.parentContexts.getOrCreateContext(this.name).children,x=new m8(e,_,l.injector);if(r&&function g8(n){return!!n.resolveComponentFactory}(r)){const D=r.resolveComponentFactory(h);this.activated=l.createComponent(D,l.length,x)}else this.activated=l.createComponent(h,{index:l.length,injector:x,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ki]}),n})();class m8{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===Jg?this.route:t===L0?this.childContexts:this.parent.get(t,e)}}let AI=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Mn({type:n,selectors:[["ng-component"]],standalone:!0,features:[zy],decls:1,vars:0,template:function(e,r){1&e&&yn(0,"router-outlet")},dependencies:[II],encapsulation:2}),n})();function CN(n,t){return n.providers&&!n._injector&&(n._injector=Rg(n.providers,t,`Route: ${n.path}`)),n._injector??t}function FI(n){const t=n.children&&n.children.map(FI),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==yi&&(e.component=AI),e}function ol(n){return n.outlet||yi}function SN(n,t){const e=n.filter(r=>ol(r)===t);return e.push(...n.filter(r=>ol(r)!==t)),e}function B0(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class x8{constructor(t,e,r,l){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=l}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),kI(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const l=Qg(e);t.children.forEach(d=>{const h=d.value.outlet;this.deactivateRoutes(d,l[h],r),delete l[h]}),sa(l,(d,h)=>{this.deactivateRouteAndItsChildren(d,r)})}deactivateRoutes(t,e,r){const l=t.value,d=e?e.value:null;if(l===d)if(l.component){const h=r.getContext(l.outlet);h&&this.deactivateChildRoutes(t,e,h.children)}else this.deactivateChildRoutes(t,e,r);else d&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),l=r&&t.value.component?r.children:e,d=Qg(t);for(const h of Object.keys(d))this.deactivateRouteAndItsChildren(d[h],l);if(r&&r.outlet){const h=r.outlet.detach(),_=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:h,route:t,contexts:_})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),l=r&&t.value.component?r.children:e,d=Qg(t);for(const h of Object.keys(d))this.deactivateRouteAndItsChildren(d[h],l);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const l=Qg(e);t.children.forEach(d=>{this.activateRoutes(d,l[d.value.outlet],r),this.forwardEvent(new o8(d.value.snapshot))}),t.children.length&&this.forwardEvent(new n8(t.value.snapshot))}activateRoutes(t,e,r){const l=t.value,d=e?e.value:null;if(kI(l),l===d)if(l.component){const h=r.getOrCreateContext(l.outlet);this.activateChildRoutes(t,e,h.children)}else this.activateChildRoutes(t,e,r);else if(l.component){const h=r.getOrCreateContext(l.outlet);if(this.routeReuseStrategy.shouldAttach(l.snapshot)){const _=this.routeReuseStrategy.retrieve(l.snapshot);this.routeReuseStrategy.store(l.snapshot,null),h.children.onOutletReAttached(_.contexts),h.attachRef=_.componentRef,h.route=_.route.value,h.outlet&&h.outlet.attach(_.componentRef,_.route.value),kI(_.route.value),this.activateChildRoutes(t,null,h.children)}else{const _=B0(l.snapshot),x=_?.get(nc)??null;h.attachRef=null,h.route=l,h.resolver=x,h.injector=_,h.outlet&&h.outlet.activateWith(l,h.injector),this.activateChildRoutes(t,null,h.children)}}else this.activateChildRoutes(t,null,r)}}class DN{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class xD{constructor(t,e){this.component=t,this.route=e}}function w8(n,t,e){const r=n._root;return z0(r,t?t._root:null,e,[r.value])}function e_(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function B_(n){return null!==fl(n)}(n)?t.get(n):n:r}function z0(n,t,e,r,l={canDeactivateChecks:[],canActivateChecks:[]}){const d=Qg(t);return n.children.forEach(h=>{(function S8(n,t,e,r,l={canDeactivateChecks:[],canActivateChecks:[]}){const d=n.value,h=t?t.value:null,_=e?e.getContext(n.value.outlet):null;if(h&&d.routeConfig===h.routeConfig){const x=function D8(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!bf(n.url,t.url);case"pathParamsOrQueryParamsChange":return!bf(n.url,t.url)||!vc(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!MI(n,t)||!vc(n.queryParams,t.queryParams);default:return!MI(n,t)}}(h,d,d.routeConfig.runGuardsAndResolvers);x?l.canActivateChecks.push(new DN(r)):(d.data=h.data,d._resolvedData=h._resolvedData),z0(n,t,d.component?_?_.children:null:e,r,l),x&&_&&_.outlet&&_.outlet.isActivated&&l.canDeactivateChecks.push(new xD(_.outlet.component,h))}else h&&V0(t,_,l),l.canActivateChecks.push(new DN(r)),z0(n,null,d.component?_?_.children:null:e,r,l)})(h,d[h.value.outlet],e,r.concat([h.value]),l),delete d[h.value.outlet]}),sa(d,(h,_)=>V0(h,e.getContext(_),l)),l}function V0(n,t,e){const r=Qg(n),l=n.value;sa(r,(d,h)=>{V0(d,l.component?t?t.children.getContext(h):null:t,e)}),e.canDeactivateChecks.push(new xD(l.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,l))}function U0(n){return"function"==typeof n}function OI(n){return n instanceof lD||"EmptyError"===n?.name}const wD=Symbol("INITIAL_VALUE");function t_(){return cs(n=>pI(n.map(t=>t.pipe(Kr(1),_c(wD)))).pipe(Pt(t=>{for(const e of t)if(!0!==e){if(e===wD)return wD;if(!1===e||e instanceof vf)return e}return!0}),Eo(t=>t!==wD),Kr(1)))}function EN(n){return function kt(...n){return Ve(n)}(io(t=>{if(yf(t))throw bN(0,t)}),Pt(t=>!0===t))}const NI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function kN(n,t,e,r,l){const d=PI(n,t,e);return d.matched?function H8(n,t,e,r){const l=t.canMatch;return l&&0!==l.length?hn(l.map(h=>{const _=e_(h,n);return bh(function A8(n){return n&&U0(n.canMatch)}(_)?_.canMatch(t,e):n.runInContext(()=>_(t,e)))})).pipe(t_(),EN()):hn(!0)}(r=CN(t,r),t,e).pipe(Pt(h=>!0===h?d:{...NI})):hn(d)}function PI(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...NI}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const l=(t.matcher||w5)(e,n,t);if(!l)return{...NI};const d={};sa(l.posParams,(_,x)=>{d[x]=_.path});const h=l.consumed.length>0?{...d,...l.consumed[l.consumed.length-1].parameters}:d;return{matched:!0,consumedSegments:l.consumed,remainingSegments:e.slice(l.consumed.length),parameters:h,positionalParamSegments:l.posParams??{}}}function CD(n,t,e,r){if(e.length>0&&function G8(n,t,e){return e.some(r=>SD(n,t,r)&&ol(r)!==yi)}(n,e,r)){const d=new Ci(t,function W8(n,t,e,r){const l={};l[yi]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const d of e)if(""===d.path&&ol(d)!==yi){const h=new Ci([],{});h._sourceSegment=n,h._segmentIndexShift=t.length,l[ol(d)]=h}return l}(n,t,r,new Ci(e,n.children)));return d._sourceSegment=n,d._segmentIndexShift=t.length,{segmentGroup:d,slicedSegments:[]}}if(0===e.length&&function $8(n,t,e){return e.some(r=>SD(n,t,r))}(n,e,r)){const d=new Ci(n.segments,function j8(n,t,e,r,l){const d={};for(const h of r)if(SD(n,e,h)&&!l[ol(h)]){const _=new Ci([],{});_._sourceSegment=n,_._segmentIndexShift=t.length,d[ol(h)]=_}return{...l,...d}}(n,t,e,r,n.children));return d._sourceSegment=n,d._segmentIndexShift=t.length,{segmentGroup:d,slicedSegments:e}}const l=new Ci(n.segments,n.children);return l._sourceSegment=n,l._segmentIndexShift=t.length,{segmentGroup:l,slicedSegments:e}}function SD(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function MN(n,t,e,r){return!!(ol(n)===r||r!==yi&&SD(t,e,n))&&("**"===n.path||PI(t,n,e).matched)}function TN(n,t,e){return 0===t.length&&!n.children[e]}const DD=!1;class ED{constructor(t){this.segmentGroup=t||null}}class IN{constructor(t){this.urlTree=t}}function H0(n){return Yg(new ED(n))}function AN(n){return Yg(new IN(n))}class X8{constructor(t,e,r,l,d){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=l,this.config=d,this.allowRedirects=!0}apply(){const t=CD(this.urlTree.root,[],[],this.config).segmentGroup,e=new Ci(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,yi).pipe(Pt(d=>this.createUrlTree(_D(d),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Rd(d=>{if(d instanceof IN)return this.allowRedirects=!1,this.match(d.urlTree);throw d instanceof ED?this.noMatchError(d):d}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,yi).pipe(Pt(l=>this.createUrlTree(_D(l),t.queryParams,t.fragment))).pipe(Rd(l=>{throw l instanceof ED?this.noMatchError(l):l}))}noMatchError(t){return new ot(4002,DD)}createUrlTree(t,e,r){const l=bI(t);return new vf(l,e,r)}expandSegmentGroup(t,e,r,l){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(Pt(d=>new Ci([],d))):this.expandSegment(t,r,e,r.segments,l,!0)}expandChildren(t,e,r){const l=[];for(const d of Object.keys(r.children))"primary"===d?l.unshift(d):l.push(d);return tr(l).pipe(vh(d=>{const h=r.children[d],_=SN(e,d);return this.expandSegmentGroup(t,_,h,d).pipe(Pt(x=>({segment:x,outlet:d})))}),GO((d,h)=>(d[h.outlet]=h.segment,d),{}),$O())}expandSegment(t,e,r,l,d,h){return tr(r).pipe(vh(_=>this.expandSegmentAgainstRoute(t,e,r,_,l,d,h).pipe(Rd(D=>{if(D instanceof ED)return hn(null);throw D}))),_h(_=>!!_),Rd((_,x)=>{if(OI(_))return TN(e,l,d)?hn(new Ci([],{})):H0(e);throw _}))}expandSegmentAgainstRoute(t,e,r,l,d,h,_){return MN(l,e,d,h)?void 0===l.redirectTo?this.matchSegmentAgainstRoute(t,e,l,d,h):_&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,l,d,h):H0(e):H0(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,l,d,h){return"**"===l.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,l,h):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,l,d,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,l){const d=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?AN(d):this.lineralizeSegments(r,d).pipe(Mi(h=>{const _=new Ci(h,{});return this.expandSegment(t,_,e,h,l,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,l,d,h){const{matched:_,consumedSegments:x,remainingSegments:D,positionalParamSegments:I}=PI(e,l,d);if(!_)return H0(e);const V=this.applyRedirectCommands(x,l.redirectTo,I);return l.redirectTo.startsWith("/")?AN(V):this.lineralizeSegments(l,V).pipe(Mi(ne=>this.expandSegment(t,e,r,ne.concat(D),h,!1)))}matchSegmentAgainstRoute(t,e,r,l,d){return"**"===r.path?(t=CN(r,t),r.loadChildren?(r._loadedRoutes?hn({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(Pt(_=>(r._loadedRoutes=_.routes,r._loadedInjector=_.injector,new Ci(l,{})))):hn(new Ci(l,{}))):kN(e,r,l,t).pipe(cs(({matched:h,consumedSegments:_,remainingSegments:x})=>h?this.getChildConfig(t=r._injector??t,r,l).pipe(Mi(I=>{const V=I.injector??t,ne=I.routes,{segmentGroup:he,slicedSegments:Ce}=CD(e,_,x,ne),Ae=new Ci(he.segments,he.children);if(0===Ce.length&&Ae.hasChildren())return this.expandChildren(V,ne,Ae).pipe(Pt(st=>new Ci(_,st)));if(0===ne.length&&0===Ce.length)return hn(new Ci(_,{}));const He=ol(r)===d;return this.expandSegment(V,Ae,ne,Ce,He?yi:d,!0).pipe(Pt(Tt=>new Ci(_.concat(Tt.segments),Tt.children)))})):H0(e)))}getChildConfig(t,e,r){return e.children?hn({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?hn({routes:e._loadedRoutes,injector:e._loadedInjector}):function U8(n,t,e,r){const l=t.canLoad;return void 0===l||0===l.length?hn(!0):hn(l.map(h=>{const _=e_(h,n);return bh(function k8(n){return n&&U0(n.canLoad)}(_)?_.canLoad(t,e):n.runInContext(()=>_(t,e)))})).pipe(t_(),EN())}(t,e,r).pipe(Mi(l=>l?this.configLoader.loadChildren(t,e).pipe(io(d=>{e._loadedRoutes=d.routes,e._loadedInjector=d.injector})):function Y8(n){return Yg(yN(DD,3))}())):hn({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],l=e.root;for(;;){if(r=r.concat(l.segments),0===l.numberOfChildren)return hn(r);if(l.numberOfChildren>1||!l.children[yi])return Yg(new ot(4e3,DD));l=l.children[yi]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,l){const d=this.createSegmentGroup(t,e.root,r,l);return new vf(d,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return sa(t,(l,d)=>{if("string"==typeof l&&l.startsWith(":")){const _=l.substring(1);r[d]=e[_]}else r[d]=l}),r}createSegmentGroup(t,e,r,l){const d=this.createSegments(t,e.segments,r,l);let h={};return sa(e.children,(_,x)=>{h[x]=this.createSegmentGroup(t,_,r,l)}),new Ci(d,h)}createSegments(t,e,r,l){return e.map(d=>d.path.startsWith(":")?this.findPosParam(t,d,l):this.findOrReturn(d,r))}findPosParam(t,e,r){const l=r[e.path.substring(1)];if(!l)throw new ot(4001,DD);return l}findOrReturn(t,e){let r=0;for(const l of e){if(l.path===t.path)return e.splice(r),l;r++}return t}}class Q8{}class t6{constructor(t,e,r,l,d,h,_){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=l,this.url=d,this.paramsInheritanceStrategy=h,this.urlSerializer=_}recognize(){const t=CD(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,yi).pipe(Pt(e=>{if(null===e)return null;const r=new bD([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},yi,this.rootComponentType,null,this.urlTree.root,-1,{}),l=new Od(r,e),d=new _N(this.url,l);return this.inheritParamsAndData(d._root),d}))}inheritParamsAndData(t){const e=t.value,r=gN(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(l=>this.inheritParamsAndData(l))}processSegmentGroup(t,e,r,l){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,l)}processChildren(t,e,r){return tr(Object.keys(r.children)).pipe(vh(l=>{const d=r.children[l],h=SN(e,l);return this.processSegmentGroup(t,h,d,l)}),GO((l,d)=>l&&d?(l.push(...d),l):null),function y5(n,t=!1){return en((e,r)=>{let l=0;e.subscribe(pn(r,d=>{const h=n(d,l++);(h||t)&&r.next(d),!h&&r.complete()}))})}(l=>null!==l),cD(null),$O(),Pt(l=>{if(null===l)return null;const d=FN(l);return function n6(n){n.sort((t,e)=>t.value.outlet===yi?-1:e.value.outlet===yi?1:t.value.outlet.localeCompare(e.value.outlet))}(d),d}))}processSegment(t,e,r,l,d){return tr(e).pipe(vh(h=>this.processSegmentAgainstRoute(h._injector??t,h,r,l,d)),_h(h=>!!h),Rd(h=>{if(OI(h))return TN(r,l,d)?hn([]):hn(null);throw h}))}processSegmentAgainstRoute(t,e,r,l,d){if(e.redirectTo||!MN(e,r,l,d))return hn(null);let h;if("**"===e.path){const _=l.length>0?XO(l).parameters:{},x=NN(r)+l.length;h=hn({snapshot:new bD(l,_,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,PN(e),ol(e),e.component??e._loadedComponent??null,e,ON(r),x,LN(e)),consumedSegments:[],remainingSegments:[]})}else h=kN(r,e,l,t).pipe(Pt(({matched:_,consumedSegments:x,remainingSegments:D,parameters:I})=>{if(!_)return null;const V=NN(r)+x.length;return{snapshot:new bD(x,I,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,PN(e),ol(e),e.component??e._loadedComponent??null,e,ON(r),V,LN(e)),consumedSegments:x,remainingSegments:D}}));return h.pipe(cs(_=>{if(null===_)return hn(null);const{snapshot:x,consumedSegments:D,remainingSegments:I}=_;t=e._injector??t;const V=e._loadedInjector??t,ne=function r6(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:he,slicedSegments:Ce}=CD(r,D,I,ne.filter(He=>void 0===He.redirectTo));if(0===Ce.length&&he.hasChildren())return this.processChildren(V,ne,he).pipe(Pt(He=>null===He?null:[new Od(x,He)]));if(0===ne.length&&0===Ce.length)return hn([new Od(x,[])]);const Ae=ol(e)===d;return this.processSegment(V,ne,he,Ce,Ae?yi:d).pipe(Pt(He=>null===He?null:[new Od(x,He)]))}))}}function o6(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function FN(n){const t=[],e=new Set;for(const r of n){if(!o6(r)){t.push(r);continue}const l=t.find(d=>r.value.routeConfig===d.value.routeConfig);void 0!==l?(l.children.push(...r.children),e.add(l)):t.push(r)}for(const r of e){const l=FN(r.children);t.push(new Od(r.value,l))}return t.filter(r=>!e.has(r))}function ON(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function NN(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function PN(n){return n.data||{}}function LN(n){return n.resolve||{}}function l6(n,t){return Mi(e=>{const{targetSnapshot:r,guards:{canActivateChecks:l}}=e;if(!l.length)return hn(e);let d=0;return tr(l).pipe(vh(h=>function c6(n,t,e,r){const l=n.routeConfig,d=n._resolve;return void 0!==l?.title&&!BN(l)&&(d[T0]=l.title),function d6(n,t,e,r){const l=function u6(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===l.length)return hn({});const d={};return tr(l).pipe(Mi(h=>function h6(n,t,e,r){const l=B0(t)??r,d=e_(n,l);return bh(d.resolve?d.resolve(t,e):l.runInContext(()=>d(t,e)))}(n[h],t,e,r).pipe(_h(),io(_=>{d[h]=_}))),gI(1),function qO(n){return Pt(()=>n)}(d),Rd(h=>OI(h)?Oo:Yg(h)))}(d,n,t,r).pipe(Pt(h=>(n._resolvedData=h,n.data=gN(n,e).resolve,l&&BN(l)&&(n.data[T0]=l.title),null)))}(h.route,r,n,t)),io(()=>d++),gI(1),Mi(h=>d===l.length?hn(e):Oo))})}function BN(n){return"string"==typeof n.title||null===n.title}function LI(n){return cs(t=>{const e=n(t);return e?tr(e).pipe(Pt(()=>t)):hn(t)})}const n_=new Ye("ROUTES");let BI=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return hn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=bh(e.loadComponent()).pipe(Pt(VN),io(d=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=d}),dD(()=>{this.componentLoaders.delete(e)})),l=new mI(r,()=>new Le).pipe(fI());return this.componentLoaders.set(e,l),l}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return hn({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const d=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(Pt(_=>{this.onLoadEndListener&&this.onLoadEndListener(r);let x,D,I=!1;Array.isArray(_)?D=_:(x=_.create(e).injector,D=KO(x.get(n_,[],kn.Self|kn.Optional)));return{routes:D.map(FI),injector:x}}),dD(()=>{this.childrenLoaders.delete(r)})),h=new mI(d,()=>new Le).pipe(fI());return this.childrenLoaders.set(r,h),h}loadModuleFactoryOrRoutes(e){return bh(e()).pipe(Pt(VN),Mi(l=>l instanceof BC||Array.isArray(l)?hn(l):tr(this.compiler.compileModuleAsync(l))))}}return n.\u0275fac=function(e){return new(e||n)(ee(nn),ee(SS))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function VN(n){return function f6(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let zI=(()=>{class n{constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Le,this.configLoader=Ft(BI),this.environmentInjector=Ft(js),this.urlSerializer=Ft(A0),this.rootContexts=Ft(L0),this.navigationId=0,this.configLoader.onLoadEndListener=l=>this.events.next(new e8(l)),this.configLoader.onLoadStartListener=l=>this.events.next(new J5(l))}get hasRequestedNavigation(){return 0!==this.navigationId}complete(){this.transitions?.complete()}handleNavigationRequest(e){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:r})}setupNavigations(e){return this.transitions=new ls({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Eo(r=>0!==r.id),Pt(r=>({...r,extractedUrl:e.urlHandlingStrategy.extract(r.rawUrl)})),cs(r=>{let l=!1,d=!1;return hn(r).pipe(io(h=>{this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),cs(h=>{const _=e.browserUrlTree.toString(),x=!e.navigated||h.extractedUrl.toString()!==_||_!==e.currentUrlTree.toString();if(("reload"===e.onSameUrlNavigation||x)&&e.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return HN(h.source)&&(e.browserUrlTree=h.extractedUrl),hn(h).pipe(cs(I=>{const V=this.transitions?.getValue();return this.events.next(new CI(I.id,this.urlSerializer.serialize(I.extractedUrl),I.source,I.restoredState)),V!==this.transitions?.getValue()?Oo:Promise.resolve(I)}),function Z8(n,t,e,r){return cs(l=>function K8(n,t,e,r,l){return new X8(n,t,e,r,l).apply()}(n,t,e,l.extractedUrl,r).pipe(Pt(d=>({...l,urlAfterRedirects:d}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),io(I=>{this.currentNavigation={...this.currentNavigation,finalUrl:I.urlAfterRedirects},r.urlAfterRedirects=I.urlAfterRedirects}),function s6(n,t,e,r,l){return Mi(d=>function e6(n,t,e,r,l,d,h="emptyOnly"){return new t6(n,t,e,r,l,h,d).recognize().pipe(cs(_=>null===_?function J8(n){return new pt(t=>t.error(n))}(new Q8):hn(_)))}(n,t,e,d.urlAfterRedirects,r.serialize(d.urlAfterRedirects),r,l).pipe(Pt(h=>({...d,targetSnapshot:h}))))}(this.environmentInjector,e.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),io(I=>{if(r.targetSnapshot=I.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!I.extras.skipLocationChange){const ne=e.urlHandlingStrategy.merge(I.urlAfterRedirects,I.rawUrl);e.setBrowserUrl(ne,I)}e.browserUrlTree=I.urlAfterRedirects}const V=new Y5(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(V)}));if(x&&e.rawUrlTree&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:V,extractedUrl:ne,source:he,restoredState:Ce,extras:Ae}=h,He=new CI(V,this.urlSerializer.serialize(ne),he,Ce);this.events.next(He);const rt=mN(ne,e.rootComponentType).snapshot;return hn(r={...h,targetSnapshot:rt,urlAfterRedirects:ne,extras:{...Ae,skipLocationChange:!1,replaceUrl:!1}})}return e.rawUrlTree=h.rawUrl,h.resolve(null),Oo}),io(h=>{const _=new K5(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(_)}),Pt(h=>r={...h,guards:w8(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),function F8(n,t){return Mi(e=>{const{targetSnapshot:r,currentSnapshot:l,guards:{canActivateChecks:d,canDeactivateChecks:h}}=e;return 0===h.length&&0===d.length?hn({...e,guardsResult:!0}):function O8(n,t,e,r){return tr(n).pipe(Mi(l=>function V8(n,t,e,r,l){const d=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return d&&0!==d.length?hn(d.map(_=>{const x=B0(t)??l,D=e_(_,x);return bh(function I8(n){return n&&U0(n.canDeactivate)}(D)?D.canDeactivate(n,t,e,r):x.runInContext(()=>D(n,t,e,r))).pipe(_h())})).pipe(t_()):hn(!0)}(l.component,l.route,e,t,r)),_h(l=>!0!==l,!0))}(h,r,l,n).pipe(Mi(_=>_&&function E8(n){return"boolean"==typeof n}(_)?function N8(n,t,e,r){return tr(t).pipe(vh(l=>k0(function L8(n,t){return null!==n&&t&&t(new t8(n)),hn(!0)}(l.route.parent,r),function P8(n,t){return null!==n&&t&&t(new r8(n)),hn(!0)}(l.route,r),function z8(n,t,e){const r=t[t.length-1],d=t.slice(0,t.length-1).reverse().map(h=>function C8(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(h)).filter(h=>null!==h).map(h=>M0(()=>hn(h.guards.map(x=>{const D=B0(h.node)??e,I=e_(x,D);return bh(function T8(n){return n&&U0(n.canActivateChild)}(I)?I.canActivateChild(r,n):D.runInContext(()=>I(r,n))).pipe(_h())})).pipe(t_())));return hn(d).pipe(t_())}(n,l.path,e),function B8(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return hn(!0);const l=r.map(d=>M0(()=>{const h=B0(t)??e,_=e_(d,h);return bh(function M8(n){return n&&U0(n.canActivate)}(_)?_.canActivate(t,n):h.runInContext(()=>_(t,n))).pipe(_h())}));return hn(l).pipe(t_())}(n,l.route,e))),_h(l=>!0!==l,!0))}(r,d,n,t):hn(_)),Pt(_=>({...e,guardsResult:_})))})}(this.environmentInjector,h=>this.events.next(h)),io(h=>{if(r.guardsResult=h.guardsResult,yf(h.guardsResult))throw bN(0,h.guardsResult);const _=new X5(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.events.next(_)}),Eo(h=>!!h.guardsResult||(e.restoreHistory(h),this.cancelNavigationTransition(h,"",3,e),!1)),LI(h=>{if(h.guards.canActivateChecks.length)return hn(h).pipe(io(_=>{const x=new Z5(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot);this.events.next(x)}),cs(_=>{let x=!1;return hn(_).pipe(l6(e.paramsInheritanceStrategy,this.environmentInjector),io({next:()=>x=!0,complete:()=>{x||(e.restoreHistory(_),this.cancelNavigationTransition(_,"",2,e))}}))}),io(_=>{const x=new Q5(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot);this.events.next(x)}))}),LI(h=>{const _=x=>{const D=[];x.routeConfig?.loadComponent&&!x.routeConfig._loadedComponent&&D.push(this.configLoader.loadComponent(x.routeConfig).pipe(io(I=>{x.component=I}),Pt(()=>{})));for(const I of x.children)D.push(..._(I));return D};return pI(_(h.targetSnapshot.root)).pipe(cD(),Kr(1))}),LI(()=>e.afterPreactivation()),Pt(h=>{const _=function u8(n,t,e){const r=P0(n,t._root,e?e._root:void 0);return new fN(r,t)}(e.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return r={...h,targetRouterState:_}}),io(h=>{e.currentUrlTree=h.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),e.routerState=h.targetRouterState,"deferred"===e.urlUpdateStrategy&&(h.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,h),e.browserUrlTree=h.urlAfterRedirects)}),((n,t,e)=>Pt(r=>(new x8(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,e.routeReuseStrategy,h=>this.events.next(h)),io({next:h=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new xf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)},complete:()=>{l=!0}}),dD(()=>{l||d||this.cancelNavigationTransition(r,"",1,e),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),Rd(h=>{if(d=!0,wN(h)){xN(h)||(e.navigated=!0,e.restoreHistory(r,!0));const _=new vD(r.id,this.urlSerializer.serialize(r.extractedUrl),h.message,h.cancellationCode);if(this.events.next(_),xN(h)){const x=e.urlHandlingStrategy.merge(h.url,e.rawUrlTree),D={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||HN(r.source)};e.scheduleNavigation(x,"imperative",null,D,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{e.restoreHistory(r,!0);const _=new uN(r.id,this.urlSerializer.serialize(r.extractedUrl),h,r.targetSnapshot??void 0);this.events.next(_);try{r.resolve(e.errorHandler(h))}catch(x){r.reject(x)}}return Oo}))}))}cancelNavigationTransition(e,r,l,d){const h=new vD(e.id,this.urlSerializer.serialize(e.extractedUrl),r,l);this.events.next(h),e.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function HN(n){return"imperative"!==n}let jN=(()=>{class n{buildTitle(e){let r,l=e.root;for(;void 0!==l;)r=this.getResolvedTitleForRoute(l)??r,l=l.children.find(d=>d.outlet===yi);return r}getResolvedTitleForRoute(e){return e.data[T0]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(){return Ft(m6)},providedIn:"root"}),n})(),m6=(()=>{class n extends jN{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(ee(LO))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),g6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(){return Ft(v6)},providedIn:"root"}),n})();class _6{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let v6=(()=>{class n extends _6{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Fn(n)))(r||n)}}(),n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kD=new Ye("",{providedIn:"root",factory:()=>({})});let y6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:function(){return Ft(x6)},providedIn:"root"}),n})(),x6=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function w6(n){throw n}function C6(n,t,e){return t.parse("/")}const S6={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},D6={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ds=(()=>{class n{constructor(){this.disposed=!1,this.currentPageId=0,this.console=Ft(DT),this.isNgZoneEnabled=!1,this.options=Ft(kD,{optional:!0})||{},this.errorHandler=this.options.errorHandler||w6,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||C6,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>hn(void 0),this.urlHandlingStrategy=Ft(y6),this.routeReuseStrategy=Ft(g6),this.urlCreationStrategy=Ft(l8),this.titleStrategy=Ft(jN),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=KO(Ft(n_,{optional:!0})??[]),this.navigationTransitions=Ft(zI),this.urlSerializer=Ft(A0),this.location=Ft(oa),this.rootComponentType=null,this.isNgZoneEnabled=Ft(ln)instanceof ln&&ln.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new vf,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=mN(this.currentUrlTree,this.rootComponentType),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const l={replaceUrl:!0},d=e.state?.navigationId?e.state:null;if(e.state){const _={...e.state};delete _.navigationId,delete _.\u0275routerPageId,0!==Object.keys(_).length&&(l.state=_)}const h=this.parseUrl(e.url);this.scheduleNavigation(h,r,d,l)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(FI),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:l,queryParams:d,fragment:h,queryParamsHandling:_,preserveFragment:x}=r,D=x?this.currentUrlTree.fragment:h;let I=null;switch(_){case"merge":I={...this.currentUrlTree.queryParams,...d};break;case"preserve":I=this.currentUrlTree.queryParams;break;default:I=d||null}return null!==I&&(I=this.removeEmptyProps(I)),this.urlCreationStrategy.createUrlTree(l,this.routerState,this.currentUrlTree,e,I,D??null)}navigateByUrl(e,r={skipLocationChange:!1}){const l=yf(e)?e:this.parseUrl(e),d=this.urlHandlingStrategy.merge(l,this.rawUrlTree);return this.scheduleNavigation(d,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function E6(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new ot(4008,!1)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(l){r=this.malformedUriErrorHandler(l,this.urlSerializer,e)}return r}isActive(e,r){let l;if(l=!0===r?{...S6}:!1===r?{...D6}:r,yf(e))return QO(this.currentUrlTree,e,l);const d=this.parseUrl(e);return QO(this.currentUrlTree,d,l)}removeEmptyProps(e){return Object.keys(e).reduce((r,l)=>{const d=e[l];return null!=d&&(r[l]=d),r},{})}scheduleNavigation(e,r,l,d,h){if(this.disposed)return Promise.resolve(!1);let _,x,D,I;return h?(_=h.resolve,x=h.reject,D=h.promise):D=new Promise((V,ne)=>{_=V,x=ne}),"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(l=this.location.getState()),I=l&&l.\u0275routerPageId?l.\u0275routerPageId:d.replaceUrl||d.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):I=0,this.navigationTransitions.handleNavigationRequest({targetPageId:I,source:r,restoredState:l,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:d,resolve:_,reject:x,promise:D,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),D.catch(V=>Promise.reject(V))}setBrowserUrl(e,r){const l=this.urlSerializer.serialize(e),d={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(l)||r.extras.replaceUrl?this.location.replaceState(l,"",d):this.location.go(l,"",d)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===l?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===l&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(l)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),MD=(()=>{class n{constructor(e,r,l,d,h,_){this.router=e,this.route=r,this.tabIndexAttribute=l,this.renderer=d,this.el=h,this.locationStrategy=_,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Le;const x=h.nativeElement.tagName;this.isAnchorElement="A"===x||"AREA"===x,this.isAnchorElement?this.subscription=e.events.subscribe(D=>{D instanceof xf&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=ue(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=ue(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=ue(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,r,l,d,h){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||r||l||d||h||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function Jm(n,t,e){return function Kk(n,t){return"src"===t&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===t&&("base"===n||"link"===n)?zw:Qm}(t,e)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,r){const l=this.renderer,d=this.el.nativeElement;null!==r?l.setAttribute(d,e,r):l.removeAttribute(d,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(re(Ds),re(Jg),va("tabindex"),re(wl),re(Ut),re(Gn))},n.\u0275dir=Ze({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,r){1&e&&bn("click",function(d){return r.onClick(d.button,d.ctrlKey,d.shiftKey,d.altKey,d.metaKey)}),2&e&&On("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Ki]}),n})(),GN=(()=>{class n{constructor(e,r,l,d,h){this.router=e,this.element=r,this.renderer=l,this.cdr=d,this.link=h,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new En,this.routerEventsSubscription=e.events.subscribe(_=>{_ instanceof xf&&this.update()})}ngAfterContentInit(){hn(this.links.changes,hn(null)).pipe(Vr()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=tr(e).pipe(Vr()).subscribe(r=>{this.isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){const r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(l=>!!l)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.isActive!==e&&(this.isActive=e,this.cdr.markForCheck(),this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(e))})}isLinkActive(e){const r=function k6(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return l=>!!l.urlTree&&e.isActive(l.urlTree,r)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}}return n.\u0275fac=function(e){return new(e||n)(re(Ds),re(Ut),re(wl),re(ir),re(MD,8))},n.\u0275dir=Ze({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(e,r,l){if(1&e&&vi(l,MD,5),2&e){let d;Ot(d=Kt())&&(r.links=d)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Ki]}),n})();class $N{}let M6=(()=>{class n{constructor(e,r,l,d,h){this.router=e,this.injector=l,this.preloadingStrategy=d,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(Eo(e=>e instanceof xf),vh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const l=[];for(const d of r){d.providers&&!d._injector&&(d._injector=Rg(d.providers,e,`Route: ${d.path}`));const h=d._injector??e,_=d._loadedInjector??h;d.loadChildren&&!d._loadedRoutes&&void 0===d.canLoad||d.loadComponent&&!d._loadedComponent?l.push(this.preloadConfig(h,d)):(d.children||d._loadedRoutes)&&l.push(this.processRoutes(_,d.children??d._loadedRoutes))}return tr(l).pipe(Vr())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let l;l=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):hn(null);const d=l.pipe(Mi(h=>null===h?hn(void 0):(r._loadedRoutes=h.routes,r._loadedInjector=h.injector,this.processRoutes(h.injector??e,h.routes))));return r.loadComponent&&!r._loadedComponent?tr([d,this.loader.loadComponent(r)]).pipe(Vr()):d})}}return n.\u0275fac=function(e){return new(e||n)(ee(Ds),ee(SS),ee(js),ee($N),ee(BI))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const VI=new Ye("");let qN=(()=>{class n{constructor(e,r,l,d,h={}){this.urlSerializer=e,this.transitions=r,this.viewportScroller=l,this.zone=d,this.options=h,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},h.scrollPositionRestoration=h.scrollPositionRestoration||"disabled",h.anchorScrolling=h.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof CI?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof xf&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof hN&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new hN(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(e){$s()},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();function r_(n,t){return{\u0275kind:n,\u0275providers:t}}function KN(){const n=Ft(nn);return t=>{const e=n.get(fh);if(t!==e.components[0])return;const r=n.get(Ds),l=n.get(XN);1===n.get(HI)&&r.initialNavigation(),n.get(ZN,null,kn.Optional)?.setUpPreloading(),n.get(VI,null,kn.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),l.closed||(l.next(),l.unsubscribe())}}const XN=new Ye("",{factory:()=>new Le}),HI=new Ye("",{providedIn:"root",factory:()=>1});const ZN=new Ye("");function F6(n){return r_(0,[{provide:ZN,useExisting:M6},{provide:$N,useExisting:n}])}const QN=new Ye("ROUTER_FORROOT_GUARD"),O6=[oa,{provide:A0,useClass:_I},Ds,L0,{provide:Jg,useFactory:function YN(n){return n.routerState.root},deps:[Ds]},BI,[]];function N6(){return new OS("Router",Ds)}let JN=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[O6,[],{provide:n_,multi:!0,useValue:e},{provide:QN,useFactory:z6,deps:[[Ds,new Vo,new Uo]]},{provide:kD,useValue:r||{}},r?.useHash?{provide:Gn,useClass:ra}:{provide:Gn,useClass:Hi},{provide:VI,useFactory:()=>{const n=Ft(tV),t=Ft(ln),e=Ft(kD),r=Ft(zI),l=Ft(A0);return e.scrollOffset&&n.setOffset(e.scrollOffset),new qN(l,r,n,t,e)}},r?.preloadingStrategy?F6(r.preloadingStrategy).\u0275providers:[],{provide:OS,multi:!0,useFactory:N6},r?.initialNavigation?V6(r):[],[{provide:eP,useFactory:KN},{provide:wS,multi:!0,useExisting:eP}]]}}static forChild(e){return{ngModule:n,providers:[{provide:n_,multi:!0,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)(ee(QN,8))},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[AI]}),n})();function z6(n){return"guarded"}function V6(n){return["disabled"===n.initialNavigation?r_(3,[{provide:lf,multi:!0,useFactory:()=>{const t=Ft(Ds);return()=>{t.setUpLocationChangeListener()}}},{provide:HI,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?r_(2,[{provide:HI,useValue:0},{provide:lf,multi:!0,deps:[nn],useFactory:t=>{const e=t.get(si,Promise.resolve());return()=>e.then(()=>new Promise(l=>{const d=t.get(Ds),h=t.get(XN);(function r(l){t.get(Ds).events.pipe(Eo(h=>h instanceof xf||h instanceof vD||h instanceof uN),Pt(h=>h instanceof xf||h instanceof vD&&(0===h.code||1===h.code)&&null),Eo(h=>null!==h),Kr(1)).subscribe(()=>{l()})})(()=>{l(!0)}),d.afterPreactivation=()=>(l(!0),h.closed?hn(void 0):h),d.initialNavigation()}))}}]).\u0275providers:[]]}const eP=new Ye("");function tP(n,t,e,r,l,d,h){try{var _=n[d](h),x=_.value}catch(D){return void e(D)}_.done?t(x):Promise.resolve(x).then(r,l)}function Ni(n){return function(){var t=this,e=arguments;return new Promise(function(r,l){var d=n.apply(t,e);function h(x){tP(d,r,l,h,_,"next",x)}function _(x){tP(d,r,l,h,_,"throw",x)}h(void 0)})}}var Pi=Re(796),jI=Re(650);function Mr(n=[],t=[]){const e=Math.min(n.length,t.length);let r=0,l=0,d=0,h=0;for(;h<e;){const x=n[h],D=t[h];r+=x*D,l+=x*x,d+=D*D,h+=1}const _=Math.sqrt(l*d);return 0===_?0:r/_}class TD{constructor(){}loadByDataUrl(t){var e=this;return Ni(function*(){const r=yield new Promise((h,_)=>{const x=new Image;x.src=t,x.onload=()=>{h(x)}}),l=document.createElement("canvas"),d=l.getContext("2d");l.width=r.width,l.height=r.height,d.drawImage(r,0,0),e.canvas=l,e.context=d})()}trimMargin(t,e=10){var r=this;return Ni(function*(){if(void 0===r.canvas)throw new Error("Image is not loaded");const d=Math.floor(.2*r.canvas.width),_=(yield r.getVerticalEdgePositionOfColor(t,"top",e,0,d))??0,D=(yield r.getVerticalEdgePositionOfColor(t,"bottom",e,0,d))??r.canvas.height,I=r.canvas.height,V=D-_;return r.crop(0,_,r.canvas.width,V),{marginTop:_,marginBottom:D,heightNew:V,heightOld:I,width:r.canvas.width}})()}crop(t,e,r,l){var d=this;return Ni(function*(){if(!d.canvas||!d.context)return;const h=document.createElement("canvas"),_=h.getContext("2d");h.width=r,h.height=l,_.drawImage(d.canvas,t,e,h.width,h.height,0,0,h.width,h.height),d.replaceCanvas(h)})()}replaceColor(t,e,r){var l=this;return Ni(function*(){if(!l.canvas||!l.context)return;const d=l.context.getImageData(0,0,l.canvas.width,l.canvas.height),h=l.hexColorCodeToRgba(e);for(let _=0;_<d.width;_++)for(let x=0;x<d.height;x++){const D=4*(_+x*d.width),Ce=l.rgbToHexColorCode(d.data[D+0],d.data[D+1],d.data[D+2]);!l.isSimilarColor(t,Ce,r)||(d.data[D+0]=h.r,d.data[D+1]=h.g,d.data[D+2]=h.b,void 0!==h.a&&(d.data[D+3]=h.a))}l.context.putImageData(d,0,0)})()}getMarginColor(){var t=this;return Ni(function*(){if(!t.canvas||!t.context)return null;let e=null;const r=t.context.getImageData(0,0,t.canvas.width,t.canvas.height);let l=!1;for(let d=0;d<r.width&&!l;d++)for(let h=0;h<r.height;h++){const _=4*(d+h*r.width),ne=t.rgbToHexColorCode(r.data[_+0],r.data[_+1],r.data[_+2]);if(e!=ne){if(null!==e){l=!0;break}e=ne}}return e})()}getVerticalEdgePositionOfColor(t,e,r,l,d){var h=this;return Ni(function*(){if(!h.canvas||!h.context)return null;void 0===l&&(l=0),void 0===d&&(d=h.canvas.width);const _=h.context.getImageData(0,0,h.canvas.width,h.canvas.height);let D,x=!1;if("top"===e){D=0;for(let I=0;I<_.height;I++)for(let V=0;V<d&&!x;V++){const ne=4*(V+I*_.width),rt=h.rgbToHexColorCode(_.data[ne+0],_.data[ne+1],_.data[ne+2]);if(t!=rt&&!h.isSimilarColor(t,rt,r)){x=!0;break}D<I&&(D=I)}0!==D&&(D+=1)}else if("bottom"===e){D=h.canvas.height;for(let I=_.height-1;I>=0;I--)for(let V=0;V<_.width&&!x;V++){const ne=4*(V+I*_.width),rt=h.rgbToHexColorCode(_.data[ne+0],_.data[ne+1],_.data[ne+2]);if(t!=rt&&!h.isSimilarColor(t,rt,r)){x=!0;break}D>I&&(D=I)}D!==h.canvas.height&&(D-=1)}return D})()}getWidth(){var t=this;return Ni(function*(){return t.canvas?.width})()}getHeight(){var t=this;return Ni(function*(){return t.canvas?.height})()}resizeWithFit(t){var e=this;return Ni(function*(){if(!e.canvas)return;let r=0,l=0;if(t.width&&e.canvas.width>t.width)r=t.width?t.width:e.canvas.width,l=e.canvas.height*(r/e.canvas.width);else{if(!(t.height&&e.canvas.height>t.height))return;l=t.height?t.height:e.canvas.height,r=e.canvas.width*(l/e.canvas.height)}const d=document.createElement("canvas"),h=d.getContext("2d");d.width=r,d.height=l,h.drawImage(e.canvas,0,0,r,l),e.replaceCanvas(d)})()}replaceCanvas(t){if(!this.canvas||!this.context)return this.canvas=t,void(this.context=this.canvas.getContext("2d"));this.canvas.width=0,this.canvas.height=0,delete this.canvas,delete this.context,this.canvas=t,this.context=this.canvas.getContext("2d")}getDataUrl(t="image/jpeg",e){var r=this;return Ni(function*(){return r.canvas?"image/jpeg"===t||"image/webp"===t?r.canvas.toDataURL(t,e):r.canvas.toDataURL(t):null})()}hexColorCodeToRgba(t){const e=parseInt(t.substr(1,2),16),r=parseInt(t.substr(3,2),16),l=parseInt(t.substr(5,2),16);return 9===t.length?{r:e,g:r,b:l,a:parseInt(t.substr(7,2),16)}:{r:e,g:r,b:l}}rgbToHexColorCode(t,e,r){return"#"+this.valueToHex(t)+this.valueToHex(e)+this.valueToHex(r)}valueToHex(t){return("0"+t.toString(16)).slice(-2)}isSimilarColor(t,e,r){const l=this.hexColorCodeToRgba(t),d=this.hexColorCodeToRgba(e);return Math.abs(l.r-d.r)+Math.abs(l.g-d.g)+Math.abs(l.b-d.b)<r}}class ko{constructor(){this.poses=[],this.isFinalized=!1,this.IMAGE_WIDTH=1080,this.IMAGE_MIME="image/webp",this.IMAGE_QUALITY=.8,this.IMAGE_MARGIN_TRIMMING_COLOR="#000000",this.IMAGE_MARGIN_TRIMMING_DIFF_THRESHOLD=50,this.IMAGE_BACKGROUND_REPLACE_SRC_COLOR="#016AFD",this.IMAGE_BACKGROUND_REPLACE_DST_COLOR="#FFFFFF00",this.IMAGE_BACKGROUND_REPLACE_DIFF_THRESHOLD=130,this.videoMetadata={name:"",width:0,height:0,duration:0,firstPoseDetectedTime:0}}getVideoName(){return this.videoMetadata.name}setVideoName(t){this.videoMetadata.name=t}setVideoMetaData(t,e,r){this.videoMetadata.width=t,this.videoMetadata.height=e,this.videoMetadata.duration=r}getNumberOfPoses(){return void 0===this.poses?-1:this.poses.length}getPoses(){return void 0===this.poses?[]:this.poses}getPoseByTime(t){if(void 0!==this.poses)return this.poses.find(e=>e.timeMiliseconds===t)}pushPose(t,e,r,l,d){if(void 0===d.poseLandmarks)return;0===this.poses.length&&(this.videoMetadata.firstPoseDetectedTime=t);const h=d.ea?d.ea:[];if(0===h.length)return void console.warn(`[PoseSet] pushPose (${t}) - Could not get the pose with the world coordinate`,d);const _=ko.getBodyVector(h);if(!_)return void console.warn(`[PoseSet] pushPose (${t}) - Could not get the body vector`,h);void 0===d.leftHandLandmarks&&void 0===d.rightHandLandmarks?console.warn(`[PoseSet] pushPose (${t}) - Could not get the hand landmarks`,d):void 0===d.leftHandLandmarks?console.warn(`[PoseSet] pushPose (${t}) - Could not get the left hand landmarks`,d):void 0===d.rightHandLandmarks&&console.warn(`[PoseSet] pushPose (${t}) - Could not get the right hand landmarks`,d);const x=ko.getHandVectors(d.leftHandLandmarks,d.rightHandLandmarks);x||console.warn(`[PoseSet] pushPose (${t}) - Could not get the hand vector`,d);const D={timeMiliseconds:t,durationMiliseconds:-1,pose:h.map(I=>[I.x,I.y,I.z,I.visibility]),leftHand:d.leftHandLandmarks?.map(I=>[I.x,I.y,I.z]),rightHand:d.leftHandLandmarks?.map(I=>[I.x,I.y,I.z]),bodyVectors:_,handVectors:x,frameImageDataUrl:e,poseImageDataUrl:r,faceFrameImageDataUrl:l,extendedData:{}};if(1<=this.poses.length){const I=this.poses[this.poses.length-1],V=ko.isSimilarBodyPose(I.bodyVectors,D.bodyVectors);let ne=!0;if(I.handVectors&&D.handVectors?ne=ko.isSimilarHandPose(I.handVectors,D.handVectors):!I.handVectors&&D.handVectors&&(ne=!1),V&&ne)return;this.poses[this.poses.length-1].durationMiliseconds=t-I.timeMiliseconds}return this.poses.push(D),D}finalize(){var t=this;return Ni(function*(){if(0==t.poses.length)return void(t.isFinalized=!0);if(1<=t.poses.length){const r=t.poses[t.poses.length-1];-1==r.durationMiliseconds&&(t.poses[t.poses.length-1].durationMiliseconds=t.videoMetadata.duration-r.timeMiliseconds)}let e;t.removeDuplicatedPoses(),t.poses.shift(),console.log("[PoseSet] finalize - Detecting image margins...");for(const r of t.poses){let l=new TD;if(!r.frameImageDataUrl)continue;yield l.loadByDataUrl(r.frameImageDataUrl);const d=yield l.getMarginColor();if(console.log("[PoseSet] finalize - Detected margin color...",r.timeMiliseconds,d),null===d||d!==t.IMAGE_MARGIN_TRIMMING_COLOR)continue;const h=yield l.trimMargin(d,t.IMAGE_MARGIN_TRIMMING_DIFF_THRESHOLD);if(h){e=h,console.log("[PoseSet] finalize - Determined image trimming positions...",h);break}}for(const r of t.poses){let l=new TD;if(!r.frameImageDataUrl||!r.poseImageDataUrl)continue;console.log("[PoseSet] finalize - Processing image...",r.timeMiliseconds),yield l.loadByDataUrl(r.frameImageDataUrl),e&&(yield l.crop(0,e.marginTop,e.width,e.heightNew)),yield l.replaceColor(t.IMAGE_BACKGROUND_REPLACE_SRC_COLOR,t.IMAGE_BACKGROUND_REPLACE_DST_COLOR,t.IMAGE_BACKGROUND_REPLACE_DIFF_THRESHOLD),yield l.resizeWithFit({width:t.IMAGE_WIDTH});let d=yield l.getDataUrl(t.IMAGE_MIME,"image/jpeg"===t.IMAGE_MIME||"image/webp"===t.IMAGE_MIME?t.IMAGE_QUALITY:void 0);if(d)if(r.frameImageDataUrl=d,l=new TD,yield l.loadByDataUrl(r.poseImageDataUrl),e&&(yield l.crop(0,e.marginTop,e.width,e.heightNew)),yield l.resizeWithFit({width:t.IMAGE_WIDTH}),d=yield l.getDataUrl(t.IMAGE_MIME,"image/jpeg"===t.IMAGE_MIME||"image/webp"===t.IMAGE_MIME?t.IMAGE_QUALITY:void 0),d){if(r.poseImageDataUrl=d,r.faceFrameImageDataUrl){if(l=new TD,yield l.loadByDataUrl(r.faceFrameImageDataUrl),d=yield l.getDataUrl(t.IMAGE_MIME,"image/jpeg"===t.IMAGE_MIME||"image/webp"===t.IMAGE_MIME?t.IMAGE_QUALITY:void 0),!d){console.warn("[PoseSet] finalize - Could not get the new dataurl for face frame image");continue}r.faceFrameImageDataUrl=d}}else console.warn("[PoseSet] finalize - Could not get the new dataurl for pose preview image");else console.warn("[PoseSet] finalize - Could not get the new dataurl for frame image")}t.isFinalized=!0})()}removeDuplicatedPoses(){const t=[];for(const e of this.poses){let r=!1;for(const l of t){const d=ko.isSimilarBodyPose(e.bodyVectors,l.bodyVectors),h=!(!e.handVectors||!l.handVectors)&&ko.isSimilarHandPose(e.handVectors,l.handVectors);if(d&&h){r=!0;break}}r||t.push(e)}console.info(`[PoseSet] removeDuplicatedPoses - Reduced ${this.poses.length} poses -> ${t.length} poses`),this.poses=t}getSimilarPoses(t,e=.9){const r=ko.getBodyVector(t.ea);if(!r)throw"Could not get the body vector";const l=[];for(const d of this.poses){const h=ko.getBodyPoseSimilarity(d.bodyVectors,r);e<=h&&l.push({...d,similarity:h})}return l}static getBodyVector(t){return{rightWristToRightElbow:[t[Pi.POSE_LANDMARKS.RIGHT_WRIST].x-t[Pi.POSE_LANDMARKS.RIGHT_ELBOW].x,t[Pi.POSE_LANDMARKS.RIGHT_WRIST].y-t[Pi.POSE_LANDMARKS.RIGHT_ELBOW].y,t[Pi.POSE_LANDMARKS.RIGHT_WRIST].z-t[Pi.POSE_LANDMARKS.RIGHT_ELBOW].z],rightElbowToRightShoulder:[t[Pi.POSE_LANDMARKS.RIGHT_ELBOW].x-t[Pi.POSE_LANDMARKS.RIGHT_SHOULDER].x,t[Pi.POSE_LANDMARKS.RIGHT_ELBOW].y-t[Pi.POSE_LANDMARKS.RIGHT_SHOULDER].y,t[Pi.POSE_LANDMARKS.RIGHT_ELBOW].z-t[Pi.POSE_LANDMARKS.RIGHT_SHOULDER].z],leftWristToLeftElbow:[t[Pi.POSE_LANDMARKS.LEFT_WRIST].x-t[Pi.POSE_LANDMARKS.LEFT_ELBOW].x,t[Pi.POSE_LANDMARKS.LEFT_WRIST].y-t[Pi.POSE_LANDMARKS.LEFT_ELBOW].y,t[Pi.POSE_LANDMARKS.LEFT_WRIST].z-t[Pi.POSE_LANDMARKS.LEFT_ELBOW].z],leftElbowToLeftShoulder:[t[Pi.POSE_LANDMARKS.LEFT_ELBOW].x-t[Pi.POSE_LANDMARKS.LEFT_SHOULDER].x,t[Pi.POSE_LANDMARKS.LEFT_ELBOW].y-t[Pi.POSE_LANDMARKS.LEFT_SHOULDER].y,t[Pi.POSE_LANDMARKS.LEFT_ELBOW].z-t[Pi.POSE_LANDMARKS.LEFT_SHOULDER].z]}}static getHandVectors(t,e){if(void 0!==e&&0!==e.length||void 0!==t&&0!==t.length)return{rightThumbTipToFirstJoint:void 0===e||0===e.length?null:[e[4].x-e[3].x,e[4].y-e[3].y,e[4].z-e[3].z],rightThumbFirstJointToSecondJoint:void 0===e||0===e.length?null:[e[3].x-e[2].x,e[3].y-e[2].y,e[3].z-e[2].z],rightIndexFingerTipToFirstJoint:void 0===e||0===e.length?null:[e[8].x-e[7].x,e[8].y-e[7].y,e[8].z-e[7].z],rightIndexFingerFirstJointToSecondJoint:void 0===e||0===e.length?null:[e[7].x-e[6].x,e[7].y-e[6].y,e[7].z-e[6].z],rightMiddleFingerTipToFirstJoint:void 0===e||0===e.length?null:[e[12].x-e[11].x,e[12].y-e[11].y,e[12].z-e[11].z],rightMiddleFingerFirstJointToSecondJoint:void 0===e||0===e.length?null:[e[11].x-e[10].x,e[11].y-e[10].y,e[11].z-e[10].z],rightRingFingerTipToFirstJoint:void 0===e||0===e.length?null:[e[16].x-e[15].x,e[16].y-e[15].y,e[16].z-e[15].z],rightRingFingerFirstJointToSecondJoint:void 0===e||0===e.length?null:[e[15].x-e[14].x,e[15].y-e[14].y,e[15].z-e[14].z],rightPinkyFingerTipToFirstJoint:void 0===e||0===e.length?null:[e[20].x-e[19].x,e[20].y-e[19].y,e[20].z-e[19].z],rightPinkyFingerFirstJointToSecondJoint:void 0===e||0===e.length?null:[e[19].x-e[18].x,e[19].y-e[18].y,e[19].z-e[18].z],leftThumbTipToFirstJoint:void 0===t||0===t.length?null:[t[4].x-t[3].x,t[4].y-t[3].y,t[4].z-t[3].z],leftThumbFirstJointToSecondJoint:void 0===t||0===t.length?null:[t[3].x-t[2].x,t[3].y-t[2].y,t[3].z-t[2].z],leftIndexFingerTipToFirstJoint:void 0===t||0===t.length?null:[t[8].x-t[7].x,t[8].y-t[7].y,t[8].z-t[7].z],leftIndexFingerFirstJointToSecondJoint:void 0===t||0===t.length?null:[t[7].x-t[6].x,t[7].y-t[6].y,t[7].z-t[6].z],leftMiddleFingerTipToFirstJoint:void 0===t||0===t.length?null:[t[12].x-t[11].x,t[12].y-t[11].y,t[12].z-t[11].z],leftMiddleFingerFirstJointToSecondJoint:void 0===t||0===t.length?null:[t[11].x-t[10].x,t[11].y-t[10].y,t[11].z-t[10].z],leftRingFingerTipToFirstJoint:void 0===t||0===t.length?null:[t[16].x-t[15].x,t[16].y-t[15].y,t[16].z-t[15].z],leftRingFingerFirstJointToSecondJoint:void 0===t||0===t.length?null:[t[15].x-t[14].x,t[15].y-t[14].y,t[15].z-t[14].z],leftPinkyFingerTipToFirstJoint:void 0===t||0===t.length?null:[t[20].x-t[19].x,t[20].y-t[19].y,t[20].z-t[19].z],leftPinkyFingerFirstJointToSecondJoint:void 0===t||0===t.length?null:[t[19].x-t[18].x,t[19].y-t[18].y,t[19].z-t[18].z]}}static isSimilarBodyPose(t,e,r=.8){let l=!1;return ko.getBodyPoseSimilarity(t,e)>=r&&(l=!0),l}static getBodyPoseSimilarity(t,e){const r={leftWristToLeftElbow:Mr(t.leftWristToLeftElbow,e.leftWristToLeftElbow),leftElbowToLeftShoulder:Mr(t.leftElbowToLeftShoulder,e.leftElbowToLeftShoulder),rightWristToRightElbow:Mr(t.rightWristToRightElbow,e.rightWristToRightElbow),rightElbowToRightShoulder:Mr(t.rightElbowToRightShoulder,e.rightElbowToRightShoulder)};return Object.values(r).reduce((d,h)=>d+h,0)/Object.keys(r).length}static isSimilarHandPose(t,e,r=.75){const l=ko.getHandSimilarity(t,e);return-1===l||l>=r}static getHandSimilarity(t,e){const r=null===t.rightThumbFirstJointToSecondJoint||null===e.rightThumbFirstJointToSecondJoint?void 0:{rightThumbTipToFirstJoint:Mr(t.rightThumbTipToFirstJoint,e.rightThumbTipToFirstJoint),rightThumbFirstJointToSecondJoint:Mr(t.rightThumbFirstJointToSecondJoint,e.rightThumbFirstJointToSecondJoint),rightIndexFingerTipToFirstJoint:Mr(t.rightIndexFingerTipToFirstJoint,e.rightIndexFingerTipToFirstJoint),rightIndexFingerFirstJointToSecondJoint:Mr(t.rightIndexFingerFirstJointToSecondJoint,e.rightIndexFingerFirstJointToSecondJoint),rightMiddleFingerTipToFirstJoint:Mr(t.rightMiddleFingerTipToFirstJoint,e.rightMiddleFingerTipToFirstJoint),rightMiddleFingerFirstJointToSecondJoint:Mr(t.rightMiddleFingerFirstJointToSecondJoint,e.rightMiddleFingerFirstJointToSecondJoint),rightRingFingerTipToFirstJoint:Mr(t.rightRingFingerTipToFirstJoint,e.rightRingFingerFirstJointToSecondJoint),rightRingFingerFirstJointToSecondJoint:Mr(t.rightRingFingerFirstJointToSecondJoint,e.rightRingFingerFirstJointToSecondJoint),rightPinkyFingerTipToFirstJoint:Mr(t.rightPinkyFingerTipToFirstJoint,e.rightPinkyFingerTipToFirstJoint),rightPinkyFingerFirstJointToSecondJoint:Mr(t.rightPinkyFingerFirstJointToSecondJoint,e.rightPinkyFingerFirstJointToSecondJoint)},l=null===t.leftThumbFirstJointToSecondJoint||null===e.leftThumbFirstJointToSecondJoint?void 0:{leftThumbTipToFirstJoint:Mr(t.leftThumbTipToFirstJoint,e.leftThumbTipToFirstJoint),leftThumbFirstJointToSecondJoint:Mr(t.leftThumbFirstJointToSecondJoint,e.leftThumbFirstJointToSecondJoint),leftIndexFingerTipToFirstJoint:Mr(t.leftIndexFingerTipToFirstJoint,e.leftIndexFingerTipToFirstJoint),leftIndexFingerFirstJointToSecondJoint:Mr(t.leftIndexFingerFirstJointToSecondJoint,e.leftIndexFingerFirstJointToSecondJoint),leftMiddleFingerTipToFirstJoint:Mr(t.leftMiddleFingerTipToFirstJoint,e.leftMiddleFingerTipToFirstJoint),leftMiddleFingerFirstJointToSecondJoint:Mr(t.leftMiddleFingerFirstJointToSecondJoint,e.leftMiddleFingerFirstJointToSecondJoint),leftRingFingerTipToFirstJoint:Mr(t.leftRingFingerTipToFirstJoint,e.leftRingFingerTipToFirstJoint),leftRingFingerFirstJointToSecondJoint:Mr(t.leftRingFingerFirstJointToSecondJoint,e.leftRingFingerFirstJointToSecondJoint),leftPinkyFingerTipToFirstJoint:Mr(t.leftPinkyFingerTipToFirstJoint,e.leftPinkyFingerTipToFirstJoint),leftPinkyFingerFirstJointToSecondJoint:Mr(t.leftPinkyFingerFirstJointToSecondJoint,e.leftPinkyFingerFirstJointToSecondJoint)};let d=0;l&&(d=Object.values(l).reduce((_,x)=>_+x,0));let h=0;return r&&(h=Object.values(r).reduce((_,x)=>_+x,0)),r&&l?(h+d)/(Object.keys(r).length+Object.keys(l).length):h?h/Object.keys(r).length:l?d/Object.keys(l).length:-1}getZip(){var t=this;return Ni(function*(){const e=new jI;e.file("poses.json",yield t.getJson());const r=t.getFileExtensionByMime(t.IMAGE_MIME);for(const l of t.poses){if(l.frameImageDataUrl)try{const d=l.frameImageDataUrl.indexOf("base64,")+7,h=l.frameImageDataUrl.substring(d);e.file(`frame-${l.timeMiliseconds}.${r}`,h,{base64:!0})}catch(d){throw console.warn("[PoseExporterService] push - Could not push frame image",d),d}if(l.poseImageDataUrl)try{const d=l.poseImageDataUrl.indexOf("base64,")+7,h=l.poseImageDataUrl.substring(d);e.file(`pose-${l.timeMiliseconds}.${r}`,h,{base64:!0})}catch(d){throw console.warn("[PoseExporterService] push - Could not push frame image",d),d}if(l.faceFrameImageDataUrl)try{const d=l.faceFrameImageDataUrl.indexOf("base64,")+7,h=l.faceFrameImageDataUrl.substring(d);e.file(`face-${l.timeMiliseconds}.${r}`,h,{base64:!0})}catch(d){throw console.warn("[PoseExporterService] push - Could not push face frame image",d),d}}return yield e.generateAsync({type:"blob"})})()}getFileExtensionByMime(t){switch(t){case"image/png":default:return"png";case"image/jpeg":return"jpg";case"image/webp":return"webp"}}getJson(){var t=this;return Ni(function*(){if(void 0===t.videoMetadata||void 0===t.poses)return"{}";t.isFinalized||(yield t.finalize());let e=[];for(const l of Object.keys(Pi.POSE_LANDMARKS))e[Pi.POSE_LANDMARKS[l]]=l;const r={generator:"mp-video-pose-extractor",version:1,video:t.videoMetadata,poses:t.poses.map(l=>{const d=[];for(const _ of ko.BODY_VECTOR_MAPPINGS)d.push(l.bodyVectors[_]);let h;if(l.handVectors){h=[];for(const _ of ko.HAND_VECTOR_MAPPINGS)h.push(l.handVectors[_])}return{t:l.timeMiliseconds,d:l.durationMiliseconds,p:l.pose,l:l.leftHand,r:l.rightHand,v:d,h,e:l.extendedData}}),poseLandmarkMapppings:e};return JSON.stringify(r)})()}loadJson(t){const e="string"==typeof t?JSON.parse(t):t;if("mp-video-pose-extractor"!==e.generator)throw"\u4e0d\u6b63\u306a\u30d5\u30a1\u30a4\u30eb";if(1!==e.version)throw"\u672a\u5bfe\u5fdc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3";this.videoMetadata=e.video,this.poses=e.poses.map(r=>{const l={};ko.BODY_VECTOR_MAPPINGS.map((h,_)=>{l[h]=r.v[_]});const d={};return r.h&&ko.HAND_VECTOR_MAPPINGS.map((h,_)=>{d[h]=r.h[_]}),{timeMiliseconds:r.t,durationMiliseconds:r.d,pose:r.p,leftHand:r.l,rightHand:r.r,bodyVectors:l,handVectors:d,frameImageDataUrl:void 0,extendedData:r.e}})}loadZip(t,e=!0){var r=this;return Ni(function*(){console.log("[PoseSet] loadZip...",jI);const l=new jI;console.log("[PoseSet] init...");const d=yield l.loadAsync(t,{base64:!1});if(!d)throw"ZIP\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3081\u307e\u305b\u3093\u3067\u3057\u305f";const h=yield d.file("poses.json")?.async("text");if(void 0===h)throw"ZIP\u30d5\u30a1\u30a4\u30eb\u306b pose.json \u304c\u542b\u307e\u308c\u3066\u3044\u307e\u305b\u3093";r.loadJson(h);const _=r.getFileExtensionByMime(r.IMAGE_MIME);if(e)for(const x of r.poses){if(!x.frameImageDataUrl){const D=`frame-${x.timeMiliseconds}.${_}`,I=yield d.file(D)?.async("base64");I&&(x.frameImageDataUrl=`data:${r.IMAGE_MIME};base64,${I}`)}if(!x.poseImageDataUrl){const D=`pose-${x.timeMiliseconds}.${_}`,I=yield d.file(D)?.async("base64");I&&(x.poseImageDataUrl=`data:${r.IMAGE_MIME};base64,${I}`)}}})()}}ko.BODY_VECTOR_MAPPINGS=["rightWristToRightElbow","rightElbowToRightShoulder","leftWristToLeftElbow","leftElbowToLeftShoulder"],ko.HAND_VECTOR_MAPPINGS=["rightThumbTipToFirstJoint","rightThumbFirstJointToSecondJoint","rightIndexFingerTipToFirstJoint","rightIndexFingerFirstJointToSecondJoint","rightMiddleFingerTipToFirstJoint","rightMiddleFingerFirstJointToSecondJoint","rightRingFingerTipToFirstJoint","rightRingFingerFirstJointToSecondJoint","rightPinkyFingerTipToFirstJoint","rightPinkyFingerFirstJointToSecondJoint","leftThumbTipToFirstJoint","leftThumbFirstJointToSecondJoint","leftIndexFingerTipToFirstJoint","leftIndexFingerFirstJointToSecondJoint","leftMiddleFingerTipToFirstJoint","leftMiddleFingerFirstJointToSecondJoint","leftRingFingerTipToFirstJoint","leftRingFingerFirstJointToSecondJoint","leftPinkyFingerTipToFirstJoint","leftPinkyFingerFirstJointToSecondJoint","rightAnkleToRightKnee","rightKneeToRightHip","leftAnkleToLeftKnee","leftKneeToLeftHip","rightHipToLeftHip","rightShoulderToLeftShoulder"];class Nd{constructor(){}init(t){const e=new ko;return e.setVideoName(t),e}downloadAsJson(t){return Ni(function*(){const e=new Blob([yield t.getJson()],{type:"application/json"}),r=window.URL.createObjectURL(e),l=document.createElement("a");l.href=r,l.target="_blank",l.download=`${t.getVideoName()}-poses.json`,l.click()})()}downloadAsZip(t){return Ni(function*(){const e=yield t.getZip(),r=window.URL.createObjectURL(e),l=document.createElement("a");l.href=r,l.target="_blank",l.download=`${t.getVideoName()}-poses.zip`,l.click()})()}}Nd.\u0275fac=function(t){return new(t||Nd)},Nd.\u0275prov=St({token:Nd,factory:Nd.\u0275fac,providedIn:"root"});class W0{constructor(){}}W0.\u0275fac=function(t){return new(t||W0)},W0.\u0275prov=St({token:W0,factory:W0.\u0275fac,providedIn:"root"});class ID{}ID.\u0275fac=function(t){return new(t||ID)},ID.\u0275cmp=Mn({type:ID,selectors:[["lib-ngx-mp-pose-extractor"]],decls:2,vars:0,template:function(t,e){1&t&&(ct(0,"p"),gn(1," ngx-mp-pose-extractor works! "),dt())},encapsulation:2});class G0{}G0.\u0275fac=function(t){return new(t||G0)},G0.\u0275mod=Vt({type:G0}),G0.\u0275inj=$t({});var Pd=Re(534);class Ld{constructor(){this.onResultsEventEmitter=new En,this.init()}getPosePreviewMediaStream(){if(this.posePreviewCanvasElement)return this.posePreviewCanvasElement.captureStream()}getHandPreviewMediaStream(){if(this.handPreviewCanvasElement)return this.handPreviewCanvasElement.captureStream()}getFacePreviewMediaStream(){if(this.facePreviewCanvasElement)return this.facePreviewCanvasElement.captureStream()}onVideoFrame(t){var e=this;return Ni(function*(){!e.holistic||(t instanceof HTMLVideoElement?(e.posePreviewCanvasElement&&(e.posePreviewCanvasElement.width=t.videoWidth,e.posePreviewCanvasElement.height=t.videoHeight),e.handPreviewCanvasElement&&(e.handPreviewCanvasElement.width=t.videoWidth,e.handPreviewCanvasElement.height=t.videoHeight),e.facePreviewCanvasElement&&(e.facePreviewCanvasElement.width=t.videoWidth,e.facePreviewCanvasElement.height=t.videoHeight)):t instanceof HTMLCanvasElement&&(e.posePreviewCanvasElement&&(e.posePreviewCanvasElement.width=t.width,e.posePreviewCanvasElement.height=t.height),e.handPreviewCanvasElement&&(e.handPreviewCanvasElement.width=t.width,e.handPreviewCanvasElement.height=t.height),e.facePreviewCanvasElement&&(e.facePreviewCanvasElement.width=t.width,e.facePreviewCanvasElement.height=t.height)),yield e.holistic.send({image:t}))})()}init(){this.posePreviewCanvasElement=document.createElement("canvas"),this.posePreviewCanvasContext=this.posePreviewCanvasElement.getContext("2d")||void 0,this.handPreviewCanvasElement=document.createElement("canvas"),this.handPreviewCanvasContext=this.handPreviewCanvasElement.getContext("2d")||void 0,this.facePreviewCanvasElement=document.createElement("canvas"),this.facePreviewCanvasContext=this.facePreviewCanvasElement.getContext("2d")||void 0,this.holistic=new Pi.Holistic({locateFile:t=>`https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${t}`}),this.holistic.setOptions({selfieMode:!1,modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,smoothSegmentation:!0,minDetectionConfidence:.6,minTrackingConfidence:.6}),this.holistic.onResults(t=>{this.onResults(t)})}onResults(t){if(!this.posePreviewCanvasElement||!this.posePreviewCanvasContext||!this.holistic)return;let e=[];t.poseLandmarks&&(e=JSON.parse(JSON.stringify(t.poseLandmarks)),this.removeElements(e,[0,1,2,3,4,5,6,7,8,9,10,15,16,17,18,19,20,21,22])),this.posePreviewCanvasContext.save(),this.posePreviewCanvasContext.clearRect(0,0,this.posePreviewCanvasElement.width,this.posePreviewCanvasElement.height),this.posePreviewCanvasContext.drawImage(t.image,0,0,this.posePreviewCanvasElement.width,this.posePreviewCanvasElement.height);const r=this.posePreviewCanvasElement.toDataURL("image/png");if(this.posePreviewCanvasContext.lineWidth=5,e&&(t.rightHandLandmarks&&(this.posePreviewCanvasContext.strokeStyle="white",this.connect(this.posePreviewCanvasContext,[[e[Pi.POSE_LANDMARKS.RIGHT_ELBOW],t.rightHandLandmarks[0]]])),t.leftHandLandmarks&&(this.posePreviewCanvasContext.strokeStyle="white",this.connect(this.posePreviewCanvasContext,[[e[Pi.POSE_LANDMARKS.LEFT_ELBOW],t.leftHandLandmarks[0]]]))),e&&((0,Pd.drawConnectors)(this.posePreviewCanvasContext,e,Pi.POSE_CONNECTIONS,{color:"white"}),(0,Pd.drawLandmarks)(this.posePreviewCanvasContext,Object.values(Pi.POSE_LANDMARKS_LEFT).map(l=>e[l]),{visibilityMin:.65,color:"white",fillColor:"rgb(255,138,0)"}),(0,Pd.drawLandmarks)(this.posePreviewCanvasContext,Object.values(Pi.POSE_LANDMARKS_RIGHT).map(l=>e[l]),{visibilityMin:.65,color:"white",fillColor:"rgb(0,217,231)"})),(0,Pd.drawConnectors)(this.posePreviewCanvasContext,t.rightHandLandmarks,Pi.HAND_CONNECTIONS,{color:"white"}),(0,Pd.drawLandmarks)(this.posePreviewCanvasContext,t.rightHandLandmarks,{color:"white",fillColor:"rgb(0,217,231)",lineWidth:2,radius:l=>(0,Pd.lerp)(l.from.z,-.15,.1,10,1)}),(0,Pd.drawConnectors)(this.posePreviewCanvasContext,t.leftHandLandmarks,Pi.HAND_CONNECTIONS,{color:"white"}),(0,Pd.drawLandmarks)(this.posePreviewCanvasContext,t.leftHandLandmarks,{color:"white",fillColor:"rgb(255,138,0)",lineWidth:2,radius:l=>(0,Pd.lerp)(l.from.z,-.15,.1,10,1)}),this.handPreviewCanvasContext&&this.handPreviewCanvasElement){const d=this.handPreviewCanvasElement.height/2;if(this.handPreviewCanvasContext.clearRect(0,0,this.handPreviewCanvasElement.width,this.handPreviewCanvasElement.height),t.rightHandLandmarks){const h=this.getRectByLandmarks(t.rightHandLandmarks,t.image.width,t.image.height);this.handPreviewCanvasContext.drawImage(this.posePreviewCanvasElement,h[0]-10,h[1]-10,h[2]+10,h[3]+10,0,d-3*h[3]/2,3*h[2],3*h[3])}if(t.leftHandLandmarks){const h=this.getRectByLandmarks(t.leftHandLandmarks,t.image.width,t.image.height);this.handPreviewCanvasContext.drawImage(this.posePreviewCanvasElement,h[0]-10,h[1]-10,h[2]+10,h[3]+10,this.handPreviewCanvasElement.width-3*h[2],d-3*h[3]/2,3*h[2],3*h[3])}}if(this.facePreviewCanvasContext&&this.facePreviewCanvasElement)if(t.faceLandmarks){const h=this.getRectByLandmarks(t.faceLandmarks,t.image.width,t.image.height),_=1.25*h[2],x=1.25*h[3];this.facePreviewCanvasElement.width=_,this.facePreviewCanvasElement.height=x,this.facePreviewCanvasContext.clearRect(0,0,_,x),this.facePreviewCanvasContext.drawImage(t.image,h[0]-10,h[1]-10,h[2]+10,h[3]+10,0,0,_,x)}else this.facePreviewCanvasContext.clearRect(0,0,this.facePreviewCanvasElement.width,this.facePreviewCanvasElement.height);this.onResultsEventEmitter.emit({mpResults:t,frameImageDataUrl:r,posePreviewImageDataUrl:this.posePreviewCanvasElement.toDataURL("image/png"),faceFrameImageDataUrl:t.faceLandmarks?this.facePreviewCanvasElement.toDataURL("image/png"):void 0}),this.posePreviewCanvasContext.restore()}connect(t,e){const r=t.canvas;for(const l of e){const d=l[0],h=l[1];if(d&&h){if(d.visibility&&h.visibility&&(d.visibility<.1||h.visibility<.1))continue;t.beginPath(),t.moveTo(d.x*r.width,d.y*r.height),t.lineTo(h.x*r.width,h.y*r.height),t.stroke()}}}removeElements(t,e){for(const r of e)delete t[r]}getRectByLandmarks(t,e,r){const l=t.map(I=>I.x*e),d=t.map(I=>I.y*r),h=Math.min(...l),_=Math.max(...l),x=Math.min(...d);return[h,x,_-h,Math.max(...d)-x]}}function nP(n,t){if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WI(n,t){nP(n,t),t.add(n)}function GI(n,t,e){if(!t.has(n))throw new TypeError("attempted to get private field on non-instance");return e}function wf(n,t,e){nP(n,t),t.set(n,e)}function iP(n,t,e){if(!t.has(n))throw new TypeError("attempted to "+e+" private field on non-instance");return t.get(n)}function la(n,t){return function H6(n,t){return t.get?t.get.call(n):t.value}(n,iP(n,t,"get"))}function Cf(n,t,e){return function j6(n,t,e){if(t.set)t.set.call(n,e);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=e}}(n,iP(n,t,"set"),e),e}Ld.\u0275fac=function(t){return new(t||Ld)},Ld.\u0275prov=St({token:Ld,factory:Ld.\u0275fac});var $I=Re(153),AD=new WeakMap,RD=new WeakMap,$0=new WeakMap;class W6{constructor(t,e){wf(this,AD,{writable:!0,value:null}),wf(this,RD,{writable:!0,value:null}),wf(this,$0,{writable:!0,value:0}),Cf(this,RD,t),Cf(this,AD,e)}write(t){const e=new ArrayBuffer(t.byteLength);new Uint8Array(e).set(t),e.fileStart=la(this,$0),Cf(this,$0,la(this,$0)+e.byteLength),la(this,AD).call(this,"fetch",(la(this,$0)/1048576).toFixed(1)+" MiB"),la(this,RD).appendBuffer(e)}close(){la(this,AD).call(this,"fetch","Done"),la(this,RD).flush()}}var qI=new WeakMap,YI=new WeakMap,KI=new WeakMap,Bd=new WeakMap,rP=new WeakSet,oP=new WeakSet,aP=new WeakSet;class G6{constructor(t,{onConfig:e,onChunk:r,setStatus:l}){WI(this,aP),WI(this,oP),WI(this,rP),wf(this,qI,{writable:!0,value:null}),wf(this,YI,{writable:!0,value:null}),wf(this,KI,{writable:!0,value:null}),wf(this,Bd,{writable:!0,value:null}),Cf(this,qI,e),Cf(this,YI,r),Cf(this,KI,l),Cf(this,Bd,$I.cn()),la(this,Bd).onError=h=>l("demux",h),la(this,Bd).onReady=GI(this,oP,q6).bind(this),la(this,Bd).onSamples=GI(this,aP,Y6).bind(this);const d=new W6(la(this,Bd),l);fetch(t).then(h=>{h.body.pipeTo(new WritableStream(d,{highWaterMark:2}))})}}function $6(n){const t=la(this,Bd).getTrackById(n.id);for(const e of t.mdia.minf.stbl.stsd.entries)if(e.avcC||e.hvcC){const r=new $I.hb(void 0,0,$I.hb.BIG_ENDIAN);return e.avcC?e.avcC.write(r):e.hvcC.write(r),new Uint8Array(r.buffer,8)}throw"avcC or hvcC not found"}function q6(n){la(this,KI).call(this,"demux","Ready");const t=n.videoTracks[0];la(this,qI).call(this,{codec:t.codec,codedHeight:t.video.height,codedWidth:t.video.width,description:GI(this,rP,$6).call(this,t)}),la(this,Bd).setExtractionOptions(t.id),la(this,Bd).start()}function Y6(n,t,e){for(const r of e)la(this,YI).call(this,new EncodedVideoChunk({type:r.is_sync?"key":"delta",timestamp:1e6*r.cts/r.timescale,duration:1e6*r.duration/r.timescale,data:r.data}))}var K6=Re(275);let XI;try{XI=typeof Intl<"u"&&Intl.v8BreakIterator}catch{XI=!1}let o_,yr=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function eV(n){return n===fO}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!XI)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)(ee(n0))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const sP=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function lP(){if(o_)return o_;if("object"!=typeof document||!document)return o_=new Set(sP),o_;let n=document.createElement("input");return o_=new Set(sP.filter(t=>(n.setAttribute("type",t),n.type===t))),o_}let q0,FD,Sf,ZI;function yh(n){return function X6(){if(null==q0&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>q0=!0}))}finally{q0=q0||!1}return q0}()?n:!!n.capture}function cP(){if(null==Sf){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Sf=!1,Sf;if("scrollBehavior"in document.documentElement.style)Sf=!0;else{const n=Element.prototype.scrollTo;Sf=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Sf}function Y0(){if("object"!=typeof document||!document)return 0;if(null==FD){const n=document.createElement("div"),t=n.style;n.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";const e=document.createElement("div"),r=e.style;r.width="2px",r.height="1px",n.appendChild(e),document.body.appendChild(n),FD=0,0===n.scrollLeft&&(n.scrollLeft=1,FD=0===n.scrollLeft?1:2),n.remove()}return FD}function OD(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const t=n.shadowRoot.activeElement;if(t===n)break;n=t}return n}function zd(n){return n.composedPath?n.composedPath()[0]:n.target}function QI(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function bc(n,...t){return t.length?t.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}class fU extends K{constructor(t,e){super()}schedule(t,e=0){return this}}const PD={setInterval(n,t,...e){const{delegate:r}=PD;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=PD;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class iA extends fU{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const l=this.id,d=this.scheduler;return null!=l&&(this.id=this.recycleAsyncId(d,l,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(d,this.id,e),this}requestAsyncId(t,e,r=0){return PD.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&PD.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let l,r=!1;try{this.work(t)}catch(d){r=!0,l=d||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),l}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,J(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const uP={now:()=>(uP.delegate||Date).now(),delegate:void 0};class X0{constructor(t,e=X0.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}X0.now=uP.now;class rA extends X0{constructor(t,e=X0.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const LD=new rA(iA),mU=LD;function oA(n,t=LD){return en((e,r)=>{let l=null,d=null,h=null;const _=()=>{if(l){l.unsubscribe(),l=null;const D=d;d=null,r.next(D)}};function x(){const D=h+n,I=t.now();if(I<D)return l=this.schedule(void 0,D-I),void r.add(l);_()}e.subscribe(pn(r,D=>{d=D,h=t.now(),l||(l=t.schedule(x,n),r.add(l))},()=>{_(),r.complete()},void 0,()=>{d=l=null}))})}function hP(n){return Eo((t,e)=>n<=e)}function _U(n,t){return n===t}function Si(n){return en((t,e)=>{Ir(n).subscribe(pn(e,()=>e.complete(),z)),!e.closed&&t.subscribe(e)})}function xn(n){return null!=n&&"false"!=`${n}`}function Mo(n,t=0){return function vU(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):t}function BD(n){return Array.isArray(n)?n:[n]}function uo(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Vd(n){return n instanceof Ut?n.nativeElement:n}let pP=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),bU=(()=>{class n{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,r)=>this._cleanupObserver(r))}observe(e){const r=Vd(e);return new pt(l=>{const h=this._observeElement(r).subscribe(l);return()=>{h.unsubscribe(),this._unobserveElement(r)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const r=new Le,l=this._mutationObserverFactory.create(d=>r.next(d));l&&l.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:l,stream:r,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:r,stream:l}=this._observedElements.get(e);r&&r.disconnect(),l.complete(),this._observedElements.delete(e)}}}return n.\u0275fac=function(e){return new(e||n)(ee(pP))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),fP=(()=>{class n{constructor(e,r,l){this._contentObserver=e,this._elementRef=r,this._ngZone=l,this.event=new En,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=Mo(e),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(oA(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(re(bU),re(Ut),re(ln))},n.\u0275dir=Ze({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),zD=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[pP]}),n})();const mP=new Set;let s_,yU=(()=>{class n{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):wU}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function xU(n){if(!mP.has(n))try{s_||(s_=document.createElement("style"),s_.setAttribute("type","text/css"),document.head.appendChild(s_)),s_.sheet&&(s_.sheet.insertRule(`@media ${n} {body{ }}`,0),mP.add(n))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)(ee(yr))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function wU(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let aA=(()=>{class n{constructor(e,r){this._mediaMatcher=e,this._zone=r,this._queries=new Map,this._destroySubject=new Le}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return gP(BD(e)).some(l=>this._registerQuery(l).mql.matches)}observe(e){let d=pI(gP(BD(e)).map(h=>this._registerQuery(h).observable));return d=k0(d.pipe(Kr(1)),d.pipe(hP(1),oA(0))),d.pipe(Pt(h=>{const _={matches:!1,breakpoints:{}};return h.forEach(({matches:x,query:D})=>{_.matches=_.matches||x,_.breakpoints[D]=x}),_}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const r=this._mediaMatcher.matchMedia(e),d={observable:new pt(h=>{const _=x=>this._zone.run(()=>h.next(x));return r.addListener(_),()=>{r.removeListener(_)}}).pipe(_c(r),Pt(({matches:h})=>({query:e,matches:h})),Si(this._destroySubject)),mql:r};return this._queries.set(e,d),d}}return n.\u0275fac=function(e){return new(e||n)(ee(yU),ee(ln))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function gP(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}function VD(n,t){return(n.getAttribute(t)||"").match(/\S+/g)||[]}const vP="cdk-describedby-message",UD="cdk-describedby-host";let sA=0,EU=(()=>{class n{constructor(e,r){this._platform=r,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+sA++,this._document=e,this._id=Ft(dh)+"-"+sA++}describe(e,r,l){if(!this._canBeDescribed(e,r))return;const d=lA(r,l);"string"!=typeof r?(bP(r,this._id),this._messageRegistry.set(d,{messageElement:r,referenceCount:0})):this._messageRegistry.has(d)||this._createMessageElement(r,l),this._isElementDescribedByMessage(e,d)||this._addMessageReference(e,d)}removeDescription(e,r,l){if(!r||!this._isElementNode(e))return;const d=lA(r,l);if(this._isElementDescribedByMessage(e,d)&&this._removeMessageReference(e,d),"string"==typeof r){const h=this._messageRegistry.get(d);h&&0===h.referenceCount&&this._deleteMessageElement(d)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const e=this._document.querySelectorAll(`[${UD}="${this._id}"]`);for(let r=0;r<e.length;r++)this._removeCdkDescribedByReferenceIds(e[r]),e[r].removeAttribute(UD);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,r){const l=this._document.createElement("div");bP(l,this._id),l.textContent=e,r&&l.setAttribute("role",r),this._createMessagesContainer(),this._messagesContainer.appendChild(l),this._messageRegistry.set(lA(e,r),{messageElement:l,referenceCount:0})}_deleteMessageElement(e){this._messageRegistry.get(e)?.messageElement?.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;const e="cdk-describedby-message-container",r=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let d=0;d<r.length;d++)r[d].remove();const l=this._document.createElement("div");l.style.visibility="hidden",l.classList.add(e),l.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&l.setAttribute("platform","server"),this._document.body.appendChild(l),this._messagesContainer=l}_removeCdkDescribedByReferenceIds(e){const r=VD(e,"aria-describedby").filter(l=>0!=l.indexOf(vP));e.setAttribute("aria-describedby",r.join(" "))}_addMessageReference(e,r){const l=this._messageRegistry.get(r);(function SU(n,t,e){const r=VD(n,t);r.some(l=>l.trim()==e.trim())||(r.push(e.trim()),n.setAttribute(t,r.join(" ")))})(e,"aria-describedby",l.messageElement.id),e.setAttribute(UD,this._id),l.referenceCount++}_removeMessageReference(e,r){const l=this._messageRegistry.get(r);l.referenceCount--,function DU(n,t,e){const l=VD(n,t).filter(d=>d!=e.trim());l.length?n.setAttribute(t,l.join(" ")):n.removeAttribute(t)}(e,"aria-describedby",l.messageElement.id),e.removeAttribute(UD)}_isElementDescribedByMessage(e,r){const l=VD(e,"aria-describedby"),d=this._messageRegistry.get(r),h=d&&d.messageElement.id;return!!h&&-1!=l.indexOf(h)}_canBeDescribed(e,r){if(!this._isElementNode(e))return!1;if(r&&"object"==typeof r)return!0;const l=null==r?"":`${r}`.trim(),d=e.getAttribute("aria-label");return!(!l||d&&d.trim()===l)}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt),ee(yr))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function lA(n,t){return"string"==typeof n?`${t||""}/${n}`:n}function bP(n,t){n.id||(n.id=`${vP}-${t}-${sA++}`)}let HD=(()=>{class n{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function TU(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const r=function MU(n){try{return n.frameElement}catch{return null}}(function LU(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(e));if(r&&(-1===wP(r)||!this.isVisible(r)))return!1;let l=e.nodeName.toLowerCase(),d=wP(e);return e.hasAttribute("contenteditable")?-1!==d:!("iframe"===l||"object"===l||this._platform.WEBKIT&&this._platform.IOS&&!function NU(n){let t=n.nodeName.toLowerCase(),e="input"===t&&n.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===l?!!e.hasAttribute("controls")&&-1!==d:"video"===l?-1!==d&&(null!==d||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,r){return function PU(n){return!function AU(n){return function FU(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function IU(n){let t=n.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(n)||function RU(n){return function OU(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||xP(n))}(e)&&!this.isDisabled(e)&&(r?.ignoreVisibility||this.isVisible(e))}}return n.\u0275fac=function(e){return new(e||n)(ee(yr))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function xP(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let t=n.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function wP(n){if(!xP(n))return null;const t=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class BU{constructor(t,e,r,l,d=!1){this._element=t,this._checker=e,this._ngZone=r,this._document=l,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,d||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const r=this._getFirstTabbableElement(e);return r?.focus(t),!!r}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let r=0;r<e.length;r++){const l=e[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[r]):null;if(l)return l}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let r=e.length-1;r>=0;r--){const l=e[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[r]):null;if(l)return l}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Kr(1)).subscribe(t)}}let cA=(()=>{class n{constructor(e,r,l){this._checker=e,this._ngZone=r,this._document=l}create(e,r=!1){return new BU(e,this._checker,this._ngZone,this._document,r)}}return n.\u0275fac=function(e){return new(e||n)(ee(HD),ee(ln),ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function CP(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function SP(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const zU=new Ye("cdk-input-modality-detector-options"),VU={ignoreKeys:[18,17,224,91,16]},l_=yh({passive:!0,capture:!0});let UU=(()=>{class n{constructor(e,r,l,d){this._platform=e,this._mostRecentTarget=null,this._modality=new ls(null),this._lastTouchMs=0,this._onKeydown=h=>{this._options?.ignoreKeys?.some(_=>_===h.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=zd(h))},this._onMousedown=h=>{Date.now()-this._lastTouchMs<650||(this._modality.next(CP(h)?"keyboard":"mouse"),this._mostRecentTarget=zd(h))},this._onTouchstart=h=>{SP(h)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=zd(h))},this._options={...VU,...d},this.modalityDetected=this._modality.pipe(hP(1)),this.modalityChanged=this.modalityDetected.pipe(function gU(n,t=Be){return n=n??_U,en((e,r)=>{let l,d=!0;e.subscribe(pn(r,h=>{const _=t(h);(d||!n(l,_))&&(d=!1,l=_,r.next(h))}))})}()),e.isBrowser&&r.runOutsideAngular(()=>{l.addEventListener("keydown",this._onKeydown,l_),l.addEventListener("mousedown",this._onMousedown,l_),l.addEventListener("touchstart",this._onTouchstart,l_)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,l_),document.removeEventListener("mousedown",this._onMousedown,l_),document.removeEventListener("touchstart",this._onTouchstart,l_))}}return n.\u0275fac=function(e){return new(e||n)(ee(yr),ee(ln),ee(Mt),ee(zU,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const HU=new Ye("liveAnnouncerElement",{providedIn:"root",factory:function jU(){return null}}),WU=new Ye("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let GU=0,EP=(()=>{class n{constructor(e,r,l,d){this._ngZone=r,this._defaultOptions=d,this._document=l,this._liveElement=e||this._createLiveElement()}announce(e,...r){const l=this._defaultOptions;let d,h;return 1===r.length&&"number"==typeof r[0]?h=r[0]:[d,h]=r,this.clear(),clearTimeout(this._previousTimeout),d||(d=l&&l.politeness?l.politeness:"polite"),null==h&&l&&(h=l.duration),this._liveElement.setAttribute("aria-live",d),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(_=>this._currentResolve=_)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof h&&(this._previousTimeout=setTimeout(()=>this.clear(),h)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",r=this._document.getElementsByClassName(e),l=this._document.createElement("div");for(let d=0;d<r.length;d++)r[d].remove();return l.classList.add(e),l.classList.add("cdk-visually-hidden"),l.setAttribute("aria-atomic","true"),l.setAttribute("aria-live","polite"),l.id="cdk-live-announcer-"+GU++,this._document.body.appendChild(l),l}_exposeAnnouncerToModals(e){const r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let l=0;l<r.length;l++){const d=r[l],h=d.getAttribute("aria-owns");h?-1===h.indexOf(e)&&d.setAttribute("aria-owns",h+" "+e):d.setAttribute("aria-owns",e)}}}return n.\u0275fac=function(e){return new(e||n)(ee(HU,8),ee(ln),ee(Mt),ee(WU,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $U=new Ye("cdk-focus-monitor-default-options"),jD=yh({passive:!0,capture:!0});let yc=(()=>{class n{constructor(e,r,l,d,h){this._ngZone=e,this._platform=r,this._inputModalityDetector=l,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Le,this._rootNodeFocusAndBlurListener=_=>{for(let D=zd(_);D;D=D.parentElement)"focus"===_.type?this._onFocus(_,D):this._onBlur(_,D)},this._document=d,this._detectionMode=h?.detectionMode||0}monitor(e,r=!1){const l=Vd(e);if(!this._platform.isBrowser||1!==l.nodeType)return hn(null);const d=function Q6(n){if(function Z6(){if(null==ZI){const n=typeof document<"u"?document.head:null;ZI=!(!n||!n.createShadowRoot&&!n.attachShadow)}return ZI}()){const t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(l)||this._getDocument(),h=this._elementInfo.get(l);if(h)return r&&(h.checkChildren=!0),h.subject;const _={checkChildren:r,subject:new Le,rootNode:d};return this._elementInfo.set(l,_),this._registerGlobalListeners(_),_.subject}stopMonitoring(e){const r=Vd(e),l=this._elementInfo.get(r);l&&(l.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(l))}focusVia(e,r,l){const d=Vd(e);d===this._getDocument().activeElement?this._getClosestElementsInfo(d).forEach(([_,x])=>this._originChanged(_,r,x)):(this._setOrigin(r),"function"==typeof d.focus&&d.focus(l))}ngOnDestroy(){this._elementInfo.forEach((e,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,r){e.classList.toggle("cdk-focused",!!r),e.classList.toggle("cdk-touch-focused","touch"===r),e.classList.toggle("cdk-keyboard-focused","keyboard"===r),e.classList.toggle("cdk-mouse-focused","mouse"===r),e.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(e,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&r,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,r){const l=this._elementInfo.get(r),d=zd(e);!l||!l.checkChildren&&r!==d||this._originChanged(r,this._getFocusOrigin(d),l)}_onBlur(e,r){const l=this._elementInfo.get(r);!l||l.checkChildren&&e.relatedTarget instanceof Node&&r.contains(e.relatedTarget)||(this._setClasses(r),this._emitOrigin(l,null))}_emitOrigin(e,r){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(r))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const r=e.rootNode,l=this._rootNodeFocusListenerCount.get(r)||0;l||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,jD),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,jD)}),this._rootNodeFocusListenerCount.set(r,l+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Si(this._stopInputModalityDetector)).subscribe(d=>{this._setOrigin(d,!0)}))}_removeGlobalListeners(e){const r=e.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const l=this._rootNodeFocusListenerCount.get(r);l>1?this._rootNodeFocusListenerCount.set(r,l-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,jD),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,jD),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,r,l){this._setClasses(e,r),this._emitOrigin(l,r),this._lastFocusOrigin=r}_getClosestElementsInfo(e){const r=[];return this._elementInfo.forEach((l,d)=>{(d===e||l.checkChildren&&d.contains(e))&&r.push([d,l])}),r}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:r,mostRecentModality:l}=this._inputModalityDetector;if("mouse"!==l||!r||r===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const d=e.labels;if(d)for(let h=0;h<d.length;h++)if(d[h].contains(r))return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)(ee(ln),ee(yr),ee(UU),ee(Mt,8),ee($U,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kP="cdk-high-contrast-black-on-white",MP="cdk-high-contrast-white-on-black",dA="cdk-high-contrast-active";let TP=(()=>{class n{constructor(e,r){this._platform=e,this._document=r,this._breakpointSubscription=Ft(aA).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const r=this._document.defaultView||window,l=r&&r.getComputedStyle?r.getComputedStyle(e):null,d=(l&&l.backgroundColor||"").replace(/ /g,"");switch(e.remove(),d){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(dA,kP,MP),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?e.add(dA,kP):2===r&&e.add(dA,MP)}}}return n.\u0275fac=function(e){return new(e||n)(ee(yr),ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Z0=(()=>{class n{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(e){return new(e||n)(ee(TP))},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[zD]}),n})();const qU=new Ye("cdk-dir-doc",{providedIn:"root",factory:function YU(){return Ft(Mt)}}),KU=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Es=(()=>{class n{constructor(e){if(this.value="ltr",this.change=new En,e){const l=e.documentElement?e.documentElement.dir:null;this.value=function XU(n){const t=n?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?KU.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||l||"ltr")}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(e){return new(e||n)(ee(qU,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),c_=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();const QU=new Ye("mat-sanity-checks",{providedIn:"root",factory:function ZU(){return!0}});let un=(()=>{class n{constructor(e,r,l){this._sanityChecks=r,this._document=l,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!QI()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)(ee(TP),ee(QU,8),ee(Mt))},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[c_,c_]}),n})();function Q0(n){return class extends n{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=xn(t)}}}function d_(n,t){return class extends n{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const r=e||this.defaultColor;r!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),r&&this._elementRef.nativeElement.classList.add(`mat-${r}`),this._color=r)}}}function u_(n){return class extends n{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=xn(t)}}}function Df(n,t=0){return class extends n{constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?Mo(e):this.defaultTabIndex}}}function RP(n){return class extends n{constructor(...t){super(...t),this.errorState=!1}updateErrorState(){const t=this.errorState,d=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);d!==t&&(this.errorState=d,this.stateChanges.next())}}}const JU=new Ye("MAT_DATE_LOCALE",{providedIn:"root",factory:function eH(){return Ft(Cs)}});class xc{constructor(){this._localeChanges=new Le,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let r=this.isValid(t),l=this.isValid(e);return r&&l?!this.compareDate(t,e):r==l}return t==e}clampDate(t,e,r){return e&&this.compareDate(t,e)<0?e:r&&this.compareDate(t,r)>0?r:t}}const pA=new Ye("mat-date-formats"),tH=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function fA(n,t){const e=Array(n);for(let r=0;r<n;r++)e[r]=t(r);return e}let nH=(()=>{class n extends xc{constructor(e,r){super(),this.useUtcForDisplay=!1,super.setLocale(e)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const r=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return fA(12,l=>this._format(r,new Date(2017,l,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return fA(31,r=>this._format(e,new Date(2017,0,r+1)))}getDayOfWeekNames(e){const r=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return fA(7,l=>this._format(r,new Date(2017,0,l+1)))}getYearName(e){const r=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(r,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,r,l){let d=this._createDateWithOverflow(e,r,l);return d.getMonth(),d}today(){return new Date}parse(e,r){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,r){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const l=new Intl.DateTimeFormat(this.locale,{...r,timeZone:"utc"});return this._format(l,e)}addCalendarYears(e,r){return this.addCalendarMonths(e,12*r)}addCalendarMonths(e,r){let l=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+r,this.getDate(e));return this.getMonth(l)!=((this.getMonth(e)+r)%12+12)%12&&(l=this._createDateWithOverflow(this.getYear(l),this.getMonth(l),0)),l}addCalendarDays(e,r){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+r)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(tH.test(e)){let r=new Date(e);if(this.isValid(r))return r}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,r,l){const d=new Date;return d.setFullYear(e,r,l),d.setHours(0,0,0,0),d}_2digit(e){return("00"+e).slice(-2)}_format(e,r){const l=new Date;return l.setUTCFullYear(r.getFullYear(),r.getMonth(),r.getDate()),l.setUTCHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),e.format(l)}}return n.\u0275fac=function(e){return new(e||n)(ee(JU,8),ee(yr))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const iH={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let rH=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[{provide:xc,useClass:nH}]}),n})(),oH=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[{provide:pA,useValue:iH}],imports:[rH]}),n})(),WD=(()=>{class n{isErrorState(e,r){return!!(e&&e.invalid&&(e.touched||r&&r.submitted))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),FP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,un]}),n})();class aH{constructor(t,e,r,l=!1){this._renderer=t,this.element=e,this.config=r,this._animationForciblyDisabledThroughCss=l,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const OP=yh({passive:!0,capture:!0});class sH{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=zd(t);e&&this._events.get(t.type)?.forEach((r,l)=>{(l===e||l.contains(e))&&r.forEach(d=>d.handleEvent(t))})}}addHandler(t,e,r,l){const d=this._events.get(e);if(d){const h=d.get(r);h?h.add(l):d.set(r,new Set([l]))}else this._events.set(e,new Map([[r,new Set([l])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,OP)})}removeHandler(t,e,r){const l=this._events.get(t);if(!l)return;const d=l.get(e);!d||(d.delete(r),0===d.size&&l.delete(e),0===l.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,OP)))}}const NP={enterDuration:225,exitDuration:150},PP=yh({passive:!0,capture:!0}),LP=["mousedown","touchstart"],BP=["mouseup","mouseleave","touchend","touchcancel"];class h_{constructor(t,e,r,l){this._target=t,this._ngZone=e,this._platform=l,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,l.isBrowser&&(this._containerElement=Vd(r))}fadeInRipple(t,e,r={}){const l=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),d={...NP,...r.animation};r.centered&&(t=l.left+l.width/2,e=l.top+l.height/2);const h=r.radius||function cH(n,t,e){const r=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),l=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(r*r+l*l)}(t,e,l),_=t-l.left,x=e-l.top,D=d.enterDuration,I=document.createElement("div");I.classList.add("mat-ripple-element"),I.style.left=_-h+"px",I.style.top=x-h+"px",I.style.height=2*h+"px",I.style.width=2*h+"px",null!=r.color&&(I.style.backgroundColor=r.color),I.style.transitionDuration=`${D}ms`,this._containerElement.appendChild(I);const V=window.getComputedStyle(I),he=V.transitionDuration,Ce="none"===V.transitionProperty||"0s"===he||"0s, 0s"===he||0===l.width&&0===l.height,Ae=new aH(this,I,r,Ce);I.style.transform="scale3d(1, 1, 1)",Ae.state=0,r.persistent||(this._mostRecentTransientRipple=Ae);let He=null;return!Ce&&(D||d.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const rt=()=>this._finishRippleTransition(Ae),Tt=()=>this._destroyRipple(Ae);I.addEventListener("transitionend",rt),I.addEventListener("transitioncancel",Tt),He={onTransitionEnd:rt,onTransitionCancel:Tt}}),this._activeRipples.set(Ae,He),(Ce||!D)&&this._finishRippleTransition(Ae),Ae}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,r={...NP,...t.config.animation};e.style.transitionDuration=`${r.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=Vd(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,LP.forEach(r=>{h_._eventManager.addHandler(this._ngZone,r,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{BP.forEach(e=>{this._triggerElement.addEventListener(e,this,PP)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=1,!r&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=CP(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!SP(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let r=0;r<e.length;r++)this.fadeInRipple(e[r].clientX,e[r].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(LP.forEach(e=>h_._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&BP.forEach(e=>t.removeEventListener(e,this,PP)))}}h_._eventManager=new sH;const ex=new Ye("mat-ripple-global-options");let al=(()=>{class n{constructor(e,r,l,d,h){this._elementRef=e,this._animationMode=h,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=d||{},this._rippleRenderer=new h_(this,r,e,l)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,r=0,l){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,r,{...this.rippleConfig,...l}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ln),re(yr),re(ex,8),re(no,8))},n.\u0275dir=Ze({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,r){2&e&&Wn("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),ks=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,un]}),n})(),zP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un]}),n})(),GD=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[ks,Yr,un,zP]}),n})();const pH=["mat-button",""],fH=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],mH=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],_H=["mat-icon-button",""],vH=["*"],bH=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],yH=d_(Q0(u_(class{constructor(n){this._elementRef=n}})));let VP=(()=>{class n extends yH{constructor(e,r,l,d){super(e),this._platform=r,this._ngZone=l,this._animationMode=d,this._focusMonitor=Ft(yc),this._isFab=!1;const h=e.nativeElement.classList;for(const _ of bH)this._hasHostAttributes(_.selector)&&_.mdcClasses.forEach(x=>{h.add(x)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",r){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,r):this._elementRef.nativeElement.focus(r)}_hasHostAttributes(...e){return e.some(r=>this._elementRef.nativeElement.hasAttribute(r))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(e){$s()},n.\u0275dir=Ze({type:n,viewQuery:function(e,r){if(1&e&&Ti(al,5),2&e){let l;Ot(l=Kt())&&(r.ripple=l.first)}},features:[Et]}),n})(),$D=(()=>{class n extends VP{constructor(e,r,l,d){super(e,r,l,d)}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(yr),re(ln),re(no,8))},n.\u0275cmp=Mn({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(e,r){2&e&&(On("disabled",r.disabled||null),Wn("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Et],attrs:pH,ngContentSelectors:mH,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,r){1&e&&(cr(fH),yn(0,"span",0),Sn(1),ct(2,"span",1),Sn(3,1),dt(),Sn(4,2),yn(5,"span",2)(6,"span",3)(7,"span",4)),2&e&&(Wn("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab),Ct(6),Dt("matRippleDisabled",r._isRippleDisabled())("matRippleTrigger",r._elementRef.nativeElement))},dependencies:[al],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),CH=(()=>{class n extends VP{constructor(e,r,l,d){super(e,r,l,d)}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(yr),re(ln),re(no,8))},n.\u0275cmp=Mn({type:n,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(e,r){2&e&&(On("disabled",r.disabled||null),Wn("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Et],attrs:_H,ngContentSelectors:vH,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,r){1&e&&(cr(),yn(0,"span",0),Sn(1),yn(2,"span",1)(3,"span",2)(4,"span",3)),2&e&&(Ct(3),Dt("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",r._elementRef.nativeElement))},dependencies:[al],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),qD=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,ks,un]}),n})();class UP{}class SH{}const Ud="*";function Tr(n,t){return{type:7,name:n,definitions:t,options:{}}}function xi(n,t=null){return{type:4,styles:t,timings:n}}function HP(n,t=null){return{type:2,steps:n,options:t}}function Qt(n){return{type:6,styles:n,offset:null}}function oi(n,t,e){return{type:0,name:n,styles:t,options:e}}function gi(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function jP(n){Promise.resolve().then(n)}class nx{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){jP(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class WP{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,l=0;const d=this.players.length;0==d?jP(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++e==d&&this._onFinish()}),h.onDestroy(()=>{++r==d&&this._onDestroy()}),h.onStart(()=>{++l==d&&this._onStart()})}),this.totalTime=this.players.reduce((h,_)=>Math.max(h,_.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const l=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(l)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class gA{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class g_ extends gA{constructor(t,e,r,l,d){super(),this.component=t,this.viewContainerRef=e,this.injector=r,this.componentFactoryResolver=l,this.projectableNodes=d}}class YD extends gA{constructor(t,e,r,l){super(),this.templateRef=t,this.viewContainerRef=e,this.context=r,this.injector=l}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class DH extends gA{constructor(t){super(),this.element=t instanceof Ut?t.nativeElement:t}}class KD{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof g_?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof YD?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof DH?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class EH extends KD{constructor(t,e,r,l,d){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=r,this._defaultInjector=l,this.attachDomPortal=h=>{const _=h.element,x=this._document.createComment("dom-portal");_.parentNode.insertBefore(x,_),this.outletElement.appendChild(_),this._attachedPortal=h,super.setDisposeFn(()=>{x.parentNode&&x.parentNode.replaceChild(_,x)})},this._document=d}attachComponentPortal(t){const r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let l;return t.viewContainerRef?(l=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>l.destroy())):(l=r.create(t.injector||this._defaultInjector||nn.NULL),this._appRef.attachView(l.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(l.hostView),l.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(l)),this._attachedPortal=t,l}attachTemplatePortal(t){let e=t.viewContainerRef,r=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return r.rootNodes.forEach(l=>this.outletElement.appendChild(l)),r.detectChanges(),this.setDisposeFn(()=>{let l=e.indexOf(r);-1!==l&&e.remove(l)}),this._attachedPortal=t,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let ix=(()=>{class n extends KD{constructor(e,r,l){super(),this._componentFactoryResolver=e,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new En,this.attachDomPortal=d=>{const h=d.element,_=this._document.createComment("dom-portal");d.setAttachedHost(this),h.parentNode.insertBefore(_,h),this._getRootNode().appendChild(h),this._attachedPortal=d,super.setDisposeFn(()=>{_.parentNode&&_.parentNode.replaceChild(h,_)})},this._document=l}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const r=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,d=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),h=r.createComponent(d,r.length,e.injector||r.injector,e.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(h.hostView.rootNodes[0]),super.setDisposeFn(()=>h.destroy()),this._attachedPortal=e,this._attachedRef=h,this.attached.emit(h),h}attachTemplatePortal(e){e.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return n.\u0275fac=function(e){return new(e||n)(re(nc),re(Lr),re(Mt))},n.\u0275dir=Ze({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Et]}),n})(),wc=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();const kH=["addListener","removeListener"],MH=["addEventListener","removeEventListener"],TH=["on","off"];function Ef(n,t,e,r){if(ie(e)&&(r=e,e=void 0),r)return Ef(n,t,e).pipe(hI(r));const[l,d]=function RH(n){return ie(n.addEventListener)&&ie(n.removeEventListener)}(n)?MH.map(h=>_=>n[h](t,_,e)):function IH(n){return ie(n.addListener)&&ie(n.removeListener)}(n)?kH.map(GP(n,t)):function AH(n){return ie(n.on)&&ie(n.off)}(n)?TH.map(GP(n,t)):[];if(!l&&As(n))return Mi(h=>Ef(h,t,e))(Ir(n));if(!l)throw new TypeError("Invalid event target");return new pt(h=>{const _=(...x)=>h.next(1<x.length?x:x[0]);return l(_),()=>d(_)})}function GP(n,t){return e=>r=>n[e](t,r)}const rx={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:r}=rx;r&&(t=r.requestAnimationFrame,e=r.cancelAnimationFrame);const l=t(d=>{e=void 0,n(d)});return new K(()=>e?.(l))},requestAnimationFrame(...n){const{delegate:t}=rx;return(t?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=rx;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},NH=new class OH extends rA{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let l;t=t||r.shift();do{if(l=t.execute(t.state,t.delay))break}while((t=r[0])&&t.id===e&&r.shift());if(this._active=!1,l){for(;(t=r[0])&&t.id===e&&r.shift();)t.unsubscribe();throw l}}}(class FH extends iA{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,r=0){return null!==r&&r>0?super.requestAsyncId(t,e,r):(t.actions.push(this),t._scheduled||(t._scheduled=rx.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,r=0){var l;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(t,e,r);const{actions:d}=t;null!=e&&(null===(l=d[d.length-1])||void 0===l?void 0:l.id)!==e&&(rx.cancelAnimationFrame(e),t._scheduled=void 0)}});let _A,PH=1;const XD={};function $P(n){return n in XD&&(delete XD[n],!0)}const LH={setImmediate(n){const t=PH++;return XD[t]=!0,_A||(_A=Promise.resolve()),_A.then(()=>$P(t)&&n()),t},clearImmediate(n){$P(n)}},{setImmediate:BH,clearImmediate:zH}=LH,ZD={setImmediate(...n){const{delegate:t}=ZD;return(t?.setImmediate||BH)(...n)},clearImmediate(n){const{delegate:t}=ZD;return(t?.clearImmediate||zH)(n)},delegate:void 0},HH=new class UH extends rA{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let l;t=t||r.shift();do{if(l=t.execute(t.state,t.delay))break}while((t=r[0])&&t.id===e&&r.shift());if(this._active=!1,l){for(;(t=r[0])&&t.id===e&&r.shift();)t.unsubscribe();throw l}}}(class VH extends iA{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,r=0){return null!==r&&r>0?super.requestAsyncId(t,e,r):(t.actions.push(this),t._scheduled||(t._scheduled=ZD.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,r=0){var l;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(t,e,r);const{actions:d}=t;null!=e&&(null===(l=d[d.length-1])||void 0===l?void 0:l.id)!==e&&(ZD.clearImmediate(e),t._scheduled=void 0)}});function vA(n=0,t,e=mU){let r=-1;return null!=t&&(Mc(t)?e=t:r=t),new pt(l=>{let d=function WH(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;d<0&&(d=0);let h=0;return e.schedule(function(){l.closed||(l.next(h++),0<=r?this.schedule(void 0,r):l.complete())},d)})}function bA(n,t=LD){return function jH(n){return en((t,e)=>{let r=!1,l=null,d=null,h=!1;const _=()=>{if(d?.unsubscribe(),d=null,r){r=!1;const D=l;l=null,e.next(D)}h&&e.complete()},x=()=>{d=null,h&&e.complete()};t.subscribe(pn(e,D=>{r=!0,l=D,d||Ir(n(D)).subscribe(d=pn(e,_,x))},()=>{h=!0,(!r||!d||d.closed)&&e.complete()}))})}(()=>vA(n,t))}const GH=["contentWrapper"],$H=["*"],qH=new Ye("VIRTUAL_SCROLL_STRATEGY");let ox=(()=>{class n{constructor(e,r,l){this._ngZone=e,this._platform=r,this._scrolled=new Le,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=l}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new pt(r=>{this._globalSubscription||this._addGlobalListener();const l=e>0?this._scrolled.pipe(bA(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{l.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):hn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){const l=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(Eo(d=>!d||l.indexOf(d)>-1))}getAncestorScrollContainers(e){const r=[];return this.scrollContainers.forEach((l,d)=>{this._scrollableContainsElement(d,e)&&r.push(d)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,r){let l=Vd(r),d=e.getElementRef().nativeElement;do{if(l==d)return!0}while(l=l.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Ef(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(e){return new(e||n)(ee(ln),ee(yr),ee(Mt,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qP=(()=>{class n{constructor(e,r,l,d){this.elementRef=e,this.scrollDispatcher=r,this.ngZone=l,this.dir=d,this._destroyed=new Le,this._elementScrolled=new pt(h=>this.ngZone.runOutsideAngular(()=>Ef(this.elementRef.nativeElement,"scroll").pipe(Si(this._destroyed)).subscribe(h)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const r=this.elementRef.nativeElement,l=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=l?e.end:e.start),null==e.right&&(e.right=l?e.start:e.end),null!=e.bottom&&(e.top=r.scrollHeight-r.clientHeight-e.bottom),l&&0!=Y0()?(null!=e.left&&(e.right=r.scrollWidth-r.clientWidth-e.left),2==Y0()?e.left=e.right:1==Y0()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=r.scrollWidth-r.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const r=this.elementRef.nativeElement;cP()?r.scrollTo(e):(null!=e.top&&(r.scrollTop=e.top),null!=e.left&&(r.scrollLeft=e.left))}measureScrollOffset(e){const r="left",l="right",d=this.elementRef.nativeElement;if("top"==e)return d.scrollTop;if("bottom"==e)return d.scrollHeight-d.clientHeight-d.scrollTop;const h=this.dir&&"rtl"==this.dir.value;return"start"==e?e=h?l:r:"end"==e&&(e=h?r:l),h&&2==Y0()?e==r?d.scrollWidth-d.clientWidth-d.scrollLeft:d.scrollLeft:h&&1==Y0()?e==r?d.scrollLeft+d.scrollWidth-d.clientWidth:-d.scrollLeft:e==r?d.scrollLeft:d.scrollWidth-d.clientWidth-d.scrollLeft}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ox),re(ln),re(Es,8))},n.\u0275dir=Ze({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),ax=(()=>{class n{constructor(e,r,l){this._platform=e,this._change=new Le,this._changeListener=d=>{this._change.next(d)},this._document=l,r.runOutsideAngular(()=>{if(e.isBrowser){const d=this._getWindow();d.addEventListener("resize",this._changeListener),d.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:r,height:l}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+l,right:e.left+r,height:l,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,r=this._getWindow(),l=e.documentElement,d=l.getBoundingClientRect();return{top:-d.top||e.body.scrollTop||r.scrollY||l.scrollTop||0,left:-d.left||e.body.scrollLeft||r.scrollX||l.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(bA(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(e){return new(e||n)(ee(yr),ee(ln),ee(Mt,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const YP=new Ye("VIRTUAL_SCROLLABLE");let XH=(()=>{class n extends qP{constructor(e,r,l,d){super(e,r,l,d)}measureViewportSize(e){const r=this.elementRef.nativeElement;return"horizontal"===e?r.clientWidth:r.clientHeight}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ox),re(ln),re(Es,8))},n.\u0275dir=Ze({type:n,features:[Et]}),n})();const QH=typeof requestAnimationFrame<"u"?NH:HH;let JH=(()=>{class n extends XH{constructor(e,r,l,d,h,_,x,D){super(e,_,l,h),this.elementRef=e,this._changeDetectorRef=r,this._scrollStrategy=d,this.scrollable=D,this._platform=Ft(yr),this._detachedSubject=new Le,this._renderedRangeSubject=new Le,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new pt(I=>this._scrollStrategy.scrolledIndexChange.subscribe(V=>Promise.resolve().then(()=>this.ngZone.run(()=>I.next(V))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=K.EMPTY,this._viewportChanges=x.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}get orientation(){return this._orientation}set orientation(e){this._orientation!==e&&(this._orientation=e,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=xn(e)}ngOnInit(){!this._platform.isBrowser||(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(_c(null),bA(0,QH)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(e){this.ngZone.runOutsideAngular(()=>{this._forOf=e,this._forOf.dataStream.pipe(Si(this._detachedSubject)).subscribe(r=>{const l=r.length;l!==this._dataLength&&(this._dataLength=l,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(e){return this.getElementRef().nativeElement.getBoundingClientRect()[e]}setTotalContentSize(e){this._totalContentSize!==e&&(this._totalContentSize=e,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(e){(function ZH(n,t){return n.start==t.start&&n.end==t.end})(this._renderedRange,e)||(this.appendOnly&&(e={start:0,end:Math.max(this._renderedRange.end,e.end)}),this._renderedRangeSubject.next(this._renderedRange=e),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(e,r="to-start"){e=this.appendOnly&&"to-start"===r?0:e;const d="horizontal"==this.orientation,h=d?"X":"Y";let x=`translate${h}(${Number((d&&this.dir&&"rtl"==this.dir.value?-1:1)*e)}px)`;this._renderedContentOffset=e,"to-end"===r&&(x+=` translate${h}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=x&&(this._renderedContentTransform=x,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(e,r="auto"){const l={behavior:r};"horizontal"===this.orientation?l.start=e:l.top=e,this.scrollable.scrollTo(l)}scrollToIndex(e,r="auto"){this._scrollStrategy.scrollToIndex(e,r)}measureScrollOffset(e){let r;return r=this.scrollable==this?l=>super.measureScrollOffset(l):l=>this.scrollable.measureScrollOffset(l),Math.max(0,r(e??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(e){let r;const l="left",d="right",h="rtl"==this.dir?.value;r="start"==e?h?d:l:"end"==e?h?l:d:e||("horizontal"===this.orientation?"left":"top");const _=this.scrollable.measureBoundingClientRectWithScrollOffset(r);return this.elementRef.nativeElement.getBoundingClientRect()[r]-_}measureRenderedContentSize(){const e=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?e.offsetWidth:e.offsetHeight}measureRangeSize(e){return this._forOf?this._forOf.measureRangeSize(e,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(e){e&&this._runAfterChangeDetection.push(e),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const e=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const r of e)r()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ir),re(ln),re(qH,8),re(Es,8),re(ox),re(ax),re(YP,8))},n.\u0275cmp=Mn({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(e,r){if(1&e&&Ti(GH,7),2&e){let l;Ot(l=Kt())&&(r._contentWrapper=l.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(e,r){2&e&&Wn("cdk-virtual-scroll-orientation-horizontal","horizontal"===r.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==r.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[Ht([{provide:qP,useFactory:(t,e)=>t||e,deps:[[new Vo,new op(YP)],n]}]),Et,zy],ngContentSelectors:$H,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(e,r){1&e&&(cr(),ct(0,"div",0,1),Sn(2),dt(),yn(3,"div",2)),2&e&&(Ct(3),Qs("width",r._totalContentWidth)("height",r._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),Hd=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})(),yA=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[c_,Hd,JH,c_,Hd]}),n})();const KP=cP();class ej{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=uo(-this._previousScrollPosition.left),t.style.top=uo(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,r=t.style,l=this._document.body.style,d=r.scrollBehavior||"",h=l.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),KP&&(r.scrollBehavior=l.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),KP&&(r.scrollBehavior=d,l.scrollBehavior=h)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,r=this._viewportRuler.getViewportSize();return e.scrollHeight>r.height||e.scrollWidth>r.width}}class tj{constructor(t,e,r,l){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=r,this._config=l,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class XP{enable(){}disable(){}attach(){}}function xA(n,t){return t.some(e=>n.bottom<e.top||n.top>e.bottom||n.right<e.left||n.left>e.right)}function ZP(n,t){return t.some(e=>n.top<e.top||n.bottom>e.bottom||n.left<e.left||n.right>e.right)}class nj{constructor(t,e,r,l){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=r,this._config=l,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:l}=this._viewportRuler.getViewportSize();xA(e,[{width:r,height:l,bottom:l,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let ij=(()=>{class n{constructor(e,r,l,d){this._scrollDispatcher=e,this._viewportRuler=r,this._ngZone=l,this.noop=()=>new XP,this.close=h=>new tj(this._scrollDispatcher,this._ngZone,this._viewportRuler,h),this.block=()=>new ej(this._viewportRuler,this._document),this.reposition=h=>new nj(this._scrollDispatcher,this._viewportRuler,this._ngZone,h),this._document=d}}return n.\u0275fac=function(e){return new(e||n)(ee(ox),ee(ax),ee(ln),ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class QD{constructor(t){if(this.scrollStrategy=new XP,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const r of e)void 0!==t[r]&&(this[r]=t[r])}}}class rj{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let QP=(()=>{class n{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const r=this._attachedOverlays.indexOf(e);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),oj=(()=>{class n extends QP{constructor(e,r){super(e),this._ngZone=r,this._keydownListener=l=>{const d=this._attachedOverlays;for(let h=d.length-1;h>-1;h--)if(d[h]._keydownEvents.observers.length>0){const _=d[h]._keydownEvents;this._ngZone?this._ngZone.run(()=>_.next(l)):_.next(l);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt),ee(ln,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),aj=(()=>{class n extends QP{constructor(e,r,l){super(e),this._platform=r,this._ngZone=l,this._cursorStyleIsSet=!1,this._pointerDownListener=d=>{this._pointerDownEventTarget=zd(d)},this._clickListener=d=>{const h=zd(d),_="click"===d.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:h;this._pointerDownEventTarget=null;const x=this._attachedOverlays.slice();for(let D=x.length-1;D>-1;D--){const I=x[D];if(I._outsidePointerEvents.observers.length<1||!I.hasAttached())continue;if(I.overlayElement.contains(h)||I.overlayElement.contains(_))break;const V=I._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>V.next(d)):V.next(d)}}}add(e){if(super.add(e),!this._isAttached){const r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt),ee(yr),ee(ln,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JD=(()=>{class n{constructor(e,r){this._platform=r,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||QI()){const l=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let d=0;d<l.length;d++)l[d].remove()}const r=this._document.createElement("div");r.classList.add(e),QI()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt),ee(yr))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class sx{constructor(t,e,r,l,d,h,_,x,D,I=!1){this._portalOutlet=t,this._host=e,this._pane=r,this._config=l,this._ngZone=d,this._keyboardDispatcher=h,this._document=_,this._location=x,this._outsideClickDispatcher=D,this._animationsDisabled=I,this._backdropElement=null,this._backdropClick=new Le,this._attachments=new Le,this._detachments=new Le,this._locationChanges=K.EMPTY,this._backdropClickHandler=V=>this._backdropClick.next(V),this._backdropTransitionendHandler=V=>{this._disposeBackdrop(V.target)},this._keydownEvents=new Le,this._outsidePointerEvents=new Le,l.scrollStrategy&&(this._scrollStrategy=l.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=l.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Kr(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=uo(this._config.width),t.height=uo(this._config.height),t.minWidth=uo(this._config.minWidth),t.minHeight=uo(this._config.minHeight),t.maxWidth=uo(this._config.maxWidth),t.maxHeight=uo(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,r){const l=BD(e||[]).filter(d=>!!d);l.length&&(r?t.classList.add(...l):t.classList.remove(...l))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(Si(Ra(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const JP="cdk-overlay-connected-position-bounding-box",sj=/([A-Za-z%]+)$/;class lj{constructor(t,e,r,l,d){this._viewportRuler=e,this._document=r,this._platform=l,this._overlayContainer=d,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Le,this._resizeSubscription=K.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(JP),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,r=this._viewportRect,l=this._containerRect,d=[];let h;for(let _ of this._preferredPositions){let x=this._getOriginPoint(t,l,_),D=this._getOverlayPoint(x,e,_),I=this._getOverlayFit(D,e,r,_);if(I.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(_,x);this._canFitWithFlexibleDimensions(I,D,r)?d.push({position:_,origin:x,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(x,_)}):(!h||h.overlayFit.visibleArea<I.visibleArea)&&(h={overlayFit:I,overlayPoint:D,originPoint:x,position:_,overlayRect:e})}if(d.length){let _=null,x=-1;for(const D of d){const I=D.boundingBoxRect.width*D.boundingBoxRect.height*(D.position.weight||1);I>x&&(x=I,_=D)}return this._isPushed=!1,void this._applyPosition(_.position,_.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(h.position,h.originPoint);this._applyPosition(h.position,h.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&kf(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(JP),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,r){let l,d;if("center"==r.originX)l=t.left+t.width/2;else{const h=this._isRtl()?t.right:t.left,_=this._isRtl()?t.left:t.right;l="start"==r.originX?h:_}return e.left<0&&(l-=e.left),d="center"==r.originY?t.top+t.height/2:"top"==r.originY?t.top:t.bottom,e.top<0&&(d-=e.top),{x:l,y:d}}_getOverlayPoint(t,e,r){let l,d;return l="center"==r.overlayX?-e.width/2:"start"===r.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,d="center"==r.overlayY?-e.height/2:"top"==r.overlayY?0:-e.height,{x:t.x+l,y:t.y+d}}_getOverlayFit(t,e,r,l){const d=t3(e);let{x:h,y:_}=t,x=this._getOffset(l,"x"),D=this._getOffset(l,"y");x&&(h+=x),D&&(_+=D);let ne=0-_,he=_+d.height-r.height,Ce=this._subtractOverflows(d.width,0-h,h+d.width-r.width),Ae=this._subtractOverflows(d.height,ne,he),He=Ce*Ae;return{visibleArea:He,isCompletelyWithinViewport:d.width*d.height===He,fitsInViewportVertically:Ae===d.height,fitsInViewportHorizontally:Ce==d.width}}_canFitWithFlexibleDimensions(t,e,r){if(this._hasFlexibleDimensions){const l=r.bottom-e.y,d=r.right-e.x,h=e3(this._overlayRef.getConfig().minHeight),_=e3(this._overlayRef.getConfig().minWidth),D=t.fitsInViewportHorizontally||null!=_&&_<=d;return(t.fitsInViewportVertically||null!=h&&h<=l)&&D}return!1}_pushOverlayOnScreen(t,e,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const l=t3(e),d=this._viewportRect,h=Math.max(t.x+l.width-d.width,0),_=Math.max(t.y+l.height-d.height,0),x=Math.max(d.top-r.top-t.y,0),D=Math.max(d.left-r.left-t.x,0);let I=0,V=0;return I=l.width<=d.width?D||-h:t.x<this._viewportMargin?d.left-r.left-t.x:0,V=l.height<=d.height?x||-_:t.y<this._viewportMargin?d.top-r.top-t.y:0,this._previousPushAmount={x:I,y:V},{x:t.x+I,y:t.y+V}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const r=this._getScrollVisibility(),l=new rj(t,r);this._positionChanges.next(l)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,l=t.overlayY;r="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let d=0;d<e.length;d++)e[d].style.transformOrigin=`${r} ${l}`}_calculateBoundingBoxRect(t,e){const r=this._viewportRect,l=this._isRtl();let d,h,_,I,V,ne;if("top"===e.overlayY)h=t.y,d=r.height-h+this._viewportMargin;else if("bottom"===e.overlayY)_=r.height-t.y+2*this._viewportMargin,d=r.height-_+this._viewportMargin;else{const he=Math.min(r.bottom-t.y+r.top,t.y),Ce=this._lastBoundingBoxSize.height;d=2*he,h=t.y-he,d>Ce&&!this._isInitialRender&&!this._growAfterOpen&&(h=t.y-Ce/2)}if("end"===e.overlayX&&!l||"start"===e.overlayX&&l)ne=r.width-t.x+this._viewportMargin,I=t.x-this._viewportMargin;else if("start"===e.overlayX&&!l||"end"===e.overlayX&&l)V=t.x,I=r.right-t.x;else{const he=Math.min(r.right-t.x+r.left,t.x),Ce=this._lastBoundingBoxSize.width;I=2*he,V=t.x-he,I>Ce&&!this._isInitialRender&&!this._growAfterOpen&&(V=t.x-Ce/2)}return{top:h,left:V,bottom:_,right:ne,width:I,height:d}}_setBoundingBoxStyles(t,e){const r=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const l={};if(this._hasExactPosition())l.top=l.left="0",l.bottom=l.right=l.maxHeight=l.maxWidth="",l.width=l.height="100%";else{const d=this._overlayRef.getConfig().maxHeight,h=this._overlayRef.getConfig().maxWidth;l.height=uo(r.height),l.top=uo(r.top),l.bottom=uo(r.bottom),l.width=uo(r.width),l.left=uo(r.left),l.right=uo(r.right),l.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",l.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",d&&(l.maxHeight=uo(d)),h&&(l.maxWidth=uo(h))}this._lastBoundingBoxSize=r,kf(this._boundingBox.style,l)}_resetBoundingBoxStyles(){kf(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){kf(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const r={},l=this._hasExactPosition(),d=this._hasFlexibleDimensions,h=this._overlayRef.getConfig();if(l){const I=this._viewportRuler.getViewportScrollPosition();kf(r,this._getExactOverlayY(e,t,I)),kf(r,this._getExactOverlayX(e,t,I))}else r.position="static";let _="",x=this._getOffset(e,"x"),D=this._getOffset(e,"y");x&&(_+=`translateX(${x}px) `),D&&(_+=`translateY(${D}px)`),r.transform=_.trim(),h.maxHeight&&(l?r.maxHeight=uo(h.maxHeight):d&&(r.maxHeight="")),h.maxWidth&&(l?r.maxWidth=uo(h.maxWidth):d&&(r.maxWidth="")),kf(this._pane.style,r)}_getExactOverlayY(t,e,r){let l={top:"",bottom:""},d=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(d=this._pushOverlayOnScreen(d,this._overlayRect,r)),"bottom"===t.overlayY?l.bottom=this._document.documentElement.clientHeight-(d.y+this._overlayRect.height)+"px":l.top=uo(d.y),l}_getExactOverlayX(t,e,r){let h,l={left:"",right:""},d=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(d=this._pushOverlayOnScreen(d,this._overlayRect,r)),h=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===h?l.right=this._document.documentElement.clientWidth-(d.x+this._overlayRect.width)+"px":l.left=uo(d.x),l}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),r=this._scrollables.map(l=>l.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:ZP(t,r),isOriginOutsideView:xA(t,r),isOverlayClipped:ZP(e,r),isOverlayOutsideView:xA(e,r)}}_subtractOverflows(t,...e){return e.reduce((r,l)=>r-Math.max(l,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+t-this._viewportMargin,bottom:r.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&BD(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof Ut)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+e,height:r,width:e}}}function kf(n,t){for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function e3(n){if("number"!=typeof n&&null!=n){const[t,e]=n.split(sj);return e&&"px"!==e?null:parseFloat(t)}return n||null}function t3(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const n3="cdk-global-overlay-wrapper";class cj{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(n3),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:l,height:d,maxWidth:h,maxHeight:_}=r,x=!("100%"!==l&&"100vw"!==l||h&&"100%"!==h&&"100vw"!==h),D=!("100%"!==d&&"100vh"!==d||_&&"100%"!==_&&"100vh"!==_),I=this._xPosition,V=this._xOffset,ne="rtl"===this._overlayRef.getConfig().direction;let he="",Ce="",Ae="";x?Ae="flex-start":"center"===I?(Ae="center",ne?Ce=V:he=V):ne?"left"===I||"end"===I?(Ae="flex-end",he=V):("right"===I||"start"===I)&&(Ae="flex-start",Ce=V):"left"===I||"start"===I?(Ae="flex-start",he=V):("right"===I||"end"===I)&&(Ae="flex-end",Ce=V),t.position=this._cssPosition,t.marginLeft=x?"0":he,t.marginTop=D?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=x?"0":Ce,e.justifyContent=Ae,e.alignItems=D?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,r=e.style;e.classList.remove(n3),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let dj=(()=>{class n{constructor(e,r,l,d){this._viewportRuler=e,this._document=r,this._platform=l,this._overlayContainer=d}global(){return new cj}flexibleConnectedTo(e){return new lj(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(e){return new(e||n)(ee(ax),ee(Mt),ee(yr),ee(JD))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),uj=0,Ga=(()=>{class n{constructor(e,r,l,d,h,_,x,D,I,V,ne,he){this.scrollStrategies=e,this._overlayContainer=r,this._componentFactoryResolver=l,this._positionBuilder=d,this._keyboardDispatcher=h,this._injector=_,this._ngZone=x,this._document=D,this._directionality=I,this._location=V,this._outsideClickDispatcher=ne,this._animationsModuleType=he}create(e){const r=this._createHostElement(),l=this._createPaneElement(r),d=this._createPortalOutlet(l),h=new QD(e);return h.direction=h.direction||this._directionality.value,new sx(d,r,l,h,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const r=this._document.createElement("div");return r.id="cdk-overlay-"+uj++,r.classList.add("cdk-overlay-pane"),e.appendChild(r),r}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(fh)),new EH(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(e){return new(e||n)(ee(ij),ee(JD),ee(nc),ee(dj),ee(oj),ee(nn),ee(ln),ee(Mt),ee(Es),ee(oa),ee(aj),ee(no,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const fj={provide:new Ye("cdk-connected-overlay-scroll-strategy"),deps:[Ga],useFactory:function pj(n){return()=>n.scrollStrategies.reposition()}};let xh=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[Ga,fj],imports:[c_,wc,yA,yA]}),n})();function mj(n,t){if(1&n){const e=Zs();ct(0,"div",2)(1,"button",3),bn("click",function(){return ts(e),hs(qn().action())}),gn(2),dt()()}if(2&n){const e=qn();Ct(2),ta(" ",e.data.action," ")}}const gj=["label"];function _j(n,t){}const vj=Math.pow(2,31)-1;class wA{constructor(t,e){this._overlayRef=e,this._afterDismissed=new Le,this._afterOpened=new Le,this._onAction=new Le,this._dismissedByAction=!1,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,vj))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const r3=new Ye("MatSnackBarData");class eE{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let bj=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]}),n})(),yj=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]}),n})(),xj=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]}),n})(),wj=(()=>{class n{constructor(e,r){this.snackBarRef=e,this.data=r}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return n.\u0275fac=function(e){return new(e||n)(re(wA),re(r3))},n.\u0275cmp=Mn({type:n,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions","",4,"ngIf"],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(e,r){1&e&&(ct(0,"div",0),gn(1),dt(),Bt(2,mj,3,1,"div",1)),2&e&&(Ct(1),ta(" ",r.data.message,"\n"),Ct(1),Dt("ngIf",r.hasAction))},dependencies:[gc,$D,bj,yj,xj],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0}),n})();const Cj={snackBarState:Tr("state",[oi("void, hidden",Qt({transform:"scale(0.8)",opacity:0})),oi("visible",Qt({transform:"scale(1)",opacity:1})),gi("* => visible",xi("150ms cubic-bezier(0, 0, 0.2, 1)")),gi("* => void, * => hidden",xi("75ms cubic-bezier(0.4, 0.0, 1, 1)",Qt({opacity:0})))])};let Sj=(()=>{class n extends KD{constructor(e,r,l,d,h){super(),this._ngZone=e,this._elementRef=r,this._changeDetectorRef=l,this._platform=d,this.snackBarConfig=h,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new Le,this._onExit=new Le,this._onEnter=new Le,this._animationState="void",this.attachDomPortal=_=>{this._assertNotAttached();const x=this._portalOutlet.attachDomPortal(_);return this._afterPortalAttached(),x},this._live="assertive"!==h.politeness||h.announcementMessage?"off"===h.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),r}attachTemplatePortal(e){this._assertNotAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),r}onAnimationEnd(e){const{fromState:r,toState:l}=e;if(("void"===l&&"void"!==r||"hidden"===l)&&this._completeExit(),"visible"===l){const d=this._onEnter;this._ngZone.run(()=>{d.next(),d.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(Kr(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const e=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(l=>e.classList.add(l)):e.classList.add(r))}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),r=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&r){let l=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(l=document.activeElement),e.removeAttribute("aria-hidden"),r.appendChild(e),l?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return n.\u0275fac=function(e){return new(e||n)(re(ln),re(Ut),re(ir),re(yr),re(eE))},n.\u0275dir=Ze({type:n,viewQuery:function(e,r){if(1&e&&Ti(ix,7),2&e){let l;Ot(l=Kt())&&(r._portalOutlet=l.first)}},features:[Et]}),n})(),Dj=(()=>{class n extends Sj{_afterPortalAttached(){super._afterPortalAttached();const e=this._label.nativeElement,r="mdc-snackbar__label";e.classList.toggle(r,!e.querySelector(`.${r}`))}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Fn(n)))(r||n)}}(),n.\u0275cmp=Mn({type:n,selectors:[["mat-snack-bar-container"]],viewQuery:function(e,r){if(1&e&&Ti(gj,7),2&e){let l;Ot(l=Kt())&&(r._label=l.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container","mdc-snackbar--open"],hostVars:1,hostBindings:function(e,r){1&e&&Bp("@state.done",function(d){return r.onAnimationEnd(d)}),2&e&&Mg("@state",r._animationState)},features:[Et],decls:6,vars:2,consts:[[1,"mdc-snackbar__surface"],[1,"mat-mdc-snack-bar-label"],["label",""],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(e,r){1&e&&(ct(0,"div",0)(1,"div",1,2)(3,"div",3),Bt(4,_j,0,0,"ng-template",4),dt(),yn(5,"div"),dt()()),2&e&&(Ct(5),On("aria-live",r._live)("role",r._role))},dependencies:[ix],styles:['.mdc-snackbar{display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-snackbar--opening,.mdc-snackbar--open,.mdc-snackbar--closing{display:flex}.mdc-snackbar--open .mdc-snackbar__label,.mdc-snackbar--open .mdc-snackbar__actions{visibility:visible}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(0.8);opacity:0}.mdc-snackbar__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-snackbar__surface::before{border-color:CanvasText}}[dir=rtl] .mdc-snackbar__surface,.mdc-snackbar__surface[dir=rtl]{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1)}.mdc-snackbar__label{padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}[dir=rtl] .mdc-snackbar__label,.mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss,.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-snack-bar-container{margin:8px;position:static}.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:344px}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:100%}}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container{width:100vw}}.mat-mdc-snack-bar-container .mdc-snackbar__surface{max-width:672px}.mat-mdc-snack-bar-container .mdc-snackbar__surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)}.mat-mdc-snack-bar-container .mdc-snackbar__dismiss .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-snack-bar-container .mdc-snackbar__dismiss svg,.mat-mdc-snack-bar-container .mdc-snackbar__dismiss img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{background-color:var(--mdc-snackbar-container-color, inherit)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{border-radius:var(--mdc-snackbar-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-snack-bar-container .mdc-snackbar__label{color:var(--mdc-snackbar-supporting-text-color, inherit)}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-size:var(--mdc-snackbar-supporting-text-size, inherit);font-family:var(--mdc-snackbar-supporting-text-font, inherit);font-weight:var(--mdc-snackbar-supporting-text-weight, inherit);line-height:var(--mdc-snackbar-supporting-text-line-height, inherit)}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-mdc-snack-bar-button-color, transparent);--mat-mdc-button-persistent-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{background-color:currentColor;opacity:.1}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-handset .mdc-snackbar__surface{width:100%}'],encapsulation:2,data:{animation:[Cj.snackBarState]}}),n})(),o3=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[xh,wc,Yr,qD,un,un]}),n})();const a3=new Ye("mat-snack-bar-default-options",{providedIn:"root",factory:function Ej(){return new eE}});let kj=(()=>{class n{constructor(e,r,l,d,h,_){this._overlay=e,this._live=r,this._injector=l,this._breakpointObserver=d,this._parentSnackBar=h,this._defaultConfig=_,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,r){return this._attach(e,r)}openFromTemplate(e,r){return this._attach(e,r)}open(e,r="",l){const d={...this._defaultConfig,...l};return d.data={message:e,action:r},d.announcementMessage===e&&(d.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,d)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,r){const d=nn.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:eE,useValue:r}]}),h=new g_(this.snackBarContainerComponent,r.viewContainerRef,d),_=e.attach(h);return _.instance.snackBarConfig=r,_.instance}_attach(e,r){const l={...new eE,...this._defaultConfig,...r},d=this._createOverlay(l),h=this._attachSnackBarContainer(d,l),_=new wA(h,d);if(e instanceof qr){const x=new YD(e,null,{$implicit:l.data,snackBarRef:_});_.instance=h.attachTemplatePortal(x)}else{const x=this._createInjector(l,_),D=new g_(e,void 0,x),I=h.attachComponentPortal(D);_.instance=I.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(Si(d.detachments())).subscribe(x=>{d.overlayElement.classList.toggle(this.handsetCssClass,x.matches)}),l.announcementMessage&&h._onAnnounce.subscribe(()=>{this._live.announce(l.announcementMessage,l.politeness)}),this._animateSnackBar(_,l),this._openedSnackBarRef=_,this._openedSnackBarRef}_animateSnackBar(e,r){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),r.duration&&r.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(r.duration))}_createOverlay(e){const r=new QD;r.direction=e.direction;let l=this._overlay.position().global();const d="rtl"===e.direction,h="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!d||"end"===e.horizontalPosition&&d,_=!h&&"center"!==e.horizontalPosition;return h?l.left("0"):_?l.right("0"):l.centerHorizontally(),"top"===e.verticalPosition?l.top("0"):l.bottom("0"),r.positionStrategy=l,this._overlay.create(r)}_createInjector(e,r){return nn.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:wA,useValue:r},{provide:r3,useValue:e.data}]})}}return n.\u0275fac=function(e){return new(e||n)(ee(Ga),ee(EP),ee(nn),ee(aA),ee(n,12),ee(a3))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),CA=(()=>{class n extends kj{constructor(e,r,l,d,h,_){super(e,r,l,d,h,_),this.simpleSnackBarComponent=wj,this.snackBarContainerComponent=Dj,this.handsetCssClass="mat-mdc-snack-bar-handset"}}return n.\u0275fac=function(e){return new(e||n)(ee(Ga),ee(EP),ee(nn),ee(aA),ee(n,12),ee(a3))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:o3}),n})();class __{constructor(t){this.snackBar=t,this.classifiers=[]}init(t){var e=this;return Ni(function*(){const r=[],l=Date.now();for(const d of t){const h=yield K6.zD(d.url+"/model.json?t="+l,d.url+"/metadata.json?t="+l);r.push({...d,model:h,classLabels:h.getClassLabels()})}e.classifiers=r,console.log("[ExtendedClassifierService] init - classifiers:",r)})()}classify(t){var e=this;return Ni(function*(){let r,l;t.frameImageDataUrl&&(r=new Image,r.src=t.frameImageDataUrl,yield r.decode()),t.faceFrameImageDataUrl&&(l=new Image,l.src=t.faceFrameImageDataUrl,yield l.decode());const d={};for(const h of e.classifiers){let _;if("frameImage"===h.target&&r?_=r:"faceFrameImage"===h.target&&l&&(_=l),!_){console.warn(`[ExtendedClassifierService] classify - No image for ${h.name}.`,h);continue}const x=yield h.model.predict(_);let D;for(const V of x)(!D||D.probability<V.probability)&&(D=V);if(!D){console.warn(`[ExtendedClassifierService] classify - No prediction for ${h.name}.`,h);continue}const I=x.sort((V,ne)=>ne.probability-V.probability);d[h.name]=I.map(V=>({label:V.className,prob:V.probability}))}return d})()}}function s3(...n){const t=ro(n),{args:e,keys:r}=UO(n),l=new pt(d=>{const{length:h}=e;if(!h)return void d.complete();const _=new Array(h);let x=h,D=h;for(let I=0;I<h;I++){let V=!1;Ir(e[I]).subscribe(pn(d,ne=>{V||(V=!0,D--),_[I]=ne},()=>x--,void 0,()=>{(!x||!V)&&(D||d.next(r?HO(r,_):_),d.complete())}))}});return t?l.pipe(hI(t)):l}__.\u0275fac=function(t){return new(t||__)(ee(CA))},__.\u0275prov=St({token:__,factory:__.\u0275fac,providedIn:"root"});let l3=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=l=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(re(wl),re(Ut))},n.\u0275dir=Ze({type:n}),n})(),Mf=(()=>{class n extends l3{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Fn(n)))(r||n)}}(),n.\u0275dir=Ze({type:n,features:[Et]}),n})();const ho=new Ye("NgValueAccessor"),Tj={provide:ho,useExisting:Yn(()=>tE),multi:!0},Aj=new Ye("CompositionEventMode");let tE=(()=>{class n extends l3{constructor(e,r,l){super(e,r),this._compositionMode=l,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Ij(){const n=yt()?yt().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(re(wl),re(Ut),re(Aj,8))},n.\u0275dir=Ze({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&bn("input",function(d){return r._handleInput(d.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(d){return r._compositionEnd(d.target.value)})},features:[Ht([Tj]),Et]}),n})();function wh(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function d3(n){return null!=n&&"number"==typeof n.length}const To=new Ye("NgValidators"),Ch=new Ye("NgAsyncValidators"),Fj=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class SA{static min(t){return function u3(n){return t=>{if(wh(t.value)||wh(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function h3(n){return t=>{if(wh(t.value)||wh(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return function p3(n){return wh(n.value)?{required:!0}:null}(t)}static requiredTrue(t){return function f3(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function m3(n){return wh(n.value)||Fj.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function g3(n){return t=>wh(t.value)||!d3(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function _3(n){return t=>d3(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static pattern(t){return function v3(n){if(!n)return nE;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(wh(r.value))return null;const l=r.value;return t.test(l)?null:{pattern:{requiredPattern:e,actualValue:l}}}}(t)}static nullValidator(t){return null}static compose(t){return S3(t)}static composeAsync(t){return D3(t)}}function nE(n){return null}function b3(n){return null!=n}function y3(n){return Pp(n)?tr(n):n}function x3(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function w3(n,t){return t.map(e=>e(n))}function C3(n){return n.map(t=>function Oj(n){return!n.validate}(t)?t:e=>t.validate(e))}function S3(n){if(!n)return null;const t=n.filter(b3);return 0==t.length?null:function(e){return x3(w3(e,t))}}function DA(n){return null!=n?S3(C3(n)):null}function D3(n){if(!n)return null;const t=n.filter(b3);return 0==t.length?null:function(e){return s3(w3(e,t).map(y3)).pipe(Pt(x3))}}function EA(n){return null!=n?D3(C3(n)):null}function E3(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function k3(n){return n._rawValidators}function M3(n){return n._rawAsyncValidators}function kA(n){return n?Array.isArray(n)?n:[n]:[]}function iE(n,t){return Array.isArray(n)?n.includes(t):n===t}function T3(n,t){const e=kA(t);return kA(n).forEach(l=>{iE(e,l)||e.push(l)}),e}function I3(n,t){return kA(t).filter(e=>!iE(n,e))}class A3{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=DA(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=EA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class $a extends A3{get formDirective(){return null}get path(){return null}}class Cc extends A3{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class R3{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let MA=(()=>{class n extends R3{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(re(Cc,2))},n.\u0275dir=Ze({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&Wn("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Et]}),n})();const lx="VALID",oE="INVALID",v_="PENDING",cx="DISABLED";function RA(n){return(aE(n)?n.validators:n)||null}function FA(n,t){return(aE(t)?t.asyncValidators:n)||null}function aE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class P3{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===lx}get invalid(){return this.status===oE}get pending(){return this.status==v_}get disabled(){return this.status===cx}get enabled(){return this.status!==cx}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(T3(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(T3(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(I3(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(I3(t,this._rawAsyncValidators))}hasValidator(t){return iE(this._rawValidators,t)}hasAsyncValidator(t){return iE(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=v_,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=cx,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=lx,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===lx||this.status===v_)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?cx:lx}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=v_,this._hasOwnPendingAsyncValidator=!0;const e=y3(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,l)=>r&&r._find(l),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new En,this.statusChanges=new En}_calculateStatus(){return this._allControlsDisabled()?cx:this.errors?oE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(v_)?v_:this._anyControlsHaveStatus(oE)?oE:lx}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){aE(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function Hj(n){return Array.isArray(n)?DA(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function jj(n){return Array.isArray(n)?EA(n):n||null}(this._rawAsyncValidators)}}class OA extends P3{constructor(t,e,r){super(RA(e),FA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){(function N3(n,t,e){n._forEachChild((r,l)=>{if(void 0===e[l])throw new ot(1002,"")})})(this,0,t),Object.keys(t).forEach(r=>{(function O3(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new ot(1e3,"");if(!r[e])throw new ot(1001,"")})(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const l=this.controls[r];l&&l.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,l)=>{r.reset(t[l],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,l)=>((r.enabled||this.disabled)&&(e[l]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((l,d)=>{r=e(r,l,d)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}const dx=new Ye("CallSetDisabledState",{providedIn:"root",factory:()=>NA}),NA="always";function ux(n,t,e=NA){PA(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function $j(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&L3(n,t)})}(n,t),function Yj(n,t){const e=(r,l)=>{t.valueAccessor.writeValue(r),l&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function qj(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&L3(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function Gj(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function lE(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),dE(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function cE(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function PA(n,t){const e=k3(n);null!==t.validator?n.setValidators(E3(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=M3(n);null!==t.asyncValidator?n.setAsyncValidators(E3(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const l=()=>n.updateValueAndValidity();cE(t._rawValidators,l),cE(t._rawAsyncValidators,l)}function dE(n,t){let e=!1;if(null!==n){if(null!==t.validator){const l=k3(n);if(Array.isArray(l)&&l.length>0){const d=l.filter(h=>h!==t.validator);d.length!==l.length&&(e=!0,n.setValidators(d))}}if(null!==t.asyncValidator){const l=M3(n);if(Array.isArray(l)&&l.length>0){const d=l.filter(h=>h!==t.asyncValidator);d.length!==l.length&&(e=!0,n.setAsyncValidators(d))}}}const r=()=>{};return cE(t._rawValidators,r),cE(t._rawAsyncValidators,r),e}function L3(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function B3(n,t){PA(n,t)}function z3(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}const Jj={provide:$a,useExisting:Yn(()=>px)},hx=(()=>Promise.resolve())();let px=(()=>{class n extends $a{constructor(e,r,l){super(),this.callSetDisabledState=l,this.submitted=!1,this._directives=new Set,this.ngSubmit=new En,this.form=new OA({},DA(e),EA(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){hx.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),ux(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){hx.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){hx.then(()=>{const r=this._findContainer(e.path),l=new OA({});B3(l,e),r.registerControl(e.name,l),l.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){hx.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){hx.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,z3(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(re(To,10),re(Ch,10),re(dx,8))},n.\u0275dir=Ze({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&bn("submit",function(d){return r.onSubmit(d)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ht([Jj]),Et]}),n})();function V3(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function U3(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const H3=class extends P3{constructor(t=null,e,r){super(RA(e),FA(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),aE(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=U3(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){V3(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){V3(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){U3(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},n7={provide:Cc,useExisting:Yn(()=>uE)},G3=(()=>Promise.resolve())();let uE=(()=>{class n extends Cc{constructor(e,r,l,d,h,_){super(),this._changeDetectorRef=h,this.callSetDisabledState=_,this.control=new H3,this._registered=!1,this.update=new En,this._parent=e,this._setValidators(r),this._setAsyncValidators(l),this.valueAccessor=function zA(n,t){if(!t)return null;let e,r,l;return Array.isArray(t),t.forEach(d=>{d.constructor===tE?e=d:function Zj(n){return Object.getPrototypeOf(n.constructor)===Mf}(d)?r=d:l=d}),l||r||e||null}(0,d)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function BA(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ux(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){G3.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,l=0!==r&&ue(r);G3.then(()=>{l&&!this.control.disabled?this.control.disable():!l&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function sE(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(re($a,9),re(To,10),re(Ch,10),re(ho,10),re(ir,8),re(dx,8))},n.\u0275dir=Ze({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ht([n7]),Et,Ki]}),n})(),q3=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();const d7={provide:$a,useExisting:Yn(()=>fx)};let fx=(()=>{class n extends $a{constructor(e,r,l){super(),this.callSetDisabledState=l,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new En,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(dE(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return ux(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){lE(e.control||null,e,!1),function Qj(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,z3(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,l=this.form.get(e.path);r!==l&&(lE(r||null,e),(n=>n instanceof H3)(l)&&(ux(l,e,this.callSetDisabledState),e.control=l))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);B3(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function Kj(n,t){return dE(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){PA(this.form,this),this._oldForm&&dE(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(re(To,10),re(Ch,10),re(dx,8))},n.\u0275dir=Ze({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&bn("submit",function(d){return r.onSubmit(d)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ht([d7]),Et,Ki]}),n})(),M7=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[q3]}),n})(),T7=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:dx,useValue:e.callSetDisabledState??NA}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[M7]}),n})();const A7=["*"],O7=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],N7=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],P7=new Ye("MAT_CARD_CONFIG");let pE=(()=>{class n{constructor(e){this.appearance=e?.appearance||"raised"}}return n.\u0275fac=function(e){return new(e||n)(re(P7,8))},n.\u0275cmp=Mn({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(e,r){2&e&&Wn("mat-mdc-card-outlined","outlined"===r.appearance)("mdc-card--outlined","outlined"===r.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:A7,decls:1,vars:0,template:function(e,r){1&e&&(cr(),Sn(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mat-mdc-card{position:relative;border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px));background-color:var(--mdc-elevated-card-container-color, transparent);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color, transparent)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width, 1px);border-style:solid;border-color:var(--mdc-outlined-card-outline-color, transparent)}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0}),n})(),fE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]}),n})(),mE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]}),n})(),gE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]}),n})(),dL=(()=>{class n{constructor(){this.align="start"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(e,r){2&e&&Wn("mat-mdc-card-actions-align-end","end"===r.align)},inputs:{align:"align"},exportAs:["matCardActions"]}),n})(),_E=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Mn({type:n,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:N7,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(e,r){1&e&&(cr(O7),Sn(0),ct(1,"div",0),Sn(2,1),dt(),Sn(3,2))},encapsulation:2,changeDetection:0}),n})(),G7=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,Yr,un]}),n})();class GA{}class Sh{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const l=e.slice(0,r),d=l.toLowerCase(),h=e.slice(r+1).trim();this.maybeSetNormalizedName(l,d),this.headers.has(d)?this.headers.get(d).push(h):this.headers.set(d,[h])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const l=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(l,r),this.maybeSetNormalizedName(e,l))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Sh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Sh;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Sh?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const l=("a"===t.op?this.headers.get(e):void 0)||[];l.push(...r),this.headers.set(e,l);break;case"d":const d=t.value;if(d){let h=this.headers.get(e);if(!h)return;h=h.filter(_=>-1===d.indexOf(_)),0===h.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,h)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class $7{encodeKey(t){return hL(t)}encodeValue(t){return hL(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Y7=/%(\d[a-f0-9])/gi,K7={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function hL(n){return encodeURIComponent(n).replace(Y7,(t,e)=>K7[e]??t)}function vE(n){return`${n}`}class Dh{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new $7,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function q7(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(l=>{const d=l.indexOf("="),[h,_]=-1==d?[t.decodeKey(l),""]:[t.decodeKey(l.slice(0,d)),t.decodeValue(l.slice(d+1))],x=e.get(h)||[];x.push(_),e.set(h,x)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],l=Array.isArray(r)?r.map(vE):[vE(r)];this.map.set(e,l)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const l=t[r];Array.isArray(l)?l.forEach(d=>{e.push({param:r,value:d,op:"a"})}):e.push({param:r,value:l,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Dh({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(vE(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const l=r.indexOf(vE(t.value));-1!==l&&r.splice(l,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class X7{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function pL(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function fL(n){return typeof Blob<"u"&&n instanceof Blob}function mL(n){return typeof FormData<"u"&&n instanceof FormData}class mx{constructor(t,e,r,l){let d;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Z7(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||l?(this.body=void 0!==r?r:null,d=l):d=r,d&&(this.reportProgress=!!d.reportProgress,this.withCredentials=!!d.withCredentials,d.responseType&&(this.responseType=d.responseType),d.headers&&(this.headers=d.headers),d.context&&(this.context=d.context),d.params&&(this.params=d.params)),this.headers||(this.headers=new Sh),this.context||(this.context=new X7),this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=e;else{const _=e.indexOf("?");this.urlWithParams=e+(-1===_?"?":_<e.length-1?"&":"")+h}}else this.params=new Dh,this.urlWithParams=e}serializeBody(){return null===this.body?null:pL(this.body)||fL(this.body)||mL(this.body)||function Q7(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Dh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||mL(this.body)?null:fL(this.body)?this.body.type||null:pL(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Dh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,l=t.responseType||this.responseType,d=void 0!==t.body?t.body:this.body,h=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,_=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let x=t.headers||this.headers,D=t.params||this.params;const I=t.context??this.context;return void 0!==t.setHeaders&&(x=Object.keys(t.setHeaders).reduce((V,ne)=>V.set(ne,t.setHeaders[ne]),x)),t.setParams&&(D=Object.keys(t.setParams).reduce((V,ne)=>V.set(ne,t.setParams[ne]),D)),new mx(e,r,d,{params:D,headers:x,context:I,reportProgress:_,responseType:l,withCredentials:h})}}var ca=(()=>((ca=ca||{})[ca.Sent=0]="Sent",ca[ca.UploadProgress=1]="UploadProgress",ca[ca.ResponseHeader=2]="ResponseHeader",ca[ca.DownloadProgress=3]="DownloadProgress",ca[ca.Response=4]="Response",ca[ca.User=5]="User",ca))();class J7{constructor(t,e=200,r="OK"){this.headers=t.headers||new Sh,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class $A extends J7{constructor(t={}){super(t),this.type=ca.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new $A({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}function qA(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let YA=(()=>{class n{constructor(e){this.handler=e}request(e,r,l={}){let d;if(e instanceof mx)d=e;else{let x,D;x=l.headers instanceof Sh?l.headers:new Sh(l.headers),l.params&&(D=l.params instanceof Dh?l.params:new Dh({fromObject:l.params})),d=new mx(e,r,void 0!==l.body?l.body:null,{headers:x,context:l.context,params:D,reportProgress:l.reportProgress,responseType:l.responseType||"json",withCredentials:l.withCredentials})}const h=hn(d).pipe(vh(x=>this.handler.handle(x)));if(e instanceof mx||"events"===l.observe)return h;const _=h.pipe(Eo(x=>x instanceof $A));switch(l.observe||"body"){case"body":switch(d.responseType){case"arraybuffer":return _.pipe(Pt(x=>{if(null!==x.body&&!(x.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return x.body}));case"blob":return _.pipe(Pt(x=>{if(null!==x.body&&!(x.body instanceof Blob))throw new Error("Response is not a Blob.");return x.body}));case"text":return _.pipe(Pt(x=>{if(null!==x.body&&"string"!=typeof x.body)throw new Error("Response is not a string.");return x.body}));default:return _.pipe(Pt(x=>x.body))}case"response":return _;default:throw new Error(`Unreachable: unhandled observe type ${l.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new Dh).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,l={}){return this.request("PATCH",e,qA(l,r))}post(e,r,l={}){return this.request("POST",e,qA(l,r))}put(e,r,l={}){return this.request("PUT",e,qA(l,r))}}return n.\u0275fac=function(e){return new(e||n)(ee(GA))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();const p9=["*"];let yE;function gx(n){return function f9(){if(void 0===yE&&(yE=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(yE=n.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return yE}()?.createHTML(n)||n}function CL(n){return Error(`Unable to find icon with the name "${n}"`)}function SL(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function DL(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class If{constructor(t,e,r){this.url=t,this.svgText=e,this.options=r}}let xE=(()=>{class n{constructor(e,r,l,d){this._httpClient=e,this._sanitizer=r,this._errorHandler=d,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=l}addSvgIcon(e,r,l){return this.addSvgIconInNamespace("",e,r,l)}addSvgIconLiteral(e,r,l){return this.addSvgIconLiteralInNamespace("",e,r,l)}addSvgIconInNamespace(e,r,l,d){return this._addSvgIconConfig(e,r,new If(l,null,d))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,r,l,d){const h=this._sanitizer.sanitize(zi.HTML,l);if(!h)throw DL(l);const _=gx(h);return this._addSvgIconConfig(e,r,new If("",_,d))}addSvgIconSet(e,r){return this.addSvgIconSetInNamespace("",e,r)}addSvgIconSetLiteral(e,r){return this.addSvgIconSetLiteralInNamespace("",e,r)}addSvgIconSetInNamespace(e,r,l){return this._addSvgIconSetConfig(e,new If(r,null,l))}addSvgIconSetLiteralInNamespace(e,r,l){const d=this._sanitizer.sanitize(zi.HTML,r);if(!d)throw DL(r);const h=gx(d);return this._addSvgIconSetConfig(e,new If("",h,l))}registerFontClassAlias(e,r=e){return this._fontCssClassesByAlias.set(e,r),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const r=this._sanitizer.sanitize(zi.RESOURCE_URL,e);if(!r)throw SL(e);const l=this._cachedIconsByUrl.get(r);return l?hn(wE(l)):this._loadSvgIconFromConfig(new If(e,null)).pipe(io(d=>this._cachedIconsByUrl.set(r,d)),Pt(d=>wE(d)))}getNamedSvgIcon(e,r=""){const l=EL(r,e);let d=this._svgIconConfigs.get(l);if(d)return this._getSvgFromConfig(d);if(d=this._getIconConfigFromResolvers(r,e),d)return this._svgIconConfigs.set(l,d),this._getSvgFromConfig(d);const h=this._iconSetConfigs.get(r);return h?this._getSvgFromIconSetConfigs(e,h):Yg(CL(l))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?hn(wE(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(Pt(r=>wE(r)))}_getSvgFromIconSetConfigs(e,r){const l=this._extractIconWithNameFromAnySet(e,r);return l?hn(l):s3(r.filter(h=>!h.svgText).map(h=>this._loadSvgIconSetFromConfig(h).pipe(Rd(_=>{const D=`Loading icon set URL: ${this._sanitizer.sanitize(zi.RESOURCE_URL,h.url)} failed: ${_.message}`;return this._errorHandler.handleError(new Error(D)),hn(null)})))).pipe(Pt(()=>{const h=this._extractIconWithNameFromAnySet(e,r);if(!h)throw CL(e);return h}))}_extractIconWithNameFromAnySet(e,r){for(let l=r.length-1;l>=0;l--){const d=r[l];if(d.svgText&&d.svgText.toString().indexOf(e)>-1){const h=this._svgElementFromConfig(d),_=this._extractSvgIconFromSet(h,e,d.options);if(_)return _}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(io(r=>e.svgText=r),Pt(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?hn(null):this._fetchIcon(e).pipe(io(r=>e.svgText=r))}_extractSvgIconFromSet(e,r,l){const d=e.querySelector(`[id="${r}"]`);if(!d)return null;const h=d.cloneNode(!0);if(h.removeAttribute("id"),"svg"===h.nodeName.toLowerCase())return this._setSvgAttributes(h,l);if("symbol"===h.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(h),l);const _=this._svgElementFromString(gx("<svg></svg>"));return _.appendChild(h),this._setSvgAttributes(_,l)}_svgElementFromString(e){const r=this._document.createElement("DIV");r.innerHTML=e;const l=r.querySelector("svg");if(!l)throw Error("<svg> tag not found");return l}_toSvgElement(e){const r=this._svgElementFromString(gx("<svg></svg>")),l=e.attributes;for(let d=0;d<l.length;d++){const{name:h,value:_}=l[d];"id"!==h&&r.setAttribute(h,_)}for(let d=0;d<e.childNodes.length;d++)e.childNodes[d].nodeType===this._document.ELEMENT_NODE&&r.appendChild(e.childNodes[d].cloneNode(!0));return r}_setSvgAttributes(e,r){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),r&&r.viewBox&&e.setAttribute("viewBox",r.viewBox),e}_fetchIcon(e){const{url:r,options:l}=e,d=l?.withCredentials??!1;if(!this._httpClient)throw function m9(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const h=this._sanitizer.sanitize(zi.RESOURCE_URL,r);if(!h)throw SL(r);const _=this._inProgressUrlFetches.get(h);if(_)return _;const x=this._httpClient.get(h,{responseType:"text",withCredentials:d}).pipe(Pt(D=>gx(D)),dD(()=>this._inProgressUrlFetches.delete(h)),hl());return this._inProgressUrlFetches.set(h,x),x}_addSvgIconConfig(e,r,l){return this._svgIconConfigs.set(EL(e,r),l),this}_addSvgIconSetConfig(e,r){const l=this._iconSetConfigs.get(e);return l?l.push(r):this._iconSetConfigs.set(e,[r]),this}_svgElementFromConfig(e){if(!e.svgElement){const r=this._svgElementFromString(e.svgText);this._setSvgAttributes(r,e.options),e.svgElement=r}return e.svgElement}_getIconConfigFromResolvers(e,r){for(let l=0;l<this._resolvers.length;l++){const d=this._resolvers[l](r,e);if(d)return _9(d)?new If(d.url,null,d.options):new If(d,null)}}}return n.\u0275fac=function(e){return new(e||n)(ee(YA,8),ee(sD),ee(Mt,8),ee(Cl))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function wE(n){return n.cloneNode(!0)}function EL(n,t){return n+":"+t}function _9(n){return!(!n.url||!n.options)}const v9=d_(class{constructor(n){this._elementRef=n}}),b9=new Ye("MAT_ICON_DEFAULT_OPTIONS"),y9=new Ye("mat-icon-location",{providedIn:"root",factory:function x9(){const n=Ft(Mt),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),kL=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],w9=kL.map(n=>`[${n}]`).join(", "),C9=/^url\(['"]?#(.*?)['"]?\)$/;let XA=(()=>{class n extends v9{constructor(e,r,l,d,h,_){super(e),this._iconRegistry=r,this._location=d,this._errorHandler=h,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=K.EMPTY,_&&(_.color&&(this.color=this.defaultColor=_.color),_.fontSet&&(this.fontSet=_.fontSet)),l||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=xn(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const r=this._cleanupFontValue(e);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const r=this._cleanupFontValue(e);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}_splitIconName(e){if(!e)return["",""];const r=e.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let r=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const l=e.childNodes[r];(1!==l.nodeType||"svg"===l.nodeName.toLowerCase())&&l.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(l=>l.length>0);this._previousFontSetClass.forEach(l=>e.classList.remove(l)),r.forEach(l=>e.classList.add(l)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const r=this._elementsWithExternalReferences;r&&r.forEach((l,d)=>{l.forEach(h=>{d.setAttribute(h.name,`url('${e}#${h.value}')`)})})}_cacheChildrenWithExternalReferences(e){const r=e.querySelectorAll(w9),l=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let d=0;d<r.length;d++)kL.forEach(h=>{const _=r[d],x=_.getAttribute(h),D=x?x.match(C9):null;if(D){let I=l.get(_);I||(I=[],l.set(_,I)),I.push({name:h,value:D[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[r,l]=this._splitIconName(e);r&&(this._svgNamespace=r),l&&(this._svgName=l),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(l,r).pipe(Kr(1)).subscribe(d=>this._setSvgElement(d),d=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${l}! ${d.message}`))})}}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(xE),va("aria-hidden"),re(y9),re(Cl),re(b9,8))},n.\u0275cmp=Mn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(e,r){2&e&&(On("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),Wn("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Et],ngContentSelectors:p9,decls:1,vars:0,template:function(e,r){1&e&&(cr(),Sn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),ML=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,un]}),n})(),S9=(()=>{class n{constructor(){this._listeners=[]}notify(e,r){for(let l of this._listeners)l(e,r)}listen(e){return this._listeners.push(e),()=>{this._listeners=this._listeners.filter(r=>e!==r)}}ngOnDestroy(){this._listeners=[]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const D9=["input"],E9=["*"];let AL=0;class RL{constructor(t,e){this.source=t,this.value=e}}const k9={provide:ho,useExisting:Yn(()=>OL),multi:!0},FL=new Ye("MatRadioGroup"),M9=new Ye("mat-radio-default-options",{providedIn:"root",factory:function T9(){return{color:"accent"}}});let I9=(()=>{class n{constructor(e){this._changeDetector=e,this._value=null,this._name="mat-radio-group-"+AL++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new En}get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition="before"===e?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=xn(e),this._markRadiosForCheck()}ngAfterContentInit(){this._isInitialized=!0}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(r=>{r.checked=this.value===r.value,r.checked&&(this._selected=r)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new RL(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(re(ir))},n.\u0275dir=Ze({type:n,inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:"disabled",required:"required"},outputs:{change:"change"}}),n})();class A9{constructor(t){this._elementRef=t}}const R9=u_(Df(A9));let F9=(()=>{class n extends R9{constructor(e,r,l,d,h,_,x,D){super(r),this._changeDetector=l,this._focusMonitor=d,this._radioDispatcher=h,this._providerOverride=x,this._uniqueId="mat-radio-"+ ++AL,this.id=this._uniqueId,this.change=new En,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=e,this._noopAnimations="NoopAnimations"===_,D&&(this.tabIndex=Mo(D,0))}get checked(){return this._checked}set checked(e){const r=xn(e);this._checked!==r&&(this._checked=r,r&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!r&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),r&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(e){this._setDisabled(xn(e))}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=xn(e)}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(e){this._color=e}get inputId(){return`${this.id||this._uniqueId}-input`}focus(e,r){r?this._focusMonitor.focusVia(this._inputElement,r,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,r)=>{e!==this.id&&r===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new RL(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(e){e.stopPropagation()}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){const r=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),r&&this.radioGroup._emitChangeEvent())}}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_updateTabIndex(){const e=this.radioGroup;let r;if(r=e&&e.selected&&!this.disabled?e.selected===this?this.tabIndex:-1:this.tabIndex,r!==this._previousTabIndex){const l=this._inputElement?.nativeElement;l&&(l.setAttribute("tabindex",r+""),this._previousTabIndex=r)}}}return n.\u0275fac=function(e){$s()},n.\u0275dir=Ze({type:n,viewQuery:function(e,r){if(1&e&&Ti(D9,5),2&e){let l;Ot(l=Kt())&&(r._inputElement=l.first)}},inputs:{id:"id",name:"name",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],checked:"checked",value:"value",labelPosition:"labelPosition",disabled:"disabled",required:"required",color:"color"},outputs:{change:"change"},features:[Et]}),n})(),OL=(()=>{class n extends I9{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Fn(n)))(r||n)}}(),n.\u0275dir=Ze({type:n,selectors:[["mat-radio-group"]],contentQueries:function(e,r,l){if(1&e&&vi(l,NL,5),2&e){let d;Ot(d=Kt())&&(r._radios=d)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],exportAs:["matRadioGroup"],features:[Ht([k9,{provide:FL,useExisting:n}]),Et]}),n})(),NL=(()=>{class n extends F9{constructor(e,r,l,d,h,_,x,D){super(e,r,l,d,h,_,x,D)}}return n.\u0275fac=function(e){return new(e||n)(re(FL,8),re(Ut),re(ir),re(yc),re(S9),re(no,8),re(M9,8),va("tabindex"))},n.\u0275cmp=Mn({type:n,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-mdc-radio-button"],hostVars:15,hostBindings:function(e,r){1&e&&bn("focus",function(){return r._inputElement.nativeElement.focus()}),2&e&&(On("id",r.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),Wn("mat-primary","primary"===r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("mat-mdc-radio-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[Et],ngContentSelectors:E9,decls:13,vars:17,consts:[[1,"mdc-form-field"],["formField",""],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"id","checked","disabled","required","change"],["input",""],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[3,"for"]],template:function(e,r){if(1&e&&(cr(),ct(0,"div",0,1)(2,"div",2)(3,"div",3),bn("click",function(d){return r._onInputInteraction(d)}),dt(),ct(4,"input",4,5),bn("change",function(d){return r._onInputInteraction(d)}),dt(),ct(6,"div",6),yn(7,"div",7)(8,"div",8),dt(),ct(9,"div",9),yn(10,"div",10),dt()(),ct(11,"label",11),Sn(12),dt()()),2&e){const l=Gr(1);Wn("mdc-form-field--align-end","before"==r.labelPosition),Ct(2),Wn("mdc-radio--disabled",r.disabled),Ct(2),Dt("id",r.inputId)("checked",r.checked)("disabled",r.disabled)("required",r.required),On("name",r.name)("value",r.value)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby),Ct(5),Dt("matRippleTrigger",l)("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0),Ct(2),Dt("for",r.inputId)}},dependencies:[al],styles:['.mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color}.mdc-radio[hidden]{display:none}.mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1),border-color 120ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;z-index:1}.mdc-radio--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-radio--touch .mdc-radio__native-control{top:calc((40px - 48px) / 2);right:calc((40px - 48px) / 2);left:calc((40px - 48px) / 2);width:48px;height:48px}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring{border-color:CanvasText}}.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__focus-ring::after,.mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__focus-ring::after{border-color:CanvasText}}.mdc-radio__native-control:checked+.mdc-radio__background,.mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio--disabled{cursor:default;pointer-events:none}.mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1),border-color 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-radio__native-control:disabled+.mdc-radio__background,[aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background{cursor:default}.mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 120ms 0ms cubic-bezier(0, 0, 0.2, 1),transform 120ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{padding:calc((var(--mdc-radio-state-layer-size, 40px) - 20px) / 2)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, #000)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, #000)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:checked+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, #000)}.mat-mdc-radio-button .mdc-radio [aria-disabled=true] .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio.mdc-ripple-upgraded--background-focused .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio:not(.mdc-ripple-upgraded):focus .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-focus-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-hover-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-pressed-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color, #6200ee)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color, #000)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color, #000)}.mat-mdc-radio-button .mdc-radio:not(:disabled):active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color, #000)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{top:calc(-1 * (var(--mdc-radio-state-layer-size, 40px) - 20px) / 2);left:calc(-1 * (var(--mdc-radio-state-layer-size, 40px) - 20px) / 2);width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control{top:calc((var(--mdc-radio-state-layer-size, 40px) - var(--mdc-radio-state-layer-size, 40px)) / 2);right:calc((var(--mdc-radio-state-layer-size, 40px) - var(--mdc-radio-state-layer-size, 40px)) / 2);left:calc((var(--mdc-radio-state-layer-size, 40px) - var(--mdc-radio-state-layer-size, 40px)) / 2);width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio .mdc-radio__background::before{background-color:var(--mat-mdc-radio-ripple-color, transparent)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-mdc-radio-checked-ripple-color, transparent)}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element{background-color:var(--mat-mdc-radio-checked-ripple-color, transparent)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}[dir=rtl] .mat-mdc-radio-touch-target{left:0;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0}),n})(),O9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,Yr,ks,un]}),n})();const N9=["tooltip"],PL=new Ye("mat-tooltip-scroll-strategy"),B9={provide:PL,deps:[Ga],useFactory:function L9(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},V9=new Ye("mat-tooltip-default-options",{providedIn:"root",factory:function z9(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),LL="tooltip-panel",BL=yh({passive:!0});let $9=(()=>{class n{constructor(e,r,l,d,h,_,x,D,I,V,ne,he){this._overlay=e,this._elementRef=r,this._scrollDispatcher=l,this._viewContainerRef=d,this._ngZone=h,this._platform=_,this._ariaDescriber=x,this._focusMonitor=D,this._dir=V,this._defaultOptions=ne,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new Le,this._scrollStrategy=I,this._document=he,ne&&(ne.position&&(this.position=ne.position),ne.positionAtOrigin&&(this.positionAtOrigin=ne.positionAtOrigin),ne.touchGestures&&(this.touchGestures=ne.touchGestures)),V.change.pipe(Si(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(e){this._positionAtOrigin=xn(e),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=Mo(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=Mo(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=e?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Si(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([r,l])=>{e.removeEventListener(r,l,BL)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay,r){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const l=this._createOverlay(r);this._detach(),this._portal=this._portal||new g_(this._tooltipComponent,this._viewContainerRef);const d=this._tooltipInstance=l.attach(this._portal).instance;d._triggerElement=this._elementRef.nativeElement,d._mouseLeaveHideDelay=this._hideDelay,d.afterHidden().pipe(Si(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),d.show(e)}hide(e=this.hideDelay){const r=this._tooltipInstance;r&&(r.isVisible()?r.hide(e):(r._cancelPendingAnimations(),this._detach()))}toggle(e){this._isTooltipVisible()?this.hide():this.show(void 0,e)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(e){if(this._overlayRef){const d=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!e)&&d._origin instanceof Ut)return this._overlayRef;this._detach()}const r=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),l=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&e||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(r);return l.positionChanges.pipe(Si(this._destroyed)).subscribe(d=>{this._updateCurrentPositionClass(d.connectionPair),this._tooltipInstance&&d.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:l,panelClass:`${this._cssClassPrefix}-${LL}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Si(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Si(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Si(this._destroyed)).subscribe(d=>{this._isTooltipVisible()&&27===d.keyCode&&!bc(d)&&(d.preventDefault(),d.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){const r=e.getConfig().positionStrategy,l=this._getOrigin(),d=this._getOverlayPosition();r.withPositions([this._addOffset({...l.main,...d.main}),this._addOffset({...l.fallback,...d.fallback})])}_addOffset(e){return e}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,r=this.position;let l;"above"==r||"below"==r?l={originX:"center",originY:"above"==r?"top":"bottom"}:"before"==r||"left"==r&&e||"right"==r&&!e?l={originX:"start",originY:"center"}:("after"==r||"right"==r&&e||"left"==r&&!e)&&(l={originX:"end",originY:"center"});const{x:d,y:h}=this._invertPosition(l.originX,l.originY);return{main:l,fallback:{originX:d,originY:h}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,r=this.position;let l;"above"==r?l={overlayX:"center",overlayY:"bottom"}:"below"==r?l={overlayX:"center",overlayY:"top"}:"before"==r||"left"==r&&e||"right"==r&&!e?l={overlayX:"end",overlayY:"center"}:("after"==r||"right"==r&&e||"left"==r&&!e)&&(l={overlayX:"start",overlayY:"center"});const{x:d,y:h}=this._invertPosition(l.overlayX,l.overlayY);return{main:l,fallback:{overlayX:d,overlayY:h}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(Kr(1),Si(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,r){return"above"===this.position||"below"===this.position?"top"===r?r="bottom":"bottom"===r&&(r="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:r}}_updateCurrentPositionClass(e){const{overlayY:r,originX:l,originY:d}=e;let h;if(h="center"===r?this._dir&&"rtl"===this._dir.value?"end"===l?"left":"right":"start"===l?"left":"right":"bottom"===r&&"top"===d?"above":"below",h!==this._currentPosition){const _=this._overlayRef;if(_){const x=`${this._cssClassPrefix}-${LL}-`;_.removePanelClass(x+this._currentPosition),_.addPanelClass(x+h)}this._currentPosition=h}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",e=>{let r;this._setupPointerExitEventsIfNeeded(),void 0!==e.x&&void 0!==e.y&&(r=e),this.show(void 0,r)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",e=>{const r=e.targetTouches?.[0],l=r?{x:r.clientX,y:r.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,l),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",r=>{const l=r.relatedTarget;(!l||!this._overlayRef?.overlayElement.contains(l))&&this.hide()}],["wheel",r=>this._wheelListener(r)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const r=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};e.push(["touchend",r],["touchcancel",r])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([r,l])=>{this._elementRef.nativeElement.addEventListener(r,l,BL)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){const r=this._document.elementFromPoint(e.clientX,e.clientY),l=this._elementRef.nativeElement;r!==l&&!l.contains(r)&&this.hide()}}_disableNativeGesturesIfNecessary(){const e=this.touchGestures;if("off"!==e){const r=this._elementRef.nativeElement,l=r.style;("on"===e||"INPUT"!==r.nodeName&&"TEXTAREA"!==r.nodeName)&&(l.userSelect=l.msUserSelect=l.webkitUserSelect=l.MozUserSelect="none"),("on"===e||!r.draggable)&&(l.webkitUserDrag="none"),l.touchAction="none",l.webkitTapHighlightColor="transparent"}}}return n.\u0275fac=function(e){$s()},n.\u0275dir=Ze({type:n,inputs:{position:["matTooltipPosition","position"],positionAtOrigin:["matTooltipPositionAtOrigin","positionAtOrigin"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),n})(),zL=(()=>{class n extends $9{constructor(e,r,l,d,h,_,x,D,I,V,ne,he){super(e,r,l,d,h,_,x,D,I,V,ne,he),this._tooltipComponent=Y9,this._cssClassPrefix="mat-mdc",this._viewportMargin=8}_addOffset(e){const l=!this._dir||"ltr"==this._dir.value;return"top"===e.originY?e.offsetY=-8:"bottom"===e.originY?e.offsetY=8:"start"===e.originX?e.offsetX=l?-8:8:"end"===e.originX&&(e.offsetX=l?8:-8),e}}return n.\u0275fac=function(e){return new(e||n)(re(Ga),re(Ut),re(ox),re(Lr),re(ln),re(yr),re(EU),re(yc),re(PL),re(Es,8),re(V9,8),re(Mt))},n.\u0275dir=Ze({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],exportAs:["matTooltip"],features:[Et]}),n})(),q9=(()=>{class n{constructor(e,r){this._changeDetectorRef=e,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Le,this._animationsDisabled="NoopAnimations"===r}show(e){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){const r=this._tooltip.nativeElement,l=this._showAnimation,d=this._hideAnimation;if(r.classList.remove(e?d:l),r.classList.add(e?l:d),this._isVisible=e,e&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const h=getComputedStyle(r);("0s"===h.getPropertyValue("animation-duration")||"none"===h.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(r.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}}return n.\u0275fac=function(e){return new(e||n)(re(ir),re(no,8))},n.\u0275dir=Ze({type:n}),n})(),Y9=(()=>{class n extends q9{constructor(e,r,l){super(e,l),this._elementRef=r,this._isMultiline=!1,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide"}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const e=this._elementRef.nativeElement.getBoundingClientRect();return e.height>24&&e.width>=200}}return n.\u0275fac=function(e){return new(e||n)(re(ir),re(Ut),re(no,8))},n.\u0275cmp=Mn({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(e,r){if(1&e&&Ti(N9,7),2&e){let l;Ot(l=Kt())&&(r._tooltip=l.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,r){1&e&&bn("mouseleave",function(d){return r._handleMouseLeave(d)}),2&e&&Qs("zoom",r.isVisible()?1:null)},features:[Et],decls:4,vars:4,consts:[[1,"mdc-tooltip","mdc-tooltip--shown","mat-mdc-tooltip",3,"ngClass","animationend"],["tooltip",""],[1,"mdc-tooltip__surface","mdc-tooltip__surface-animation"]],template:function(e,r){1&e&&(ct(0,"div",0,1),bn("animationend",function(d){return r._handleAnimationEnd(d)}),ct(2,"div",2),gn(3),dt()()),2&e&&(Wn("mdc-tooltip--multiline",r._isMultiline),Dt("ngClass",r.tooltipClass),Ct(3),Gp(r.message))},dependencies:[aO],styles:['.mdc-tooltip__surface{word-break:var(--mdc-tooltip-word-break, normal);overflow-wrap:anywhere}.mdc-tooltip{position:fixed;display:none;z-index:9}.mdc-tooltip-wrapper--rich{position:relative}.mdc-tooltip--shown,.mdc-tooltip--showing,.mdc-tooltip--hide{display:inline-flex}.mdc-tooltip--shown.mdc-tooltip--rich,.mdc-tooltip--showing.mdc-tooltip--rich,.mdc-tooltip--hide.mdc-tooltip--rich{display:inline-block;left:-320px;position:absolute}.mdc-tooltip__surface{line-height:16px;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center}.mdc-tooltip__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-tooltip__surface::before{border-color:CanvasText}}.mdc-tooltip--rich .mdc-tooltip__surface{align-items:flex-start;display:flex;flex-direction:column;min-height:24px;min-width:40px;max-width:320px;position:relative}.mdc-tooltip--multiline .mdc-tooltip__surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mdc-tooltip__surface,.mdc-tooltip--multiline .mdc-tooltip__surface[dir=rtl]{text-align:right}.mdc-tooltip__surface .mdc-tooltip__title{margin:0 8px}.mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(200px - (2 * 8px));margin:8px;text-align:left}[dir=rtl] .mdc-tooltip__surface .mdc-tooltip__content,.mdc-tooltip__surface .mdc-tooltip__content[dir=rtl]{text-align:right}.mdc-tooltip--rich .mdc-tooltip__surface .mdc-tooltip__content{max-width:calc(320px - (2 * 8px));align-self:stretch}.mdc-tooltip__surface .mdc-tooltip__content-link{text-decoration:none}.mdc-tooltip--rich-actions,.mdc-tooltip__content,.mdc-tooltip__title{z-index:1}.mdc-tooltip__surface-animation{opacity:0;transform:scale(0.8);will-change:transform,opacity}.mdc-tooltip--shown .mdc-tooltip__surface-animation{transform:scale(1);opacity:1}.mdc-tooltip--hide .mdc-tooltip__surface-animation{transform:scale(1)}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{position:absolute;height:24px;width:24px;transform:rotate(35deg) skewY(20deg) scaleX(0.9396926208)}.mdc-tooltip__caret-surface-top .mdc-elevation-overlay,.mdc-tooltip__caret-surface-bottom .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-tooltip__caret-surface-bottom{outline:1px solid rgba(0,0,0,0);z-index:-1}@media screen and (forced-colors: active){.mdc-tooltip__caret-surface-bottom{outline-color:CanvasText}}.mdc-tooltip__surface{background-color:var(--mdc-plain-tooltip-container-color, #fff)}.mdc-tooltip__surface{border-radius:var(--mdc-plain-tooltip-container-shape, var(--mdc-shape-small, 4px))}.mdc-tooltip__caret-surface-top,.mdc-tooltip__caret-surface-bottom{border-radius:var(--mdc-plain-tooltip-container-shape, var(--mdc-shape-small, 4px))}.mdc-tooltip__surface{color:var(--mdc-plain-tooltip-supporting-text-color, #000)}.mdc-tooltip__surface{font-family:var(--mdc-plain-tooltip-supporting-text-font, inherit);font-size:var(--mdc-plain-tooltip-supporting-text-size, inherit);font-weight:var(--mdc-plain-tooltip-supporting-text-weight, inherit);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, inherit)}.mat-mdc-tooltip{position:relative;transform:scale(0)}.mat-mdc-tooltip::before{content:"";top:-8px;right:-8px;bottom:-8px;left:-8px;z-index:-1;position:absolute}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0}),n})(),VL=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[B9],imports:[Z0,Yr,xh,un,un,Hd]}),n})();const UL=yh({passive:!0});let K9=(()=>{class n{constructor(e,r){this._platform=e,this._ngZone=r,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Oo;const r=Vd(e),l=this._monitoredElements.get(r);if(l)return l.subject;const d=new Le,h="cdk-text-field-autofilled",_=x=>{"cdk-text-field-autofill-start"!==x.animationName||r.classList.contains(h)?"cdk-text-field-autofill-end"===x.animationName&&r.classList.contains(h)&&(r.classList.remove(h),this._ngZone.run(()=>d.next({target:x.target,isAutofilled:!1}))):(r.classList.add(h),this._ngZone.run(()=>d.next({target:x.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",_,UL),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:d,unlisten:()=>{r.removeEventListener("animationstart",_,UL)}}),d}stopMonitoring(e){const r=Vd(e),l=this._monitoredElements.get(r);l&&(l.unlisten(),l.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((e,r)=>this.stopMonitoring(r))}}return n.\u0275fac=function(e){return new(e||n)(ee(yr),ee(ln))},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),X9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();const Z9=["matFormFieldNotchedOutline",""],Q9=["*"],J9=["textField"],eW=["iconPrefixContainer"],tW=["textPrefixContainer"];function nW(n,t){1&n&&yn(0,"span",19)}function iW(n,t){if(1&n){const e=Zs();ct(0,"label",17),bn("cdkObserveContent",function(){return ts(e),hs(qn(2)._refreshOutlineNotchWidth())}),Sn(1,1),Bt(2,nW,1,0,"span",18),dt()}if(2&n){const e=qn(2);Dt("floating",e._shouldLabelFloat())("cdkObserveContentDisabled",!e._hasOutline())("id",e._labelId),On("for",e._control.id)("aria-owns",e._control.id),Ct(2),Dt("ngIf",!e.hideRequiredMarker&&e._control.required)}}function rW(n,t){1&n&&Bt(0,iW,3,6,"label",16),2&n&&Dt("ngIf",qn()._hasFloatingLabel())}function oW(n,t){1&n&&yn(0,"div",20)}function aW(n,t){}function sW(n,t){1&n&&Bt(0,aW,0,0,"ng-template",22),2&n&&(qn(2),Dt("ngTemplateOutlet",Gr(1)))}function lW(n,t){if(1&n&&(ct(0,"div",21),Bt(1,sW,1,1,"ng-template",9),dt()),2&n){const e=qn();Dt("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat())("matFormFieldNotchedOutlineLabelWidth",e._labelWidth),Ct(1),Dt("ngIf",!e._forceDisplayInfixLabel())}}function cW(n,t){1&n&&(ct(0,"div",23,24),Sn(2,2),dt())}function dW(n,t){1&n&&(ct(0,"div",25,26),Sn(2,3),dt())}function uW(n,t){}function hW(n,t){1&n&&Bt(0,uW,0,0,"ng-template",22),2&n&&(qn(),Dt("ngTemplateOutlet",Gr(1)))}function pW(n,t){1&n&&(ct(0,"div",27),Sn(1,4),dt())}function fW(n,t){1&n&&(ct(0,"div",28),Sn(1,5),dt())}function mW(n,t){1&n&&yn(0,"div",29)}function gW(n,t){1&n&&(ct(0,"div",30),Sn(1,6),dt()),2&n&&Dt("@transitionMessages",qn()._subscriptAnimationState)}function _W(n,t){if(1&n&&(ct(0,"mat-hint",34),gn(1),dt()),2&n){const e=qn(2);Dt("id",e._hintLabelId),Ct(1),Gp(e.hintLabel)}}function vW(n,t){if(1&n&&(ct(0,"div",31),Bt(1,_W,2,2,"mat-hint",32),Sn(2,7),yn(3,"div",33),Sn(4,8),dt()),2&n){const e=qn();Dt("@transitionMessages",e._subscriptAnimationState),Ct(1),Dt("ngIf",e.hintLabel)}}const bW=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],yW=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let QA=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-label"]]}),n})();const xW=new Ye("MatError");let wW=0,HL=(()=>{class n{constructor(){this.align="start",this.id="mat-mdc-hint-"+wW++}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(e,r){2&e&&(fi("id",r.id),On("align",null),Wn("mat-mdc-form-field-hint-end","end"===r.align))},inputs:{align:"align",id:"id"}}),n})();const CW=new Ye("MatPrefix"),SW=new Ye("MatSuffix");let jL=(()=>{class n{constructor(e){this._elementRef=e,this.floating=!1}getWidth(){return function DW(n){if(null!==n.offsetParent)return n.scrollWidth;const e=n.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);const r=e.scrollWidth;return e.remove(),r}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}}return n.\u0275fac=function(e){return new(e||n)(re(Ut))},n.\u0275dir=Ze({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(e,r){2&e&&Wn("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating"}}),n})();const WL="mdc-line-ripple--active",SE="mdc-line-ripple--deactivating";let GL=(()=>{class n{constructor(e,r){this._elementRef=e,this._handleTransitionEnd=l=>{const d=this._elementRef.nativeElement.classList,h=d.contains(SE);"opacity"===l.propertyName&&h&&d.remove(WL,SE)},r.runOutsideAngular(()=>{e.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const e=this._elementRef.nativeElement.classList;e.remove(SE),e.add(WL)}deactivate(){this._elementRef.nativeElement.classList.add(SE)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ln))},n.\u0275dir=Ze({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]}),n})(),$L=(()=>{class n{constructor(e,r){this._elementRef=e,this._ngZone=r,this.labelWidth=0,this.open=!1}ngAfterViewInit(){const e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_getNotchWidth(){return this.open?this.labelWidth>0?`calc(${this.labelWidth}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:"0px":null}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ln))},n.\u0275cmp=Mn({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(e,r){2&e&&Wn("mdc-notched-outline--notched",r.open)},inputs:{labelWidth:["matFormFieldNotchedOutlineLabelWidth","labelWidth"],open:["matFormFieldNotchedOutlineOpen","open"]},attrs:Z9,ngContentSelectors:Q9,decls:4,vars:2,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(e,r){1&e&&(cr(),yn(0,"div",0),ct(1,"div",1),Sn(2),dt(),yn(3,"div",2)),2&e&&(Ct(1),Qs("width",r._getNotchWidth()))},encapsulation:2,changeDetection:0}),n})();const EW={transitionMessages:Tr("transitionMessages",[oi("enter",Qt({opacity:1,transform:"translateY(0%)"})),gi("void => enter",[Qt({opacity:0,transform:"translateY(-5px)"}),xi("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let JA=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n}),n})();const vx=new Ye("MatFormField"),kW=new Ye("MAT_FORM_FIELD_DEFAULT_OPTIONS");let qL=0,IW=(()=>{class n{constructor(e,r,l,d,h,_,x,D){this._elementRef=e,this._changeDetectorRef=r,this._ngZone=l,this._dir=d,this._platform=h,this._defaults=_,this._animationMode=x,this._document=D,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+qL++,this._hintLabelId="mat-mdc-hint-"+qL++,this._subscriptAnimationState="",this._labelWidth=0,this._destroyed=new Le,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,_&&(_.appearance&&(this.appearance=_.appearance),this._hideRequiredMarker=Boolean(_?.hideRequiredMarker),_.color&&(this.color=_.color))}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=xn(e)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(e){const r=this._appearance;this._appearance=e||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==r&&(this._refreshOutlineNotchWidth(),this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}ngAfterViewInit(){this._updateFocusState(),this._refreshOutlineNotchWidth(),this._document?.fonts?.ready?this._document.fonts.ready.then(()=>{this._refreshOutlineNotchWidth(),this._changeDetectorRef.markForCheck()}):setTimeout(()=>this._refreshOutlineNotchWidth(),100),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${e.controlType}`),e.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(Si(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Ra(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Si(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(Si(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(e){const r=this._control?this._control.ngControl:null;return r&&r[e]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||(this._labelWidth=this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const r=this._hintChildren?this._hintChildren.find(d=>"start"===d.align):null,l=this._hintChildren?this._hintChildren.find(d=>"end"===d.align):null;r?e.push(r.id):this._hintLabel&&e.push(this._hintLabelId),l&&e.push(l.id)}else this._errorChildren&&e.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const e=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(e.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const r=this._iconPrefixContainer?.nativeElement,l=this._textPrefixContainer?.nativeElement,d=r?.getBoundingClientRect().width??0,h=l?.getBoundingClientRect().width??0;e.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${d+h}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const e=this._elementRef.nativeElement;if(e.getRootNode){const r=e.getRootNode();return r&&r!==e}return document.documentElement.contains(e)}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(ir),re(ln),re(Es),re(yr),re(kW,8),re(no,8),re(Mt))},n.\u0275cmp=Mn({type:n,selectors:[["mat-form-field"]],contentQueries:function(e,r,l){if(1&e&&(vi(l,QA,5),vi(l,QA,7),vi(l,JA,5),vi(l,CW,5),vi(l,SW,5),vi(l,xW,5),vi(l,HL,5)),2&e){let d;Ot(d=Kt())&&(r._labelChildNonStatic=d.first),Ot(d=Kt())&&(r._labelChildStatic=d.first),Ot(d=Kt())&&(r._formFieldControl=d.first),Ot(d=Kt())&&(r._prefixChildren=d),Ot(d=Kt())&&(r._suffixChildren=d),Ot(d=Kt())&&(r._errorChildren=d),Ot(d=Kt())&&(r._hintChildren=d)}},viewQuery:function(e,r){if(1&e&&(Ti(J9,5),Ti(eW,5),Ti(tW,5),Ti(jL,5),Ti($L,5),Ti(GL,5)),2&e){let l;Ot(l=Kt())&&(r._textField=l.first),Ot(l=Kt())&&(r._iconPrefixContainer=l.first),Ot(l=Kt())&&(r._textPrefixContainer=l.first),Ot(l=Kt())&&(r._floatingLabel=l.first),Ot(l=Kt())&&(r._notchedOutline=l.first),Ot(l=Kt())&&(r._lineRipple=l.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(e,r){2&e&&Wn("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===r._animationMode)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary","accent"!==r.color&&"warn"!==r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Ht([{provide:vx,useExisting:n}])],ngContentSelectors:yW,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(e,r){1&e&&(cr(bW),Bt(0,rW,1,1,"ng-template",null,0,af),ct(2,"div",1,2),bn("click",function(d){return r._control.onContainerClick&&r._control.onContainerClick(d)}),Bt(4,oW,1,0,"div",3),ct(5,"div",4),Bt(6,lW,2,3,"div",5),Bt(7,cW,3,0,"div",6),Bt(8,dW,3,0,"div",7),ct(9,"div",8),Bt(10,hW,1,1,"ng-template",9),Sn(11),dt(),Bt(12,pW,2,0,"div",10),Bt(13,fW,2,0,"div",11),dt(),Bt(14,mW,1,0,"div",12),dt(),ct(15,"div",13),Bt(16,gW,2,1,"div",14),Bt(17,vW,5,2,"div",15),dt()),2&e&&(Ct(2),Wn("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),Ct(2),Dt("ngIf",!r._hasOutline()&&!r._control.disabled),Ct(2),Dt("ngIf",r._hasOutline()),Ct(1),Dt("ngIf",r._hasIconPrefix),Ct(1),Dt("ngIf",r._hasTextPrefix),Ct(2),Dt("ngIf",!r._hasOutline()||r._forceDisplayInfixLabel()),Ct(2),Dt("ngIf",r._hasTextSuffix),Ct(1),Dt("ngIf",r._hasIconSuffix),Ct(1),Dt("ngIf",!r._hasOutline()),Ct(1),Wn("mat-mdc-form-field-subscript-dynamic-size","dynamic"===r.subscriptSizing),Dt("ngSwitch",r._getDisplayedMessages()),Ct(1),Dt("ngSwitchCase","error"),Ct(1),Dt("ngSwitchCase","hint"))},dependencies:[gc,eI,C0,JT,fP,HL,jL,$L,GL],styles:['.mdc-text-field{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required::after,.mdc-floating-label--required[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{line-height:normal;pointer-events:all}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-10.25px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-10.25px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}'],encapsulation:2,data:{animation:[EW.transitionMessages]},changeDetection:0}),n})(),eR=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,Yr,zD,un]}),n})();const XL=new Ye("MAT_INPUT_VALUE_ACCESSOR"),AW=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let RW=0;const FW=RP(class{constructor(n,t,e,r){this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=e,this.ngControl=r,this.stateChanges=new Le}});let OW=(()=>{class n extends FW{constructor(e,r,l,d,h,_,x,D,I,V){super(_,d,h,l),this._elementRef=e,this._platform=r,this._autofillMonitor=D,this._formField=V,this._uid="mat-input-"+RW++,this.focused=!1,this.stateChanges=new Le,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(Ce=>lP().has(Ce)),this._iOSKeyupListener=Ce=>{const Ae=Ce.target;!Ae.value&&0===Ae.selectionStart&&0===Ae.selectionEnd&&(Ae.setSelectionRange(1,1),Ae.setSelectionRange(0,0))};const ne=this._elementRef.nativeElement,he=ne.nodeName.toLowerCase();this._inputValueAccessor=x||ne,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&I.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===he,this._isTextarea="textarea"===he,this._isInFormField=!!V,this._isNativeSelect&&(this.controlType=ne.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this._disabled}set disabled(e){this._disabled=xn(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(SA.required)??!1}set required(e){this._required=xn(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&lP().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=xn(e)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){const e=this._getPlaceholder();if(e!==this._previousPlaceholder){const r=this._elementRef.nativeElement;this._previousPlaceholder=e,e?r.setAttribute("placeholder",e):r.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){AW.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,r=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&r&&r.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(yr),re(Cc,10),re(px,8),re(fx,8),re(WD),re(XL,10),re(K9),re(ln),re(vx,8))},n.\u0275dir=Ze({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(e,r){1&e&&bn("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&e&&(fi("id",r.id)("disabled",r.disabled)("required",r.required),On("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),Wn("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Ht([{provide:JA,useExisting:n}]),Et,Ki]}),n})(),NW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,eR,eR,X9,un]}),n})();function PW(n,t){if(1&n){const e=Zs();$r(0),ct(1,"p")(2,"mat-form-field",2)(3,"mat-label"),gn(4,"\u5206\u985e\u5668\u540d"),dt(),ct(5,"input",3),bn("ngModelChange",function(l){return hs(ts(e).$implicit.name=l)})("ngModelChange",function(){return ts(e),hs(qn().save())}),dt()(),ct(6,"mat-form-field")(7,"mat-label"),gn(8,"\u30e2\u30c7\u30eb\u306eURL (model.json \u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea)"),dt(),ct(9,"input",4),bn("ngModelChange",function(l){return hs(ts(e).$implicit.url=l)})("ngModelChange",function(){return ts(e),hs(qn().save())}),dt()(),ct(10,"button",5),bn("click",function(){const d=ts(e).index;return hs(qn().deleteClassifier(d))}),ct(11,"mat-icon"),gn(12,"remove_circle"),dt()()(),to()}if(2&n){const e=t.$implicit;Ct(5),Dt("ngModel",e.name),Ct(4),Dt("ngModel",e.url)}}class bx{constructor(){this.extendedClassifierDefinitions=[],this.extendedClassifierDefinitionsChange=new En,this.DEFAULT_CLASSIFIER_DEFINITIONS=[{name:"faceExp",url:"https://arisucool.github.io/tf-cg-stage-face-expression-classifier/tfjs/",target:"faceFrameImage"}],this.LOCAL_STORAGE_KEY="mpVideoPoseExtractorExtClassifiers"}ngOnInit(){this.load()}ngOnDestroy(){this.saveTimer&&this.saveTimer.unsubscribe()}addClassifier(){this.extendedClassifierDefinitions.push({name:"",url:"",target:"faceFrameImage"})}deleteClassifier(t){this.extendedClassifierDefinitions.splice(t,1)}load(){const t=window.localStorage.getItem(this.LOCAL_STORAGE_KEY);this.extendedClassifierDefinitions=t?JSON.parse(t):this.DEFAULT_CLASSIFIER_DEFINITIONS,this.extendedClassifierDefinitionsChange.emit(this.extendedClassifierDefinitions)}save(){this.saveTimer&&this.saveTimer.unsubscribe(),this.extendedClassifierDefinitionsChange.emit(this.extendedClassifierDefinitions),this.saveTimer=vA(500).subscribe(()=>{const t=[];for(const r of this.extendedClassifierDefinitions)r.name&&r.url&&t.push(r);let e=!1;if(t.length!==this.DEFAULT_CLASSIFIER_DEFINITIONS.length)e=!0;else for(let r=0;r<t.length;r++)if(t[r].name!==this.DEFAULT_CLASSIFIER_DEFINITIONS[r].name||t[r].url!==this.DEFAULT_CLASSIFIER_DEFINITIONS[r].url){e=!0;break}e?window.localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(this.extendedClassifierDefinitions)):window.localStorage.removeItem(this.LOCAL_STORAGE_KEY)})}}bx.\u0275fac=function(t){return new(t||bx)},bx.\u0275cmp=Mn({type:bx,selectors:[["app-extended-classifier"]],inputs:{extendedClassifierDefinitions:"extendedClassifierDefinitions"},outputs:{extendedClassifierDefinitionsChange:"extendedClassifierDefinitionsChange"},decls:4,vars:1,consts:[[4,"ngFor","ngForOf"],["mat-icon-button","","matTooltip","\u5206\u985e\u5668\u3092\u8ffd\u52a0","color","primary",2,"float","right",3,"click"],[2,"width","40%","min-width","150px"],["matInput","","placeholder","fooBar",3,"ngModel","ngModelChange"],["matInput","","placeholder","https://***/",3,"ngModel","ngModelChange"],["mat-icon-button","","color","warn","matTooltip","\u5206\u985e\u5668\u3092\u524a\u9664",2,"float","right",3,"click"]],template:function(t,e){1&t&&(Bt(0,PW,13,2,"ng-container",0),ct(1,"button",1),bn("click",function(){return e.addClassifier()}),ct(2,"mat-icon"),gn(3,"add_circle"),dt()()),2&t&&Dt("ngForOf",e.extendedClassifierDefinitions)},dependencies:[tD,tE,MA,uE,CH,XA,OW,IW,QA,zL],styles:["[_nghost-%COMP%]{margin:1rem}p[_ngcontent-%COMP%]{display:flex;gap:1rem;margin:0;padding:0}mat-form-field[_ngcontent-%COMP%]{width:100%}"]});const LW=["sourceVideo"];function BW(n,t){if(1&n&&(ct(0,"small"),gn(1),dt()),2&n){const e=qn();Ct(1),ta(" \xa0\xa0 ",e.sourceVideoFileName," ")}}function zW(n,t){1&n&&($r(0),gn(1," \u62bd\u51fa\u7d50\u679c "),to())}function VW(n,t){if(1&n&&($r(0),gn(1),to()),2&n){const e=qn(2);Ct(1),ta(" ",e.mathFloor((e.numOfSourceVideoFrames-e.sourceVideoFrames.length)/e.numOfSourceVideoFrames*100),"% ")}}function UW(n,t){if(1&n&&($r(0),gn(1," \u62bd\u51fa\u4e2d... "),Bt(2,VW,2,1,"ng-container",5),to()),2&n){const e=qn();Ct(2),Dt("ngIf",void 0!==e.sourceVideoFrames&&1<=e.sourceVideoFrames.length)}}function HW(n,t){if(1&n&&($r(0),gn(1),to()),2&n){const e=qn(2);Ct(1),ta(" ",e.mathFloor(e.sourceVideoFrames[e.sourceVideoFrames.length-1].timestamp/1e3),"s ")}}function jW(n,t){if(1&n&&($r(0),gn(1," \u30c7\u30b3\u30fc\u30c9\u4e2d... "),Bt(2,HW,2,1,"ng-container",5),to()),2&n){const e=qn();Ct(2),Dt("ngIf",void 0!==e.sourceVideoFrames&&1<=e.sourceVideoFrames.length)}}function WW(n,t){1&n&&($r(0),gn(1,"-"),to())}function GW(n,t){if(1&n&&($r(0),gn(1),to()),2&n){const e=qn();Ct(1),ta(" ",null==e.poseSet?null:e.poseSet.getNumberOfPoses()," ")}}function $W(n,t){if(1&n&&(ct(0,"div",10)(1,"p",11),gn(2,"\u5168\u4f53\u306e\u691c\u51fa\u7d50\u679c"),dt(),yn(3,"video",12,16),dt()),2&n){const e=qn();Ct(3),Dt("srcObject",e.posePreviewMediaStream)}}function qW(n,t){if(1&n&&(ct(0,"div",10)(1,"p",11),gn(2,"\u9854\u306e\u691c\u51fa\u7d50\u679c"),dt(),yn(3,"video",12),dt()),2&n){const e=qn();Ct(3),Dt("srcObject",e.facePreviewMediaStream)}}function YW(n,t){if(1&n&&(ct(0,"div",10)(1,"p",11),gn(2,"\u624b\u306e\u691c\u51fa\u7d50\u679c"),dt(),yn(3,"video",12),dt()),2&n){const e=qn();Ct(3),Dt("srcObject",e.handPreviewMediaStream)}}function KW(n,t){if(1&n&&(ct(0,"div",21),function KC(n,t){const e=wi();let r;const l=n+22;e.firstCreatePass?(r=function J2(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[l]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(l,r.onDestroy)):r=e.data[l];const d=r.factory||(r.factory=vl(r.type)),h=Go(re);try{const _=ep(!1),x=d();return ep(_),function vg(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,vt(),l,x),x}finally{Go(h)}}(1,"json"),ct(2,"p",11),gn(3),dt(),yn(4,"img",22),dt()),2&n){const e=t.$implicit,r=qn(2);yg("matTooltip",function XC(n,t,e){const r=n+22,l=vt(),d=fu(l,r);return function ef(n,t){return n[1].data[t].pure}(l,r)?WC(l,Hr(),t,d.transform,e,d):d.transform(e)}(1,3,e.extendedData)),Ct(3),Gp(e.timeMiliseconds),Ct(1),Dt("src","pose"===r.previewImage?e.poseImageDataUrl:e.frameImageDataUrl,Qm)}}function XW(n,t){if(1&n){const e=Zs();ct(0,"mat-card",9)(1,"mat-card-header")(2,"mat-card-title"),gn(3," \u691c\u51fa\u3055\u308c\u305f\u30dd\u30fc\u30ba "),dt()(),ct(4,"mat-card-content")(5,"div")(6,"mat-radio-group",17),bn("ngModelChange",function(l){return ts(e),hs(qn().previewImage=l)}),ct(7,"mat-radio-button",18),gn(8," \u30d5\u30ec\u30fc\u30e0\u753b\u50cf "),dt(),ct(9,"mat-radio-button",19),gn(10," \u30dd\u30fc\u30ba\u753b\u50cf "),dt()()(),Bt(11,KW,5,5,"div",20),dt()()}if(2&n){const e=qn();let r;Ct(6),Dt("ngModel",e.previewImage),Ct(5),Dt("ngForOf",null==e.poseSet||null==(r=e.poseSet.getPoses())?null:r.slice())}}class yx{constructor(t,e,r,l,d,h,_){this.poseComposerService=t,this.poseExtractorService=e,this.extendedClassifierService=r,this.domSanitizer=l,this.snackBar=d,this.ngZone=h,this.changeDetectorRef=_,this.sourceVideoFileName=void 0,this.state="initial",this.mathFloor=Math.floor,this.previewImage="frame",this.numOfSourceVideoFrames=0,this.sourceVideoLoadTimer=null,this.MINIMUM_FRAME_INTERVAL_MILISECONDS=250,this.extendedClassifierDefinitions=[]}ngOnInit(){this.onResultsEventEmitterSubscription=this.poseExtractorService.onResultsEventEmitter.subscribe(t=>{this.onPoseDetected(t)}),this.changeDetectorRef.detectChanges()}ngOnDestroy(){this.onResultsEventEmitterSubscription&&this.onResultsEventEmitterSubscription.unsubscribe()}onChooseSourceVideoFile(t){var e=this;return Ni(function*(){const r=t.target.files;if(0===r.length)return;const l=r[0],d=URL.createObjectURL(l);e.sourceVideoFileName=l.name;const h=l.name.split(".").slice(0,-1).join(".");e.state="loading",e.poseSet=e.poseComposerService.init(h);try{yield e.extendedClassifierService.init(e.extendedClassifierDefinitions)}catch(D){e.snackBar.open("\u30a8\u30e9\u30fc: \u5206\u985e\u5668\u306e\u521d\u671f\u5316\u306b\u5931\u6557..."+D.message,void 0,{duration:3e3})}e.sourceFrameCanvas=document.createElement("canvas"),e.sourceFrameCanvasContext=e.sourceFrameCanvas.getContext("2d"),e.sourceVideoFrames=[];const _=new VideoDecoder({output:(D=Ni(function*(I){e.lastFrameDrawedAt=Date.now(),yield e.onVideoFrame(I)}),function(V){return D.apply(this,arguments)}),error:D=>{console.error("[ExtractorPageComponent] onChooseSourceVideoFile - Error occurred",D)}});var D;new G6(d,{onConfig:D=>{_.configure(D)},onChunk:D=>{_.decode(D)},setStatus:(D,I)=>{console.log("[ExtractorPageComponent] - MP4Demuxer setStatus",D,I)}}),e.lastFrameDrawedAt=Date.now(),e.sourceVideoLoadTimer=setInterval(()=>{Date.now()-e.lastFrameDrawedAt>1e3&&(clearInterval(e.sourceVideoLoadTimer),e.onVideoAllFramesLoaded())},1e3)})()}onVideoFrame(t){var e=this;return Ni(function*(){const r=t.timestamp/1e3;if(void 0!==e.lastFrameChoosedAt&&r-e.lastFrameChoosedAt<e.MINIMUM_FRAME_INTERVAL_MILISECONDS)return void t.close();e.lastFrameChoosedAt=r,yield e.renderVideoFrame(t);const l=e.sourceFrameCanvas?.toDataURL();l&&e.sourceVideoFrames&&e.sourceVideoFrames.push({dataUrl:l,timestamp:r,width:t.codedWidth,height:t.codedHeight}),t.close()})()}renderVideoFrame(t){var e=this;return Ni(function*(){!e.sourceFrameCanvas||!e.sourceFrameCanvasContext||(e.sourceFrameCanvas.width=t.displayWidth,e.sourceFrameCanvas.height=t.displayHeight,e.sourceFrameCanvasContext.drawImage(t,0,0,e.sourceFrameCanvas.width,e.sourceFrameCanvas.height))})()}onVideoAllFramesLoaded(){var t=this;return Ni(function*(){if(t.sourceVideoFrames&&t.poseSet){if(t.numOfSourceVideoFrames=t.sourceVideoFrames.length,t.numOfSourceVideoFrames<=1)return t.snackBar.open("\u30a8\u30e9\u30fc: \u52d5\u753b\u306e\u30d5\u30ec\u30fc\u30e0\u6570\u304c\u5c11\u306a\u3059\u304e\u307e\u3059"),t.state="initial",void(t.poseSet=void 0);t.snackBar.open(t.numOfSourceVideoFrames+" frames \u304b\u3089\u30dd\u30fc\u30ba\u691c\u51fa\u3092\u304a\u3053\u306a\u3063\u3066\u3044\u307e\u3059... "),t.state="processing",console.log("[ExtractorPageComponent] - onVideoAllFramesLoaded",t.sourceVideoFrames),!t.sourceVideoStream&&t.sourceFrameCanvas&&(t.sourceVideoStream=t.sourceFrameCanvas.captureStream(30)),t.poseSet.setVideoMetaData(t.sourceVideoFrames[0].width,t.sourceVideoFrames[0].height,t.sourceVideoFrames[t.sourceVideoFrames.length-1].timestamp),t.posePreviewMediaStream=t.poseExtractorService.getPosePreviewMediaStream(),t.handPreviewMediaStream=t.poseExtractorService.getHandPreviewMediaStream(),t.facePreviewMediaStream=t.poseExtractorService.getFacePreviewMediaStream(),yield t.detectPoseOfNextVideoFrame()}})()}detectPoseOfNextVideoFrame(){var t=this;return Ni(function*(){if(!t.sourceFrameCanvas||!t.sourceFrameCanvasContext)throw new Error("sourceFrameCanvas is not initialized");if(!t.sourceVideoFrames)return;if(0===t.sourceVideoFrames.length)return void t.onPoseDetectionCompleted();const e=t.sourceVideoFrames.shift();if(!e)throw new Error("frame is not initialized");t.currentSourceVideoFrame=e;try{let r=new Image;r.src=e.dataUrl,yield r.decode(),t.sourceFrameCanvas.width=e.width,t.sourceFrameCanvas.height=e.height,t.sourceFrameCanvasContext.drawImage(r,0,0,t.sourceFrameCanvas.width,t.sourceFrameCanvas.height)}catch(r){return console.error("[ExtractorPageComponent] detectPoseOfNextVideoFrame - Error occurred",r,e),void(yield t.detectPoseOfNextVideoFrame())}t.poseExtractorService.onVideoFrame(t.sourceFrameCanvas)})()}onPoseDetected(t){var e=this;return Ni(function*(){if(!e.poseSet||!e.currentSourceVideoFrame)return;const l=Math.floor(e.currentSourceVideoFrame.timestamp),d=e.poseSet.pushPose(l,t.frameImageDataUrl,t.posePreviewImageDataUrl,t.faceFrameImageDataUrl,t.mpResults);d&&(d.extendedData=yield e.extendedClassifierService.classify(d)),yield e.detectPoseOfNextVideoFrame()})()}onPoseDetectionCompleted(){var t=this;return Ni(function*(){if(!t.poseSet)return;let e=t.snackBar.open("\u6700\u7d42\u51e6\u7406\u3092\u3057\u3066\u3044\u307e\u3059...");yield t.poseSet.finalize(),e.dismiss(),t.state="completed",e=t.snackBar.open("\u691c\u51fa\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f","\u4fdd\u5b58"),e.onAction().subscribe(()=>{t.downloadPosesAsZip()})})()}downloadPosesAsZip(){if(!this.poseSet)return;const t=this.snackBar.open("\u4fdd\u5b58\u3059\u308b\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059...");try{this.poseComposerService.downloadAsZip(this.poseSet)}catch(e){return console.error(e),t.dismiss(),void this.snackBar.open("\u30a8\u30e9\u30fc: "+e.toString(),"OK")}t.dismiss()}downloadPosesAsJson(){if(!this.poseSet)return;const t=this.snackBar.open("\u4fdd\u5b58\u3059\u308b\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059...");try{this.poseComposerService.downloadAsJson(this.poseSet)}catch(e){return console.error(e),t.dismiss(),void this.snackBar.open("\u30a8\u30e9\u30fc: "+e.toString(),"OK")}t.dismiss()}}yx.\u0275fac=function(t){return new(t||yx)(re(Nd),re(Ld),re(__),re(sD),re(CA),re(ln),re(ir))},yx.\u0275cmp=Mn({type:yx,selectors:[["app-extractor-page"]],viewQuery:function(t,e){if(1&t&&Ti(LW,5),2&t){let r;Ot(r=Kt())&&(e.sourceVideoElement=r.first)}},features:[Ht([Ld,Nd])],decls:58,vars:17,consts:[[1,"row"],[2,"padding","0.5rem 1rem 1rem 1rem"],["mat-raised-button","","color","primary",3,"disabled","click"],["type","file","accept",".mp4",2,"display","none",3,"change"],["fileChooser",""],[4,"ngIf"],[3,"extendedClassifierDefinitions","extendedClassifierDefinitionsChange"],["mat-button","","color","primary","matTooltip","\u30dd\u30fc\u30ba\u304a\u3088\u3073\u30d5\u30ec\u30fc\u30e0\u753b\u50cf\u3092 ZIP \u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059",3,"disabled","click"],["mat-button","","matTooltip","\u30dd\u30fc\u30ba\u306e\u307f\u3092 JSON \u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059",3,"disabled","click"],[1,"preview"],[1,"preview-video-container"],[1,"label"],["autoplay","","muted","",1,"preview-video",3,"srcObject"],["sourceVideo",""],["class","preview-video-container",4,"ngIf"],["class","preview",4,"ngIf"],["posePreviewVideo",""],[3,"ngModel","ngModelChange"],["value","frame"],["value","pose"],["class","preview-video-container",3,"matTooltip",4,"ngFor","ngForOf"],[1,"preview-video-container",3,"matTooltip"],[1,"preview-video",3,"src"]],template:function(t,e){if(1&t){const r=Zs();ct(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),gn(4," \u30dd\u30fc\u30ba\u62bd\u51fa "),dt(),ct(5,"mat-card-subtitle"),gn(6,"\u30dd\u30fc\u30ba\u3092\u62bd\u51fa\u3057\u305f\u3044\u52d5\u753b\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"),yn(7,"br"),gn(8," \u3053\u306e\u51e6\u7406\u306f\u30ed\u30fc\u30ab\u30eb\u3067\u884c\u308f\u308c\u3001\u30b5\u30fc\u30d0\u306b\u306f\u9001\u4fe1\u3055\u308c\u307e\u305b\u3093"),dt()(),ct(9,"mat-card-content",1)(10,"button",2),bn("click",function(){return ts(r),hs(Gr(15).click())}),ct(11,"mat-icon"),gn(12,"upload"),dt(),gn(13," \u52d5\u753b\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e "),dt(),ct(14,"input",3,4),bn("change",function(d){return e.onChooseSourceVideoFile(d)}),dt(),gn(16," \xa0 "),Bt(17,BW,2,1,"small",5),yn(18,"br"),ct(19,"app-extended-classifier",6),bn("extendedClassifierDefinitionsChange",function(d){return e.extendedClassifierDefinitions=d}),dt()()(),ct(20,"mat-card")(21,"mat-card-header")(22,"mat-card-title"),Bt(23,zW,2,0,"ng-container",5),Bt(24,UW,3,1,"ng-container",5),Bt(25,jW,3,1,"ng-container",5),dt(),ct(26,"mat-card-subtitle"),gn(27," \u30dd\u30fc\u30ba\u6570: "),Bt(28,WW,2,0,"ng-container",5),Bt(29,GW,2,1,"ng-container",5),dt()(),ct(30,"mat-card-content"),yn(31,"p"),dt(),ct(32,"mat-card-actions")(33,"button",7),bn("click",function(){return e.downloadPosesAsZip()}),ct(34,"mat-icon"),gn(35,"download"),dt(),gn(36," \u4fdd\u5b58 "),dt(),gn(37," \xa0\xa0 "),ct(38,"button",8),bn("click",function(){return e.downloadPosesAsJson()}),ct(39,"mat-icon"),gn(40,"download"),dt(),gn(41," \u30dd\u30fc\u30ba\u306e\u307f\u4fdd\u5b58 "),dt()()()(),ct(42,"div",0)(43,"mat-card",9)(44,"mat-card-header")(45,"mat-card-title"),gn(46," \u30d7\u30ec\u30d3\u30e5\u30fc "),dt()(),ct(47,"mat-card-content")(48,"div",10)(49,"p",11),gn(50,"\u30bd\u30fc\u30b9\u52d5\u753b"),dt(),yn(51,"video",12,13),dt(),Bt(53,$W,5,1,"div",14),Bt(54,qW,4,1,"div",14),Bt(55,YW,4,1,"div",14),dt()()(),ct(56,"div",0),Bt(57,XW,12,2,"mat-card",15),dt()}2&t&&(Ct(10),Dt("disabled","processing"===e.state),Ct(7),Dt("ngIf",void 0!==e.sourceVideoFileName),Ct(2),Dt("extendedClassifierDefinitions",e.extendedClassifierDefinitions),Ct(4),Dt("ngIf","initial"===e.state||"completed"===e.state),Ct(1),Dt("ngIf","processing"===e.state),Ct(1),Dt("ngIf","loading"===e.state),Ct(3),Dt("ngIf","initial"===e.state||"loading"===e.state),Ct(1),Dt("ngIf","processing"===e.state||"completed"===e.state),Ct(4),Dt("disabled","completed"!==e.state),Ct(5),Dt("disabled","completed"!==e.state),Ct(5),Qs("visibility","initial"===e.state||"loading"===e.state?"hidden":"visible"),Ct(8),Dt("srcObject",e.sourceVideoStream),Ct(2),Dt("ngIf",e.posePreviewMediaStream),Ct(1),Dt("ngIf",e.facePreviewMediaStream),Ct(1),Dt("ngIf",e.handPreviewMediaStream),Ct(2),Dt("ngIf","processing"===e.state||"completed"===e.state))},dependencies:[tD,gc,MA,uE,$D,pE,dL,mE,_E,gE,fE,XA,OL,NL,zL,bx,hO],styles:[".row[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;width:100%;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}mat-card[_ngcontent-%COMP%]{width:48%}.preview-video-container[_ngcontent-%COMP%]{display:inline-block;margin-right:1rem;position:relative}.preview-video-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:rgba(221,221,221,.9803921569);border-bottom-right-radius:6px;font-size:.8rem;position:absolute;left:0;top:0;padding:.5rem .7rem .5rem .5rem}.preview-video-container[_ngcontent-%COMP%]   .preview-video[_ngcontent-%COMP%]{max-height:50vh}","[_nghost-%COMP%]{display:block;padding:2rem}mat-card.preview[_ngcontent-%COMP%]{width:100%}mat-card.preview[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:2% 3%}"]});const ZW=["cameraVideo"];function QW(n,t){if(1&n&&(ct(0,"div",6)(1,"p",1),gn(2,"\u5168\u4f53\u306e\u691c\u51fa\u7d50\u679c"),dt(),yn(3,"video",2,7),dt()),2&n){const e=qn();Ct(3),Dt("srcObject",e.cameraPosePreviewStream)}}function JW(n,t){1&n&&yn(0,"img",11),2&n&&Dt("src",qn().$implicit.frameImageDataUrl,Qm)}function eG(n,t){1&n&&yn(0,"img",12)}function tG(n,t){if(1&n&&(ct(0,"div",6)(1,"p",1),gn(2),dt(),Bt(3,JW,1,1,"img",9),Bt(4,eG,1,0,"img",10),dt()),2&n){const e=t.$implicit;Ct(2),Rl(" ",e.timeMiliseconds," / ",e.similarity," "),Ct(1),Dt("ngIf",e.frameImageDataUrl),Ct(1),Dt("ngIf",!e.frameImageDataUrl)}}function nG(n,t){if(1&n&&(ct(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),gn(3," \u4e00\u81f4\u7d50\u679c "),dt(),ct(4,"mat-card-subtitle"),gn(5),dt()(),ct(6,"mat-card-content"),Bt(7,tG,5,4,"div",8),dt()()),2&n){const e=qn();Ct(5),ta("",null==e.similarPoses?null:e.similarPoses.length," \u4ef6\u306e\u30dd\u30fc\u30ba\u3068\u4e00\u81f4"),Ct(2),Dt("ngForOf",e.similarPoses)}}class xx{constructor(t,e,r){this.poseExtractorService=t,this.poseComposerService=e,this.snackBar=r,this.isPoseLoaded=!1}ngOnInit(){var t=this;return Ni(function*(){t.onResultsEventEmitterSubscription=t.poseExtractorService.onResultsEventEmitter.subscribe(e=>{t.onPoseDetected(e.mpResults,e.posePreviewImageDataUrl)})})()}ngOnDestroy(){this.onResultsEventEmitterSubscription&&this.onResultsEventEmitterSubscription.unsubscribe()}ngOnChanges(t){var e=this;return Ni(function*(){(t.poseFileType||t.poseZipArrayBuffer||t.poseSetJson)&&e.loadPoses()})()}loadPoses(){var t=this;return Ni(function*(){if(!t.poseFileType||!t.poseZipArrayBuffer&&!t.poseSetJson)return;const e=t.snackBar.open("\u30dd\u30fc\u30ba\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059...");t.poseSet=new ko;try{if("zip"===t.poseFileType&&t.poseZipArrayBuffer)yield t.poseSet.loadZip(t.poseZipArrayBuffer);else{if(!t.poseSetJson)throw"Invalid poseFileType";t.poseSet.loadJson(t.poseSetJson)}}catch(r){return e.dismiss(),void t.snackBar.open("\u30a8\u30e9\u30fc: \u30dd\u30fc\u30ba\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f..."+r.toString())}e.dismiss(),t.snackBar.open(`${t.poseSet.getNumberOfPoses()} \u4ef6\u306e\u30dd\u30fc\u30ba\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3057\u305f`),t.isPoseLoaded||(t.isPoseLoaded=!0,t.initCamera())})()}initCamera(){var t=this;return Ni(function*(){!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia||(t.cameraStream=yield navigator.mediaDevices.getUserMedia({video:{width:720,height:1280},audio:!1}),t.onCameraFrame(),t.cameraPosePreviewStream=t.poseExtractorService.getPosePreviewMediaStream())})()}onCameraFrame(){var t=this;return Ni(function*(){const e=t.cameraVideoElement?.nativeElement;if(e){if(e.paused||e.ended)return void setTimeout(()=>{t.onCameraFrame()},500);yield t.poseExtractorService.onVideoFrame(e),yield new Promise(requestAnimationFrame),t.onCameraFrame()}})()}onPoseDetected(t,e){var r=this;return Ni(function*(){if(!r.poseSet)return;let l=r.poseSet.getSimilarPoses(t,.8);0<l.length&&(l=l.sort((d,h)=>h.similarity-d.similarity),l.map(d=>(d.similarity=Math.floor(100*d.similarity)/100,d))),r.similarPoses=l})()}}function iG(n,t){if(1&n&&(ct(0,"small"),gn(1),dt()),2&n){const e=qn();Ct(1),ta(" \xa0\xa0 ",e.poseFileName," ")}}function rG(n,t){if(1&n&&yn(0,"app-tester",7),2&n){const e=qn();Dt("poseFileType",e.poseFileType)("poseSetJson",e.poseSetJson)("poseZipArrayBuffer",e.poseZipArrayBuffer)}}xx.\u0275fac=function(t){return new(t||xx)(re(Ld),re(Nd),re(CA))},xx.\u0275cmp=Mn({type:xx,selectors:[["app-tester"]],viewQuery:function(t,e){if(1&t&&Ti(ZW,5),2&t){let r;Ot(r=Kt())&&(e.cameraVideoElement=r.first)}},inputs:{poseFileType:"poseFileType",poseZipArrayBuffer:"poseZipArrayBuffer",poseSetJson:"poseSetJson"},features:[Ht([Ld]),Ki],decls:12,vars:3,consts:[[1,"preview-video-container",2,"display","none"],[1,"label"],["autoplay","","muted","",1,"preview-video",3,"srcObject"],["cameraVideo",""],["class","preview-video-container",4,"ngIf"],[4,"ngIf"],[1,"preview-video-container"],["posePreviewVideo",""],["class","preview-video-container",4,"ngFor","ngForOf"],["class","preview-video",3,"src",4,"ngIf"],["class","preview-video","src","/assets/dummy.png",4,"ngIf"],[1,"preview-video",3,"src"],["src","/assets/dummy.png",1,"preview-video"]],template:function(t,e){1&t&&(ct(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),gn(3," \u30ab\u30e1\u30e9 "),dt()(),ct(4,"mat-card-content")(5,"div",0)(6,"p",1),gn(7,"\u30ab\u30e1\u30e9\u6620\u50cf"),dt(),yn(8,"video",2,3),dt(),Bt(10,QW,5,1,"div",4),dt()(),Bt(11,nG,8,2,"mat-card",5)),2&t&&(Ct(8),Dt("srcObject",e.cameraStream),Ct(2),Dt("ngIf",e.cameraPosePreviewStream),Ct(1),Dt("ngIf",e.isPoseLoaded))},dependencies:[tD,gc,pE,mE,_E,gE,fE],styles:[".row[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;width:100%;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}mat-card[_ngcontent-%COMP%]{width:48%}.preview-video-container[_ngcontent-%COMP%]{display:inline-block;margin-right:1rem;position:relative}.preview-video-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:rgba(221,221,221,.9803921569);border-bottom-right-radius:6px;font-size:.8rem;position:absolute;left:0;top:0;padding:.5rem .7rem .5rem .5rem}.preview-video-container[_ngcontent-%COMP%]   .preview-video[_ngcontent-%COMP%]{max-height:50vh}"]});class wx{constructor(){}ngOnInit(){}ohChoosePoseFile(t){var e=this;const r=t.target.files;if(0===r.length)return;const l=r[0];this.poseFileName=l.name,this.poseFileType="application/zip"===l.type?"zip":"json";const d=new FileReader;d.onload=function(){var h=Ni(function*(_){const x=_.target?.result;"zip"===e.poseFileType?e.poseZipArrayBuffer=x:e.poseSetJson=x});return function(_){return h.apply(this,arguments)}}(),"zip"===this.poseFileType?d.readAsArrayBuffer(l):d.readAsText(l)}}wx.\u0275fac=function(t){return new(t||wx)},wx.\u0275cmp=Mn({type:wx,selectors:[["app-tester-page"]],features:[Ht([Nd])],decls:18,vars:2,consts:[[1,"row"],[2,"padding","0.5rem 1rem 1rem 1rem"],["mat-raised-button","","color","primary",3,"click"],["type","file","accept",".json,.zip",2,"display","none",3,"change"],["fileChooser",""],[4,"ngIf"],["class","row",3,"poseFileType","poseSetJson","poseZipArrayBuffer",4,"ngIf"],[1,"row",3,"poseFileType","poseSetJson","poseZipArrayBuffer"]],template:function(t,e){if(1&t){const r=Zs();ct(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),gn(4," \u30dd\u30fc\u30ba\u30d5\u30a1\u30a4\u30eb "),dt(),ct(5,"mat-card-subtitle"),gn(6,"\u52d5\u4f5c\u78ba\u8a8d\u3057\u305f\u3044\u30dd\u30fc\u30ba\u30d5\u30a1\u30a4\u30eb (ZIP \u307e\u305f\u306f JSON \u30d5\u30a1\u30a4\u30eb) \u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),yn(7,"br"),gn(8," \u3053\u306e\u51e6\u7406\u306f\u30ed\u30fc\u30ab\u30eb\u3067\u884c\u308f\u308c\u3001\u30b5\u30fc\u30d0\u306b\u306f\u9001\u4fe1\u3055\u308c\u307e\u305b\u3093"),dt()(),ct(9,"mat-card-content",1)(10,"button",2),bn("click",function(){return ts(r),hs(Gr(15).click())}),ct(11,"mat-icon"),gn(12,"upload"),dt(),gn(13," \u30dd\u30fc\u30ba\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e "),dt(),ct(14,"input",3,4),bn("change",function(d){return e.ohChoosePoseFile(d)}),dt(),Bt(16,iG,2,1,"small",5),dt()()(),Bt(17,rG,1,3,"app-tester",6)}2&t&&(Ct(16),Dt("ngIf",void 0!==e.poseFileName),Ct(1),Dt("ngIf",e.poseFileType))},dependencies:[gc,$D,pE,mE,_E,gE,fE,XA,xx],styles:[".row[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;width:100%;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}mat-card[_ngcontent-%COMP%]{width:48%}.preview-video-container[_ngcontent-%COMP%]{display:inline-block;margin-right:1rem;position:relative}.preview-video-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:rgba(221,221,221,.9803921569);border-bottom-right-radius:6px;font-size:.8rem;position:absolute;left:0;top:0;padding:.5rem .7rem .5rem .5rem}.preview-video-container[_ngcontent-%COMP%]   .preview-video[_ngcontent-%COMP%]{max-height:50vh}","[_nghost-%COMP%]{display:block;padding:2rem}.preview-video-container[_ngcontent-%COMP%]{display:inline-block;margin-right:1rem;position:relative}"]});const oG=[{path:"",component:yx},{path:"tester",component:wx}];class x_{}x_.\u0275fac=function(t){return new(t||x_)},x_.\u0275mod=Vt({type:x_}),x_.\u0275inj=$t({imports:[JN.forRoot(oG),JN]});const aG=["*",[["mat-toolbar-row"]]],sG=["*","mat-toolbar-row"],lG=d_(class{constructor(n){this._elementRef=n}});let cG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Ze({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),dG=(()=>{class n extends lG{constructor(e,r,l){super(e),this._platform=r,this._document=l}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(yr),re(Mt))},n.\u0275cmp=Mn({type:n,selectors:[["mat-toolbar"]],contentQueries:function(e,r,l){if(1&e&&vi(l,cG,5),2&e){let d;Ot(d=Kt())&&(r._toolbarRows=d)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,r){2&e&&Wn("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",0===r._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Et],ngContentSelectors:sG,decls:2,vars:0,template:function(e,r){1&e&&(cr(aG),Sn(0),Sn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),uG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,un]}),n})();const hG=function(){return{exact:!0}};class Cx{constructor(){this.title="mp-video-pose-extractor"}}function ZL(n){return new ot(3e3,!1)}function qG(){return typeof window<"u"&&typeof window.document<"u"}function tR(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Eh(n){switch(n.length){case 0:return new nx;case 1:return n[0];default:return new WP(n)}}function QL(n,t,e,r,l=new Map,d=new Map){const h=[],_=[];let x=-1,D=null;if(r.forEach(I=>{const V=I.get("offset"),ne=V==x,he=ne&&D||new Map;I.forEach((Ce,Ae)=>{let He=Ae,rt=Ce;if("offset"!==Ae)switch(He=t.normalizePropertyName(He,h),rt){case"!":rt=l.get(Ae);break;case Ud:rt=d.get(Ae);break;default:rt=t.normalizeStyleValue(Ae,He,rt,h)}he.set(He,rt)}),ne||_.push(he),D=he,x=V}),h.length)throw function NG(n){return new ot(3502,!1)}();return _}function nR(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&iR(e,"start",n)));break;case"done":n.onDone(()=>r(e&&iR(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&iR(e,"destroy",n)))}}function iR(n,t,e){const d=rR(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),h=n._data;return null!=h&&(d._data=h),d}function rR(n,t,e,r,l="",d=0,h){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:l,totalTime:d,disabled:!!h}}function Ms(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function JL(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}Cx.\u0275fac=function(t){return new(t||Cx)},Cx.\u0275cmp=Mn({type:Cx,selectors:[["app-root"]],decls:9,vars:2,consts:[["color","primary"],[1,"app-title"],[2,"display","flex"],["mat-button","","routerLink","","routerLinkActive","active",3,"routerLinkActiveOptions"],["mat-button","","routerLink","/tester","routerLinkActive","active"]],template:function(t,e){1&t&&(ct(0,"mat-toolbar",0)(1,"span",1),gn(2,"mp-video-pose-extractor"),dt(),yn(3,"span",2),ct(4,"button",3),gn(5," \u30dd\u30fc\u30ba\u62bd\u51fa "),dt(),ct(6,"button",4),gn(7," \u30c6\u30b9\u30c8 "),dt()(),yn(8,"router-outlet")),2&t&&(Ct(4),Dt("routerLinkActiveOptions",function jC(n,t,e){const r=Hr()+n,l=vt();return l[r]===Un?bs(l,r,e?t.call(e):t()):function Np(n,t){return n[t]}(l,r)}(1,hG)))},dependencies:[II,MD,GN,$D,dG],styles:["mat-toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:2rem}mat-toolbar[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{opacity:.5}"]});let oR=(n,t)=>!1,e4=(n,t,e)=>[],t4=null;function aR(n){const t=n.parentNode||n.host;return t===t4?null:t}(tR()||typeof Element<"u")&&(qG()?(t4=(()=>document.documentElement)(),oR=(n,t)=>{for(;t;){if(t===n)return!0;t=aR(t)}return!1}):oR=(n,t)=>n.contains(t),e4=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Af=null,n4=!1;const r4=oR,o4=e4;let a4=(()=>{class n{validateStyleProperty(e){return function KG(n){Af||(Af=function XG(){return typeof document<"u"?document.body:null}()||{},n4=!!Af.style&&"WebkitAppearance"in Af.style);let t=!0;return Af.style&&!function YG(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Af.style,!t&&n4&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Af.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return r4(e,r)}getParentElement(e){return aR(e)}query(e,r,l){return o4(e,r,l)}computeStyle(e,r,l){return l||""}animate(e,r,l,d,h,_=[],x){return new nx(l,d)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),sR=(()=>{class n{}return n.NOOP=new a4,n})();const lR="ng-enter",DE="ng-leave",EE="ng-trigger",kE=".ng-trigger",l4="ng-animating",cR=".ng-animating";function jd(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:dR(parseFloat(t[1]),t[2])}function dR(n,t){return"s"===t?1e3*n:n}function ME(n,t,e){return n.hasOwnProperty("duration")?n:function JG(n,t,e){let l,d=0,h="";if("string"==typeof n){const _=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===_)return t.push(ZL()),{duration:0,delay:0,easing:""};l=dR(parseFloat(_[1]),_[2]);const x=_[3];null!=x&&(d=dR(parseFloat(x),_[4]));const D=_[5];D&&(h=D)}else l=n;if(!e){let _=!1,x=t.length;l<0&&(t.push(function pG(){return new ot(3100,!1)}()),_=!0),d<0&&(t.push(function fG(){return new ot(3101,!1)}()),_=!0),_&&t.splice(x,0,ZL())}return{duration:l,delay:d,easing:h}}(n,t,e)}function Sx(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function c4(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function kh(n,t=new Map,e){if(e)for(let[r,l]of e)t.set(r,l);for(let[r,l]of n)t.set(r,l);return t}function u4(n,t,e){return e?t+":"+e+";":""}function h4(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=u4(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=u4(0,i$(e),n.style[e]));n.setAttribute("style",t)}function Sc(n,t,e){n.style&&(t.forEach((r,l)=>{const d=hR(l);e&&!e.has(l)&&e.set(l,n.style[d]),n.style[d]=r}),tR()&&h4(n))}function Rf(n,t){n.style&&(t.forEach((e,r)=>{const l=hR(r);n.style[l]=""}),tR()&&h4(n))}function Dx(n){return Array.isArray(n)?1==n.length?n[0]:HP(n):n}const uR=new RegExp("{{\\s*(.+?)\\s*}}","g");function p4(n){let t=[];if("string"==typeof n){let e;for(;e=uR.exec(n);)t.push(e[1]);uR.lastIndex=0}return t}function Ex(n,t,e){const r=n.toString(),l=r.replace(uR,(d,h)=>{let _=t[h];return null==_&&(e.push(function gG(n){return new ot(3003,!1)}()),_=""),_.toString()});return l==r?n:l}function TE(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const n$=/-+([a-z0-9])/g;function hR(n){return n.replace(n$,(...t)=>t[1].toUpperCase())}function i$(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ts(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function _G(n){return new ot(3004,!1)}()}}function f4(n,t){return window.getComputedStyle(n)[t]}function c$(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function d$(n,t,e){if(":"==n[0]){const x=function u$(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function AG(n){return new ot(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof x)return void t.push(x);n=x}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function IG(n){return new ot(3015,!1)}()),t;const l=r[1],d=r[2],h=r[3];t.push(m4(l,h));"<"==d[0]&&!("*"==l&&"*"==h)&&t.push(m4(h,l))}(r,e,t)):e.push(n),e}const FE=new Set(["true","1"]),OE=new Set(["false","0"]);function m4(n,t){const e=FE.has(n)||OE.has(n),r=FE.has(t)||OE.has(t);return(l,d)=>{let h="*"==n||n==l,_="*"==t||t==d;return!h&&e&&"boolean"==typeof l&&(h=l?FE.has(n):OE.has(n)),!_&&r&&"boolean"==typeof d&&(_=d?FE.has(t):OE.has(t)),h&&_}}const h$=new RegExp("s*:selfs*,?","g");function pR(n,t,e,r){return new p$(n).build(t,e,r)}class p${constructor(t){this._driver=t}build(t,e,r){const l=new g$(e);return this._resetContextStyleTimingState(l),Ts(this,Dx(t),l)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,l=e.depCount=0;const d=[],h=[];return"@"==t.name.charAt(0)&&e.errors.push(function bG(){return new ot(3006,!1)}()),t.definitions.forEach(_=>{if(this._resetContextStyleTimingState(e),0==_.type){const x=_,D=x.name;D.toString().split(/\s*,\s*/).forEach(I=>{x.name=I,d.push(this.visitState(x,e))}),x.name=D}else if(1==_.type){const x=this.visitTransition(_,e);r+=x.queryCount,l+=x.depCount,h.push(x)}else e.errors.push(function yG(){return new ot(3007,!1)}())}),{type:7,name:t.name,states:d,transitions:h,queryCount:r,depCount:l,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),l=t.options&&t.options.params||null;if(r.containsDynamicStyles){const d=new Set,h=l||{};r.styles.forEach(_=>{_ instanceof Map&&_.forEach(x=>{p4(x).forEach(D=>{h.hasOwnProperty(D)||d.add(D)})})}),d.size&&(TE(d.values()),e.errors.push(function xG(n,t){return new ot(3008,!1)}()))}return{type:0,name:t.name,style:r,options:l?{params:l}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Ts(this,Dx(t.animation),e);return{type:1,matchers:c$(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Ff(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Ts(this,r,e)),options:Ff(t.options)}}visitGroup(t,e){const r=e.currentTime;let l=0;const d=t.steps.map(h=>{e.currentTime=r;const _=Ts(this,h,e);return l=Math.max(l,e.currentTime),_});return e.currentTime=l,{type:3,steps:d,options:Ff(t.options)}}visitAnimate(t,e){const r=function v$(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return fR(ME(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(d=>"{"==d.charAt(0)&&"{"==d.charAt(1))){const d=fR(0,0,"");return d.dynamic=!0,d.strValue=e,d}const l=ME(e,t);return fR(l.duration,l.delay,l.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let l,d=t.styles?t.styles:Qt({});if(5==d.type)l=this.visitKeyframes(d,e);else{let h=t.styles,_=!1;if(!h){_=!0;const D={};r.easing&&(D.easing=r.easing),h=Qt(D)}e.currentTime+=r.duration+r.delay;const x=this.visitStyle(h,e);x.isEmptyStep=_,l=x}return e.currentAnimateTimings=null,{type:4,timings:r,style:l,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],l=Array.isArray(t.styles)?t.styles:[t.styles];for(let _ of l)"string"==typeof _?_===Ud?r.push(_):e.errors.push(new ot(3002,!1)):r.push(c4(_));let d=!1,h=null;return r.forEach(_=>{if(_ instanceof Map&&(_.has("easing")&&(h=_.get("easing"),_.delete("easing")),!d))for(let x of _.values())if(x.toString().indexOf("{{")>=0){d=!0;break}}),{type:6,styles:r,easing:h,offset:t.offset,containsDynamicStyles:d,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let l=e.currentTime,d=e.currentTime;r&&d>0&&(d-=r.duration+r.delay),t.styles.forEach(h=>{"string"!=typeof h&&h.forEach((_,x)=>{const D=e.collectedStyles.get(e.currentQuerySelector),I=D.get(x);let V=!0;I&&(d!=l&&d>=I.startTime&&l<=I.endTime&&(e.errors.push(function CG(n,t,e,r,l){return new ot(3010,!1)}()),V=!1),d=I.startTime),V&&D.set(x,{startTime:d,endTime:l}),e.options&&function t$(n,t,e){const r=t.params||{},l=p4(n);l.length&&l.forEach(d=>{r.hasOwnProperty(d)||e.push(function mG(n){return new ot(3001,!1)}())})}(_,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function SG(){return new ot(3011,!1)}()),r;let d=0;const h=[];let _=!1,x=!1,D=0;const I=t.steps.map(rt=>{const Tt=this._makeStyleAst(rt,e);let st=null!=Tt.offset?Tt.offset:function _$(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(Tt.styles),an=0;return null!=st&&(d++,an=Tt.offset=st),x=x||an<0||an>1,_=_||an<D,D=an,h.push(an),Tt});x&&e.errors.push(function DG(){return new ot(3012,!1)}()),_&&e.errors.push(function EG(){return new ot(3200,!1)}());const V=t.steps.length;let ne=0;d>0&&d<V?e.errors.push(function kG(){return new ot(3202,!1)}()):0==d&&(ne=1/(V-1));const he=V-1,Ce=e.currentTime,Ae=e.currentAnimateTimings,He=Ae.duration;return I.forEach((rt,Tt)=>{const st=ne>0?Tt==he?1:ne*Tt:h[Tt],an=st*He;e.currentTime=Ce+Ae.delay+an,Ae.duration=an,this._validateStyleAst(rt,e),rt.offset=st,r.styles.push(rt)}),r}visitReference(t,e){return{type:8,animation:Ts(this,Dx(t.animation),e),options:Ff(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Ff(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Ff(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,l=t.options||{};e.queryCount++,e.currentQuery=t;const[d,h]=function f$(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(h$,"")),n=n.replace(/@\*/g,kE).replace(/@\w+/g,e=>kE+"-"+e.slice(1)).replace(/:animating/g,cR),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+d:d,Ms(e.collectedStyles,e.currentQuerySelector,new Map);const _=Ts(this,Dx(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:d,limit:l.limit||0,optional:!!l.optional,includeSelf:h,animation:_,originalSelector:t.selector,options:Ff(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function MG(){return new ot(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:ME(t.timings,e.errors,!0);return{type:12,animation:Ts(this,Dx(t.animation),e),timings:r,options:null}}}class g${constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ff(n){return n?(n=Sx(n)).params&&(n.params=function m$(n){return n?Sx(n):null}(n.params)):n={},n}function fR(n,t,e){return{duration:n,delay:t,easing:e}}function mR(n,t,e,r,l,d,h=null,_=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:l,delay:d,totalTime:l+d,easing:h,subTimeline:_}}class NE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const x$=new RegExp(":enter","g"),C$=new RegExp(":leave","g");function gR(n,t,e,r,l,d=new Map,h=new Map,_,x,D=[]){return(new S$).buildKeyframes(n,t,e,r,l,d,h,_,x,D)}class S${buildKeyframes(t,e,r,l,d,h,_,x,D,I=[]){D=D||new NE;const V=new _R(t,e,D,l,d,I,[]);V.options=x;const ne=x.delay?jd(x.delay):0;V.currentTimeline.delayNextStep(ne),V.currentTimeline.setStyles([h],null,V.errors,x),Ts(this,r,V);const he=V.timelines.filter(Ce=>Ce.containsAnimation());if(he.length&&_.size){let Ce;for(let Ae=he.length-1;Ae>=0;Ae--){const He=he[Ae];if(He.element===e){Ce=He;break}}Ce&&!Ce.allowOnlyTimelineStyles()&&Ce.setStyles([_],null,V.errors,x)}return he.length?he.map(Ce=>Ce.buildKeyframes()):[mR(e,[],[],[],0,ne,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const l=e.createSubContext(t.options),d=e.currentTimeline.currentTime,h=this._visitSubInstructions(r,l,l.options);d!=h&&e.transformIntoNewTimeline(h)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const l of t){const d=l?.delay;if(d){const h="number"==typeof d?d:jd(Ex(d,l?.params??{},e.errors));r.delayNextStep(h)}}}_visitSubInstructions(t,e,r){let d=e.currentTimeline.currentTime;const h=null!=r.duration?jd(r.duration):null,_=null!=r.delay?jd(r.delay):null;return 0!==h&&t.forEach(x=>{const D=e.appendInstructionToTimeline(x,h,_);d=Math.max(d,D.duration+D.delay)}),d}visitReference(t,e){e.updateOptions(t.options,!0),Ts(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let l=e;const d=t.options;if(d&&(d.params||d.delay)&&(l=e.createSubContext(d),l.transformIntoNewTimeline(),null!=d.delay)){6==l.previousNode.type&&(l.currentTimeline.snapshotCurrentStyles(),l.previousNode=PE);const h=jd(d.delay);l.delayNextStep(h)}t.steps.length&&(t.steps.forEach(h=>Ts(this,h,l)),l.currentTimeline.applyStylesToKeyframe(),l.subContextCount>r&&l.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let l=e.currentTimeline.currentTime;const d=t.options&&t.options.delay?jd(t.options.delay):0;t.steps.forEach(h=>{const _=e.createSubContext(t.options);d&&_.delayNextStep(d),Ts(this,h,_),l=Math.max(l,_.currentTimeline.currentTime),r.push(_.currentTimeline)}),r.forEach(h=>e.currentTimeline.mergeTimelineCollectedStyles(h)),e.transformIntoNewTimeline(l),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return ME(e.params?Ex(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),l=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),l.snapshotCurrentStyles());const d=t.style;5==d.type?this.visitKeyframes(d,e):(e.incrementTime(r.duration),this.visitStyle(d,e),l.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,l=e.currentAnimateTimings;!l&&r.hasCurrentStyleProperties()&&r.forwardFrame();const d=l&&l.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(d):r.setStyles(t.styles,d,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,l=e.currentTimeline.duration,d=r.duration,_=e.createSubContext().currentTimeline;_.easing=r.easing,t.styles.forEach(x=>{_.forwardTime((x.offset||0)*d),_.setStyles(x.styles,x.easing,e.errors,e.options),_.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(_),e.transformIntoNewTimeline(l+d),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,l=t.options||{},d=l.delay?jd(l.delay):0;d&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=PE);let h=r;const _=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!l.optional,e.errors);e.currentQueryTotal=_.length;let x=null;_.forEach((D,I)=>{e.currentQueryIndex=I;const V=e.createSubContext(t.options,D);d&&V.delayNextStep(d),D===e.element&&(x=V.currentTimeline),Ts(this,t.animation,V),V.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,V.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(h),x&&(e.currentTimeline.mergeTimelineCollectedStyles(x),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,l=e.currentTimeline,d=t.timings,h=Math.abs(d.duration),_=h*(e.currentQueryTotal-1);let x=h*e.currentQueryIndex;switch(d.duration<0?"reverse":d.easing){case"reverse":x=_-x;break;case"full":x=r.currentStaggerTime}const I=e.currentTimeline;x&&I.delayNextStep(x);const V=I.currentTime;Ts(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=l.currentTime-V+(l.startTime-r.currentTimeline.startTime)}}const PE={};class _R{constructor(t,e,r,l,d,h,_,x){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=l,this._leaveClassName=d,this.errors=h,this.timelines=_,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=PE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=x||new LE(this._driver,e,0),_.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let l=this.options;null!=r.duration&&(l.duration=jd(r.duration)),null!=r.delay&&(l.delay=jd(r.delay));const d=r.params;if(d){let h=l.params;h||(h=this.options.params={}),Object.keys(d).forEach(_=>{(!e||!h.hasOwnProperty(_))&&(h[_]=Ex(d[_],h,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(l=>{r[l]=e[l]})}}return t}createSubContext(t=null,e,r){const l=e||this.element,d=new _R(this._driver,l,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(l,r||0));return d.previousNode=this.previousNode,d.currentAnimateTimings=this.currentAnimateTimings,d.options=this._copyOptions(),d.updateOptions(t),d.currentQueryIndex=this.currentQueryIndex,d.currentQueryTotal=this.currentQueryTotal,d.parentContext=this,this.subContextCount++,d}transformIntoNewTimeline(t){return this.previousNode=PE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const l={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},d=new D$(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,l,t.stretchStartingKeyframe);return this.timelines.push(d),l}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,l,d,h){let _=[];if(l&&_.push(this.element),t.length>0){t=(t=t.replace(x$,"."+this._enterClassName)).replace(C$,"."+this._leaveClassName);let D=this._driver.query(this.element,t,1!=r);0!==r&&(D=r<0?D.slice(D.length+r,D.length):D.slice(0,r)),_.push(...D)}return!d&&0==_.length&&h.push(function TG(n){return new ot(3014,!1)}()),_}}class LE{constructor(t,e,r,l){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=l,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new LE(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Ud),this._currentKeyframe.set(e,Ud);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,l){e&&this._previousKeyframe.set("easing",e);const d=l&&l.params||{},h=function E$(n,t){const e=new Map;let r;return n.forEach(l=>{if("*"===l){r=r||t.keys();for(let d of r)e.set(d,Ud)}else kh(l,e)}),e}(t,this._globalTimelineStyles);for(let[_,x]of h){const D=Ex(x,d,r);this._pendingStyles.set(_,D),this._localTimelineStyles.has(_)||this._backFill.set(_,this._globalTimelineStyles.get(_)??Ud),this._updateStyle(_,D)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const l=this._styleSummary.get(r);(!l||e.time>l.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let l=[];this._keyframes.forEach((_,x)=>{const D=kh(_,new Map,this._backFill);D.forEach((I,V)=>{"!"===I?t.add(V):I===Ud&&e.add(V)}),r||D.set("offset",x/this.duration),l.push(D)});const d=t.size?TE(t.values()):[],h=e.size?TE(e.values()):[];if(r){const _=l[0],x=new Map(_);_.set("offset",0),x.set("offset",1),l=[_,x]}return mR(this.element,l,d,h,this.duration,this.startTime,this.easing,!1)}}class D$ extends LE{constructor(t,e,r,l,d,h,_=!1){super(t,e,h.delay),this.keyframes=r,this.preStyleProps=l,this.postStyleProps=d,this._stretchStartingKeyframe=_,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:l}=this.timings;if(this._stretchStartingKeyframe&&e){const d=[],h=r+e,_=e/h,x=kh(t[0]);x.set("offset",0),d.push(x);const D=kh(t[0]);D.set("offset",v4(_)),d.push(D);const I=t.length-1;for(let V=1;V<=I;V++){let ne=kh(t[V]);const he=ne.get("offset");ne.set("offset",v4((e+he*r)/h)),d.push(ne)}r=h,e=0,l="",t=d}return mR(this.element,t,this.preStyleProps,this.postStyleProps,r,e,l,!0)}}function v4(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class vR{}const k$=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class M$ extends vR{normalizePropertyName(t,e){return hR(t)}normalizeStyleValue(t,e,r,l){let d="";const h=r.toString().trim();if(k$.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)d="px";else{const _=r.match(/^[+-]?[\d\.]+([a-z]*)$/);_&&0==_[1].length&&l.push(function vG(n,t){return new ot(3005,!1)}())}return h+d}}function b4(n,t,e,r,l,d,h,_,x,D,I,V,ne){return{type:0,element:n,triggerName:t,isRemovalTransition:l,fromState:e,fromStyles:d,toState:r,toStyles:h,timelines:_,queriedElements:x,preStyleProps:D,postStyleProps:I,totalTime:V,errors:ne}}const bR={};class y4{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,l){return function T$(n,t,e,r,l){return n.some(d=>d(t,e,r,l))}(this.ast.matchers,t,e,r,l)}buildStyles(t,e,r){let l=this._stateStyles.get("*");return void 0!==t&&(l=this._stateStyles.get(t?.toString())||l),l?l.buildStyles(e,r):new Map}build(t,e,r,l,d,h,_,x,D,I){const V=[],ne=this.ast.options&&this.ast.options.params||bR,Ce=this.buildStyles(r,_&&_.params||bR,V),Ae=x&&x.params||bR,He=this.buildStyles(l,Ae,V),rt=new Set,Tt=new Map,st=new Map,an="void"===l,Li={params:I$(Ae,ne),delay:this.ast.options?.delay},$i=I?[]:gR(t,e,this.ast.animation,d,h,Ce,He,Li,D,V);let Ea=0;if($i.forEach(Yd=>{Ea=Math.max(Yd.duration+Yd.delay,Ea)}),V.length)return b4(e,this._triggerName,r,l,an,Ce,He,[],[],Tt,st,Ea,V);$i.forEach(Yd=>{const Kd=Yd.element,zB=Ms(Tt,Kd,new Set);Yd.preStyleProps.forEach(Pf=>zB.add(Pf));const Ax=Ms(st,Kd,new Set);Yd.postStyleProps.forEach(Pf=>Ax.add(Pf)),Kd!==e&&rt.add(Kd)});const qd=TE(rt.values());return b4(e,this._triggerName,r,l,an,Ce,He,$i,qd,Tt,st,Ea)}}function I$(n,t){const e=Sx(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class A${constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,l=Sx(this.defaultParams);return Object.keys(t).forEach(d=>{const h=t[d];null!==h&&(l[d]=h)}),this.styles.styles.forEach(d=>{"string"!=typeof d&&d.forEach((h,_)=>{h&&(h=Ex(h,l,e));const x=this.normalizer.normalizePropertyName(_,e);h=this.normalizer.normalizeStyleValue(_,x,h,e),r.set(_,h)})}),r}}class F${constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(l=>{this.states.set(l.name,new A$(l.style,l.options&&l.options.params||{},r))}),x4(this.states,"true","1"),x4(this.states,"false","0"),e.transitions.forEach(l=>{this.transitionFactories.push(new y4(t,l,this.states))}),this.fallbackTransition=function O$(n,t,e){return new y4(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(h,_)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,l){return this.transitionFactories.find(h=>h.match(t,e,r,l))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function x4(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const N$=new NE;class P${constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],d=pR(this._driver,e,r,[]);if(r.length)throw function PG(n){return new ot(3503,!1)}();this._animations.set(t,d)}_buildPlayer(t,e,r){const l=t.element,d=QL(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(l,d,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const l=[],d=this._animations.get(t);let h;const _=new Map;if(d?(h=gR(this._driver,e,d,lR,DE,new Map,new Map,r,N$,l),h.forEach(I=>{const V=Ms(_,I.element,new Map);I.postStyleProps.forEach(ne=>V.set(ne,null))})):(l.push(function LG(){return new ot(3300,!1)}()),h=[]),l.length)throw function BG(n){return new ot(3504,!1)}();_.forEach((I,V)=>{I.forEach((ne,he)=>{I.set(he,this._driver.computeStyle(V,he,Ud))})});const D=Eh(h.map(I=>{const V=_.get(I.element);return this._buildPlayer(I,new Map,V)}));return this._playersById.set(t,D),D.onDestroy(()=>this.destroy(t)),this.players.push(D),D}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function zG(n){return new ot(3301,!1)}();return e}listen(t,e,r,l){const d=rR(e,"","","");return nR(this._getPlayer(t),r,d,l),()=>{}}command(t,e,r,l){if("register"==r)return void this.register(t,l[0]);if("create"==r)return void this.create(t,e,l[0]||{});const d=this._getPlayer(t);switch(r){case"play":d.play();break;case"pause":d.pause();break;case"reset":d.reset();break;case"restart":d.restart();break;case"finish":d.finish();break;case"init":d.init();break;case"setPosition":d.setPosition(parseFloat(l[0]));break;case"destroy":this.destroy(t)}}}const w4="ng-animate-queued",yR="ng-animate-disabled",U$=[],C4={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},H$={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},sl="__ng_removed";class xR{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function $$(n){return n??null}(r?t.value:t),r){const d=Sx(t);delete d.value,this.options=d}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(l=>{null==r[l]&&(r[l]=e[l])})}}}const kx="void",wR=new xR(kx);class j${constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,ll(e,this._hostClassName)}listen(t,e,r,l){if(!this._triggers.has(e))throw function VG(n,t){return new ot(3302,!1)}();if(null==r||0==r.length)throw function UG(n){return new ot(3303,!1)}();if(!function q$(n){return"start"==n||"done"==n}(r))throw function HG(n,t){return new ot(3400,!1)}();const d=Ms(this._elementListeners,t,[]),h={name:e,phase:r,callback:l};d.push(h);const _=Ms(this._engine.statesByElement,t,new Map);return _.has(e)||(ll(t,EE),ll(t,EE+"-"+e),_.set(e,wR)),()=>{this._engine.afterFlush(()=>{const x=d.indexOf(h);x>=0&&d.splice(x,1),this._triggers.has(e)||_.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function jG(n){return new ot(3401,!1)}();return e}trigger(t,e,r,l=!0){const d=this._getTrigger(e),h=new CR(this.id,e,t);let _=this._engine.statesByElement.get(t);_||(ll(t,EE),ll(t,EE+"-"+e),this._engine.statesByElement.set(t,_=new Map));let x=_.get(e);const D=new xR(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&x&&D.absorbOptions(x.options),_.set(e,D),x||(x=wR),D.value!==kx&&x.value===D.value){if(!function X$(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let l=0;l<e.length;l++){const d=e[l];if(!t.hasOwnProperty(d)||n[d]!==t[d])return!1}return!0}(x.params,D.params)){const Ae=[],He=d.matchStyles(x.value,x.params,Ae),rt=d.matchStyles(D.value,D.params,Ae);Ae.length?this._engine.reportError(Ae):this._engine.afterFlush(()=>{Rf(t,He),Sc(t,rt)})}return}const ne=Ms(this._engine.playersByElement,t,[]);ne.forEach(Ae=>{Ae.namespaceId==this.id&&Ae.triggerName==e&&Ae.queued&&Ae.destroy()});let he=d.matchTransition(x.value,D.value,t,D.params),Ce=!1;if(!he){if(!l)return;he=d.fallbackTransition,Ce=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:he,fromState:x,toState:D,player:h,isFallbackTransition:Ce}),Ce||(ll(t,w4),h.onStart(()=>{w_(t,w4)})),h.onDone(()=>{let Ae=this.players.indexOf(h);Ae>=0&&this.players.splice(Ae,1);const He=this._engine.playersByElement.get(t);if(He){let rt=He.indexOf(h);rt>=0&&He.splice(rt,1)}}),this.players.push(h),ne.push(h),h}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(l=>l.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,kE,!0);r.forEach(l=>{if(l[sl])return;const d=this._engine.fetchNamespacesByElement(l);d.size?d.forEach(h=>h.triggerLeaveAnimation(l,e,!1,!0)):this.clearElementCache(l)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(l=>this.clearElementCache(l)))}triggerLeaveAnimation(t,e,r,l){const d=this._engine.statesByElement.get(t),h=new Map;if(d){const _=[];if(d.forEach((x,D)=>{if(h.set(D,x.value),this._triggers.has(D)){const I=this.trigger(t,D,kx,l);I&&_.push(I)}}),_.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,h),r&&Eh(_).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const l=new Set;e.forEach(d=>{const h=d.name;if(l.has(h))return;l.add(h);const x=this._triggers.get(h).fallbackTransition,D=r.get(h)||wR,I=new xR(kx),V=new CR(this.id,h,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:h,transition:x,fromState:D,toState:I,player:V,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let l=!1;if(r.totalAnimations){const d=r.players.length?r.playersByQueriedElement.get(t):[];if(d&&d.length)l=!0;else{let h=t;for(;h=h.parentNode;)if(r.statesByElement.get(h)){l=!0;break}}}if(this.prepareLeaveAnimationListeners(t),l)r.markElementAsRemoved(this.id,t,!1,e);else{const d=t[sl];(!d||d===C4)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){ll(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const l=r.player;if(l.destroyed)return;const d=r.element,h=this._elementListeners.get(d);h&&h.forEach(_=>{if(_.name==r.triggerName){const x=rR(d,r.triggerName,r.fromState.value,r.toState.value);x._data=t,nR(r.player,_.phase,x,_.callback)}}),l.markedForDestroy?this._engine.afterFlush(()=>{l.destroy()}):e.push(r)}),this._queue=[],e.sort((r,l)=>{const d=r.transition.ast.depCount,h=l.transition.ast.depCount;return 0==d||0==h?d-h:this._engine.driver.containsElement(r.element,l.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class W${constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(l,d)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new j$(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,l=this.namespacesByHostElement;if(r.length-1>=0){let h=!1,_=this.driver.getParentElement(e);for(;_;){const x=l.get(_);if(x){const D=r.indexOf(x);r.splice(D+1,0,t),h=!0;break}_=this.driver.getParentElement(_)}h||r.unshift(t)}else r.push(t);return l.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let l=this._namespaceLookup[t];l&&l.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const l=this._namespaceList.indexOf(r);l>=0&&this._namespaceList.splice(l,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let l of r.values())if(l.namespaceId){const d=this._fetchNamespace(l.namespaceId);d&&e.add(d)}return e}trigger(t,e,r,l){if(BE(e)){const d=this._fetchNamespace(t);if(d)return d.trigger(e,r,l),!0}return!1}insertNode(t,e,r,l){if(!BE(e))return;const d=e[sl];if(d&&d.setForRemoval){d.setForRemoval=!1,d.setForMove=!0;const h=this.collectedLeaveElements.indexOf(e);h>=0&&this.collectedLeaveElements.splice(h,1)}if(t){const h=this._fetchNamespace(t);h&&h.insertNode(e,r)}l&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),ll(t,yR)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),w_(t,yR))}removeNode(t,e,r,l){if(BE(e)){const d=t?this._fetchNamespace(t):null;if(d?d.removeNode(e,l):this.markElementAsRemoved(t,e,!1,l),r){const h=this.namespacesByHostElement.get(e);h&&h.id!==t&&h.removeNode(e,l)}}else this._onRemovalComplete(e,l)}markElementAsRemoved(t,e,r,l,d){this.collectedLeaveElements.push(e),e[sl]={namespaceId:t,setForRemoval:l,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:d}}listen(t,e,r,l,d){return BE(e)?this._fetchNamespace(t).listen(e,r,l,d):()=>{}}_buildInstruction(t,e,r,l,d){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,l,t.fromState.options,t.toState.options,e,d)}destroyInnerAnimations(t){let e=this.driver.query(t,kE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,cR,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Eh(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[sl];if(e&&e.setForRemoval){if(t[sl]=C4,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(yR)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,l)=>this._balanceNamespaceList(r,l)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)ll(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let l=0;l<r.length;l++)r[l]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?Eh(e).onDone(()=>{r.forEach(l=>l())}):r.forEach(l=>l())}}reportError(t){throw function WG(n){return new ot(3402,!1)}()}_flushAnimations(t,e){const r=new NE,l=[],d=new Map,h=[],_=new Map,x=new Map,D=new Map,I=new Set;this.disabledNodes.forEach(mn=>{I.add(mn);const In=this.driver.query(mn,".ng-animate-queued",!0);for(let zn=0;zn<In.length;zn++)I.add(In[zn])});const V=this.bodyNode,ne=Array.from(this.statesByElement.keys()),he=E4(ne,this.collectedEnterElements),Ce=new Map;let Ae=0;he.forEach((mn,In)=>{const zn=lR+Ae++;Ce.set(In,zn),mn.forEach(Wi=>ll(Wi,zn))});const He=[],rt=new Set,Tt=new Set;for(let mn=0;mn<this.collectedLeaveElements.length;mn++){const In=this.collectedLeaveElements[mn],zn=In[sl];zn&&zn.setForRemoval&&(He.push(In),rt.add(In),zn.hasAnimation?this.driver.query(In,".ng-star-inserted",!0).forEach(Wi=>rt.add(Wi)):Tt.add(In))}const st=new Map,an=E4(ne,Array.from(rt));an.forEach((mn,In)=>{const zn=DE+Ae++;st.set(In,zn),mn.forEach(Wi=>ll(Wi,zn))}),t.push(()=>{he.forEach((mn,In)=>{const zn=Ce.get(In);mn.forEach(Wi=>w_(Wi,zn))}),an.forEach((mn,In)=>{const zn=st.get(In);mn.forEach(Wi=>w_(Wi,zn))}),He.forEach(mn=>{this.processLeaveNode(mn)})});const Li=[],$i=[];for(let mn=this._namespaceList.length-1;mn>=0;mn--)this._namespaceList[mn].drainQueuedTransitions(e).forEach(zn=>{const Wi=zn.player,jo=zn.element;if(Li.push(Wi),this.collectedEnterElements.length){const ka=jo[sl];if(ka&&ka.setForMove){if(ka.previousTriggersValues&&ka.previousTriggersValues.has(zn.triggerName)){const Lf=ka.previousTriggersValues.get(zn.triggerName),cl=this.statesByElement.get(zn.element);if(cl&&cl.has(zn.triggerName)){const ok=cl.get(zn.triggerName);ok.value=Lf,cl.set(zn.triggerName,ok)}}return void Wi.destroy()}}const Ec=!V||!this.driver.containsElement(V,jo),Is=st.get(jo),Th=Ce.get(jo),Br=this._buildInstruction(zn,r,Th,Is,Ec);if(Br.errors&&Br.errors.length)return void $i.push(Br);if(Ec)return Wi.onStart(()=>Rf(jo,Br.fromStyles)),Wi.onDestroy(()=>Sc(jo,Br.toStyles)),void l.push(Wi);if(zn.isFallbackTransition)return Wi.onStart(()=>Rf(jo,Br.fromStyles)),Wi.onDestroy(()=>Sc(jo,Br.toStyles)),void l.push(Wi);const HB=[];Br.timelines.forEach(ka=>{ka.stretchStartingKeyframe=!0,this.disabledNodes.has(ka.element)||HB.push(ka)}),Br.timelines=HB,r.append(jo,Br.timelines),h.push({instruction:Br,player:Wi,element:jo}),Br.queriedElements.forEach(ka=>Ms(_,ka,[]).push(Wi)),Br.preStyleProps.forEach((ka,Lf)=>{if(ka.size){let cl=x.get(Lf);cl||x.set(Lf,cl=new Set),ka.forEach((ok,ZR)=>cl.add(ZR))}}),Br.postStyleProps.forEach((ka,Lf)=>{let cl=D.get(Lf);cl||D.set(Lf,cl=new Set),ka.forEach((ok,ZR)=>cl.add(ZR))})});if($i.length){const mn=[];$i.forEach(In=>{mn.push(function GG(n,t){return new ot(3505,!1)}())}),Li.forEach(In=>In.destroy()),this.reportError(mn)}const Ea=new Map,qd=new Map;h.forEach(mn=>{const In=mn.element;r.has(In)&&(qd.set(In,In),this._beforeAnimationBuild(mn.player.namespaceId,mn.instruction,Ea))}),l.forEach(mn=>{const In=mn.element;this._getPreviousPlayers(In,!1,mn.namespaceId,mn.triggerName,null).forEach(Wi=>{Ms(Ea,In,[]).push(Wi),Wi.destroy()})});const Yd=He.filter(mn=>M4(mn,x,D)),Kd=new Map;D4(Kd,this.driver,Tt,D,Ud).forEach(mn=>{M4(mn,x,D)&&Yd.push(mn)});const Ax=new Map;he.forEach((mn,In)=>{D4(Ax,this.driver,new Set(mn),x,"!")}),Yd.forEach(mn=>{const In=Kd.get(mn),zn=Ax.get(mn);Kd.set(mn,new Map([...Array.from(In?.entries()??[]),...Array.from(zn?.entries()??[])]))});const Pf=[],VB=[],UB={};h.forEach(mn=>{const{element:In,player:zn,instruction:Wi}=mn;if(r.has(In)){if(I.has(In))return zn.onDestroy(()=>Sc(In,Wi.toStyles)),zn.disabled=!0,zn.overrideTotalTime(Wi.totalTime),void l.push(zn);let jo=UB;if(qd.size>1){let Is=In;const Th=[];for(;Is=Is.parentNode;){const Br=qd.get(Is);if(Br){jo=Br;break}Th.push(Is)}Th.forEach(Br=>qd.set(Br,jo))}const Ec=this._buildAnimation(zn.namespaceId,Wi,Ea,d,Ax,Kd);if(zn.setRealPlayer(Ec),jo===UB)Pf.push(zn);else{const Is=this.playersByElement.get(jo);Is&&Is.length&&(zn.parentPlayer=Eh(Is)),l.push(zn)}}else Rf(In,Wi.fromStyles),zn.onDestroy(()=>Sc(In,Wi.toStyles)),VB.push(zn),I.has(In)&&l.push(zn)}),VB.forEach(mn=>{const In=d.get(mn.element);if(In&&In.length){const zn=Eh(In);mn.setRealPlayer(zn)}}),l.forEach(mn=>{mn.parentPlayer?mn.syncPlayerEvents(mn.parentPlayer):mn.destroy()});for(let mn=0;mn<He.length;mn++){const In=He[mn],zn=In[sl];if(w_(In,DE),zn&&zn.hasAnimation)continue;let Wi=[];if(_.size){let Ec=_.get(In);Ec&&Ec.length&&Wi.push(...Ec);let Is=this.driver.query(In,cR,!0);for(let Th=0;Th<Is.length;Th++){let Br=_.get(Is[Th]);Br&&Br.length&&Wi.push(...Br)}}const jo=Wi.filter(Ec=>!Ec.destroyed);jo.length?Y$(this,In,jo):this.processLeaveNode(In)}return He.length=0,Pf.forEach(mn=>{this.players.push(mn),mn.onDone(()=>{mn.destroy();const In=this.players.indexOf(mn);this.players.splice(In,1)}),mn.play()}),Pf}elementContainsData(t,e){let r=!1;const l=e[sl];return l&&l.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,l,d){let h=[];if(e){const _=this.playersByQueriedElement.get(t);_&&(h=_)}else{const _=this.playersByElement.get(t);if(_){const x=!d||d==kx;_.forEach(D=>{D.queued||!x&&D.triggerName!=l||h.push(D)})}}return(r||l)&&(h=h.filter(_=>!(r&&r!=_.namespaceId||l&&l!=_.triggerName))),h}_beforeAnimationBuild(t,e,r){const d=e.element,h=e.isRemovalTransition?void 0:t,_=e.isRemovalTransition?void 0:e.triggerName;for(const x of e.timelines){const D=x.element,I=D!==d,V=Ms(r,D,[]);this._getPreviousPlayers(D,I,h,_,e.toState).forEach(he=>{const Ce=he.getRealPlayer();Ce.beforeDestroy&&Ce.beforeDestroy(),he.destroy(),V.push(he)})}Rf(d,e.fromStyles)}_buildAnimation(t,e,r,l,d,h){const _=e.triggerName,x=e.element,D=[],I=new Set,V=new Set,ne=e.timelines.map(Ce=>{const Ae=Ce.element;I.add(Ae);const He=Ae[sl];if(He&&He.removedBeforeQueried)return new nx(Ce.duration,Ce.delay);const rt=Ae!==x,Tt=function K$(n){const t=[];return k4(n,t),t}((r.get(Ae)||U$).map(Ea=>Ea.getRealPlayer())).filter(Ea=>!!Ea.element&&Ea.element===Ae),st=d.get(Ae),an=h.get(Ae),Li=QL(0,this._normalizer,0,Ce.keyframes,st,an),$i=this._buildPlayer(Ce,Li,Tt);if(Ce.subTimeline&&l&&V.add(Ae),rt){const Ea=new CR(t,_,Ae);Ea.setRealPlayer($i),D.push(Ea)}return $i});D.forEach(Ce=>{Ms(this.playersByQueriedElement,Ce.element,[]).push(Ce),Ce.onDone(()=>function G$(n,t,e){let r=n.get(t);if(r){if(r.length){const l=r.indexOf(e);r.splice(l,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,Ce.element,Ce))}),I.forEach(Ce=>ll(Ce,l4));const he=Eh(ne);return he.onDestroy(()=>{I.forEach(Ce=>w_(Ce,l4)),Sc(x,e.toStyles)}),V.forEach(Ce=>{Ms(l,Ce,[]).push(he)}),he}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new nx(t.duration,t.delay)}}class CR{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new nx,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(l=>nR(t,r,void 0,l))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Ms(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function BE(n){return n&&1===n.nodeType}function S4(n,t){const e=n.style.display;return n.style.display=t??"none",e}function D4(n,t,e,r,l){const d=[];e.forEach(x=>d.push(S4(x)));const h=[];r.forEach((x,D)=>{const I=new Map;x.forEach(V=>{const ne=t.computeStyle(D,V,l);I.set(V,ne),(!ne||0==ne.length)&&(D[sl]=H$,h.push(D))}),n.set(D,I)});let _=0;return e.forEach(x=>S4(x,d[_++])),h}function E4(n,t){const e=new Map;if(n.forEach(_=>e.set(_,[])),0==t.length)return e;const l=new Set(t),d=new Map;function h(_){if(!_)return 1;let x=d.get(_);if(x)return x;const D=_.parentNode;return x=e.has(D)?D:l.has(D)?1:h(D),d.set(_,x),x}return t.forEach(_=>{const x=h(_);1!==x&&e.get(x).push(_)}),e}function ll(n,t){n.classList?.add(t)}function w_(n,t){n.classList?.remove(t)}function Y$(n,t,e){Eh(e).onDone(()=>n.processLeaveNode(t))}function k4(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof WP?k4(r.players,t):t.push(r)}}function M4(n,t,e){const r=e.get(n);if(!r)return!1;let l=t.get(n);return l?r.forEach(d=>l.add(d)):t.set(n,r),e.delete(n),!0}class zE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(l,d)=>{},this._transitionEngine=new W$(t,e,r),this._timelineEngine=new P$(t,e,r),this._transitionEngine.onRemovalComplete=(l,d)=>this.onRemovalComplete(l,d)}registerTrigger(t,e,r,l,d){const h=t+"-"+l;let _=this._triggerCache[h];if(!_){const x=[],I=pR(this._driver,d,x,[]);if(x.length)throw function OG(n,t){return new ot(3404,!1)}();_=function R$(n,t,e){return new F$(n,t,e)}(l,I,this._normalizer),this._triggerCache[h]=_}this._transitionEngine.registerTrigger(e,l,_)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,l){this._transitionEngine.insertNode(t,e,r,l)}onRemove(t,e,r,l){this._transitionEngine.removeNode(t,e,l||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,l){if("@"==r.charAt(0)){const[d,h]=JL(r);this._timelineEngine.command(d,e,h,l)}else this._transitionEngine.trigger(t,e,r,l)}listen(t,e,r,l,d){if("@"==r.charAt(0)){const[h,_]=JL(r);return this._timelineEngine.listen(h,e,_,d)}return this._transitionEngine.listen(t,e,r,l,d)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Q$=(()=>{class n{constructor(e,r,l){this._element=e,this._startStyles=r,this._endStyles=l,this._state=0;let d=n.initialStylesByElement.get(e);d||n.initialStylesByElement.set(e,d=new Map),this._initialStyles=d}start(){this._state<1&&(this._startStyles&&Sc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Sc(this._element,this._initialStyles),this._endStyles&&(Sc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Rf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Rf(this._element,this._endStyles),this._endStyles=null),Sc(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function SR(n){let t=null;return n.forEach((e,r)=>{(function J$(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class T4{constructor(t,e,r,l){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=l,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,l)=>{"offset"!==l&&t.set(l,this._finished?r:f4(this.element,l))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class eq{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return r4(t,e)}getParentElement(t){return aR(t)}query(t,e,r){return o4(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,l,d,h=[]){const x={duration:r,delay:l,fill:0==l?"both":"forwards"};d&&(x.easing=d);const D=new Map,I=h.filter(he=>he instanceof T4);(function r$(n,t){return 0===n||0===t})(r,l)&&I.forEach(he=>{he.currentSnapshot.forEach((Ce,Ae)=>D.set(Ae,Ce))});let V=function e$(n){return n.length?n[0]instanceof Map?n:n.map(t=>c4(t)):[]}(e).map(he=>kh(he));V=function o$(n,t,e){if(e.size&&t.length){let r=t[0],l=[];if(e.forEach((d,h)=>{r.has(h)||l.push(h),r.set(h,d)}),l.length)for(let d=1;d<t.length;d++){let h=t[d];l.forEach(_=>h.set(_,f4(n,_)))}}return t}(t,V,D);const ne=function Z$(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=SR(t[0]),t.length>1&&(r=SR(t[t.length-1]))):t instanceof Map&&(e=SR(t)),e||r?new Q$(n,e,r):null}(t,V);return new T4(t,V,x,ne)}}let tq=(()=>{class n extends UP{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Oa.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const l=Array.isArray(e)?HP(e):e;return I4(this._renderer,null,r,"register",[l]),new nq(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(ee(Dp),ee(Mt))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();class nq extends SH{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new iq(this._id,t,e||{},this._renderer)}}class iq{constructor(t,e,r,l){this.id=t,this.element=e,this._renderer=l,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return I4(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function I4(n,t,e,r,l){return n.setProperty(t,`@@${e}:${r}`,l)}const A4="@.disabled";let rq=(()=>{class n{constructor(e,r,l){this.delegate=e,this.engine=r,this._zone=l,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(d,h)=>{const _=h?.parentNode(d);_&&h.removeChild(_,d)}}createRenderer(e,r){const d=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let I=this._rendererCache.get(d);return I||(I=new R4("",d,this.engine,()=>this._rendererCache.delete(d)),this._rendererCache.set(d,I)),I}const h=r.id,_=r.id+"-"+this._currentId;this._currentId++,this.engine.register(_,e);const x=I=>{Array.isArray(I)?I.forEach(x):this.engine.registerTrigger(h,_,e,I.name,I)};return r.data.animation.forEach(x),new oq(this,_,d,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,l){e>=0&&e<this._microtaskId?this._zone.run(()=>r(l)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(d=>{const[h,_]=d;h(_)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,l]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(ee(Dp),ee(zE),ee(ln))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();class R4{constructor(t,e,r,l){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=l,this.destroyNode=this.delegate.destroyNode?d=>e.destroyNode(d):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,l=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,l)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,l){this.delegate.setAttribute(t,e,r,l)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,l){this.delegate.setStyle(t,e,r,l)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==A4?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class oq extends R4{constructor(t,e,r,l,d){super(e,r,l,d),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==A4?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const l=function aq(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let d=e.slice(1),h="";return"@"!=d.charAt(0)&&([d,h]=function sq(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(d)),this.engine.listen(this.namespaceId,l,d,h,_=>{this.factory.scheduleListenerCallback(_._data||-1,r,_)})}return this.delegate.listen(t,e,r)}}const F4=[{provide:UP,useClass:tq},{provide:vR,useFactory:function cq(){return new M$}},{provide:zE,useClass:(()=>{class n extends zE{constructor(e,r,l,d){super(e.body,r,l)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(ee(Mt),ee(sR),ee(vR),ee(fh))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})()},{provide:Dp,useFactory:function dq(n,t,e){return new rq(n,t,e)},deps:[aD,zE,ln]}],DR=[{provide:sR,useFactory:()=>new eq},{provide:no,useValue:"BrowserAnimations"},...F4],O4=[{provide:sR,useClass:a4},{provide:no,useValue:"NoopAnimations"},...F4];let uq=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?O4:DR}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:DR,imports:[PO]}),n})();const vq={provide:new Ye("mat-autocomplete-scroll-strategy"),deps:[Ga],useFactory:function _q(n){return()=>n.scrollStrategies.reposition()}};let xq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[vq],imports:[xh,GD,un,Yr,Hd,GD,un]}),n})(),wq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[Z0,un,un]}),n})();function Cq(n,t){}class UE{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0}}let L4=(()=>{class n extends KD{constructor(e,r,l,d,h,_,x,D){super(),this._elementRef=e,this._focusTrapFactory=r,this._config=d,this._interactivityChecker=h,this._ngZone=_,this._overlayRef=x,this._focusMonitor=D,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=I=>{this._portalOutlet.hasAttached();const V=this._portalOutlet.attachDomPortal(I);return this._contentAttached(),V},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=l}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),r}attachTemplatePortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),r}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,r){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const l=()=>{e.removeEventListener("blur",l),e.removeEventListener("mousedown",l),e.removeAttribute("tabindex")};e.addEventListener("blur",l),e.addEventListener("mousedown",l)})),e.focus(r)}_focusByCssSelector(e,r){let l=this._elementRef.nativeElement.querySelector(e);l&&this._forceFocus(l,r)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{r||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._config.restoreFocus;let r=null;if("string"==typeof e?r=this._document.querySelector(e):"boolean"==typeof e?r=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(r=e),this._config.restoreFocus&&r&&"function"==typeof r.focus){const l=OD(),d=this._elementRef.nativeElement;(!l||l===this._document.body||l===d||d.contains(l))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,r=OD();return e===r||e.contains(r)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=OD())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(cA),re(Mt,8),re(UE),re(HD),re(ln),re(sx),re(yc))},n.\u0275cmp=Mn({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(e,r){if(1&e&&Ti(ix,7),2&e){let l;Ot(l=Kt())&&(r._portalOutlet=l.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(e,r){2&e&&On("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},features:[Et],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,r){1&e&&Bt(0,Cq,0,0,"ng-template",0)},dependencies:[ix],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),n})();class ER{constructor(t,e){this.overlayRef=t,this.config=e,this.closed=new Le,this.disableClose=e.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!bc(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})})}close(t,e){if(this.containerInstance){const r=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this.overlayRef.dispose(),r.next(t),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",e=""){return this.overlayRef.updateSize({width:t,height:e}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}}const B4=new Ye("DialogScrollStrategy"),Sq=new Ye("DialogData"),Dq=new Ye("DefaultDialogConfig"),kq={provide:B4,deps:[Ga],useFactory:function Eq(n){return()=>n.scrollStrategies.block()}};let Mq=0,z4=(()=>{class n{constructor(e,r,l,d,h,_){this._overlay=e,this._injector=r,this._defaultOptions=l,this._parentDialog=d,this._overlayContainer=h,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Le,this._afterOpenedAtThisLevel=new Le,this._ariaHiddenElements=new Map,this.afterAllClosed=M0(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(_c(void 0))),this._scrollStrategy=_}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}open(e,r){(r={...this._defaultOptions||new UE,...r}).id=r.id||"cdk-dialog-"+Mq++,r.id&&this.getDialogById(r.id);const d=this._getOverlayConfig(r),h=this._overlay.create(d),_=new ER(h,r),x=this._attachContainer(h,_,r);return _.containerInstance=x,this._attachDialogContent(e,_,x,r),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(_),_.closed.subscribe(()=>this._removeOpenDialog(_,!0)),this.afterOpened.next(_),_}closeAll(){kR(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){kR(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),kR(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const r=new QD({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(r.backdropClass=e.backdropClass),r}_attachContainer(e,r,l){const d=l.injector||l.viewContainerRef?.injector,h=[{provide:UE,useValue:l},{provide:ER,useValue:r},{provide:sx,useValue:e}];let _;l.container?"function"==typeof l.container?_=l.container:(_=l.container.type,h.push(...l.container.providers(l))):_=L4;const x=new g_(_,l.viewContainerRef,nn.create({parent:d||this._injector,providers:h}),l.componentFactoryResolver);return e.attach(x).instance}_attachDialogContent(e,r,l,d){if(e instanceof qr){const h=this._createInjector(d,r,l,void 0);let _={$implicit:d.data,dialogRef:r};d.templateContext&&(_={..._,..."function"==typeof d.templateContext?d.templateContext():d.templateContext}),l.attachTemplatePortal(new YD(e,null,_,h))}else{const h=this._createInjector(d,r,l,this._injector),_=l.attachComponentPortal(new g_(e,d.viewContainerRef,h,d.componentFactoryResolver));r.componentInstance=_.instance}}_createInjector(e,r,l,d){const h=e.injector||e.viewContainerRef?.injector,_=[{provide:Sq,useValue:e.data},{provide:ER,useValue:r}];return e.providers&&("function"==typeof e.providers?_.push(...e.providers(r,e,l)):_.push(...e.providers)),e.direction&&(!h||!h.get(Es,null,{optional:!0}))&&_.push({provide:Es,useValue:{value:e.direction,change:hn()}}),nn.create({parent:h||d,providers:_})}_removeOpenDialog(e,r){const l=this.openDialogs.indexOf(e);l>-1&&(this.openDialogs.splice(l,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((d,h)=>{d?h.setAttribute("aria-hidden",d):h.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const r=e.parentElement.children;for(let l=r.length-1;l>-1;l--){const d=r[l];d!==e&&"SCRIPT"!==d.nodeName&&"STYLE"!==d.nodeName&&!d.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(d,d.getAttribute("aria-hidden")),d.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return n.\u0275fac=function(e){return new(e||n)(ee(Ga),ee(nn),ee(Dq,8),ee(n,12),ee(JD),ee(B4))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})();function kR(n,t){let e=n.length;for(;e--;)t(n[e])}let V4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[z4,kq],imports:[xh,wc,Z0,wc]}),n})(),Tq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[V4,un,wc,un]}),n})(),Pq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,ks,un]}),n})(),q4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})(),Kq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,ks,q4,un,q4]}),n})();const X4=new Ye("mat-chips-default-options");let TY=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[WD,{provide:X4,useValue:{separatorKeyCodes:[13]}}],imports:[un,Yr,ks,un]}),n})(),IY=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[c_]}),n})(),IR=(()=>{class n{constructor(){this.changes=new Le,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const UY={provide:IR,deps:[[new Vo,new Uo,IR]],useFactory:function VY(n){return n||new IR}};let HY=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[UY,WD],imports:[un,Yr,wc,IY,ML,ks,un]}),n})(),GY=(()=>{class n{constructor(){this.changes=new Le,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,r){return`${e} \u2013 ${r}`}formatYearRangeLabel(e,r){return`${e} to ${r}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const tK={provide:new Ye("mat-datepicker-scroll-strategy"),deps:[Ga],useFactory:function eK(n){return()=>n.scrollStrategies.reposition()}};let lK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[GY,tK],imports:[Yr,qD,xh,Z0,wc,un,Hd]}),n})();var Of_OPEN="mdc-dialog--open",dB_DIALOG_ANIMATION_CLOSE_TIME_MS=(["textarea",".mdc-menu .mdc-list-item",".mdc-menu .mdc-deprecated-list-item"].join(", "),75);function cK(n,t){}class qE{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}let dK=(()=>{class n extends L4{constructor(e,r,l,d,h,_,x,D){super(e,r,l,d,h,_,x,D),this._animationStateChanged=new En}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(cA),re(Mt,8),re(qE),re(HD),re(ln),re(sx),re(yc))},n.\u0275cmp=Mn({type:n,selectors:[["ng-component"]],features:[Et],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const uB="--mat-dialog-transition-duration";function hB(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?Mo(n.substring(0,n.length-2)):n.endsWith("s")?1e3*Mo(n.substring(0,n.length-1)):"0"===n?0:null}let uK=(()=>{class n extends dK{constructor(e,r,l,d,h,_,x,D,I){super(e,r,l,d,h,_,x,I),this._animationMode=D,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._openAnimationDuration=this._animationsEnabled?hB(this._config.enterAnimationDuration)??150:0,this._closeAnimationDuration=this._animationsEnabled?hB(this._config.exitAnimationDuration)??dB_DIALOG_ANIMATION_CLOSE_TIME_MS:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._openAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._closeAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._openAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(uB,`${this._openAnimationDuration}ms`),this._hostElement.classList.add("mdc-dialog--opening"),this._hostElement.classList.add(Of_OPEN),this._waitForAnimationToComplete(this._openAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(Of_OPEN),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._closeAnimationDuration}),this._hostElement.classList.remove(Of_OPEN),this._animationsEnabled?(this._hostElement.style.setProperty(uB,`${this._openAnimationDuration}ms`),this._hostElement.classList.add("mdc-dialog--closing"),this._waitForAnimationToComplete(this._closeAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove("mdc-dialog--opening"),this._hostElement.classList.remove("mdc-dialog--closing")}_waitForAnimationToComplete(e,r){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,e)}}return n.\u0275fac=function(e){return new(e||n)(re(Ut),re(cA),re(Mt,8),re(qE),re(HD),re(ln),re(sx),re(no,8),re(yc))},n.\u0275cmp=Mn({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(e,r){2&e&&(fi("id",r._config.id),On("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),Wn("_mat-animation-noopable",!r._animationsEnabled))},features:[Et],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(e,r){1&e&&(ct(0,"div",0)(1,"div",1),Bt(2,cK,0,0,"ng-template",2),dt()())},dependencies:[ix],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__title,.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__actions,.mat-mdc-dialog-container.mdc-dialog--scrollable.mdc-dialog-scroll-divider-footer .mdc-dialog__actions{border-color:var(--mdc-dialog-with-divider-divider-color, black)}.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__title{border-bottom-color:var(--mdc-dialog-with-divider-divider-color, black)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, "Arial");line-height:var(--mdc-dialog-subhead-line-height, 14px);font-size:var(--mdc-dialog-subhead-size, 14px);font-weight:var(--mdc-dialog-subhead-weight, 500);letter-spacing:var(--mdc-dialog-subhead-tracking, 1px)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, black)}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, "Arial");line-height:var(--mdc-dialog-supporting-text-line-height, 14px);font-size:var(--mdc-dialog-supporting-text-size, 14px);font-weight:var(--mdc-dialog-supporting-text-weight, 500);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 1px)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, black)}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2}),n})();class hK{constructor(t,e,r){this._ref=t,this._containerInstance=r,this._afterOpened=new Le,this._beforeClosed=new Le,this._state=0,this.disableClose=e.disableClose,this.id=t.id,r._animationStateChanged.pipe(Eo(l=>"opened"===l.state),Kr(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(Eo(l=>"closed"===l.state),Kr(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),Ra(this.backdropClick(),this.keydownEvents().pipe(Eo(l=>27===l.keyCode&&!this.disableClose&&!bc(l)))).subscribe(l=>{this.disableClose||(l.preventDefault(),function pK(n,t,e){n._closeInteractionType=t,n.close(e)}(this,"keydown"===l.type?"keyboard":"mouse"))})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(Eo(e=>"closing"===e.state),Kr(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let e=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",e=""){return this._ref.updateSize(t,e),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const fK=new Ye("MatMdcDialogData"),mK=new Ye("mat-mdc-dialog-default-options"),pB=new Ye("mat-mdc-dialog-scroll-strategy"),_K={provide:pB,deps:[Ga],useFactory:function gK(n){return()=>n.scrollStrategies.block()}};let vK=0,bK=(()=>{class n{constructor(e,r,l,d,h,_,x,D,I,V){this._overlay=e,this._defaultOptions=l,this._parentDialog=d,this._dialogRefConstructor=x,this._dialogContainerType=D,this._dialogDataToken=I,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Le,this._afterOpenedAtThisLevel=new Le,this._idPrefix="mat-dialog-",this.dialogConfigClass=qE,this.afterAllClosed=M0(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(_c(void 0))),this._scrollStrategy=_,this._dialog=r.get(z4)}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(e,r){let l;(r={...this._defaultOptions||new qE,...r}).id=r.id||`${this._idPrefix}${vK++}`,r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const d=this._dialog.open(e,{...r,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:UE,useValue:r}]},templateContext:()=>({dialogRef:l}),providers:(h,_,x)=>(l=new this._dialogRefConstructor(h,r,x),l.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:x},{provide:this._dialogDataToken,useValue:_.data},{provide:this._dialogRefConstructor,useValue:l}])});return l.componentInstance=d.componentInstance,this.openDialogs.push(l),this.afterOpened.next(l),l.afterClosed().subscribe(()=>{const h=this.openDialogs.indexOf(l);h>-1&&(this.openDialogs.splice(h,1),this.openDialogs.length||this._getAfterAllClosed().next())}),l}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let r=e.length;for(;r--;)e[r].close()}}return n.\u0275fac=function(e){$s()},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),yK=(()=>{class n extends bK{constructor(e,r,l,d,h,_,x,D){super(e,r,d,_,x,h,hK,uK,fK,D),this._idPrefix="mat-mdc-dialog-"}}return n.\u0275fac=function(e){return new(e||n)(ee(Ga),ee(nn),ee(oa,8),ee(mK,8),ee(pB),ee(n,12),ee(JD),ee(no,8))},n.\u0275prov=St({token:n,factory:n.\u0275fac}),n})(),xK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[yK,_K],imports:[V4,xh,wc,un,un]}),n})(),mB=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,un]}),n})(),wK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})(),CK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[Yr,un,wK,wc]}),n})(),EK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[FP,un,FP,un]}),n})(),XK=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[zD,Yr,un,ks,zP,mB]}),n})();const eX={provide:new Ye("mat-menu-scroll-strategy"),deps:[Ga],useFactory:function JK(n){return()=>n.scrollStrategies.reposition()}};let tX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[eX],imports:[Yr,ks,un,xh,Hd,un]}),n})();const aX={provide:new Ye("mat-select-scroll-strategy"),deps:[Ga],useFactory:function oX(n){return()=>n.scrollStrategies.reposition()}};let CB=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[aX],imports:[Yr,xh,GD,un,Hd,eR,GD,un]}),n})(),FR=(()=>{class n{constructor(){this.changes=new Le,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,r,l)=>{if(0==l||0==r)return`0 of ${l}`;const d=e*r;return`${d+1} \u2013 ${d<(l=Math.max(l,0))?Math.min(d+r,l):d+r} of ${l}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const uX={provide:FR,deps:[[new Vo,new Uo,FR]],useFactory:function dX(n){return n||new FR}};let hX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[uX],imports:[Yr,qD,CB,VL]}),n})(),fX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un]}),n})(),_X=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[Yr,un]}),n})(),bX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[Yr,un,Hd,Hd,un]}),n})(),MX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,Yr,ks]}),n})(),kB=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})(),zX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[kB,un,ks,Yr,kB,un]}),n})(),OR=(()=>{class n{constructor(){this.changes=new Le}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const UX={provide:OR,deps:[[new Vo,new Uo,OR]],useFactory:function VX(n){return n||new OR}};let HX=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({providers:[UX],imports:[Yr,un]}),n})(),nZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[yA]}),n})(),bZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[un,nZ,un]}),n})(),DZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[Yr,un,wc,ks,zD,Z0,un]}),n})(),IZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})(),BZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({imports:[IZ,un,un]}),n})();class T_{}T_.\u0275fac=function(t){return new(t||T_)},T_.\u0275mod=Vt({type:T_}),T_.\u0275inj=$t({imports:[xq,wq,Tq,qD,Pq,G7,Kq,TY,HY,lK,xK,mB,CK,EK,ML,NW,XK,tX,oH,hX,fX,_X,O9,ks,CB,bX,MX,zX,o3,HX,bZ,DZ,uG,VL,BZ]});let zZ=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vt({type:n}),n.\u0275inj=$t({}),n})();class I_{}I_.\u0275fac=function(t){return new(t||I_)},I_.\u0275mod=Vt({type:I_,bootstrap:[Cx]}),I_.\u0275inj=$t({imports:[PO,x_,T7,uq,T_,zZ]}),QV().bootstrapModule(I_).catch(n=>console.error(n))},875:function(cn,ye,Re){"use strict";var ie=this&&this.__awaiter||function(de,ke,ae,De){return new(ae||(ae=Promise))(function(Ee,ht){function Be(pt){try{Ve(De.next(pt))}catch(ze){ht(ze)}}function kt(pt){try{Ve(De.throw(pt))}catch(ze){ht(ze)}}function Ve(pt){pt.done?Ee(pt.value):function $(Ee){return Ee instanceof ae?Ee:new ae(function(ht){ht(Ee)})}(pt.value).then(Be,kt)}Ve((De=De.apply(de,ke||[])).next())})},ce=this&&this.__generator||function(de,ke){var De,$,Ee,ht,ae={label:0,sent:function(){if(1&Ee[0])throw Ee[1];return Ee[1]},trys:[],ops:[]};return ht={next:Be(0),throw:Be(1),return:Be(2)},"function"==typeof Symbol&&(ht[Symbol.iterator]=function(){return this}),ht;function Be(Ve){return function(pt){return function kt(Ve){if(De)throw new TypeError("Generator is already executing.");for(;ae;)try{if(De=1,$&&(Ee=2&Ve[0]?$.return:Ve[0]?$.throw||((Ee=$.return)&&Ee.call($),0):$.next)&&!(Ee=Ee.call($,Ve[1])).done)return Ee;switch($=0,Ee&&(Ve=[2&Ve[0],Ee.value]),Ve[0]){case 0:case 1:Ee=Ve;break;case 4:return ae.label++,{value:Ve[1],done:!1};case 5:ae.label++,$=Ve[1],Ve=[0];continue;case 7:Ve=ae.ops.pop(),ae.trys.pop();continue;default:if(!(Ee=(Ee=ae.trys).length>0&&Ee[Ee.length-1])&&(6===Ve[0]||2===Ve[0])){ae=0;continue}if(3===Ve[0]&&(!Ee||Ve[1]>Ee[0]&&Ve[1]<Ee[3])){ae.label=Ve[1];break}if(6===Ve[0]&&ae.label<Ee[1]){ae.label=Ee[1],Ee=Ve;break}if(Ee&&ae.label<Ee[2]){ae.label=Ee[2],ae.ops.push(Ve);break}Ee[2]&&ae.ops.pop(),ae.trys.pop();continue}Ve=ke.call(de,ae)}catch(pt){Ve=[6,pt],$=0}finally{De=Ee=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([Ve,pt])}}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.loadFromFiles=ye.load=ye.loadTruncatedMobileNet=ye.CustomMobileNet=ye.getTopKClasses=ye.IMAGE_SIZE=void 0;var j=Re(131),J=Re(131),K=Re(728),xe=Re(810),E=Re(530),Y=.25,z=.35;ye.IMAGE_SIZE=224;var f=function(de){return de.packageVersion=de.packageVersion||E.version,de.packageName=de.packageName||"@teachablemachine/image",de.timeStamp=de.timeStamp||(new Date).toISOString(),de.userMetadata=de.userMetadata||{},de.modelName=de.modelName||"untitled",de.labels=de.labels||[],de.imageSize=de.imageSize||ye.IMAGE_SIZE,de},w=function(de,ke){if(1===de){if(.25!==ke&&.5!==ke&&.75!==ke&&1!==ke)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",Y.toFixed(2)),Y}else if(.35!==ke&&.5!==ke&&.75!==ke&&1!==ke)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",z.toFixed(2)),z;return ke},R=function(de){return ie(void 0,void 0,void 0,function(){var ke;return ce(this,function(De){switch(De.label){case 0:return"string"!=typeof de?[3,3]:[4,fetch(de)];case 1:return[4,De.sent().json()];case 2:return ke=De.sent(),[3,4];case 3:if(!function(de){return!!de&&Array.isArray(de.labels)}(de))throw new Error("Invalid Metadata provided");ke=de,De.label=4;case 4:return[2,f(ke)]}})})};function H(de,ke,ae){return void 0===ae&&(ae=3),ie(this,void 0,void 0,function(){var De;return ce(this,function($){switch($.label){case 0:return[4,ke.data()];case 1:return De=$.sent(),[2,j.tidy(function(){ae=Math.min(ae,De.length);for(var Ee=[],ht=0;ht<De.length;ht++)Ee.push({value:De[ht],index:ht});Ee.sort(function(pt,ze){return ze.value-pt.value});var Be=new Float32Array(ae),kt=new Int32Array(ae);for(ht=0;ht<ae;ht++)Be[ht]=Ee[ht].value,kt[ht]=Ee[ht].index;var Ve=[];for(ht=0;ht<kt.length;ht++)Ve.push({className:de[kt[ht]],probability:Be[ht]});return Ve})]}})})}ye.getTopKClasses=H;var L=function(){function de(ke,ae){this.model=ke,this._metadata=f(ae)}return Object.defineProperty(de,"EXPECTED_IMAGE_SIZE",{get:function(){return ye.IMAGE_SIZE},enumerable:!1,configurable:!0}),de.prototype.getMetadata=function(){return this._metadata},de.prototype.getTotalClasses=function(){return this.model.output.shape[1]},de.prototype.getClassLabels=function(){return this._metadata.labels},de.prototype.predictTopK=function(ke,ae,De){return void 0===ae&&(ae=10),void 0===De&&(De=!1),ie(this,void 0,void 0,function(){var $,Ee,ht,Be=this;return ce(this,function(kt){switch(kt.label){case 0:return $=xe.cropTo(ke,this._metadata.imageSize,De),Ee=j.tidy(function(){var Ve=K.capture($,Be._metadata.grayscale);return Be.model.predict(Ve)}),[4,H(this._metadata.labels,Ee,ae)];case 1:return ht=kt.sent(),J.dispose(Ee),[2,ht]}})})},de.prototype.predict=function(ke,ae){return void 0===ae&&(ae=!1),ie(this,void 0,void 0,function(){var De,$,Ee,ht,Be,kt=this;return ce(this,function(Ve){switch(Ve.label){case 0:return De=xe.cropTo(ke,this._metadata.imageSize,ae),[4,($=j.tidy(function(){var pt=K.capture(De,kt._metadata.grayscale);return kt.model.predict(pt)})).data()];case 1:for(Ee=Ve.sent(),ht=[],Be=0;Be<Ee.length;Be++)ht.push({className:this._metadata.labels[Be],probability:Ee[Be]});return J.dispose($),[2,ht]}})})},de.prototype.dispose=function(){this.truncatedModel.dispose()},de}();ye.CustomMobileNet=L,ye.loadTruncatedMobileNet=function oe(de){return ie(this,void 0,void 0,function(){var ke,De,$,Ee,ht,Be;return ce(this,function(kt){switch(kt.label){case 0:return ke=function(de){if((de=de||{}).checkpointUrl&&de.trainingLayer)return(de.alpha||de.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[de.checkpointUrl,de.trainingLayer];if(de.version=de.version||1,1===de.version){de.alpha=de.alpha||Y,de.alpha=w(de.version,de.alpha),console.log("Loading mobilenet "+de.version+" and alpha "+de.alpha);var ke=de.alpha.toFixed(2);return"1.00"===ke&&(ke="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+ke+"_"+ye.IMAGE_SIZE+"/model.json","conv_pw_13_relu"]}if(2===de.version)return de.alpha=de.alpha||z,de.alpha=w(de.version,de.alpha),console.log("Loading mobilenet "+de.version+" and alpha "+de.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+de.alpha.toFixed(2)+"_"+ye.IMAGE_SIZE+"_no_top/model.json","out_relu"];throw new Error("MobileNet V"+de.version+" doesn't exist")}(de),De=ke[1],[4,j.loadLayersModel(ke[0])];case 1:return $=kt.sent(),de&&1===de.version?(Ee=$.getLayer(De),ht=j.model({inputs:$.inputs,outputs:Ee.output}),(Be=j.sequential()).add(ht),Be.add(j.layers.flatten()),[2,Be]):(Ee=$.getLayer(De),ht=j.model({inputs:$.inputs,outputs:Ee.output}),(Be=j.sequential()).add(ht),Be.add(j.layers.globalAveragePooling2d({})),[2,Be])}})})},ye.load=function ve(de,ke){return ie(this,void 0,void 0,function(){var ae,$;return ce(this,function(Ee){switch(Ee.label){case 0:return[4,j.loadLayersModel(de)];case 1:return ae=Ee.sent(),ke?[4,R(ke)]:[3,3];case 2:return $=Ee.sent(),[3,4];case 3:$=null,Ee.label=4;case 4:return[2,new L(ae,$)]}})})},ye.loadFromFiles=function we(de,ke,ae){return ie(this,void 0,void 0,function(){var De,$,ht;return ce(this,function(Be){switch(Be.label){case 0:return[4,j.loadLayersModel(j.io.browserFiles([de,ke]))];case 1:return De=Be.sent(),[4,new Response(ae).json()];case 2:return $=Be.sent(),ae?[4,R($)]:[3,4];case 3:return ht=Be.sent(),[3,5];case 4:ht=null,Be.label=5;case 5:return[2,new L(De,ht)]}})})}},275:(cn,ye,Re)=>{"use strict";var ce=Re(875);Object.defineProperty(ye,"zD",{enumerable:!0,get:function(){return ce.load}});Re(602),Re(374),Re(530)},602:function(cn,ye,Re){"use strict";var w,ie=this&&this.__extends||(w=function(T,R){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,L){H.__proto__=L}||function(H,L){for(var oe in L)L.hasOwnProperty(oe)&&(H[oe]=L[oe])})(T,R)},function(T,R){function H(){this.constructor=T}w(T,R),T.prototype=null===R?Object.create(R):(H.prototype=R.prototype,new H)}),ce=this&&this.__awaiter||function(w,T,R,H){return new(R||(R=Promise))(function(oe,ve){function we(ae){try{ke(H.next(ae))}catch(De){ve(De)}}function de(ae){try{ke(H.throw(ae))}catch(De){ve(De)}}function ke(ae){ae.done?oe(ae.value):function L(oe){return oe instanceof R?oe:new R(function(ve){ve(oe)})}(ae.value).then(we,de)}ke((H=H.apply(w,T||[])).next())})},j=this&&this.__generator||function(w,T){var H,L,oe,ve,R={label:0,sent:function(){if(1&oe[0])throw oe[1];return oe[1]},trys:[],ops:[]};return ve={next:we(0),throw:we(1),return:we(2)},"function"==typeof Symbol&&(ve[Symbol.iterator]=function(){return this}),ve;function we(ke){return function(ae){return function de(ke){if(H)throw new TypeError("Generator is already executing.");for(;R;)try{if(H=1,L&&(oe=2&ke[0]?L.return:ke[0]?L.throw||((oe=L.return)&&oe.call(L),0):L.next)&&!(oe=oe.call(L,ke[1])).done)return oe;switch(L=0,oe&&(ke=[2&ke[0],oe.value]),ke[0]){case 0:case 1:oe=ke;break;case 4:return R.label++,{value:ke[1],done:!1};case 5:R.label++,L=ke[1],ke=[0];continue;case 7:ke=R.ops.pop(),R.trys.pop();continue;default:if(!(oe=(oe=R.trys).length>0&&oe[oe.length-1])&&(6===ke[0]||2===ke[0])){R=0;continue}if(3===ke[0]&&(!oe||ke[1]>oe[0]&&ke[1]<oe[3])){R.label=ke[1];break}if(6===ke[0]&&R.label<oe[1]){R.label=oe[1],oe=ke;break}if(oe&&R.label<oe[2]){R.label=oe[2],R.ops.push(ke);break}oe[2]&&R.ops.pop(),R.trys.pop();continue}ke=T.call(w,R)}catch(ae){ke=[6,ae],L=0}finally{H=oe=0}if(5&ke[0])throw ke[1];return{value:ke[0]?ke[1]:void 0,done:!0}}([ke,ae])}}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.createTeachable=ye.TeachableMobileNet=void 0;var J=Re(131),K=Re(131),xe=Re(728),E=Re(875),pe=Re(340);function z(w,T){for(var R,H=w.length,L=w.slice(),oe=H-1;oe>0;oe-=1){var ve;ve=T?Math.floor(T()*(oe+1)):Math.floor(Math.random()*(oe+1)),L[oe]=(R=[L[ve],L[oe]])[0],L[ve]=R[1]}return L}var f=function(w){function T(R,H){var L=w.call(this,J.sequential(),H)||this;return L.totalSamples=0,L.examples=[],L.truncatedModel=R,L}return ie(T,w),Object.defineProperty(T.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),T.prototype.addExample=function(R,H){return ce(this,void 0,void 0,function(){var L,oe,ve;return j(this,function(we){return L=function(w){return"object"==typeof w.dataId&&"object"==typeof w.shape}(H)?H:xe.capture(H,this._metadata.grayscale),oe=this.truncatedModel.predict(L),ve=oe.dataSync(),L.dispose(),oe.dispose(),this.examples[R].push(ve),this.totalSamples++,[2]})})},T.prototype.predict=function(R,H){return void 0===H&&(H=!1),ce(this,void 0,void 0,function(){return j(this,function(L){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,w.prototype.predict.call(this,R,H)]})})},T.prototype.predictTopK=function(R,H,L){return void 0===H&&(H=10),void 0===L&&(L=!1),ce(this,void 0,void 0,function(){return j(this,function(oe){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,w.prototype.predictTopK.call(this,R,H,L)]})})},T.prototype.prepare=function(){for(var R in this.examples)if(0===R.length)throw new Error("Add some examples before training");var H=this.convertToTfDataset();this.trainDataset=H.trainDataset,this.validationDataset=H.validationDataset},T.prototype.convertToTfDataset=function(){for(var R=0;R<this.examples.length;R++)this.examples[R]=z(this.examples[R],this.seed);var H=[],L=[],oe=function(De){var $=function Y(w,T){var R=new Array(T).fill(0);return R[w]=1,R}(De,ve.numClasses),Ee=ve.examples[De].length,Be=Ee-Math.ceil(.15*Ee),kt=ve.examples[De].slice(0,Be).map(function(pt){return{data:pt,label:$}}),Ve=ve.examples[De].slice(Be).map(function(pt){return{data:pt,label:$}});H=H.concat(kt),L=L.concat(Ve)},ve=this;for(R=0;R<this.examples.length;R++)oe(R);H=z(H,this.seed),L=z(L,this.seed);var we=J.data.array(H.map(function(De){return De.data})),de=J.data.array(L.map(function(De){return De.data})),ke=J.data.array(H.map(function(De){return De.label})),ae=J.data.array(L.map(function(De){return De.label}));return{trainDataset:J.data.zip({xs:we,ys:ke}),validationDataset:J.data.zip({xs:de,ys:ae})}},T.prototype.save=function(R,H){return ce(this,void 0,void 0,function(){return j(this,function(L){return[2,this.model.save(R,H)]})})},T.prototype.train=function(R,H){return void 0===H&&(H={}),ce(this,void 0,void 0,function(){var L,oe,ve,we,de,ke,ae,De,Ee,ht=this;return j(this,function(Be){switch(Be.label){case 0:if(L=H.onTrainEnd||function(){},H.onTrainEnd=function(kt){ht.__stopTrainingResolve&&(ht.__stopTrainingResolve(),ht.__stopTrainingResolve=null),L(kt)},this.isPrepared||this.prepare(),oe=this.getLabels().length,K.util.assert(oe===this.numClasses,function(){return"Can not train, has "+oe+" labels and "+ht.numClasses+" classes"}),ve=this.truncatedModel.outputs[0].shape.slice(1),we=J.util.sizeFromShape(ve),de=J.initializers.varianceScaling(this.seed?{seed:3.14}:{}),this.trainingModel=J.sequential({layers:[J.layers.dense({inputShape:[we],units:R.denseUnits,activation:"relu",kernelInitializer:de,useBias:!0}),J.layers.dense({kernelInitializer:de,useBias:!1,activation:"softmax",units:this.numClasses})]}),ke=J.train.adam(R.learningRate),this.trainingModel.compile({optimizer:ke,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(R.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return ae=this.trainDataset.batch(R.batchSize),De=this.validationDataset.batch(R.batchSize),[4,this.trainingModel.fitDataset(ae,{epochs:R.epochs,validationData:De,callbacks:H})];case 1:return Be.sent(),(Ee=J.sequential()).add(this.truncatedModel),Ee.add(this.trainingModel),this.model=Ee,ke.dispose(),[2,this.model]}})})},T.prototype.prepareDataset=function(){for(var R=0;R<this.numClasses;R++)this.examples[R]=[]},T.prototype.setLabel=function(R,H){this._metadata.labels[R]=H},T.prototype.setLabels=function(R){this._metadata.labels=R,this.prepareDataset()},T.prototype.getLabel=function(R){return this._metadata.labels[R]},T.prototype.getLabels=function(){return this._metadata.labels},T.prototype.setName=function(R){this._metadata.modelName=R},T.prototype.getName=function(){return this._metadata.modelName},T.prototype.stopTraining=function(){var R=this;return new Promise(function(L,oe){R.trainingModel.stopTraining=!0,R.__stopTrainingResolve=L})},T.prototype.dispose=function(){this.trainingModel.dispose(),w.prototype.dispose.call(this)},T.prototype.calculateAccuracyPerClass=function(){return ce(this,void 0,void 0,function(){var R,H,L,oe,ve,we,de,ke,ae,De,$,Ee,ht,Be,kt,Ve,pt,ze,Ge=this;return j(this,function(Jt){switch(Jt.label){case 0:return R=this.validationDataset.mapAsync(function(zt){return ce(Ge,void 0,void 0,function(){return j(this,function(Le){return[2,zt.xs]})})}),H=this.validationDataset.mapAsync(function(zt){return ce(Ge,void 0,void 0,function(){return j(this,function(Le){return[2,zt.ys]})})}),L=Math.min(H.size,32),oe=Math.ceil(H.size/L),ve=R.batch(L),we=H.batch(L),[4,ve.iterator()];case 1:return de=Jt.sent(),[4,we.iterator()];case 2:ke=Jt.sent(),ae=[],De=[],ze=0,Jt.label=3;case 3:return ze<oe?[4,de.next()]:[3,7];case 4:return $=Jt.sent(),Ee=this.trainingModel.predict($.value),ht=Ee.argMax(1),ae.push(ht),[4,ke.next()];case 5:Be=Jt.sent(),kt=Be.value.argMax(1),De.push(kt),$.value.dispose(),Ee.dispose(),Be.value.dispose(),Jt.label=6;case 6:return ze++,[3,3];case 7:if(Ve=J.concat(De),pt=J.concat(ae),1!==oe)for(ze=0;ze<ae.length;ze++)ae[ze].dispose(),De[ze].dispose();return[2,{reference:Ve,predictions:pt}]}})})},T.prototype.setSeed=function(R){this.seed=pe(R)},T}(E.CustomMobileNet);ye.TeachableMobileNet=f,ye.createTeachable=function b(w,T){return ce(this,void 0,void 0,function(){var R;return j(this,function(H){switch(H.label){case 0:return[4,E.loadTruncatedMobileNet(T)];case 1:return R=H.sent(),[2,new f(R,w)]}})})}},810:(cn,ye)=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.cropTo=ye.resizeMinTo=ye.resizeMaxTo=ye.resize=void 0;var Re=function(){return document.createElement("canvas")};function ie(K,xe,E){return void 0===E&&(E=Re()),E.width=K.width*xe,E.height=K.height*xe,E.getContext("2d").drawImage(K,0,0,E.width,E.height),E}ye.resize=ie,ye.resizeMaxTo=function ce(K,xe,E){return void 0===E&&(E=Re()),ie(K,xe/Math.max(K.width,K.height),E)},ye.resizeMinTo=function j(K,xe,E){return void 0===E&&(E=Re()),ie(K,xe/Math.min(K.width,K.height),E)},ye.cropTo=function J(K,xe,E,pe){void 0===E&&(E=!1),void 0===pe&&(pe=Re());var te=K.width,Z=K.height;K instanceof HTMLVideoElement&&(te=K.videoWidth,Z=K.videoHeight);var z=xe/Math.min(te,Z),f=Math.ceil(te*z),b=Math.ceil(Z*z),w=f-xe,T=b-xe;pe.width=pe.height=xe;var R=pe.getContext("2d");return R.drawImage(K,-1*~~(w/2),-1*~~(T/2),f,b),E&&(R.scale(-1,1),R.drawImage(pe,-1*xe,0)),pe}},728:(cn,ye,Re)=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.cropTensor=ye.capture=void 0;var ie=Re(131);function j(J,K,xe){var E=Math.min(J.shape[0],J.shape[1]),te=J.shape[0]/2-E/2,Y=J.shape[1]/2-E/2;if(K&&!xe){var z=J.slice([te,Y,0],[E,E,3]);return z=z.reshape([E*E,1,3]),z=(z=ie.mul(z,[.2989,.587,.114])).reshape([E,E,3]),z=ie.sum(z,-1),ie.expandDims(z,-1)}return J.slice([te,Y,0],[E,E,3])}ye.capture=function ce(J,K){return ie.tidy(function(){return j(ie.browser.fromPixels(J),K).expandDims(0).toFloat().div(ie.scalar(127)).sub(ie.scalar(1))})},ye.cropTensor=j},374:function(cn,ye,Re){"use strict";var ie=this&&this.__decorate||function(te,Z,Y,z){var w,f=arguments.length,b=f<3?Z:null===z?z=Object.getOwnPropertyDescriptor(Z,Y):z;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)b=Reflect.decorate(te,Z,Y,z);else for(var T=te.length-1;T>=0;T--)(w=te[T])&&(b=(f<3?w(b):f>3?w(Z,Y,b):w(Z,Y))||b);return f>3&&b&&Object.defineProperty(Z,Y,b),b},ce=this&&this.__awaiter||function(te,Z,Y,z){return new(Y||(Y=Promise))(function(b,w){function T(L){try{H(z.next(L))}catch(oe){w(oe)}}function R(L){try{H(z.throw(L))}catch(oe){w(oe)}}function H(L){L.done?b(L.value):function f(b){return b instanceof Y?b:new Y(function(w){w(b)})}(L.value).then(T,R)}H((z=z.apply(te,Z||[])).next())})},j=this&&this.__generator||function(te,Z){var z,f,b,w,Y={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};return w={next:T(0),throw:T(1),return:T(2)},"function"==typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w;function T(H){return function(L){return function R(H){if(z)throw new TypeError("Generator is already executing.");for(;Y;)try{if(z=1,f&&(b=2&H[0]?f.return:H[0]?f.throw||((b=f.return)&&b.call(f),0):f.next)&&!(b=b.call(f,H[1])).done)return b;switch(f=0,b&&(H=[2&H[0],b.value]),H[0]){case 0:case 1:b=H;break;case 4:return Y.label++,{value:H[1],done:!1};case 5:Y.label++,f=H[1],H=[0];continue;case 7:H=Y.ops.pop(),Y.trys.pop();continue;default:if(!(b=(b=Y.trys).length>0&&b[b.length-1])&&(6===H[0]||2===H[0])){Y=0;continue}if(3===H[0]&&(!b||H[1]>b[0]&&H[1]<b[3])){Y.label=H[1];break}if(6===H[0]&&Y.label<b[1]){Y.label=b[1],b=H;break}if(b&&Y.label<b[2]){Y.label=b[2],Y.ops.push(H);break}b[2]&&Y.ops.pop(),Y.trys.pop();continue}H=Z.call(te,Y)}catch(L){H=[6,L],f=0}finally{z=b=0}if(5&H[0])throw H[1];return{value:H[0]?H[1]:void 0,done:!0}}([H,L])}}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.Webcam=void 0;var J=Re(125),K=Re(810),xe={facingMode:"user",frameRate:24},pe=function(){function te(Z,Y,z){void 0===Z&&(Z=400),void 0===Y&&(Y=400),void 0===z&&(z=!1),this.width=Z,this.height=Y,this.flip=z}return te.prototype.getWebcam=function(Z){if(void 0===Z&&(Z={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");Z.width=640;var Y=function(te){return te.facingMode=te.facingMode||xe.facingMode,te.frameRate=te.frameRate||xe.frameRate,te.aspectRatio=te.aspectRatio||xe.aspectRatio,te}(Z),z=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:Y}).then(function(f){return z.srcObject=f,z.addEventListener("loadedmetadata",function(b){var T=z.videoHeight;z.width=z.videoWidth,z.height=T}),z},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},te.prototype.setup=function(Z){return void 0===Z&&(Z={}),ce(this,void 0,void 0,function(){var Y;return j(this,function(z){switch(z.label){case 0:return this.webcam?[3,2]:(Y=this,[4,this.getWebcam(Z)]);case 1:Y.webcam=z.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),z.label=2;case 2:return[2]}})})},te.prototype.play=function(){return this.webcam.play()},te.prototype.pause=function(){this.webcam.pause()},te.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},te.prototype.update=function(){this.renderCameraToCanvas()},te.prototype.stopStreamedVideo=function(Z){Z.srcObject.getTracks().forEach(function(f){f.stop()}),Z.srcObject=null},te.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var Z=this.canvas.getContext("2d");if(0!==this.webcam.videoWidth){var Y=K.cropTo(this.webcam,this.width,this.flip);Z.drawImage(Y,0,0)}}},ie([J.default],te.prototype,"getWebcam",null),ie([J.default],te.prototype,"setup",null),ie([J.default],te.prototype,"play",null),ie([J.default],te.prototype,"pause",null),ie([J.default],te.prototype,"stop",null),ie([J.default],te.prototype,"update",null),ie([J.default],te.prototype,"stopStreamedVideo",null),ie([J.default],te.prototype,"renderCameraToCanvas",null),te}();ye.Webcam=pe},530:(cn,ye)=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0}),ye.version=void 0,ye.version="0.8.4-alpha2"},131:(cn,ye,Re)=>{"use strict";Re.r(ye),Re.d(ye,{AdadeltaOptimizer:()=>fb,AdagradOptimizer:()=>Un,AdamOptimizer:()=>Ct,AdamaxOptimizer:()=>ag,Callback:()=>ZC,CallbackList:()=>Hb,CustomCallback:()=>Wb,DataStorage:()=>zx,ENV:()=>pe,EarlyStopping:()=>Pg,Environment:()=>xe,GraphModel:()=>no,History:()=>jb,InputSpec:()=>Nr,KernelBackend:()=>vl,LayerVariable:()=>bs,LayersModel:()=>Rl,MomentumOptimizer:()=>mb,Optimizer:()=>Sl,RMSPropOptimizer:()=>gb,RNN:()=>Md,Rank:()=>dl,Reduction:()=>yo,SGDOptimizer:()=>Ep,Sequential:()=>Eg,SymbolicTensor:()=>Er,Tensor:()=>ki,TensorBuffer:()=>Bi,Variable:()=>da,abs:()=>Gl,acos:()=>$l,acosh:()=>Xc,add:()=>ai,addN:()=>kv,addStrict:()=>Mv,all:()=>ad,any:()=>sd,argMax:()=>Fu,argMin:()=>Hm,asin:()=>gv,asinh:()=>mw,atan:()=>mm,atan2:()=>Tv,atanh:()=>_v,avgPool:()=>rd,avgPool3d:()=>zm,backend:()=>Go,backend_util:()=>fu,basicLSTMCell:()=>Ow,batchNorm:()=>wm,batchNorm2d:()=>Dv,batchNorm3d:()=>Ev,batchNorm4d:()=>Ho,batchNormalization:()=>ww,batchNormalization2d:()=>xm,batchNormalization3d:()=>yw,batchNormalization4d:()=>xw,batchToSpaceND:()=>pa,booleanMaskAsync:()=>Xl,browser:()=>o1,buffer:()=>Rt,callbacks:()=>Gy,cast:()=>Ns,ceil:()=>gw,clipByValue:()=>Zo,clone:()=>mo,complex:()=>Cn,concat:()=>Ur,concat1d:()=>V_,concat2d:()=>Mn,concat3d:()=>U_,concat4d:()=>$f,constraints:()=>wb,conv1d:()=>Pv,conv2d:()=>Vs,conv2dTranspose:()=>id,conv3d:()=>Fm,conv3dTranspose:()=>zv,cos:()=>vv,cosh:()=>bv,cumsum:()=>Pc,customGrad:()=>Uc,data:()=>ie,deprecationWarn:()=>St,depthToSpace:()=>gr,depthwiseConv2d:()=>nd,deregisterOp:()=>eS,diag:()=>Ym,disableDeprecationWarnings:()=>jf,dispose:()=>Kn,disposeVariables:()=>Fx,div:()=>bo,divStrict:()=>Cw,dot:()=>Pm,dropout:()=>yp,elu:()=>so,enableDebugMode:()=>Nc,enableProdMode:()=>Rx,engine:()=>$t,env:()=>E,equal:()=>Jc,equalStrict:()=>Mm,erf:()=>Du,exp:()=>gm,expandDims:()=>Lo,expm1:()=>yv,eye:()=>Lc,fft:()=>xl,fill:()=>ml,findBackend:()=>kn,findBackendFactory:()=>Ph,floor:()=>sp,floorDiv:()=>mp,frame:()=>Xm,fused:()=>Pu,gather:()=>td,gatherND:()=>Lw,getBackend:()=>Wf,getKernel:()=>Z,getKernelsForBackend:()=>Y,grad:()=>eF,grads:()=>tF,greater:()=>Tu,greaterEqual:()=>gp,greaterEqualStrict:()=>Dw,greaterStrict:()=>Ew,hammingWindow:()=>Km,hannWindow:()=>Yv,ifft:()=>ld,imag:()=>Xn,image:()=>Ql,inTopKAsync:()=>Xv,initializers:()=>RM,input:()=>iC,io:()=>Sa,irfft:()=>bp,isFinite:()=>Hk,isInf:()=>Uk,isNaN:()=>Vk,keep:()=>Ka,layers:()=>YC,leakyRelu:()=>La,less:()=>Rv,lessEqual:()=>Fv,lessEqualStrict:()=>Ov,lessStrict:()=>Tm,linalg:()=>Jm,linspace:()=>Bh,loadGraphModel:()=>DT,loadLayersModel:()=>$M,localResponseNormalization:()=>Gv,log:()=>ql,log1p:()=>_m,logSigmoid:()=>zk,logSoftmax:()=>q_,logSumExp:()=>jv,logicalAnd:()=>fs,logicalNot:()=>Cm,logicalOr:()=>ku,logicalXor:()=>vo,losses:()=>Vw,matMul:()=>Au,math:()=>n1,max:()=>xa,maxPool:()=>_p,maxPool3d:()=>Us,maximum:()=>zs,maximumStrict:()=>Sw,mean:()=>Or,memory:()=>fl,metrics:()=>aT,min:()=>jm,minimum:()=>Yl,minimumStrict:()=>Sm,mod:()=>Iv,modStrict:()=>Mu,model:()=>tC,models:()=>sT,moments:()=>vp,movingAverage:()=>Pw,mul:()=>Vn,mulStrict:()=>Dm,multiRNNCell:()=>Nw,multinomial:()=>Zn,neg:()=>Zc,nextFrame:()=>sg,norm:()=>qm,notEqual:()=>ed,notEqualStrict:()=>Im,oneHot:()=>Ul,ones:()=>ao,onesLike:()=>ua,op:()=>ee,outerProduct:()=>Lm,pad:()=>Xa,pad1d:()=>H_,pad2d:()=>Bc,pad3d:()=>go,pad4d:()=>su,pool:()=>Bm,pow:()=>Kl,powStrict:()=>Em,prelu:()=>Gm,print:()=>mr,prod:()=>Wm,profile:()=>B_,rand:()=>zc,randomGamma:()=>lu,randomNormal:()=>Za,randomUniform:()=>Hl,range:()=>au,ready:()=>Oh,real:()=>Ft,reciprocal:()=>xv,registerBackend:()=>z_,registerCallbackConstructor:()=>qM,registerKernel:()=>z,registerOp:()=>dT,regularizers:()=>cT,relu:()=>Zl,relu6:()=>Wv,removeBackend:()=>Nh,reshape:()=>Yi,reverse:()=>ya,reverse1d:()=>Iw,reverse2d:()=>Vv,reverse3d:()=>Aw,reverse4d:()=>Rw,rfft:()=>Nu,round:()=>lp,rsqrt:()=>wv,scalar:()=>Nt,scatterND:()=>ms,selu:()=>$m,separableConv2d:()=>Iu,sequential:()=>nC,serialization:()=>bt,setBackend:()=>ou,setPlatform:()=>Gf,setdiff1dAsync:()=>_o,sigmoid:()=>Cv,sign:()=>cp,signal:()=>Bw,sin:()=>_w,sinh:()=>vw,slice:()=>Pa,slice1d:()=>Vm,slice2d:()=>Um,slice3d:()=>od,slice4d:()=>Ru,slice_util:()=>JR,softmax:()=>du,softplus:()=>dp,spaceToBatchND:()=>j_,sparseToDense:()=>qv,spectral:()=>jk,split:()=>Os,sqrt:()=>Eu,square:()=>mv,squaredDifference:()=>km,squaredDifferenceStrict:()=>Qc,squeeze:()=>Vc,stack:()=>Qa,step:()=>vm,stft:()=>Kv,stridedSlice:()=>$v,sub:()=>jr,subStrict:()=>Av,sum:()=>wa,tan:()=>bm,tanh:()=>up,tensor:()=>ei,tensor1d:()=>Pn,tensor2d:()=>qi,tensor3d:()=>Jr,tensor4d:()=>oo,tensor5d:()=>ak,tensor6d:()=>sk,tensor_util:()=>ar,test_util:()=>sM,tidy:()=>$e,tile:()=>us,time:()=>ru,topk:()=>Ou,train:()=>hd,transpose:()=>ur,truncatedNormal:()=>jl,unregisterKernel:()=>f,unsortedSegmentSum:()=>Am,unstack:()=>Ja,util:()=>qe,valueAndGrad:()=>nF,valueAndGrads:()=>iF,variable:()=>Oa,variableGrads:()=>uk,version:()=>QF,version_converter:()=>CS,version_core:()=>pb,version_layers:()=>Up,webgl:()=>lM,where:()=>Na,whereAsync:()=>fp,zeros:()=>fn,zerosLike:()=>$n});var ie={};Re.r(ie),Re.d(ie,{CSVDataset:()=>u0,Dataset:()=>ph,FileDataSource:()=>mc,TextLineDataset:()=>hf,URLDataSource:()=>p0,array:()=>zS,csv:()=>f0,func:()=>m0,generator:()=>HT,microphone:()=>_0,version_data:()=>gf,webcam:()=>g0,zip:()=>VS});var ce=function(s,o){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var c in a)a.hasOwnProperty(c)&&(i[c]=a[c])})(s,o)};function j(s,o){function i(){this.constructor=s}ce(s,o),s.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}function J(s,o,i,a){return new(i||(i=Promise))(function(c,u){function p(v){try{g(a.next(v))}catch(y){u(y)}}function m(v){try{g(a.throw(v))}catch(y){u(y)}}function g(v){v.done?c(v.value):new i(function(y){y(v.value)}).then(p,m)}g((a=a.apply(s,o||[])).next())})}function K(s,o){var i,a,c,u,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:m(0),throw:m(1),return:m(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function m(g){return function(v){return function(y){if(i)throw new TypeError("Generator is already executing.");for(;p;)try{if(i=1,a&&(c=2&y[0]?a.return:y[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,y[1])).done)return c;switch(a=0,c&&(y=[2&y[0],c.value]),y[0]){case 0:case 1:c=y;break;case 4:return p.label++,{value:y[1],done:!1};case 5:p.label++,a=y[1],y=[0];continue;case 7:y=p.ops.pop(),p.trys.pop();continue;default:if(!(c=(c=p.trys).length>0&&c[c.length-1])&&(6===y[0]||2===y[0])){p=0;continue}if(3===y[0]&&(!c||y[1]>c[0]&&y[1]<c[3])){p.label=y[1];break}if(6===y[0]&&p.label<c[1]){p.label=c[1],c=y;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(y);break}c[2]&&p.ops.pop(),p.trys.pop();continue}y=o.call(s,p)}catch(C){y=[6,C],a=0}finally{i=c=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([g,v])}}}var xe=function(){function s(o){this.global=o,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return s.prototype.setPlatform=function(o,i){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+i+"."),this.platformName=o,this.platform=i},s.prototype.registerFlag=function(o,i,a){if(this.flagRegistry[o]={evaluationFn:i,setHook:a},null!=this.urlFlags[o]){var c=this.urlFlags[o];console.warn("Setting feature override from URL "+o+": "+c+"."),this.set(o,c)}},s.prototype.get=function(o){return o in this.flags||(this.flags[o]=this.evaluateFlag(o)),this.flags[o]},s.prototype.getNumber=function(o){return this.get(o)},s.prototype.getBool=function(o){return this.get(o)},s.prototype.getFlags=function(){return this.flags},Object.defineProperty(s.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),s.prototype.set=function(o,i){if(null==this.flagRegistry[o])throw new Error("Cannot set flag "+o+" as it has not been registered.");this.flags[o]=i,null!=this.flagRegistry[o].setHook&&this.flagRegistry[o].setHook(i)},s.prototype.evaluateFlag=function(o){if(null==this.flagRegistry[o])throw new Error("Cannot evaluate flag '"+o+"': no evaluation function found.");return this.flagRegistry[o].evaluationFn()},s.prototype.setFlags=function(o){this.flags=Object.assign({},o)},s.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},s.prototype.populateURLFlags=function(){var o=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var a,c=(a={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(u){for(var p=[],m=1;m<arguments.length;m++)p[m-1]=arguments[m];return y=p[1],a[decodeURIComponent(p[0])]=decodeURIComponent(y||""),p.join("=");var y}),a);"tfjsflags"in c&&c.tfjsflags.split(",").forEach(function(u){var p=u.split(":"),m=p[0];o.urlFlags[m]=function(v,y){if("true"===(y=y.toLowerCase())||"false"===y)return"true"===y;if(""+ +y===y)return+y;throw new Error("Could not parse value flag value "+y+" for flag "+v+".")}(m,p[1])})}},s}();function E(){return pe}var pe=null,te=new Map;function Z(s,o){var i=b(s,o);return te.get(i)}function Y(s){for(var o=te.entries(),i=[];;){var a=o.next(),u=a.value;if(a.done)break;var m=u[1];u[0].split("_")[0]===s&&i.push(m)}return i}function z(s){var o=s.kernelName,i=s.backendName,a=b(o,i);if(te.has(a))throw new Error("The kernel '"+o+"' for backend '"+i+"' is already registered");te.set(a,s)}function f(s,o){var i=b(s,o);if(!te.has(i))throw new Error("The kernel '"+s+"' for backend '"+o+"' is not registered");te.delete(i)}function b(s,o){return o+"_"+s}function w(s){for(var o=s.length,i=0,a=0;o>0;)a=Math.random()*o|0,i=s[--o],s[o]=s[a],s[a]=i}function T(s,o,i){return Math.max(s,Math.min(o,i))}function R(s){return s%2==0?s:s+1}function H(s){for(var o=0,i=0;i<s.length;i++)o+=s[i];return o}function L(s,o){if(!s)throw new Error("string"==typeof o?o:o())}function oe(s,o,i){void 0===i&&(i=""),L(ke(s,o),function(){return i+" Shapes "+s+" and "+o+" must match"})}function ve(s){L(null!=s,function(){return"The input to the tensor constructor must be a non-null value."})}function we(s,o,i){if(void 0===o&&(o=[]),void 0===i&&(i=!1),null==o&&(o=[]),Array.isArray(s)||Le(s)&&!i)for(var a=0;a<s.length;++a)we(s[a],o,i);else o.push(s);return o}function de(s){if(0===s.length)return 1;for(var o=s[0],i=1;i<s.length;i++)o*=s[i];return o}function ke(s,o){if(s===o)return!0;if(null==s||null==o||s.length!==o.length)return!1;for(var i=0;i<s.length;i++)if(s[i]!==o[i])return!1;return!0}function ae(s){return s%1==0}function De(s){if(null!=Math.tanh)return Math.tanh(s);if(s===1/0)return 1;if(s===-1/0)return-1;var o=Math.exp(2*s);return(o-1)/(o+1)}function $(s){var o=Math.ceil(Math.sqrt(s));return[o,Math.ceil(s/o)]}function Ee(s,o){return o<=s.length?s:s+" ".repeat(o-s.length)}function ht(s,o,i){return void 0===o&&(o=function(a){return 0}),new Promise(function(a,c){var u=0,p=function(){if(s())a();else{var m=o(++u);null!=i&&u>=i?c():setTimeout(p,m)}};p()})}function Be(s,o){for(var i=1,a=-1,c=0;c<s.length;++c)if(s[c]>=0)i*=s[c];else if(-1===s[c]){if(-1!==a)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+a+" and dim "+c);a=c}else if(s[c]<0)throw Error("Shapes can not be < 0. Found "+s[c]+" at dim "+c);if(-1===a){if(o>0&&o!==i)throw Error("Size("+o+") must match the product of shape "+s);return s}if(0===i)throw Error("Cannot infer the missing size in ["+s+"] when there are 0 elements");if(o%i!=0)throw Error("The implicit shape can't be a fractional number. Got "+o+" / "+i);var u=s.slice();return u[a]=o/i,u}function kt(s,o){var i=o.length;return L((s=null==s?o.map(function(a,c){return c}):[].concat(s)).every(function(a){return a>=-i&&a<i}),function(){return"All values in axis param must be in range [-"+i+", "+i+") but got axis "+s}),L(s.every(function(a){return ae(a)}),function(){return"All values in axis param must be integers but got axis "+s}),s.map(function(a){return a<0?i+a:a})}function Ve(s,o){for(var i=[],a=[],c=null!=o&&Array.isArray(o)&&0===o.length,u=null==o||c?null:kt(o,s).sort(),p=0,m=0;m<s.length;++m){if(null!=u){if(u[p]===m&&1!==s[m])throw new Error("Can't squeeze axis "+m+" since its dim '"+s[m]+"' is not 1");(null==u[p]||u[p]>m)&&1===s[m]&&(i.push(s[m]),a.push(m)),u[p]<=m&&p++}1!==s[m]&&(i.push(s[m]),a.push(m))}return{newShape:i,keptDims:a}}function pt(s,o){var i=null;if(null==s||"float32"===s)i=new Float32Array(o);else if("int32"===s)i=new Int32Array(o);else{if("bool"!==s)throw new Error("Unknown data type "+s);i=new Uint8Array(o)}return i}function ze(s,o){var i=null;if(null==s||"float32"===s)i=new Float32Array(o);else if("int32"===s)i=new Int32Array(o);else if("bool"===s)i=new Uint8Array(o);else{if("string"!==s)throw new Error("Unknown data type "+s);i=new Array(o)}return i}function Ge(s,o){for(var i=0;i<s.length;i++){var a=s[i];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type "+o+" being uploaded contains "+a+".")}}function Jt(s){return"bool"===s||"complex64"===s||"float32"===s||"int32"===s||"string"===s}function zt(s,o){return!("complex64"===o||"float32"===o&&"complex64"!==s||"int32"===o&&"float32"!==s&&"complex64"!==s||"bool"===o&&"bool"===s)}function Le(s){return s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array}function Di(s){if("float32"===s||"int32"===s)return 4;if("complex64"===s)return 8;if("bool"===s)return 1;throw new Error("Unknown dtype "+s)}function dn(s){if(null==s)return 0;var o=0;return s.forEach(function(i){return o+=i.length}),o}function en(s){return"string"==typeof s||s instanceof String}function pn(s){return"boolean"==typeof s}function fr(s){return"number"==typeof s}function Pt(s){return Array.isArray(s)?Pt(s[0]):s instanceof Float32Array?"float32":s instanceof Int32Array||s instanceof Uint8Array?"int32":fr(s)?"float32":en(s)?"string":pn(s)?"bool":"float32"}function or(s){return!!(s&&s.constructor&&s.call&&s.apply)}function zr(s,o){for(var i=o;i<s;++i)if(s%i==0)return i;return s}function q(s){var o=s.length;if(o<2)return[];var i=new Array(o-1);i[o-2]=s[o-1];for(var a=o-3;a>=0;--a)i[a]=i[a+1]*s[a+1];return i}function mt(s,o,i){if("string"===o)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(s)&&(s=we(s)),i&&Ge(s,o),p=o,(u=s)instanceof Float32Array&&"float32"===p||u instanceof Int32Array&&"int32"===p||u instanceof Uint8Array&&"bool"===p)return s;var u,p;if(null==o||"float32"===o||"complex64"===o)return new Float32Array(s);if("int32"===o)return new Int32Array(s);if("bool"===o){for(var a=new Uint8Array(s.length),c=0;c<a.length;++c)0!==Math.round(s[c])&&(a[c]=1);return a}throw new Error("Unknown data type "+o)}function tt(s,o){if(0===s.length)return o[0];var i=s.reduce(function(a,c){return a*c});if(0===i)return[];if(i!==o.length)throw new Error("["+s+"] does not match the input size.");return function a(c,u,p){var m=new Array;if(1===u.length)for(var g=u[0],v=0;v<g;v++)m[v]=p[c+v];else{g=u[0];var y=u.slice(1),C=y.reduce(function(S,M){return S*M});for(v=0;v<g;v++)m[v]=a(c+v*C,y,p)}return m}(0,s,o)}function Se(s,o){for(var i=be(s,o),a=0;a<i.length;a++)i[a]=1;return i}function be(s,o){if(null==o||"float32"===o||"complex64"===o)return new Float32Array(s);if("int32"===o)return new Int32Array(s);if("bool"===o)return new Uint8Array(s);throw new Error("Unknown data type "+o)}function Oe(){return E().platform.now()}function _t(s){s.forEach(function(o){L(Number.isInteger(o)&&o>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+s+"]."})})}function xt(s,o){return void 0===o&&(o="utf-8"),o=o||"utf-8",E().platform.encode(s,o)}function We(s,o){return void 0===o&&(o="utf-8"),o=o||"utf-8",E().platform.decode(s,o)}var qe=Object.freeze({shuffle:w,clamp:T,nearestLargerEven:R,sum:H,randUniform:function(s,o){var i=Math.random();return o*i+(1-i)*s},distSquared:function(s,o){for(var i=0,a=0;a<s.length;a++){var c=Number(s[a])-Number(o[a]);i+=c*c}return i},assert:L,assertShapesMatch:oe,assertNonNull:ve,flatten:we,sizeFromShape:de,isScalarShape:function(s){return 0===s.length},arraysEqual:ke,isInt:ae,tanh:De,sizeToSquarishShape:$,createShuffledIndices:function(s){for(var o=new Uint32Array(s),i=0;i<s;++i)o[i]=i;return w(o),o},rightPad:Ee,repeatedTry:ht,inferFromImplicitShape:Be,parseAxisParam:kt,squeezeShape:Ve,getTypedArrayFromDType:pt,getArrayFromDType:ze,checkConversionForErrors:Ge,isValidDtype:Jt,hasEncodingLoss:zt,isTypedArray:Le,bytesPerElement:Di,bytesFromStringArray:dn,isString:en,isBoolean:pn,isNumber:fr,inferDtype:Pt,isFunction:or,nearestDivisor:zr,computeStrides:q,toTypedArray:mt,toNestedArray:tt,makeOnesTypedArray:Se,makeZerosTypedArray:be,now:Oe,assertNonNegativeIntegerDimensions:_t,fetch:function(s,o){return E().platform.fetch(s,o)},encodeString:xt,decodeString:We}),Yt=function(){function s(o,i){this.backendTimer=o,this.logger=i,null==i&&(this.logger=new It)}return s.prototype.profileKernel=function(o,i,a){var c,u=this,p=this.backendTimer.time(function(){c=a()});return c.forEach(function(m){m.data().then(function(g){(function(v,y,C){if("float32"!==y)return!1;for(var S=0;S<v.length;S++){var M=v[S];if(isNaN(M)||!isFinite(M))return console.warn("Found "+M+" in the result of '"+C+"'"),!0}})(g,m.dtype,o),p.then(function(v){var y="";null!=v.getExtraProfileInfo&&(y=v.getExtraProfileInfo()),u.logger.logKernelProfile(o,m,g,v.kernelMs,i,y)})})}),c},s}(),It=function(){function s(){}return s.prototype.logKernelProfile=function(o,i,a,c,u,p){var m=Ee(c+"ms",9),g=Ee(o,25),v=i.rank,y=i.size,C=Ee(i.shape.toString(),14),S="";for(var M in u){var O=u[M].shape,N=O.length;S+=M+": "+N+"D "+(N>0?O:"")+" "}console.log("%c"+g+"\t%c"+m+"\t%c"+v+"D "+C+"\t%c"+y+"\t%c"+S+"\t%c"+p,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},s}();function Io(s,o,i){return Ee(Array.isArray(s)?parseFloat(s[0].toFixed(7))+" + "+parseFloat(s[1].toFixed(7))+"j":en(s)?"'"+s+"'":"bool"===i?Ao(s):parseFloat(s.toFixed(7)).toString(),o)}function Ao(s){return 0===s?"false":"true"}function Ma(s){for(var o=[],i=0;i<s.length;i+=2)o.push([s[i],s[i+1]]);return o}var Bi=function(){function s(o,i,a){var c=this;if(this.dtype=i,this.shape=o.slice(),this.size=de(o),null!=a){var u=a.length;L(u===this.size,function(){return"Length of values '"+u+"' does not match the size inferred by the shape '"+c.size+"'."})}if("complex64"===i)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=a||ze(i,this.size),this.strides=q(o)}return s.prototype.set=function(o){for(var i=this,a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];0===a.length&&(a=[0]),L(a.length===this.rank,function(){return"The number of provided coordinates ("+a.length+") must match the rank ("+i.rank+")"});var u=this.locToIndex(a);this.values[u]=o},s.prototype.get=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];0===o.length&&(o=[0]);for(var a=0,c=0,u=o;c<u.length;c++){var p=u[c];if(p<0||p>=this.shape[a]){var m="Requested out of range element at "+o+".   Buffer shape="+this.shape;throw new Error(m)}a++}for(var g=o[o.length-1],v=0;v<o.length-1;++v)g+=this.strides[v]*o[v];return this.values[g]},s.prototype.locToIndex=function(o){if(0===this.rank)return 0;if(1===this.rank)return o[0];for(var i=o[o.length-1],a=0;a<o.length-1;++a)i+=this.strides[a]*o[a];return i},s.prototype.indexToLoc=function(o){if(0===this.rank)return[];if(1===this.rank)return[o];for(var i=new Array(this.shape.length),a=0;a<i.length-1;++a)i[a]=Math.floor(o/this.strides[a]),o-=i[a]*this.strides[a];return i[i.length-1]=o,i},Object.defineProperty(s.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),s.prototype.toTensor=function(){return Xr().makeTensor(this.values,this.shape,this.dtype)},s}(),Xr=null,Je=null,Ro=null,ki=function(){function s(o,i,a,c){this.kept=!1,this.isDisposedInternal=!1,this.shape=o.slice(),this.dtype=i||"float32",this.size=de(o),this.strides=q(o),this.dataId=a,this.id=c,this.rankType=this.rank<5?this.rank.toString():"higher"}return s.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},s.prototype.asScalar=function(){return this.throwIfDisposed(),L(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},s.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},s.prototype.as2D=function(o,i){return this.throwIfDisposed(),this.reshape([o,i])},s.prototype.as3D=function(o,i,a){return this.throwIfDisposed(),this.reshape([o,i,a])},s.prototype.as4D=function(o,i,a,c){return this.throwIfDisposed(),this.reshape([o,i,a,c])},s.prototype.as5D=function(o,i,a,c,u){return this.throwIfDisposed(),this.reshape([o,i,a,c,u])},s.prototype.asType=function(o){return this.throwIfDisposed(),Je.cast(this,o)},Object.defineProperty(s.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),s.prototype.buffer=function(){return J(this,void 0,void 0,function(){var o;return K(this,function(i){switch(i.label){case 0:return[4,this.data()];case 1:return o=i.sent(),[2,Je.buffer(this.shape,this.dtype,o)]}})})},s.prototype.bufferSync=function(){return Je.buffer(this.shape,this.dtype,this.dataSync())},s.prototype.array=function(){return J(this,void 0,void 0,function(){var o;return K(this,function(i){switch(i.label){case 0:return[4,this.data()];case 1:return o=i.sent(),[2,tt(this.shape,o)]}})})},s.prototype.arraySync=function(){return tt(this.shape,this.dataSync())},s.prototype.data=function(){return J(this,void 0,void 0,function(){var o,i;return K(this,function(a){switch(a.label){case 0:return this.throwIfDisposed(),o=Xr().read(this.dataId),"string"!==this.dtype?[3,2]:[4,o];case 1:i=a.sent();try{return[2,i.map(function(c){return We(c)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}a.label=2;case 2:return[2,o]}})})},s.prototype.dataSync=function(){this.throwIfDisposed();var o=Xr().readSync(this.dataId);if("string"===this.dtype)try{return o.map(function(i){return We(i)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return o},s.prototype.bytes=function(){return J(this,void 0,void 0,function(){var o;return K(this,function(i){switch(i.label){case 0:return this.throwIfDisposed(),[4,Xr().read(this.dataId)];case 1:return o=i.sent(),"string"===this.dtype?[2,o]:[2,new Uint8Array(o.buffer)]}})})},s.prototype.dispose=function(){this.isDisposed||(Xr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(s.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),s.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},s.prototype.toFloat=function(){return this.asType("float32")},s.prototype.toInt=function(){return this.asType("int32")},s.prototype.toBool=function(){return this.asType("bool")},s.prototype.print=function(o){return void 0===o&&(o=!1),Je.print(this,o)},s.prototype.reshape=function(o){return this.throwIfDisposed(),Je.reshape(this,o)},s.prototype.reshapeAs=function(o){return this.throwIfDisposed(),this.reshape(o.shape)},s.prototype.expandDims=function(o){return void 0===o&&(o=0),Je.expandDims(this,o)},s.prototype.cumsum=function(o,i,a){return void 0===o&&(o=0),void 0===i&&(i=!1),void 0===a&&(a=!1),Je.cumsum(this,o,i,a)},s.prototype.squeeze=function(o){return this.throwIfDisposed(),Je.squeeze(this,o)},s.prototype.clone=function(){return this.throwIfDisposed(),Je.clone(this)},s.prototype.oneHot=function(o,i,a){return this.throwIfDisposed(),Je.oneHot(this,o,i,a)},s.prototype.toString=function(o){return void 0===o&&(o=!1),function po(s,o,i,a){var c=q(o),u=function(v,y,C,S){var M=de(y),O=S[S.length-1],N=new Array(O).fill(0),P=y.length,B="complex64"===C?Ma(v):v;if(P>1)for(var W=0;W<M/O;W++)for(var G=W*O,X=0;X<O;X++)N[X]=Math.max(N[X],Io(B[G+X],0,C).length);return N}(s,o,i,c),p=o.length,m=function v(y,C,S,M,O,N){void 0===N&&(N=!0);var P="complex64"===S?2:1,B=C[0],W=C.length;if(0===W)return"complex64"===S?[Io(Ma(y)[0],0,S)]:"bool"===S?[Ao(y[0])]:[y[0].toString()];if(1===W){if(B>20){var Q=Array.from(y.slice(0,3*P)),se=Array.from(y.slice(B-3*P,B));return"complex64"===S&&(Q=Ma(Q),se=Ma(se)),["["+Q.map(function(nt,je){return Io(nt,O[je],S)}).join(", ")+", ..., "+se.map(function(nt,je){return Io(nt,O[B-3+je],S)}).join(", ")+"]"]}return["["+("complex64"===S?Ma(y):Array.from(y)).map(function(nt,je){return Io(nt,O[je],S)}).join(", ")+"]"]}var fe=C.slice(1),_e=M.slice(1),me=M[0]*P,Me=[];if(B>20){for(var Te=0;Te<3;Te++)Me.push.apply(Me,v(y.slice(Ue=Te*me,Ue+me),fe,S,_e,O,!1));for(Me.push("..."),Te=B-3;Te<B;Te++)Me.push.apply(Me,v(y.slice(Ue=Te*me,Ue+me),fe,S,_e,O,Te===B-1))}else for(Te=0;Te<B;Te++){var Ue;Me.push.apply(Me,v(y.slice(Ue=Te*me,Ue+me),fe,S,_e,O,Te===B-1))}var et=2===W?",":"";for(Me[0]="["+Me[0]+et,Te=1;Te<Me.length-1;Te++)Me[Te]=" "+Me[Te]+et;var it=",\n";for(Te=2;Te<W;Te++)it+="\n";return Me[Me.length-1]=" "+Me[Me.length-1]+"]"+(N?"":it),Me}(s,o,i,c,u),g=["Tensor"];return a&&(g.push("  dtype: "+i),g.push("  rank: "+p),g.push("  shape: ["+o+"]"),g.push("  values:")),g.push(m.map(function(v){return"    "+v}).join("\n")),g.join("\n")}(this.dataSync(),this.shape,this.dtype,o)},s.prototype.tile=function(o){return this.throwIfDisposed(),Je.tile(this,o)},s.prototype.gather=function(o,i){return void 0===i&&(i=0),this.throwIfDisposed(),Je.gather(this,o,i)},s.prototype.matMul=function(o,i,a){return void 0===i&&(i=!1),void 0===a&&(a=!1),this.throwIfDisposed(),Je.matMul(this,o,i,a)},s.prototype.dot=function(o){return this.throwIfDisposed(),Je.dot(this,o)},s.prototype.norm=function(o,i,a){return void 0===o&&(o="euclidean"),void 0===i&&(i=null),void 0===a&&(a=!1),this.throwIfDisposed(),Je.norm(this,o,i,a)},s.prototype.slice=function(o,i){return this.throwIfDisposed(),Je.slice(this,o,i)},s.prototype.reverse=function(o){return this.throwIfDisposed(),Je.reverse(this,o)},s.prototype.concat=function(o,i){return void 0===i&&(i=0),this.throwIfDisposed(),o instanceof s&&(o=[o]),Je.concat([this].concat(o),i)},s.prototype.split=function(o,i){return void 0===i&&(i=0),this.throwIfDisposed(),Je.split(this,o,i)},s.prototype.stack=function(o,i){return void 0===i&&(i=0),Je.stack([this,o],i)},s.prototype.unstack=function(o){return void 0===o&&(o=0),Je.unstack(this,o)},s.prototype.pad=function(o,i){return void 0===i&&(i=0),Je.pad(this,o,i)},s.prototype.batchNormalization=function(o,i,a,c,u){return void 0===a&&(a=.001),Ro("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(o,i,u,c,a)},s.prototype.batchNorm=function(o,i,a,c,u){return void 0===u&&(u=.001),this.throwIfDisposed(),Je.batchNorm(this,o,i,a,c,u)},s.prototype.all=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.all(this,o,i)},s.prototype.any=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.any(this,o,i)},s.prototype.logSumExp=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.logSumExp(this,o,i)},s.prototype.sum=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.sum(this,o,i)},s.prototype.prod=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.prod(this,o,i)},s.prototype.mean=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.mean(this,o,i)},s.prototype.min=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.min(this,o,i)},s.prototype.max=function(o,i){return void 0===o&&(o=null),void 0===i&&(i=!1),this.throwIfDisposed(),Je.max(this,o,i)},s.prototype.argMin=function(o){return void 0===o&&(o=null),this.throwIfDisposed(),Je.argMin(this,o)},s.prototype.argMax=function(o){return void 0===o&&(o=null),this.throwIfDisposed(),Je.argMax(this,o)},s.prototype.cast=function(o){return this.throwIfDisposed(),Je.cast(this,o)},s.prototype.add=function(o){return this.throwIfDisposed(),Je.add(this,o)},s.prototype.addStrict=function(o){return this.throwIfDisposed(),Je.addStrict(this,o)},s.prototype.atan2=function(o){return this.throwIfDisposed(),Je.atan2(this,o)},s.prototype.sub=function(o){return this.throwIfDisposed(),Je.sub(this,o)},s.prototype.subStrict=function(o){return this.throwIfDisposed(),Je.subStrict(this,o)},s.prototype.pow=function(o){return this.throwIfDisposed(),Je.pow(this,o)},s.prototype.powStrict=function(o){return this.throwIfDisposed(),Je.powStrict(this,o)},s.prototype.mul=function(o){return this.throwIfDisposed(),Je.mul(this,o)},s.prototype.mulStrict=function(o){return this.throwIfDisposed(),Je.mulStrict(this,o)},s.prototype.div=function(o){return this.throwIfDisposed(),Je.div(this,o)},s.prototype.floorDiv=function(o){return this.throwIfDisposed(),Je.floorDiv(this,o)},s.prototype.divStrict=function(o){return this.throwIfDisposed(),Je.divStrict(this,o)},s.prototype.minimum=function(o){return this.throwIfDisposed(),Je.minimum(this,o)},s.prototype.minimumStrict=function(o){return this.throwIfDisposed(),Je.minimumStrict(this,o)},s.prototype.maximum=function(o){return this.throwIfDisposed(),Je.maximum(this,o)},s.prototype.maximumStrict=function(o){return this.throwIfDisposed(),Je.maximumStrict(this,o)},s.prototype.mod=function(o){return this.throwIfDisposed(),Je.mod(this,o)},s.prototype.modStrict=function(o){return this.throwIfDisposed(),Je.modStrict(this,o)},s.prototype.squaredDifference=function(o){return this.throwIfDisposed(),Je.squaredDifference(this,o)},s.prototype.squaredDifferenceStrict=function(o){return this.throwIfDisposed(),Je.squaredDifferenceStrict(this,o)},s.prototype.transpose=function(o){return this.throwIfDisposed(),Je.transpose(this,o)},s.prototype.notEqual=function(o){return this.throwIfDisposed(),Je.notEqual(this,o)},s.prototype.notEqualStrict=function(o){return this.throwIfDisposed(),Je.notEqualStrict(this,o)},s.prototype.less=function(o){return this.throwIfDisposed(),Je.less(this,o)},s.prototype.lessStrict=function(o){return this.throwIfDisposed(),Je.lessStrict(this,o)},s.prototype.equal=function(o){return this.throwIfDisposed(),Je.equal(this,o)},s.prototype.equalStrict=function(o){return this.throwIfDisposed(),Je.equalStrict(this,o)},s.prototype.lessEqual=function(o){return this.throwIfDisposed(),Je.lessEqual(this,o)},s.prototype.lessEqualStrict=function(o){return this.throwIfDisposed(),Je.lessEqualStrict(this,o)},s.prototype.greater=function(o){return this.throwIfDisposed(),Je.greater(this,o)},s.prototype.greaterStrict=function(o){return this.throwIfDisposed(),Je.greaterStrict(this,o)},s.prototype.greaterEqual=function(o){return this.throwIfDisposed(),Je.greaterEqual(this,o)},s.prototype.greaterEqualStrict=function(o){return this.throwIfDisposed(),Je.greaterEqualStrict(this,o)},s.prototype.logicalAnd=function(o){return this.throwIfDisposed(),Je.logicalAnd(this,o)},s.prototype.logicalOr=function(o){return this.throwIfDisposed(),Je.logicalOr(this,o)},s.prototype.logicalNot=function(){return this.throwIfDisposed(),Je.logicalNot(this)},s.prototype.logicalXor=function(o){return this.throwIfDisposed(),Je.logicalXor(this,o)},s.prototype.where=function(o,i){return this.throwIfDisposed(),Je.where(o,this,i)},s.prototype.neg=function(){return this.throwIfDisposed(),Je.neg(this)},s.prototype.ceil=function(){return this.throwIfDisposed(),Je.ceil(this)},s.prototype.floor=function(){return this.throwIfDisposed(),Je.floor(this)},s.prototype.sign=function(){return this.throwIfDisposed(),Je.sign(this)},s.prototype.isNaN=function(){return this.throwIfDisposed(),Je.isNaN(this)},s.prototype.isInf=function(){return this.throwIfDisposed(),Je.isInf(this)},s.prototype.isFinite=function(){return this.throwIfDisposed(),Je.isFinite(this)},s.prototype.exp=function(){return this.throwIfDisposed(),Je.exp(this)},s.prototype.expm1=function(){return this.throwIfDisposed(),Je.expm1(this)},s.prototype.log=function(){return this.throwIfDisposed(),Je.log(this)},s.prototype.log1p=function(){return this.throwIfDisposed(),Je.log1p(this)},s.prototype.sqrt=function(){return this.throwIfDisposed(),Je.sqrt(this)},s.prototype.rsqrt=function(){return this.throwIfDisposed(),Je.rsqrt(this)},s.prototype.square=function(){return this.throwIfDisposed(),Je.square(this)},s.prototype.reciprocal=function(){return this.throwIfDisposed(),Je.reciprocal(this)},s.prototype.abs=function(){return this.throwIfDisposed(),Je.abs(this)},s.prototype.clipByValue=function(o,i){return this.throwIfDisposed(),Je.clipByValue(this,o,i)},s.prototype.relu=function(){return this.throwIfDisposed(),Je.relu(this)},s.prototype.relu6=function(){return this.throwIfDisposed(),Je.relu6(this)},s.prototype.elu=function(){return this.throwIfDisposed(),Je.elu(this)},s.prototype.selu=function(){return this.throwIfDisposed(),Je.selu(this)},s.prototype.leakyRelu=function(o){return void 0===o&&(o=.2),this.throwIfDisposed(),Je.leakyRelu(this,o)},s.prototype.prelu=function(o){return this.throwIfDisposed(),Je.prelu(this,o)},s.prototype.sigmoid=function(){return this.throwIfDisposed(),Je.sigmoid(this)},s.prototype.logSigmoid=function(){return this.throwIfDisposed(),Je.logSigmoid(this)},s.prototype.softplus=function(){return this.throwIfDisposed(),Je.softplus(this)},s.prototype.zerosLike=function(){return this.throwIfDisposed(),Je.zerosLike(this)},s.prototype.onesLike=function(){return this.throwIfDisposed(),Je.onesLike(this)},s.prototype.sin=function(){return this.throwIfDisposed(),Je.sin(this)},s.prototype.cos=function(){return this.throwIfDisposed(),Je.cos(this)},s.prototype.tan=function(){return this.throwIfDisposed(),Je.tan(this)},s.prototype.asin=function(){return this.throwIfDisposed(),Je.asin(this)},s.prototype.acos=function(){return this.throwIfDisposed(),Je.acos(this)},s.prototype.atan=function(){return this.throwIfDisposed(),Je.atan(this)},s.prototype.sinh=function(){return this.throwIfDisposed(),Je.sinh(this)},s.prototype.cosh=function(){return this.throwIfDisposed(),Je.cosh(this)},s.prototype.tanh=function(){return this.throwIfDisposed(),Je.tanh(this)},s.prototype.asinh=function(){return this.throwIfDisposed(),Je.asinh(this)},s.prototype.acosh=function(){return this.throwIfDisposed(),Je.acosh(this)},s.prototype.atanh=function(){return this.throwIfDisposed(),Je.atanh(this)},s.prototype.erf=function(){return this.throwIfDisposed(),Je.erf(this)},s.prototype.round=function(){return this.throwIfDisposed(),Je.round(this)},s.prototype.step=function(o){return void 0===o&&(o=0),this.throwIfDisposed(),Je.step(this,o)},s.prototype.softmax=function(o){return void 0===o&&(o=-1),this.throwIfDisposed(),Je.softmax(this,o)},s.prototype.logSoftmax=function(o){return void 0===o&&(o=-1),this.throwIfDisposed(),Je.logSoftmax(this,o)},s.prototype.resizeBilinear=function(o,i){return void 0===i&&(i=!1),this.throwIfDisposed(),Je.image.resizeBilinear(this,o,i)},s.prototype.resizeNearestNeighbor=function(o,i){return void 0===i&&(i=!1),this.throwIfDisposed(),Je.image.resizeNearestNeighbor(this,o,i)},s.prototype.conv1d=function(o,i,a,c,u,p){return void 0===c&&(c="NWC"),void 0===u&&(u=1),this.throwIfDisposed(),Je.conv1d(this,o,i,a,c,u,p)},s.prototype.conv2d=function(o,i,a,c,u,p){return void 0===c&&(c="NHWC"),void 0===u&&(u=[1,1]),this.throwIfDisposed(),Je.conv2d(this,o,i,a,c,u,p)},s.prototype.conv2dTranspose=function(o,i,a,c,u){return this.throwIfDisposed(),Je.conv2dTranspose(this,o,i,a,c,u)},s.prototype.depthwiseConv2D=function(o,i,a,c,u,p){return void 0===c&&(c="NHWC"),void 0===u&&(u=[1,1]),this.throwIfDisposed(),Je.depthwiseConv2d(this,o,i,a,c,u,p)},s.prototype.separableConv2d=function(o,i,a,c,u,p){return void 0===u&&(u=[1,1]),void 0===p&&(p="NHWC"),this.throwIfDisposed(),Je.separableConv2d(this,o,i,a,c,u,p)},s.prototype.avgPool=function(o,i,a,c){return this.throwIfDisposed(),Je.avgPool(this,o,i,a,c)},s.prototype.maxPool=function(o,i,a,c){return this.throwIfDisposed(),Je.maxPool(this,o,i,a,c)},s.prototype.localResponseNormalization=function(o,i,a,c){return void 0===o&&(o=5),void 0===i&&(i=1),void 0===a&&(a=1),void 0===c&&(c=.5),Je.localResponseNormalization(this,o,i,a,c)},s.prototype.pool=function(o,i,a,c,u){return this.throwIfDisposed(),Je.pool(this,o,i,a,c,u)},s.prototype.variable=function(o,i,a){return void 0===o&&(o=!0),this.throwIfDisposed(),Xr().makeVariable(this,o,i,a)},s.prototype.unsortedSegmentSum=function(o,i){return this.throwIfDisposed(),Je.unsortedSegmentSum(this,o,i)},s.prototype.batchToSpaceND=function(o,i){return this.throwIfDisposed(),Je.batchToSpaceND(this,o,i)},s.prototype.spaceToBatchND=function(o,i){return this.throwIfDisposed(),Je.spaceToBatchND(this,o,i)},s.prototype.topk=function(o,i){return void 0===o&&(o=1),void 0===i&&(i=!0),this.throwIfDisposed(),Je.topk(this,o,i)},s.prototype.stridedSlice=function(o,i,a,c,u,p,m,g){return void 0===c&&(c=0),void 0===u&&(u=0),void 0===p&&(p=0),void 0===m&&(m=0),void 0===g&&(g=0),this.throwIfDisposed(),Je.stridedSlice(this,o,i,a,c,u,p,m,g)},s.prototype.depthToSpace=function(o,i){return this.throwIfDisposed(),Je.depthToSpace(this,o,i)},s.prototype.fft=function(){return this.throwIfDisposed(),Je.spectral.fft(this)},s.prototype.ifft=function(){return this.throwIfDisposed(),Je.spectral.ifft(this)},s.prototype.rfft=function(){return this.throwIfDisposed(),Je.spectral.rfft(this)},s.prototype.irfft=function(){return this.throwIfDisposed(),Je.spectral.irfft(this)},s}();Object.defineProperty(ki,Symbol.hasInstance,{value:function(s){return!!s&&null!=s.dataId&&null!=s.shape&&null!=s.dtype}});var dl,As,Rs,Ta,Ia,s,da=function(s){function o(i,a,c,u){var p=s.call(this,i.shape,i.dtype,i.dataId,u)||this;return p.trainable=a,p.name=c,p}return j(o,s),o.prototype.assign=function(i){if(i.dtype!==this.dtype)throw new Error("dtype of the new value ("+i.dtype+") and previous value ("+this.dtype+") must match");if(!ke(i.shape,this.shape))throw new Error("shape of the new value ("+i.shape+") and previous value ("+this.shape+") must match");Xr().disposeTensor(this),this.dataId=i.dataId,Xr().incRef(this,null)},o.prototype.dispose=function(){Xr().disposeVariable(this),this.isDisposedInternal=!0},o}(ki);Object.defineProperty(da,Symbol.hasInstance,{value:function(s){return s instanceof ki&&null!=s.assign&&s.assign instanceof Function}}),(s=dl||(dl={})).R0="R0",s.R1="R1",s.R2="R2",s.R3="R3",s.R4="R4",s.R5="R5",s.R6="R6",function(s){s.float32="float32",s.int32="int32",s.bool="int32",s.complex64="complex64"}(As||(As={})),function(s){s.float32="float32",s.int32="int32",s.bool="bool",s.complex64="complex64"}(Rs||(Rs={})),function(s){s.float32="float32",s.int32="float32",s.bool="float32",s.complex64="complex64"}(Ta||(Ta={})),function(s){s.float32="complex64",s.int32="complex64",s.bool="complex64",s.complex64="complex64"}(Ia||(Ia={}));var A_={float32:Ta,int32:As,bool:Rs,complex64:Ia};function dr(s,o){if("string"===s||"string"===o){if("string"===s&&"string"===o)return"string";throw new Error("Can not upcast "+s+" with "+o)}return A_[s][o]}function kc(s){return dr(s,"int32")}function er(s,o){if(s.dtype===o.dtype)return[s,o];var i=dr(s.dtype,o.dtype);return[s.cast(i),o.cast(i)]}function xr(s,o){L(s.dtype===o.dtype,function(){return"The dtypes of the first("+s.dtype+") and second("+o.dtype+") input must match"})}function Ir(s){var o=[];return function i(a,c,u){if(null!=a){if(a instanceof ki)return void c.push(a);if(p=a,Array.isArray(p)||"object"==typeof p){var p,m=a;for(var g in m){var v=m[g];u.has(v)||(u.add(v),i(v,c,u))}}}}(s,o,new Set),o}var Xd,ar=Object.freeze({makeTypesMatch:er,assertTypesMatch:xr,isTensorInList:function(s,o){for(var i=0;i<o.length;i++)if(o[i].id===s.id)return!0;return!1},getTensorsInContainer:Ir}),ul=function(){function s(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return s.prototype.dispose=function(){for(var o in this.registeredVariables)this.registeredVariables[o].dispose()},s}(),Bf=function(){function s(o){this.ENV=o,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ul}return s.prototype.ready=function(){return J(this,void 0,void 0,function(){var o,i,a;return K(this,function(c){switch(c.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];o=this.getSortedBackends(),i=0,c.label=1;case 1:return i<o.length?[4,this.initializeBackend(a=o[i]).success]:[3,5];case 2:return c.sent()?[4,this.setBackend(a)]:[3,4];case 3:return c.sent(),[2];case 4:return i++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(s.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var o=this.initializeBackendsAndReturnBest(),i=o.name;if(o.asyncInit)throw new Error("The highest priority backend '"+i+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(i)}return this.backendInstance},enumerable:!0,configurable:!0}),s.prototype.backendNames=function(){return Object.keys(this.registryFactory)},s.prototype.findBackend=function(o){return o in this.registry||o in this.registryFactory&&!this.initializeBackend(o).asyncInit?this.registry[o]:null},s.prototype.findBackendFactory=function(o){return o in this.registryFactory?this.registryFactory[o].factory:null},s.prototype.registerBackend=function(o,i,a){return void 0===a&&(a=1),o in this.registryFactory?(console.warn(o+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[o]={factory:i,priority:a},!0)},s.prototype.setBackend=function(o){return J(this,void 0,void 0,function(){var i,a,c;return K(this,function(u){switch(u.label){case 0:if(null==this.registryFactory[o])throw new Error("Backend name '"+o+"' not found in registry");return this.backendName=o,null!=this.registry[o]?[3,4]:(this.backendInstance=null,i=this.initializeBackend(o),a=i.success,i.asyncInit?[4,a]:[3,2]);case 1:return c=u.sent(),[3,3];case 2:c=a,u.label=3;case 3:if(!c)return[2,!1];u.label=4;case 4:return this.backendInstance=this.registry[o],this.setupRegisteredKernels(),this.profiler=new Yt(this.backendInstance),[2,!0]}})})},s.prototype.setupRegisteredKernels=function(){var o=this;Y(this.backendName).forEach(function(i){null!=i.setupFunc&&i.setupFunc(o.backendInstance)})},s.prototype.disposeRegisteredKernels=function(o){var i=this;Y(o).forEach(function(a){null!=a.disposeFunc&&a.disposeFunc(i.registry[o])})},s.prototype.initializeBackend=function(o){var i=this,a=this.registryFactory[o];if(null==a)throw new Error("Cannot initialize backend "+o+", no registration found.");try{var c=a.factory();if(Promise.resolve(c)===c){var u=++this.pendingBackendInitId,p=c.then(function(m){return!(u<i.pendingBackendInitId||(i.registry[o]=m,i.pendingBackendInit=null,0))}).catch(function(m){return!(u<i.pendingBackendInitId||(i.pendingBackendInit=null,console.warn("Initialization of backend "+o+" failed"),console.warn(m.stack||m.message),1))});return this.pendingBackendInit=p,{success:p,asyncInit:!0}}return this.registry[o]=c,{success:!0,asyncInit:!1}}catch(m){return console.warn("Initialization of backend "+o+" failed"),console.warn(m.stack||m.message),{success:!1,asyncInit:!1}}},s.prototype.removeBackend=function(o){if(!(o in this.registryFactory))throw new Error(o+" backend not found in registry");this.backendName===o&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,o in this.registry&&(this.disposeRegisteredKernels(o),this.registry[o].dispose(),delete this.registry[o]),delete this.registryFactory[o],this.backendName===o&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},s.prototype.getSortedBackends=function(){var o=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(i,a){return o.registryFactory[a].priority-o.registryFactory[i].priority})},s.prototype.initializeBackendsAndReturnBest=function(){for(var o=this.getSortedBackends(),i=0;i<o.length;i++){var a=o[i],c=this.initializeBackend(a),p=c.asyncInit;if(p||c.success)return{name:a,asyncInit:p}}throw new Error("Could not initialize any backends, all backend initializations failed.")},s.prototype.moveData=function(o,i){var a=this.state.tensorInfo.get(i),c=a.backend,u=this.readSync(i);c.disposeData(i),a.backend=o,o.move(i,u,a.shape,a.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},s.prototype.tidy=function(o,i){var a,c=this,u=null;if(null==i){if("function"!=typeof o)throw new Error("Please provide a function to tidy()");i=o}else{if("string"!=typeof o&&!(o instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof i)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");u=o}return this.scopedRun(function(){return c.startScope(u)},function(){return c.endScope(a)},function(){return(a=i())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a})},s.prototype.scopedRun=function(o,i,a){o();try{var c=a();return i(),c}catch(u){throw i(),u}},s.prototype.nextTensorId=function(){return s.nextTensorId++},s.prototype.nextVariableId=function(){return s.nextVariableId++},s.prototype.clone=function(o){var i=this.makeTensorFromDataId(o.dataId,o.shape,o.dtype);return this.addTapeNode(this.state.activeScope.name,{x:o},[i],function(c){return{x:function(){return c.toFloat()}}},[]),i},s.prototype.runKernel=function(o,i,a,c,u){return this.runKernelFunc(null,i,null,o,a,c,u)},s.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},s.prototype.checkKernelForMemLeak=function(o,i,a){var c=this.backend.numDataIds(),u=0;a.forEach(function(g){u+="complex64"===g.dtype?3:1});var m=c-i-u-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(m>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+m+" data ids) after running '"+o+"'")},s.prototype.runKernelFunc=function(o,i,a,c,u,p,m){var g,v=this;void 0===p&&(p=[]),void 0===m&&(m=[]);var y,C=[],S=this.isTapeOn(),M=null!=this.state.activeScope?this.state.activeScope.name:"",O=function(G){S&&(C=G.map(function(X){return v.keep(v.clone(X))}))},N=this.state.numBytes,P=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var B,W=Z(c,this.backendName);return y=null!=W?function(){var G=v.backend.numDataIds();B=W.kernelFunc({inputs:i,attrs:u,backend:v.backend});var X=Array.isArray(B)?B:[B];v.shouldCheckForMemLeaks()&&v.checkKernelForMemLeak(M,G,X);var Q=X.map(function(ue){return v.makeTensorFromDataId(ue.dataId,ue.shape,ue.dtype)}),se=Q.filter(function(ue,fe){return m[fe]});return O(p.slice().concat(se)),Q}:function(){var G=v.backend.numDataIds();B=v.tidy(function(){return o(v.backend,O)});var X=Array.isArray(B)?B:[B];return v.shouldCheckForMemLeaks()&&v.checkKernelForMemLeak(M,G,X),X},this.scopedRun(function(){return v.state.kernelDepth++},function(){return v.state.kernelDepth--},function(){g=v.ENV.getBool("DEBUG")?v.profiler.profileKernel(M,i,function(){return y()}):y()}),S&&this.addTapeNode(M,i,g,a,C),this.state.profiling&&this.state.activeProfile.kernels.push({name:M,bytesAdded:this.state.numBytes-N,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-P,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(i).map(function(G){return i[G].shape}),outputShapes:g.map(function(G){return G.shape})}),Array.isArray(B)?g:g[0]},s.prototype.makeTensor=function(o,i,a,c){if(null==o)throw new Error("Values passed to engine.makeTensor() are null");c=c||this.backend;var u=o;"string"===(a=a||"float32")&&en(o[0])&&(u=o.map(function(y){return xt(y)}));var p=c.write(u,i,a),m=new ki(i,a,p,this.nextTensorId());if(this.incRef(m,c),"string"===a){var g=this.state.tensorInfo.get(p),v=dn(u);this.state.numBytes+=v-g.bytes,g.bytes=v}return m},s.prototype.makeTensorFromDataId=function(o,i,a,c){var u=new ki(i,a=a||"float32",o,this.nextTensorId());return this.incRef(u,c),u},s.prototype.makeVariable=function(o,i,a,c){void 0===i&&(i=!0),a=a||this.nextVariableId().toString(),null!=c&&c!==o.dtype&&(o=o.asType(c));var u=new da(o,i,a,this.nextTensorId());if(null!=this.state.registeredVariables[u.name])throw new Error("Variable with name "+u.name+" was already registered");return this.state.registeredVariables[u.name]=u,this.incRef(u,this.backend),u},s.prototype.incRef=function(o,i){var a=this.state.tensorInfo.has(o.dataId)?this.state.tensorInfo.get(o.dataId).refCount:0;if(this.state.numTensors++,"string"===o.dtype&&this.state.numStringTensors++,0===a){this.state.numDataBuffers++;var c=0;"complex64"!==o.dtype&&"string"!==o.dtype&&(c=o.size*Di(o.dtype)),this.state.tensorInfo.set(o.dataId,{backend:i||this.backend,dtype:o.dtype,shape:o.shape,bytes:c,refCount:0}),this.state.numBytes+=c}this.state.tensorInfo.get(o.dataId).refCount++,o instanceof da||this.track(o)},s.prototype.disposeTensor=function(o){if(this.state.tensorInfo.has(o.dataId)){this.state.numTensors--,"string"===o.dtype&&this.state.numStringTensors--;var i=this.state.tensorInfo.get(o.dataId);i.refCount<=1?("complex64"!==o.dtype&&(this.state.numBytes-=i.bytes),this.state.numDataBuffers--,i.backend.disposeData(o.dataId),this.state.tensorInfo.delete(o.dataId)):this.state.tensorInfo.get(o.dataId).refCount--}},s.prototype.disposeVariables=function(){for(var o in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[o])},s.prototype.disposeVariable=function(o){this.disposeTensor(o),null!=this.state.registeredVariables[o.name]&&delete this.state.registeredVariables[o.name]},s.prototype.memory=function(){var o=this.backend.memory();return o.numTensors=this.state.numTensors,o.numDataBuffers=this.state.numDataBuffers,o.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(o.unreliable=!0,null==o.reasons&&(o.reasons=[]),o.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),o},s.prototype.profile=function(o){return J(this,void 0,void 0,function(){var i,a;return K(this,function(c){return this.state.profiling=!0,i=this.state.numBytes,a=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=o(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(u){return u.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-i,this.state.activeProfile.newTensors=this.state.numTensors-a,[2,this.state.activeProfile]})})},s.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},s.prototype.addTapeNode=function(o,i,a,c,u){var p=this,m={id:this.state.nextTapeNodeId++,name:o,inputs:i,outputs:a,saved:u};null!=c&&(m.gradient=function(g){return g=g.map(function(v,y){if(null==v){var C=a[y],S=be(C.size,C.dtype);return p.makeTensor(S,C.shape,C.dtype)}return v}),c(g.length>1?g:g[0],u)}),this.state.activeTape.push(m)},s.prototype.keep=function(o){return o.kept=!0,o},s.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},s.prototype.endTape=function(){this.state.gradientDepth--},s.prototype.startScope=function(o){var i={track:[],name:"unnamed scope",id:this.state.nextScopeId++};o&&(i.name=o),this.state.scopeStack.push(i),this.state.activeScope=i},s.prototype.endScope=function(o){for(var i=this,a=Ir(o),c=new Set(a.map(function(g){return g.id})),u=0;u<this.state.activeScope.track.length;u++){var p=this.state.activeScope.track[u];p.kept||c.has(p.id)||p.dispose()}var m=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],a.forEach(function(g){g.kept||g.scopeId!==m.id||i.track(g)})},s.prototype.gradients=function(o,i,a,c){var u=this;if(void 0===c&&(c=!1),L(i.length>0,function(){return"gradients() received an empty list of xs."}),null!=a&&"float32"!==a.dtype)throw new Error("dy must have 'float32' dtype, but has '"+a.dtype+"'");var p=this.scopedRun(function(){return u.startTape()},function(){return u.endTape()},function(){return u.tidy("forward",o)});L(p instanceof ki,function(){return"The result y returned by f() must be a tensor."});var m=function(g,v,y){for(var C={},S={},M=0;M<v.length;M++)C[v[M].id]=!0;for(M=0;M<g.length;M++){var O=(se=g[M]).inputs;for(var N in O){for(var P=O[N],B=!1,W=0;W<v.length;W++)if(C[P.id]){se.outputs.forEach(function(me){return C[me.id]=!0}),B=!0,S[se.id]=!0;break}if(B)break}}var G={};G[y.id]=!0;var X={};for(M=g.length-1;M>=0;M--)for(O=(se=g[M]).inputs,W=0;W<se.outputs.length;W++)if(G[se.outputs[W].id]){for(var N in O)G[O[N].id]=!0,X[se.id]=!0;break}var Q=[];for(M=0;M<g.length;M++){var se;if(S[(se=g[M]).id]&&X[se.id]){var ue={};for(var N in se.inputs){var fe=se.inputs[N];C[fe.id]&&(ue[N]=fe)}var _e=Object.assign({},se);_e.inputs=ue,_e.outputs=se.outputs,Q.push(_e)}}return Q}(this.state.activeTape,i,p);if(!c&&0===m.length&&i.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var g,v,y={};y[p.id]=a??(v=Se(de(g=p.shape),"float32"),Ie.makeTensor(v,g,"float32")),function(S,M,O){for(var N=function(B){var W=M[B],G=[];if(W.outputs.forEach(function(ue){var fe=S[ue.id];G.push(null!=fe?fe:null)}),null==W.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+W.name+".");var X=W.gradient(G),Q=function(ue){if(!(ue in X))throw new Error("Cannot backprop through input "+ue+". Available gradients found: "+Object.keys(X)+".");var fe=u.tidy(function(){return X[ue]()});if("float32"!==fe.dtype)throw new Error("Error in gradient for op "+W.name+". The gradient of input "+ue+" must have 'float32' dtype, but has '"+fe.dtype+"'");var _e=W.inputs[ue];if(!ke(fe.shape,_e.shape))throw new Error("Error in gradient for op "+W.name+". The gradient of input '"+ue+"' has shape '"+fe.shape+"', which does not match the shape of the input '"+_e.shape+"'");if(null==S[_e.id])S[_e.id]=fe;else{var me=S[_e.id];S[_e.id]=me.add(fe),me.dispose()}};for(var se in W.inputs)Q(se)},P=M.length-1;P>=0;P--)N(P)}(y,m);var C=i.map(function(S){return y[S.id]});return 0===u.state.gradientDepth&&(u.state.activeTape.forEach(function(S){for(var M in S.saved)S.saved[M].dispose()}),u.state.activeTape=null),{value:p,grads:C}})},s.prototype.customGrad=function(o){var i=this;return L(or(o),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var a,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];L(c.every(function(m){return m instanceof ki}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var p={};return c.forEach(function(m,g){p[g]=m}),i.runKernelFunc(function(m,g){return L((a=o.apply(void 0,c.concat([g]))).value instanceof ki,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),L(or(a.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),a.value},p,function(m,g){var v=a.gradFunc(m,g),y=Array.isArray(v)?v:[v];L(y.length===c.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),L(y.every(function(S){return S instanceof ki}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var C={};return y.forEach(function(S,M){C[M]=function(){return S}}),C})}},s.prototype.readSync=function(o){return this.state.tensorInfo.get(o).backend.readSync(o)},s.prototype.read=function(o){return this.state.tensorInfo.get(o).backend.read(o)},s.prototype.fromPixels=function(o,i){return this.backend.fromPixels(o,i)},s.prototype.time=function(o){return J(this,void 0,void 0,function(){var i,a;return K(this,function(c){switch(c.label){case 0:return i=Oe(),[4,this.backend.time(o)];case 1:return(a=c.sent()).wallMs=Oe()-i,[2,a]}})})},s.prototype.track=function(o){return null!=this.state.activeScope&&(o.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(o)),o},Object.defineProperty(s.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),s.prototype.reset=function(){for(var o in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ul,this.registry)this.disposeRegisteredKernels(o),this.registry[o].dispose(),delete this.registry[o];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},s.nextTensorId=0,s.nextVariableId=0,s}(),Ie=function(){var s=function(){if(null==Xd){var i=void 0;if(typeof window<"u")i=window;else if(typeof global<"u")i=global;else if(typeof process<"u")i=process;else{if(typeof self>"u")throw new Error("Could not find a global object");i=self}Xd=i}return Xd}();if(null==s._tfengine){var o=new xe(s);s._tfengine=new Bf(o)}return pe=s._tfengine.ENV,Xr=function(){return s._tfengine},s._tfengine}();function Aa(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}var Ai=E();Ai.registerFlag("DEBUG",function(){return!1},function(s){s&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ai.registerFlag("IS_BROWSER",function(){return Aa()}),Ai.registerFlag("IS_NODE",function(){return typeof process<"u"&&void 0!==process.versions&&void 0!==process.versions.node}),Ai.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Ai.registerFlag("PROD",function(){return!1}),Ai.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Ai.getBool("DEBUG")}),Ai.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Ai.registerFlag("IS_TEST",function(){return!1});var Fo,fo,Mi,Vr={},Oo={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function R_(s,o){Vr[s]=o}function Zr(s){s in Vr||(Vr[s]=function(i){if(1!==i&&2!==i)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var a=Mc(i);return a.addEventListener("webglcontextlost",function(c){c.preventDefault(),delete Vr[i]},!1),1===i?a.getContext("webgl",Oo)||a.getContext("experimental-webgl",Oo):a.getContext("webgl2",Oo)}(s));var o=Vr[s];return o.isContextLost()?(delete Vr[s],Zr(s)):(o.disable(o.DEPTH_TEST),o.disable(o.STENCIL_TEST),o.disable(o.BLEND),o.disable(o.DITHER),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SAMPLE_COVERAGE),o.enable(o.SCISSOR_TEST),o.enable(o.CULL_FACE),o.cullFace(o.BACK),Vr[s])}function Mc(s){if(typeof OffscreenCanvas<"u"&&2===s)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function ds(s,o){return[o,s]}function ro(s){var o=de(s);return $(Math.ceil(o/4))}function Ar(s,o){return[Math.max(1,Math.ceil(o/2)),Math.max(1,Math.ceil(s/2))]}function Zd(s,o){var i,a,c,u,p,m,g,v,y,C=s;return 2===E().getNumber("WEBGL_VERSION")?(i=C.R32F,a=C.R16F,c=C.RGBA16F,u=C.RGBA32F,p=C.RED,m=4,g=1,v=C.HALF_FLOAT,y=C.FLOAT):(i=s.RGBA,a=s.RGBA,c=s.RGBA,u=C.RGBA,p=s.RGBA,m=4,g=4,v=null!=o?o.HALF_FLOAT_OES:null,y=s.FLOAT),{internalFormatFloat:i,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:c,internalFormatPackedFloat:u,textureFormatFloat:p,downloadTextureFormat:s.RGBA,downloadUnpackNumChannels:m,defaultNumChannels:g,textureTypeHalfFloat:v,textureTypeFloat:y}}function Zt(s,o,i){var a=i();return o&&function(c){var u=c.getError();if(u!==c.NO_ERROR)throw new Error("WebGL Error: "+Ah(c,u))}(s),a}function Ih(s){return!!(E().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===s||5.96e-8<Math.abs(s)&&Math.abs(s)<65504)}function Ah(s,o){switch(o){case s.NO_ERROR:return"NO_ERROR";case s.INVALID_ENUM:return"INVALID_ENUM";case s.INVALID_VALUE:return"INVALID_VALUE";case s.INVALID_OPERATION:return"INVALID_OPERATION";case s.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case s.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case s.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+o}}function Jd(s,o,i){return qa(s,o,function(){return s.getExtension(i)},'Extension "'+i+'" not supported on this browser.')}function Tc(s,o,i){var a=qa(s,o,function(){return s.createShader(s.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Zt(s,o,function(){return s.shaderSource(a,i)}),Zt(s,o,function(){return s.compileShader(a)}),!1===s.getShaderParameter(a,s.COMPILE_STATUS))throw console.log(s.getShaderInfoLog(a)),new Error("Failed to compile vertex shader.");return a}function Fs(s,o,i){var a=qa(s,o,function(){return s.createShader(s.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Zt(s,o,function(){return s.shaderSource(a,i)}),Zt(s,o,function(){return s.compileShader(a)}),!1===s.getShaderParameter(a,s.COMPILE_STATUS))throw function(c,u){var p=Ra.exec(u);if(null==p)return console.log("Couldn't parse line number in error: "+u),void console.log(c);for(var m=+p[1],g=c.split("\n"),v=g.length.toString().length+2,y=g.map(function(P,B){return Ee((B+1).toString(),v)+P}),C=0,S=0;S<y.length;S++)C=Math.max(y[S].length,C);var M=y.slice(0,m-1),O=y.slice(m-1,m),N=y.slice(m);console.log(M.join("\n")),console.log(u.split("\n")[0]),console.log("%c "+Ee(O[0],C),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(N.join("\n"))}(i,s.getShaderInfoLog(a)),new Error("Failed to compile fragment shader.");return a}(function(s){s[s.DENSE=0]="DENSE",s[s.SHARED_BATCH=1]="SHARED_BATCH"})(Fo||(Fo={})),function(s){s[s.RENDER=0]="RENDER",s[s.UPLOAD=1]="UPLOAD",s[s.PIXELS=2]="PIXELS",s[s.DOWNLOAD=3]="DOWNLOAD"}(fo||(fo={})),function(s){s[s.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",s[s.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",s[s.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",s[s.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",s[s.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Mi||(Mi={}));var Ic,tr,Ra=/ERROR: [0-9]+:([0-9]+):/g;function hl(s,o){return qa(s,o,function(){return s.createProgram()},"Unable to create WebGLProgram.")}function Ac(s,o,i){if(Zt(s,o,function(){return s.linkProgram(i)}),!1===s.getProgramParameter(i,s.LINK_STATUS))throw console.log(s.getProgramInfoLog(i)),new Error("Failed to link vertex and fragment shaders.")}function Ri(s,o,i){if(Zt(s,o,function(){return s.validateProgram(i)}),!1===s.getProgramParameter(i,s.VALIDATE_STATUS))throw console.log(s.getProgramInfoLog(i)),new Error("Shader program validation failed.")}function eu(s,o,i){var a=qa(s,o,function(){return s.createBuffer()},"Unable to create WebGLBuffer");return Zt(s,o,function(){return s.bindBuffer(s.ARRAY_BUFFER,a)}),Zt(s,o,function(){return s.bufferData(s.ARRAY_BUFFER,i,s.STATIC_DRAW)}),a}function Fi(s,o,i){var a=qa(s,o,function(){return s.createBuffer()},"Unable to create WebGLBuffer");return Zt(s,o,function(){return s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,a)}),Zt(s,o,function(){return s.bufferData(s.ELEMENT_ARRAY_BUFFER,i,s.STATIC_DRAW)}),a}function Rc(s,o){return qa(s,o,function(){return s.createTexture()},"Unable to create WebGLTexture.")}function Vf(s,o){var i=E().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(s<=0||o<=0){var a="["+s+"x"+o+"]";throw new Error("Requested texture size "+a+" is invalid.")}if(s>i||o>i)throw a="["+s+"x"+o+"]",new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU ["+i+"x"+i+"].")}function Yn(s,o){return qa(s,o,function(){return s.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function _n(s,o,i,a,c,u,p,m){var g=s.getAttribLocation(i,a);return-1!==g&&(Zt(s,o,function(){return s.bindBuffer(s.ARRAY_BUFFER,c)}),Zt(s,o,function(){return s.vertexAttribPointer(g,u,s.FLOAT,!1,p,m)}),Zt(s,o,function(){return s.enableVertexAttribArray(g)}),!0)}function Fc(s,o,i,a){O_(s,a),Zt(s,o,function(){return s.activeTexture(s.TEXTURE0+a)}),Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,i)})}function tu(s,o,i,a){return qa(s,o,function(){return s.getUniformLocation(i,a)},'uniform "'+a+'" not present in program.')}function F_(s,o,i){return s.getUniformLocation(o,i)}function zl(s,o,i,a,c,u){Zt(s,o,function(){return Fc(s,o,a,u)}),Zt(s,o,function(){return s.uniform1i(c,u)})}function ot(s,o,i,a){Zt(s,o,function(){return s.bindFramebuffer(s.FRAMEBUFFER,a)}),Zt(s,o,function(){return s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0)})}function Vl(s,o,i){Zt(s,o,function(){return s.bindFramebuffer(s.FRAMEBUFFER,i)}),Zt(s,o,function(){return s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,null,0)})}function An(s){var o=s.checkFramebufferStatus(s.FRAMEBUFFER);if(o!==s.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Ei(s,o))}function Ei(s,o){switch(o){case s.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case s.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case s.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case s.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+o}}function qa(s,o,i,a){var c=Zt(s,o,function(){return i()});if(null==c)throw new Error(a);return c}function O_(s,o){var i=s.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=o+s.TEXTURE0;if(a<s.TEXTURE0||a>i)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+i+"].")}function Oc(s,o){return void 0===o&&(o=2),de(s.slice(0,s.length-o))}function No(s){if(0===s.length)throw Error("Cannot get rows and columns of an empty shape array.");return[s.length>1?s[s.length-2]:1,s[s.length-1]]}function Qr(s){var o=[1,1,1];return 0===s.length||1===s.length&&1===s[0]||(o=[Oc(s)].concat(No(s))),o}function N_(s,o){var i;void 0===o&&(o=!1);var a=E().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(o&&(a*=2,1===(s=s.map(function(v,y){return y>=s.length-2?R(s[y]):s[y]})).length&&(s=[2,s[0]])),2!==s.length){var c=Ve(s);s=c.newShape}var u=de(s);if(s.length<=1&&u<=a)return[1,u];if(2===s.length&&s[0]<=a&&s[1]<=a)return s;if(3===s.length&&s[0]*s[1]<=a&&s[2]<=a)return[s[0]*s[1],s[2]];if(3===s.length&&s[0]<=a&&s[1]*s[2]<=a)return[s[0],s[1]*s[2]];if(4===s.length&&s[0]*s[1]*s[2]<=a&&s[3]<=a)return[s[0]*s[1]*s[2],s[3]];if(4===s.length&&s[0]<=a&&s[1]*s[2]*s[3]<=a)return[s[0],s[1]*s[2]*s[3]];if(o){var p=Oc(s),m=2,g=2;return s.length&&(m=(i=No(s))[0],g=i[1]),$(u=p*(m/2)*(g/2)).map(function(v){return 2*v})}return $(u)}function nu(s){return s%2==0}function pl(s,o){if(ke(s=s.slice(-2),o=o.slice(-2))||!s.length||!o.length||0===s[0]||0===s[1]||0===o[0]||0===o[1])return!0;if(s.length!==o.length){var i=s.slice(-1)[0],a=o.slice(-1)[0];if(i===a||nu(i)&&nu(a)&&(1===s[0]||1===o[0]))return!0}return s[1]===o[1]&&nu(s[0])&&nu(o[0])}function Ya(s){if(null==Ic){var o=Zr(s);Ic=o.getParameter(o.MAX_TEXTURE_SIZE)}return Ic}function P_(s){if(null==tr){var o=Zr(s);tr=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,tr)}function Uf(s){if(0===s)return 0;var o=Zr(s);return Fa(o,"EXT_disjoint_timer_query_webgl2")&&2===s?2:Fa(o,"EXT_disjoint_timer_query")?1:0}function Fa(s,o){return null!=s.getExtension(o)}function Rh(s){try{if(null!=Zr(s))return!0}catch{return!1}return!1}function Fh(s){if(0===s)return!1;var o=Zr(s);if(1===s){if(!Fa(o,"OES_texture_float"))return!1}else if(!Fa(o,"EXT_color_buffer_float"))return!1;return iu(o)}function Hf(s){if(0===s)return!1;var o=Zr(s);if(1!==s){if(Fa(o,"EXT_color_buffer_float"))return iu(o);if(Fa(o,"EXT_color_buffer_half_float")){var i=o.getExtension("EXT_color_buffer_half_float");return function(a,c){var u=Zd(a,c),p=a.createTexture();a.bindTexture(a.TEXTURE_2D,p),a.texImage2D(a.TEXTURE_2D,0,u.internalFormatHalfFloat,1,1,0,u.textureFormatFloat,u.textureTypeHalfFloat,null);var m=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,m),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,p,0);var g=a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE;return a.bindTexture(a.TEXTURE_2D,null),a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteTexture(p),a.deleteFramebuffer(m),g}(o,i)}return!1}return!!Fa(o,"OES_texture_float")&&!!Fa(o,"WEBGL_color_buffer_float")&&iu(o)}function iu(s){var o=Zd(s),i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i),s.texImage2D(s.TEXTURE_2D,0,o.internalFormatFloat,1,1,0,o.textureFormatFloat,o.textureTypeFloat,null);var a=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,a),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,i,0);var c=s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE;return s.bindTexture(s.TEXTURE_2D,null),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteTexture(i),s.deleteFramebuffer(a),c}function L_(s){return 2===s&&null!=Zr(s).fenceSync}var Wo=Object.freeze({callAndCheck:Zt,canBeRepresented:Ih,getWebGLErrorMessage:Ah,getExtensionOrThrow:Jd,createVertexShader:Tc,createFragmentShader:Fs,createProgram:hl,linkProgram:Ac,validateProgram:Ri,createStaticVertexBuffer:eu,createStaticIndexBuffer:Fi,getNumChannels:function(){return 2===E().getNumber("WEBGL_VERSION")?1:4},createTexture:Rc,validateTextureSize:Vf,createFramebuffer:Yn,bindVertexBufferToProgramAttribute:_n,bindTextureUnit:Fc,unbindTextureUnit:function(s,o,i){O_(s,i),Zt(s,o,function(){return s.activeTexture(s.TEXTURE0+i)}),Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:tu,getProgramUniformLocation:F_,bindTextureToProgramUniformSampler:zl,bindCanvasToFramebuffer:function(s,o){Zt(s,o,function(){return s.bindFramebuffer(s.FRAMEBUFFER,null)}),Zt(s,o,function(){return s.viewport(0,0,s.canvas.width,s.canvas.height)}),Zt(s,o,function(){return s.scissor(0,0,s.canvas.width,s.canvas.height)})},bindColorTextureToFramebuffer:ot,unbindColorTextureFromFramebuffer:Vl,validateFramebuffer:An,getFramebufferErrorMessage:Ei,getBatchDim:Oc,getRowsCols:No,getShapeAs3D:Qr,getTextureShapeFromLogicalShape:N_,isReshapeFree:pl,getWebGLMaxTextureSize:Ya,resetMaxTextureSize:function(){Ic=null},resetMaxTexturesInShader:function(){tr=null},getMaxTexturesInShader:P_,getWebGLDisjointQueryTimerVersion:Uf,hasExtension:Fa,isWebGLVersionEnabled:Rh,isCapableOfRenderingToFloatTexture:Fh,isDownloadFloatTextureEnabled:Hf,isWebGLFenceEnabled:L_}),Lt=E();function Rx(){E().set("PROD",!0)}function Nc(){E().set("DEBUG",!0)}function jf(){E().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function St(s){E().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(s+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Fx(){Ie.disposeVariables()}function $t(){return Ie}function fl(){return Ie.memory()}function B_(s){return Ie.profile(s)}function $e(s,o){return Ie.tidy(s,o)}function Kn(s){Ir(s).forEach(function(o){return o.dispose()})}function Ka(s){return Ie.keep(s)}function ru(s){return Ie.time(s)}function ou(s){return Ie.setBackend(s)}function Oh(){return Ie.ready()}function Wf(){return Ie.backendName}function Nh(s){Ie.removeBackend(s)}function kn(s){return Ie.findBackend(s)}function Ph(s){return Ie.findBackendFactory(s)}function z_(s,o,i){return void 0===i&&(i=1),Ie.registerBackend(s,o,i)}function Go(){return Ie.backend}function Gf(s,o){E().setPlatform(s,o)}function Lh(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];E().getBool("IS_TEST")||console.warn.apply(console,s)}function k(s,o){var i=s;if(Le(s))return"string"===o?[]:[s.length];if(!Array.isArray(s))return[];for(var a=[];Array.isArray(i)||Le(i)&&"string"!==o;)a.push(i.length),i=i[0];return Array.isArray(s)&&E().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function c(u,p,m){if(m=m||[],Array.isArray(u)||Le(u)){L(p.length>0,function(){return"Element arr["+m.join("][")+"] should be a primitive, but is an array of "+u.length+" elements"}),L(u.length===p[0],function(){return"Element arr["+m.join("][")+"] should have "+p[0]+" elements, but has "+u.length+" elements"});for(var g=p.slice(1),v=0;v<u.length;++v)c(u[v],g,m.concat(v))}else L(0===p.length,function(){return"Element arr["+m.join("][")+"] is a primitive, but should be an array/TypedArray of "+p[0]+" elements"})}(s,a,[]),a}function U(s,o,i,a){if(null!=s&&("numeric"!==s&&s!==o||"numeric"===s&&"string"===o))throw new Error("Argument '"+i+"' passed to '"+a+"' must be "+s+" tensor, but got "+o+" tensor")}function F(s,o,i,a){if(void 0===a&&(a="numeric"),s instanceof ki)return U(a,s.dtype,o,i),s;var c=Pt(s);if("string"!==c&&["bool","int32","float32"].indexOf(a)>=0&&(c=a),U(a,c,o,i),null==s||!Le(s)&&!Array.isArray(s)&&"number"!=typeof s&&"boolean"!=typeof s&&"string"!=typeof s)throw new Error("Argument '"+o+"' passed to '"+i+"' must be a Tensor or TensorLike, but got '"+(null==s?"null":s.constructor.name)+"'");var p=k(s,c);Le(s)||Array.isArray(s)||(s=[s]);var m="string"!==c?mt(s,c,E().getBool("DEBUG")):we(s,[],!0);return Ie.makeTensor(m,p,c)}function ge(s,o,i,a){if(void 0===a&&(a="numeric"),!Array.isArray(s))throw new Error("Argument "+o+" passed to "+i+" must be a `Tensor[]` or `TensorLike[]`");return s.map(function(c,u){return F(c,o+"["+u+"]",i)},a)}function Fe(s,o){for(var i=0;i<s.length;++i)if(s[s.length-i-1]!==o-1-i)return!1;return!0}function Ke(s,o,i){for(var a=s.length+o.length,c=[],u=0,p=0,m=0;m<a;m++)-1===i.indexOf(m)?c.push(s[u++]):c.push(o[p++]);return c}function Pe(s,o){for(var i=[],a=s.length,c=0;c<a;c++)-1===o.indexOf(c)&&i.push(s[c]);return[i,o.map(function(u){return s[u]})]}function gt(s,o){return Ke(s,o.map(function(i){return 1}),o)}function lt(s,o,i){L(Fe(o,i),function(){return s+" supports only inner-most axes for now. Got axes "+o+" and rank-"+i+" input."})}function At(s,o){if(Fe(s,o))return null;for(var i=[],a=0;a<o;++a)-1===s.indexOf(a)&&i.push(a);return s.forEach(function(c){return i.push(c)}),i}function vn(s){return s.map(function(o,i){return[i,o]}).sort(function(o,i){return o[1]-i[1]}).map(function(o){return o[0]})}function Dn(s,o){for(var i=[],a=o-s;a<o;++a)i.push(a);return i}function wn(s,o){var i=s[0].length;s.forEach(function(c,u){L(c.length===i,function(){return"Error in concat"+i+"D: rank of tensors["+u+"] must be the same as the rank of the rest ("+i+")"})}),L(o>=0&&o<i,function(){return"Error in concat"+i+"D: axis must be between 0 and "+(i-1)+"."});var a=s[0];s.forEach(function(c,u){for(var p=0;p<i;p++)L(p===o||c[p]===a[p],function(){return"Error in concat"+i+"D: Shape of tensors["+u+"] ("+c+") does not match the shape of the rest ("+a+") along the non-concatenated axis "+u+"."})})}function on(s,o){for(var i=s[0].slice(),a=1;a<s.length;a++)i[o]+=s[a][o];return i}function ee(s){var o=Object.keys(s);if(1!==o.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+o.length+" keys.");var i=o[0],a=s[i];i.endsWith("_")&&(i=i.substring(0,i.length-1));var c=function(){for(var u=[],p=0;p<arguments.length;p++)u[p]=arguments[p];Ie.startScope(i);try{var m=a.apply(void 0,u);return m instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ie.endScope(m),m}catch(g){throw Ie.endScope(null),g}};return Object.defineProperty(c,"name",{value:i,configurable:!0}),c}Lt.registerFlag("HAS_WEBGL",function(){return Lt.getNumber("WEBGL_VERSION")>0}),Lt.registerFlag("WEBGL_VERSION",function(){return Rh(2)?2:Rh(1)?1:0}),Lt.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Lt.get("WEBGL_VERSION")}),Lt.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Lt.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Lt.registerFlag("WEBGL_PACK",function(){return Lt.getBool("HAS_WEBGL")}),Lt.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_PACK_CLIP",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Lt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_PACK_REDUCE",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_CONV_IM2COL",function(){return Lt.getBool("WEBGL_PACK")}),Lt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Ya(Lt.getNumber("WEBGL_VERSION"))}),Lt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return P_(Lt.getNumber("WEBGL_VERSION"))}),Lt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var s=Lt.getNumber("WEBGL_VERSION");return 0===s?0:Uf(s)}),Lt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Lt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(s=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4))));var s}),Lt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return Fh(Lt.getNumber("WEBGL_VERSION"))}),Lt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Lt.getBool("WEBGL_FORCE_F16_TEXTURES")&&Lt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Lt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Hf(Lt.getNumber("WEBGL_VERSION"))}),Lt.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return L_(Lt.getNumber("WEBGL_VERSION"))}),Lt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Lt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),Ro=St;var Cn=ee({complex_:function(s,o){var i=F(s,"real","complex"),a=F(o,"imag","complex");return oe(i.shape,a.shape,"real and imag shapes, "+i.shape+" and "+a.shape+", must match in call to tf.complex()."),Ie.runKernelFunc(function(c){return c.complex(i,a)},{$real:i,$imag:a})}}),Ft=ee({real_:function(s){var o=F(s,"input","real");return Ie.runKernelFunc(function(i){return i.real(o)},{$input:o})}}),Xn=ee({imag_:function(s){var o=F(s,"input","imag");return Ie.runKernelFunc(function(i){return i.imag(o)},{$input:o})}});function ei(s,o,i){return sr(s,o,k(s,i),i)}function sr(s,o,i,a){if(null==a&&(a=Pt(s)),"complex64"===a)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Le(s)&&!Array.isArray(s)&&"number"!=typeof s&&"boolean"!=typeof s&&"string"!=typeof s)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=o){_t(o);var c=de(o),u=de(i);L(c===u,function(){return"Based on the provided shape, ["+o+"], the tensor should have "+c+" values but has "+u});for(var p=0;p<i.length;++p){var g=p!==i.length-1||i[p]!==de(o.slice(p));L(i[p]===o[p]||!g,function(){return"Error creating a new Tensor. Inferred shape ("+i+") does not match the provided shape ("+o+"). "})}}return Le(s)||Array.isArray(s)||(s=[s]),o=o||i,s="string"!==a?mt(s,a,E().getBool("DEBUG")):we(s,[],!0),Ie.makeTensor(s,o,a)}function Nt(s,o){if((Le(s)&&"string"!==o||Array.isArray(s))&&"complex64"!==o)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===o&&Le(s)&&!(s instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return sr(s,[],[],o)}function Pn(s,o){ve(s);var i=k(s,o);if(1!==i.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return sr(s,null,i,o)}function qi(s,o,i){if(ve(s),null!=o&&2!==o.length)throw new Error("tensor2d() requires shape to have two numbers");var a=k(s,i);if(2!==a.length&&1!==a.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===a.length&&null==o)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return sr(s,o,a,i)}function Jr(s,o,i){if(ve(s),null!=o&&3!==o.length)throw new Error("tensor3d() requires shape to have three numbers");var a=k(s,i);if(3!==a.length&&1!==a.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==o)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return sr(s,o,a,i)}function oo(s,o,i){if(ve(s),null!=o&&4!==o.length)throw new Error("tensor4d() requires shape to have four numbers");var a=k(s,i);if(4!==a.length&&1!==a.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===a.length&&null==o)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return sr(s,o,a,i)}function ak(s,o,i){if(ve(s),null!=o&&5!==o.length)throw new Error("tensor5d() requires shape to have five numbers");var a=k(s,i);if(5!==a.length&&1!==a.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===a.length&&null==o)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return sr(s,o,a,i)}function sk(s,o,i){if(ve(s),null!=o&&6!==o.length)throw new Error("tensor6d() requires shape to have six numbers");var a=k(s,i);if(6!==a.length&&1!==a.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===a.length&&null==o)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return sr(s,o=o||a,a,i)}function Oa(s,o,i,a){return void 0===o&&(o=!0),Ie.makeVariable(s,o,i,a)}function ao(s,o){if(void 0===o&&(o="float32"),"complex64"===o){var i=ao(s,"float32"),a=fn(s,"float32");return Cn(i,a)}var c=Se(de(s),o);return Ie.makeTensor(c,s,o)}function fn(s,o){if(void 0===o&&(o="float32"),"complex64"===o){var i=fn(s,"float32"),a=fn(s,"float32");return Cn(i,a)}var c=be(de(s),o);return Ie.makeTensor(c,s,o)}function ml(s,o,i){return Ie.runKernelFunc(function(a){return a.fill(s,o,i)},{})}function Bh(s,o,i){if(i<=0)throw new Error("The number of values should be positive.");return Ie.runKernelFunc(function(a){return a.linspace(s,o,i)},{})}function au(s,o,i,a){if(void 0===i&&(i=1),void 0===a&&(a="float32"),0===i)throw new Error("Cannot have a step of zero");if(s===o||s<o&&i<0||o<s&&i>1)return fn([0],a);var c=be(Math.abs(Math.ceil((o-s)/i)),a);o<s&&1===i&&(i=-1),c[0]=s;for(var u=1;u<c.length;u++)c[u]=c[u-1]+i;return Pn(c,a)}var ua=ee({onesLike_:function(s){var o=F(s,"x","onesLike");if("complex64"===o.dtype){var i=ua(Ft(o)),a=$n(Xn(o));return Cn(i,a)}return Ie.runKernelFunc(function(c){return c.onesLike(o)},{$x:o},function(c,u){return{$x:function(){return $n(c)}}})}}),$n=ee({zerosLike_:function(s){var o=F(s,"x","zerosLike");return Ie.runKernelFunc(function(i){return i.zerosLike(o)},{$x:o},function(i,a){return{$x:function(){return $n(i)}}})}}),Ur=ee({concat_:function(s,o){void 0===o&&(o=0),L(s.length>=1,function(){return"Pass at least one tensor to concat"});var i=ge(s,"tensors","concat");"complex64"===i[0].dtype&&i.forEach(function(p){if("complex64"!==p.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+p.dtype+". ")}),o=kt(o,i[0].shape)[0];var a=on(i.map(function(p){return p.shape}),o);if(0===de(a))return ei([],a);if(1===(i=i.filter(function(p){return p.size>0})).length)return i[0];var c=i.map(function(p){return p.shape});return wn(c,o),Ie.runKernelFunc(function(p){return p.concat(i,o)},i,function(p){var m=c.map(function(g){return g[o]});return Os(p,m,o).map(function(g){return function(){return g}})})}}),V_=ee({concat1d_:function(s){return Ur(s,0)}}),Mn=ee({concat2d_:function(s,o){return Ur(s,o)}}),U_=ee({concat3d_:function(s,o){return Ur(s,o)}}),$f=ee({concat4d_:function(s,o){return Ur(s,o)}}),Os=ee({split_:function(s,o,i){void 0===i&&(i=0);var a,c=F(s,"x","split");return i=kt(i,c.shape)[0],"number"==typeof o?(L(c.shape[i]%o==0,function(){return"Number of splits must evenly divide the axis."}),a=new Array(o).fill(c.shape[i]/o)):(L(c.shape[i]===o.reduce(function(u,p){return u+p}),function(){return"The sum of sizes must match the size of the axis dimension."}),a=o),Ie.runKernelFunc(function(u){return u.split(c,a,i)},{$x:c},function(u){return{$x:function(){return Ur(u,i)}}})}});function Vt(s,o){return s(o={exports:{}},o.exports),o.exports}typeof globalThis<"u"||typeof window<"u"||typeof global<"u"&&global;var lk=Vt(function(s){!function(o,i,a){function c(m){var g,v=this,y=(g=4022871197,function(C){C=C.toString();for(var S=0;S<C.length;S++){var M=.02519603282416938*(g+=C.charCodeAt(S));M-=g=M>>>0,g=(M*=g)>>>0,g+=4294967296*(M-=g)}return 2.3283064365386963e-10*(g>>>0)});v.next=function(){var C=2091639*v.s0+2.3283064365386963e-10*v.c;return v.s0=v.s1,v.s1=v.s2,v.s2=C-(v.c=0|C)},v.c=1,v.s0=y(" "),v.s1=y(" "),v.s2=y(" "),v.s0-=y(m),v.s0<0&&(v.s0+=1),v.s1-=y(m),v.s1<0&&(v.s1+=1),v.s2-=y(m),v.s2<0&&(v.s2+=1),y=null}function u(m,g){return g.c=m.c,g.s0=m.s0,g.s1=m.s1,g.s2=m.s2,g}function p(m,g){var v=new c(m),y=g&&g.state,C=v.next;return C.int32=function(){return 4294967296*v.next()|0},C.double=function(){return C()+11102230246251565e-32*(2097152*C()|0)},C.quick=C,y&&("object"==typeof y&&u(y,v),C.state=function(){return u(v,{})}),C}i&&i.exports?i.exports=p:this.alea=p}(0,s)}),Ox=Vt(function(s){!function(o,i,a){function c(m){var g=this,v="";g.x=0,g.y=0,g.z=0,g.w=0,g.next=function(){var C=g.x^g.x<<11;return g.x=g.y,g.y=g.z,g.z=g.w,g.w^=g.w>>>19^C^C>>>8},m===(0|m)?g.x=m:v+=m;for(var y=0;y<v.length+64;y++)g.x^=0|v.charCodeAt(y),g.next()}function u(m,g){return g.x=m.x,g.y=m.y,g.z=m.z,g.w=m.w,g}function p(m,g){var v=new c(m),y=g&&g.state,C=function(){return(v.next()>>>0)/4294967296};return C.double=function(){do{var S=((v.next()>>>11)+(v.next()>>>0)/4294967296)/2097152}while(0===S);return S},C.int32=v.next,C.quick=C,y&&("object"==typeof y&&u(y,v),C.state=function(){return u(v,{})}),C}i&&i.exports?i.exports=p:this.xor128=p}(0,s)}),Ze=Vt(function(s){!function(o,i,a){function c(m){var g=this,v="";g.next=function(){var C=g.x^g.x>>>2;return g.x=g.y,g.y=g.z,g.z=g.w,g.w=g.v,(g.d=g.d+362437|0)+(g.v=g.v^g.v<<4^C^C<<1)|0},g.x=0,g.y=0,g.z=0,g.w=0,g.v=0,m===(0|m)?g.x=m:v+=m;for(var y=0;y<v.length+64;y++)g.x^=0|v.charCodeAt(y),y==v.length&&(g.d=g.x<<10^g.x>>>4),g.next()}function u(m,g){return g.x=m.x,g.y=m.y,g.z=m.z,g.w=m.w,g.v=m.v,g.d=m.d,g}function p(m,g){var v=new c(m),y=g&&g.state,C=function(){return(v.next()>>>0)/4294967296};return C.double=function(){do{var S=((v.next()>>>11)+(v.next()>>>0)/4294967296)/2097152}while(0===S);return S},C.int32=v.next,C.quick=C,y&&("object"==typeof y&&u(y,v),C.state=function(){return u(v,{})}),C}i&&i.exports?i.exports=p:this.xorwow=p}(0,s)}),ha=Vt(function(s){!function(o,i,a){function c(m){var g=this;g.next=function(){var v,y,C=g.x,S=g.i;return v=C[S],y=(v^=v>>>7)^v<<24,y^=(v=C[S+1&7])^v>>>10,y^=(v=C[S+3&7])^v>>>3,y^=(v=C[S+4&7])^v<<7,v=C[S+7&7],y^=(v^=v<<13)^v<<9,C[S]=y,g.i=S+1&7,y},function(v,y){var C,S=[];if(y===(0|y))S[0]=y;else for(y=""+y,C=0;C<y.length;++C)S[7&C]=S[7&C]<<15^y.charCodeAt(C)+S[C+1&7]<<13;for(;S.length<8;)S.push(0);for(C=0;C<8&&0===S[C];++C);for(8==C&&(S[7]=-1),v.x=S,v.i=0,C=256;C>0;--C)v.next()}(g,m)}function u(m,g){return g.x=m.x.slice(),g.i=m.i,g}function p(m,g){null==m&&(m=+new Date);var v=new c(m),y=g&&g.state,C=function(){return(v.next()>>>0)/4294967296};return C.double=function(){do{var S=((v.next()>>>11)+(v.next()>>>0)/4294967296)/2097152}while(0===S);return S},C.int32=v.next,C.quick=C,y&&(y.x&&u(y,v),C.state=function(){return u(v,{})}),C}i&&i.exports?i.exports=p:this.xorshift7=p}(0,s)}),Gi=Vt(function(s){!function(o,i,a){function c(m){var g=this;g.next=function(){var v,y,C=g.w,S=g.X,M=g.i;return g.w=C=C+1640531527|0,y=S[M+34&127],v=S[M=M+1&127],y^=y<<13,v^=v<<17,y=S[M]=(y^=y>>>15)^(v^=v>>>12),g.i=M,y+(C^C>>>16)|0},function(v,y){var C,S,M,O,N,P=[],B=128;for(y===(0|y)?(S=y,y=null):(y+="\0",S=0,B=Math.max(B,y.length)),M=0,O=-32;O<B;++O)y&&(S^=y.charCodeAt((O+32)%y.length)),0===O&&(N=S),S^=S<<10,S^=S>>>15,S^=S<<4,S^=S>>>13,O>=0&&(M=0==(C=P[127&O]^=S+(N=N+1640531527|0))?M+1:0);for(M>=128&&(P[127&(y&&y.length||0)]=-1),M=127,O=512;O>0;--O)S=P[M+34&127],C=P[M=M+1&127],S^=S<<13,C^=C<<17,P[M]=(S^=S>>>15)^(C^=C>>>12);v.w=N,v.X=P,v.i=M}(g,m)}function u(m,g){return g.i=m.i,g.w=m.w,g.X=m.X.slice(),g}function p(m,g){null==m&&(m=+new Date);var v=new c(m),y=g&&g.state,C=function(){return(v.next()>>>0)/4294967296};return C.double=function(){do{var S=((v.next()>>>11)+(v.next()>>>0)/4294967296)/2097152}while(0===S);return S},C.int32=v.next,C.quick=C,y&&(y.X&&u(y,v),C.state=function(){return u(v,{})}),C}i&&i.exports?i.exports=p:this.xor4096=p}(0,s)}),Po=Vt(function(s){!function(o,i,a){function c(m){var g=this,v="";g.next=function(){var C=g.b,S=g.c,M=g.d,O=g.a;return C=C<<25^C>>>7^S,S=S-M|0,M=M<<24^M>>>8^O,O=O-C|0,g.b=C=C<<20^C>>>12^S,g.c=S=S-M|0,g.d=M<<16^S>>>16^O,g.a=O-C|0},g.a=0,g.b=0,g.c=-1640531527,g.d=1367130551,m===Math.floor(m)?(g.a=m/4294967296|0,g.b=0|m):v+=m;for(var y=0;y<v.length+20;y++)g.b^=0|v.charCodeAt(y),g.next()}function u(m,g){return g.a=m.a,g.b=m.b,g.c=m.c,g.d=m.d,g}function p(m,g){var v=new c(m),y=g&&g.state,C=function(){return(v.next()>>>0)/4294967296};return C.double=function(){do{var S=((v.next()>>>11)+(v.next()>>>0)/4294967296)/2097152}while(0===S);return S},C.int32=v.next,C.quick=C,y&&("object"==typeof y&&u(y,v),C.state=function(){return u(v,{})}),C}i&&i.exports?i.exports=p:this.tychei=p}(0,s)}),Rr=Vt(function(s){!function(o,i){var a,c=this,u=256,m="random",g=i.pow(u,6),v=i.pow(2,52),y=2*v,C=255;function S(B,W,G){var X=[],Q=N(function fe(_e,me){var Me,Te=[],Ue=typeof _e;if(me&&"object"==Ue)for(Me in _e)try{Te.push(fe(_e[Me],me-1))}catch{}return Te.length?Te:"string"==Ue?_e:_e+"\0"}((W=1==W?{entropy:!0}:W||{}).entropy?[B,P(o)]:B??function(){try{var fe;return a&&(fe=a.randomBytes)?fe=fe(u):(fe=new Uint8Array(u),(c.crypto||c.msCrypto).getRandomValues(fe)),P(fe)}catch{var _e=c.navigator,me=_e&&_e.plugins;return[+new Date,c,me,c.screen,P(o)]}}(),3),X),se=new M(X),ue=function(){for(var fe=se.g(6),_e=g,me=0;fe<v;)fe=(fe+me)*u,_e*=u,me=se.g(1);for(;fe>=y;)fe/=2,_e/=2,me>>>=1;return(fe+me)/_e};return ue.int32=function(){return 0|se.g(4)},ue.quick=function(){return se.g(4)/4294967296},ue.double=ue,N(P(se.S),o),(W.pass||G||function(fe,_e,me,Me){return Me&&(Me.S&&O(Me,se),fe.state=function(){return O(se,{})}),me?(i[m]=fe,_e):fe})(ue,Q,"global"in W?W.global:this==i,W.state)}function M(B){var W,G=B.length,X=this,Q=0,se=X.i=X.j=0,ue=X.S=[];for(G||(B=[G++]);Q<u;)ue[Q]=Q++;for(Q=0;Q<u;Q++)ue[Q]=ue[se=C&se+B[Q%G]+(W=ue[Q])],ue[se]=W;(X.g=function(fe){for(var _e,me=0,Me=X.i,Te=X.j,Ue=X.S;fe--;)_e=Ue[Me=C&Me+1],me=me*u+Ue[C&(Ue[Me]=Ue[Te=C&Te+_e])+(Ue[Te]=_e)];return X.i=Me,X.j=Te,me})(u)}function O(B,W){return W.i=B.i,W.j=B.j,W.S=B.S.slice(),W}function N(B,W){for(var G,X=B+"",Q=0;Q<X.length;)W[C&Q]=C&(G^=19*W[C&Q])+X.charCodeAt(Q++);return P(W)}function P(B){return String.fromCharCode.apply(0,B)}if(i["seed"+m]=S,N(i.random(),o),s.exports){s.exports=S;try{a=Re(902)}catch{}}}([],Math)});Rr.alea=lk,Rr.xor128=Ox,Rr.xorwow=Ze,Rr.xorshift7=ha,Rr.xor4096=Gi,Rr.tychei=Po;var gl=Rr.alea,$o=function(){function s(o,i,a,c,u){this.mean=o,this.stdDev=i,this.dtype=a,this.nextVal=NaN,this.truncated=c,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var p=u||Math.random();this.random=gl(p.toString())}return s.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var o=this.nextVal;return this.nextVal=NaN,o}for(var i,a,c=!1;!c;){var u=void 0,p=void 0,m=void 0;do{m=(u=2*this.random()-1)*u+(p=2*this.random()-1)*p}while(m>=1||0===m);var g=Math.sqrt(-2*Math.log(m)/m);i=this.mean+this.stdDev*u*g,a=this.mean+this.stdDev*p*g,this.truncated&&!this.isValidTruncated(i)||(c=!0)}return this.truncated&&!this.isValidTruncated(a)||(this.nextVal=this.convertValue(a)),this.convertValue(i)},s.prototype.convertValue=function(o){return null==this.dtype||"float32"===this.dtype?o:Math.round(o)},s.prototype.isValidTruncated=function(o){return o<=this.upper&&o>=this.lower},s}(),_l=function(){function s(o,i,a,c){this.alpha=o,this.beta=1/i,this.dtype=a;var u=c||Math.random();this.randu=gl(u.toString()),this.randn=new $o(0,1,a,!1,this.randu()),this.d=o<1?o+2/3:o-1/3,this.c=1/Math.sqrt(9*this.d)}return s.prototype.nextValue=function(){for(var o,i,a,c,u,p;;){do{c=this.randn.nextValue(),p=1+this.c*c}while(p<=0);if(i=1-.331*(o=c*c)*o,a=.5*o+this.d*(1-(p*=p*p)+Math.log(p)),(u=this.randu())<i||Math.log(u)<a)break}return p*=1/this.beta*this.d,this.alpha<1&&(p*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(p)},s.prototype.convertValue=function(o){return"float32"===this.dtype?o:Math.round(o)},s}(),tn=function(){function s(o,i,a,c){var u=this;if(void 0===o&&(o=0),void 0===i&&(i=1),this.canReturnFloat=function(){return null==u.dtype||"float32"===u.dtype},this.min=o,this.range=i-o,this.dtype=a,null==c&&(c=Math.random()),"number"==typeof c&&(c=c.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+o+" - "+i+" <= 1 and dtype is not float");this.random=gl(c)}return s.prototype.convertValue=function(o){return this.canReturnFloat()?o:Math.round(o)},s.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},s}();function Rt(s,o,i){return void 0===o&&(o="float32"),o=o||"float32",_t(s),new Bi(s,o,i)}function mr(s,o){void 0===o&&(o=!1),console.log(s.toString(o))}var pa=ee({batchToSpaceND_:function(s,o,i){var a=F(s,"x","batchToSpaceND"),c=o.reduce(function(u,p){return u*p});return L(a.rank>=1+o.length,function(){return"input rank is "+a.rank+" but should be > than blockShape.length "+o.length}),L(i.length===o.length,function(){return"crops.length is "+i.length+" but should be equal to blockShape.length  "+o.length}),L(a.shape[0]%c==0,function(){return"input tensor batch is "+a.shape[0]+" but is not divisible by the product of the elements of blockShape "+o.join(" * ")+" === "+c}),Ie.runKernelFunc(function(u){return u.batchToSpaceND(a,o,i)},{$x:a},function(u){return{$x:function(){return u.spaceToBatchND(o,i)}}})}}),Ns=ee({cast_:function(s,o){var i=F(s,"x","cast");if(!Jt(o))throw new Error("Failed to cast to unknown dtype "+o);if("string"===o&&"string"!==i.dtype||"string"!==o&&"string"===i.dtype)throw new Error("Only strings can be casted to strings");return Ie.runKernelFunc(function(c){return c.cast(i,o)},{x:i},function(c){return{x:function(){return c.clone()}}},"Cast",{dtype:o})}}),mo=ee({clone_:function(s){var o=F(s,"x","clone",null);return Ie.runKernelFunc(function(){return Ie.makeTensorFromDataId(o.dataId,o.shape,o.dtype)},{$x:o},function(i){return{$x:function(){return i.toFloat()}}})}}),Pc=ee({cumsum_:function(s,o,i,a){void 0===o&&(o=0),void 0===i&&(i=!1),void 0===a&&(a=!1);var c=F(s,"x","cumsum"),u=At([o|=0],c.rank),p=c;null!=u&&(p=c.transpose(u));var m=Dn(1,c.rank)[0],g=Ie.runKernelFunc(function(v){return v.cumsum(p,m,i,a)},{permutedX:p},function(v){return{permutedX:function(){return v.cumsum(o,i,!a)}}});return null!=u&&(g=g.transpose(u)),g}}),gr=ee({depthToSpace_:function(s,o,i){void 0===i&&(i="NHWC");var a=F(s,"x","depthToSpace"),c="NHWC"===i?a.shape[1]:a.shape[2],u="NHWC"===i?a.shape[2]:a.shape[3],p="NHWC"===i?a.shape[3]:a.shape[1];return L(c*o>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+c+" and "+o+"  for depthToSpace with input shape\n      "+a.shape}),L(u*o>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+u+" and "+o+" for depthToSpace with input shape\n          "+a.shape}),L(p%(o*o)==0,function(){return"Dimension size must be evenly divisible by "+o*o+" but is "+p+" for depthToSpace with input shape "+a.shape}),Ie.runKernelFunc(function(m){return m.depthToSpace(a,o,i)},{$x:a})}}),Lo=ee({expandDims_:function(s,o){void 0===o&&(o=0);var i=F(s,"x","expandDims",null);L(o<=i.rank,function(){return"Axis must be <= rank of the tensor"});var a=i.shape.slice();return o<0&&(L(-(i.rank+1)<=o,function(){return"Axis must be in the interval ["+-(i.rank+1)+", "+i.rank+"]"}),o=i.rank+o+1),a.splice(o,0,1),Yi(i,a)}}),Lc=ee({eye_:function(s,o,i,a){void 0===a&&(a="float32"),null==o&&(o=s);for(var c=Rt([s,o],a),u=s<=o?s:o,p=0;p<u;++p)c.set(1,p,p);var m=c.toTensor().as2D(s,o);if(null==i)return m;if(1===i.length)return us(Lo(m,0),[i[0],1,1]);if(2===i.length)return us(Lo(Lo(m,0),0),[i[0],i[1],1,1]);if(3===i.length)return us(Lo(Lo(Lo(m,0),0),0),[i[0],i[1],i[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+i.length+"D.")}}),Zn=ee({multinomial_:function(s,o,i,a){void 0===a&&(a=!1);var c=F(s,"logits","multinomial"),u=c.size,p=c.rank;if(u<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+u+".");if(p>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+p);i=i||Math.random();var m=1===p?c.as2D(1,-1):c,g=Ie.runKernelFunc(function(v){return v.multinomial(m,a,o,i)},{logits2D:m});return 1===p?g.as1D():g}}),Ul=ee({oneHot_:function(s,o,i,a){if(void 0===i&&(i=1),void 0===a&&(a=0),o<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+o);var c=F(s,"indices","oneHot","int32"),u=c.shape.concat([o]);return c=c.flatten(),Ie.runKernelFunc(function(p){return p.oneHot(c,o,i,a)},{$indices:c},function(p){return{$indices:function(){return fn(c.shape,"float32")}}}).reshape(u)}}),Xa=ee({pad_:function(s,o,i){void 0===i&&(i=0);var a=F(s,"x","pad");if(0===a.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var c=o.map(function(u){return u[0]});return Ie.runKernelFunc(function(u){return u.pad(a,o,i)},{$x:a},function(u){return{$x:function(){return u.slice(c,a.shape)}}})}}),H_=ee({pad1d_:function(s,o,i){return void 0===i&&(i=0),L(2===o.length,function(){return"Invalid number of paddings. Must be length of 2."}),Xa(s,[o],i)}}),Bc=ee({pad2d_:function(s,o,i){return void 0===i&&(i=0),L(2===o.length&&2===o[0].length&&2===o[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Xa(s,o,i)}}),go=ee({pad3d_:function(s,o,i){return void 0===i&&(i=0),L(3===o.length&&2===o[0].length&&2===o[1].length&&2===o[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Xa(s,o,i)}}),su=ee({pad4d_:function(s,o,i){return void 0===i&&(i=0),L(4===o.length&&2===o[0].length&&2===o[1].length&&2===o[2].length&&2===o[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Xa(s,o,i)}}),zc=ee({rand_:function(s,o,i){var a=de(s),c=null;if(null==i||"float32"===i)c=new Float32Array(a);else if("int32"===i)c=new Int32Array(a);else{if("bool"!==i)throw new Error("Unknown data type "+i);c=new Uint8Array(a)}for(var u=0;u<a;u++)c[u]=o();return Ie.makeTensor(c,s,i)}}),Za=ee({randomNormal_:function(s,o,i,a,c){if(void 0===o&&(o=0),void 0===i&&(i=1),null!=a&&"bool"===a)throw new Error("Unsupported data type "+a);for(var u=new $o(o,i,a,!1,c),p=Rt(s,a),m=0;m<p.values.length;m++)p.values[m]=u.nextValue();return p.toTensor()}}),lu=ee({randomGamma_:function(s,o,i,a,c){if(void 0===i&&(i=1),void 0===a&&(a="float32"),null==i&&(i=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw new Error("Unsupported data type "+a);for(var u=new _l(o,i,a,c),p=Rt(s,a),m=0;m<p.values.length;m++)p.values[m]=u.nextValue();return p.toTensor()}}),Hl=ee({randomUniform_:function(s,o,i,a,c){void 0===o&&(o=0),void 0===i&&(i=1),void 0===a&&(a="float32");for(var u=Rt(s,a),p=new tn(o,i,null,c),m=0;m<u.values.length;m++)u.values[m]=p.nextValue();return u.toTensor()}}),Yi=ee({reshape_:function(s,o){var i=F(s,"x","reshape",null);return o=Be(o,i.size),L(i.size===de(o),function(){return"new shape and old shape must have the same number of elements."}),Ie.runKernelFunc(function(c){return c.reshape(i,o)},{x:i},function(c){return{x:function(){return c.reshape(i.shape)}}},"Reshape",{shape:o})}}),j_=ee({spaceToBatchND_:function(s,o,i){var a=F(s,"x","spaceToBatchND");return L(a.rank>=1+o.length,function(){return"input rank "+a.rank+" should be > than [blockShape] "+o.length}),L(i.length===o.length,function(){return"paddings.shape[0] "+i.length+" must be equal to [blockShape] "+o.length}),L(a.shape.reduce(function(c,u,p){return p>0&&p<=o.length?c&&(u+i[p-1][0]+i[p-1][1])%o[p-1]==0:c},!0),function(){return"input spatial dimensions "+a.shape.slice(1)+" with paddings "+i.toString()+" must be divisible by blockShapes "+o.toString()}),Ie.runKernelFunc(function(c){return c.spaceToBatchND(a,o,i)},{$x:a},function(c){return{$x:function(){return c.batchToSpaceND(o,i)}}})}}),Vc=ee({squeeze_:function(s,o){var i=F(s,"x","squeeze");return Yi(i,Ve(i.shape,o).newShape)}}),Qa=ee({stack_:function(s,o){void 0===o&&(o=0);var i=ge(s,"tensors","stack");if(L(i.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===i.length)return i[0].expandDims(o);var c=i[0].shape,u=i[0].dtype;L(o<=i[0].rank,function(){return"Axis must be <= rank of the tensor"}),i.forEach(function(m){oe(c,m.shape,"All tensors passed to stack must have matching shapes")}),i.forEach(function(m){L(u===m.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var p=i.map(function(m){return m.expandDims(o)});return Ur(p,o)}}),us=ee({tile_:function(s,o){var i=F(s,"x","tile",null);return L(i.rank===o.length,function(){return"Error in transpose: rank of input "+i.rank+" must match length of reps "+o+"."}),Ie.runKernelFunc(function(a,c){var u=a.tile(i,o);return c([i]),u},{$x:i},function(a,c){var u=c[0];return{$x:function(){var p=$n(u);if(1===u.rank)for(var m=0;m<o[0];++m)p=p.add(a.slice([m*u.shape[0]],[u.shape[0]]));else if(2===u.rank)for(m=0;m<o[0];++m)for(var g=0;g<o[1];++g)p=p.add(a.slice([m*u.shape[0],g*u.shape[1]],[u.shape[0],u.shape[1]]));else if(3===u.rank)for(m=0;m<o[0];++m)for(g=0;g<o[1];++g)for(var v=0;v<o[2];++v)p=p.add(a.slice([m*u.shape[0],g*u.shape[1],v*u.shape[2]],[u.shape[0],u.shape[1],u.shape[2]]));else{if(4!==u.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+u.rank+" tensors yet.");for(m=0;m<o[0];++m)for(g=0;g<o[1];++g)for(v=0;v<o[2];++v)for(var y=0;y<o[3];++y)p=p.add(a.slice([m*u.shape[0],g*u.shape[1],v*u.shape[2],y*u.shape[3]],[u.shape[0],u.shape[1],u.shape[2],u.shape[3]]))}return p}}})}}),jl=ee({truncatedNormal_:function(s,o,i,a,c){if(void 0===o&&(o=0),void 0===i&&(i=1),null!=a&&"bool"===a)throw new Error("Unsupported data type "+a);for(var u=new $o(o,i,a,!0,c),p=Rt(s,a),m=0;m<p.values.length;m++)p.values[m]=u.nextValue();return p.toTensor()}}),Ja=ee({unstack_:function(s,o){void 0===o&&(o=0),o=o||0;var i=F(s,"x","unstack");return L(o>=-i.shape.length&&o<i.shape.length,function(){return"Axis = "+o+" is not in [-"+i.shape.length+", "+i.shape.length+")"}),o<0&&(o+=i.shape.length),Ie.runKernelFunc(function(a){return a.unstack(i,o)},{$x:i},function(a){return{$x:function(){return Qa(a,o)}}})}}),_o=function(s,o){return J(this,void 0,void 0,function(){var i,a,c,u,p,m,g,v,y,C;return K(this,function(S){switch(S.label){case 0:return i=F(s,"x","setdiff1d"),a=F(o,"y","setdiff1d"),L(i.dtype===a.dtype,function(){return"x and y should have the same dtype, but got x ("+i.dtype+") and y ("+a.dtype+")."}),L(1===i.rank,function(){return"x should be 1D tensor, but got x ("+i.shape+")."}),L(1===a.rank,function(){return"y should be 1D tensor, but got y ("+a.shape+")."}),[4,i.data()];case 1:return c=S.sent(),[4,a.data()];case 2:for(u=S.sent(),p=new Set(u),m=0,y=0;y<c.length;y++)p.has(c[y])||m++;for(g=new Bi([m],i.dtype),v=new Bi([m],"int32"),y=0,C=0;y<c.length;y++)p.has(c[y])||(g.values[C]=c[y],v.values[C]=y,C++);return[2,[g.toTensor(),v.toTensor()]]}})})};function W_(s,o,i,a){void 0===a&&(a=!0);var c=[];if(a)(c=c.concat(o.slice(0))).push(s[0]/i),c=c.concat(s.slice(1));else{c=c.concat(s[0]);for(var u=o.length,p=0;p<u;++p)c=c.concat([s[p+1]/o[p],o[p]]);c=c.concat(s.slice(u+1))}return c}function Bo(s,o,i){void 0===i&&(i=!0);var a=[];if(i){a.push(o);for(var c=o+1;c<s;++c)c<=2*o?(a.push(c),a.push(c-(o+1))):a.push(c)}else{var u=[],p=[];for(c=1;c<s;++c)c>=2*o+1||c%2==1?p.push(c):u.push(c);a.push.apply(a,u),a.push(0),a.push.apply(a,p)}return a}function fa(s,o,i,a){void 0===a&&(a=!0);var c=[];c.push(a?s[0]/i:s[0]*i);for(var u=1;u<s.length;++u)c.push(u<=o.length?a?o[u-1]*s[u]:s[u]/o[u-1]:s[u]);return c}function qf(s,o){for(var i=[0],a=0;a<o;++a)i.push(s[a][0]);return i}function cu(s,o,i){for(var a=s.slice(0,1),c=0;c<i;++c)a.push(s[c+1]-o[c][0]-o[c][1]);return a}function zh(s,o){if(s.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+s.rank+".");if(o.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+o.rank+".");if("int32"!==o.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+o.dtype+".");if(o.shape[o.rank-1]>s.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+o.shape[o.rank-1]+" vs. "+s.rank);if(0===s.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+s.shape+".");for(var i=o.shape,a=i[i.length-1],c=1,u=0;u<i.length-1;++u)c*=i[u];var p=s.shape,m=i.slice();m.pop();var g=1;for(u=a;u<s.rank;++u)g*=p[u],m.push(p[u]);var v=q(s.shape).map(function(y){return y/g}).concat([1]).slice(0,a);return[m,c,g,v]}function G_(s){return s<=30?s:zr(s,Math.floor(Math.sqrt(s)))}function Yf(s,o,i){for(var a=o.rank>1?o.shape[o.rank-1]:1,c=i.length,u=1,p=a;p<c;++p)u*=i[p];return{sliceRank:a,numUpdates:o.size/(a<1?1:a),sliceSize:u,strides:q(i.slice(0,a)).concat([1]),outputSize:de(i)}}function Nx(s,o,i){L(s.rank===o.length,function(){return"Error in slice"+s.rank+"D: Length of begin "+o+" must match the rank of the array ("+s.rank+")."}),L(s.rank===i.length,function(){return"Error in slice"+s.rank+"D: Length of size "+i+" must match the rank of the array ("+s.rank+")."});for(var a=function(u){L(o[u]+i[u]<=s.shape[u],function(){return"Error in slice"+s.rank+"D: begin["+u+"] + size["+u+"] ("+(o[u]+i[u])+") would overflow input.shape["+u+"] ("+s.shape[u]+")"})},c=0;c<s.rank;++c)a(c)}function Px(s){for(var o=[],i=0;s>0;)1&s&&o.push(i),s/=2,i++;return o}function $_(s,o,i){for(var a=[],c=0;c<s.length;c++)a[c]=Math.ceil((o[c]-s[c])/i[c]);return a}function ck(s,o,i,a,c){var u=o[c];(s&1<<c||null==u)&&(u=(i[c]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var m=a[c];return u<0&&(u+=m),T(0,u,m-1)}function dk(s,o,i,a,c){var u=o[c],p=i[c]||1;(s&1<<c||null==u)&&(u=p>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var m=a[c];return u<0&&(u+=m),p>0?T(0,u,m):T(-1,u,m-1)}function Lx(s,o,i){for(var a=i.length,c=0;c<i.length;c++)if(i[c]>1){a=c;break}for(c=a+1;c<i.length;c++)if(o[c]>0||i[c]!==s[c])return!1;return!0}function Bx(s,o){for(var i=s.length>0?s[s.length-1]:1,a=0;a<s.length-1;a++)i+=s[a]*o[a];return i}var JR=Object.freeze({assertParamsValid:Nx,maskToAxes:Px,computeOutShape:$_,startForAxis:ck,stopForAxis:dk,isSliceContinous:Lx,computeFlatOffset:Bx});function eF(s){return L(or(s),function(){return"The f passed in grad(f) must be a function"}),function(o,i){var a=F(o,"x","tf.grad",null),c=null!=i?F(i,"dy","tf.grad"):null;return Ie.tidy(function(){var u=Ie.gradients(function(){return s(a)},[a],c),m=u.grads;return null!=c&&oe(u.value.shape,c.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Vh(m),m[0]})}}function tF(s){return L(or(s),function(){return"The f passed in grads(f) must be a function"}),function(o,i){L(Array.isArray(o),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var a=ge(o,"args","tf.grads",null),c=null!=i?F(i,"dy","tf.grads"):null;return Ie.tidy(function(){var u=Ie.gradients(function(){return s.apply(void 0,a)},a,c),m=u.grads;return null!=c&&oe(u.value.shape,c.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Vh(m),m})}}function nF(s){return L(or(s),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(o,i){L(o instanceof ki,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),L(null==i||i instanceof ki,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var a=Ie.gradients(function(){return s(o)},[o],i),c=a.grads,u=a.value;return Vh(c),{grad:c[0],value:u}}}function iF(s){return L(or(s),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(o,i){L(Array.isArray(o)&&o.every(function(c){return c instanceof ki}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),L(null==i||i instanceof ki,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var a=Ie.gradients(function(){return s.apply(void 0,o)},o,i);return null!=i&&oe(a.value.shape,i.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Vh(a.grads),a}}function uk(s,o){L(or(s),function(){return"The f passed in variableGrads(f) must be a function"}),L(null==o||Array.isArray(o)&&o.every(function(y){return y instanceof da}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var i=null!=o;if(!i)for(var a in o=[],Ie.registeredVariables)o.push(Ie.registeredVariables[a]);var c=i?o.filter(function(y){return!y.trainable}):null,u=o.length;L((o=o.filter(function(y){return y.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+u+" variables is trainable."});var p=Ie.gradients(s,o,null,!0),m=p.value,g=p.grads;L(g.some(function(y){return null!=y}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),L(0===m.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+m.rank+" tensor"});var v={};return o.forEach(function(y,C){null!=g[C]&&(v[y.name]=g[C])}),c?.forEach(function(y){return v[y.name]=null}),{value:m,grads:v}}function Uc(s){return Ie.customGrad(s)}function Vh(s){if(s.filter(function(o){return null==o}).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var du=ee({softmax_:function(s,o){void 0===o&&(o=-1);var i=F(s,"logits","softmax");if(-1===o&&(o=i.rank-1),o!==i.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+i.rank+" and dim was "+o);return Uc(function(a,c){var u=a.logSumExp([o],!0),p=a.toFloat().sub(u).exp();return c([p]),{value:p,gradFunc:function(m,g){var v=g[0],y=m.mul(v);return y.sub(y.sum([o],!0).mul(v))}}})(i)}}),q_=ee({logSoftmax_:function(s,o){void 0===o&&(o=-1);var i=F(s,"logits","logSoftmax");if(-1===o&&(o=i.rank-1),o!==i.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+i.rank+" and axis was "+o);return Uc(function(a,c){var u=a.max(o,!0),p=a.sub(u),m=p.toFloat().sub(p.exp().sum(o,!0).log());return c([m]),{value:m,gradFunc:function(g,v){var y=v[0].exp();return g.sub(g.sum(o,!0).mul(y))}}})(i)}}),zx=function(){function s(o,i){this.backend=o,this.dataMover=i,this.data=new WeakMap,this.dataIdsCount=0}return s.prototype.get=function(o){return this.data.has(o)||this.dataMover.moveData(this.backend,o),this.data.get(o)},s.prototype.set=function(o,i){this.dataIdsCount++,this.data.set(o,i)},s.prototype.has=function(o){return this.data.has(o)},s.prototype.delete=function(o){return this.dataIdsCount--,this.data.delete(o)},s.prototype.numDataIds=function(){return this.dataIdsCount},s}(),vl=function(){function s(){}return s.prototype.time=function(o){return Qe()},s.prototype.read=function(o){return Qe()},s.prototype.readSync=function(o){return Qe()},s.prototype.numDataIds=function(){return Qe()},s.prototype.disposeData=function(o){return Qe()},s.prototype.fromPixels=function(o,i){return Qe()},s.prototype.write=function(o,i,a){return Qe()},s.prototype.move=function(o,i,a,c){return Qe()},s.prototype.memory=function(){return Qe()},s.prototype.floatPrecision=function(){return Qe()},s.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},s.prototype.batchMatMul=function(o,i,a,c){return Qe()},s.prototype.fusedBatchMatMul=function(o){return Qe()},s.prototype.slice=function(o,i,a){return Qe()},s.prototype.stridedSlice=function(o,i,a,c){return Qe()},s.prototype.unstack=function(o,i){return Qe()},s.prototype.reverse=function(o,i){return Qe()},s.prototype.concat=function(o,i){return Qe()},s.prototype.neg=function(o){return Qe()},s.prototype.add=function(o,i){return Qe()},s.prototype.addN=function(o){return Qe()},s.prototype.subtract=function(o,i){return Qe()},s.prototype.multiply=function(o,i){return Qe()},s.prototype.realDivide=function(o,i){return Qe()},s.prototype.floorDiv=function(o,i){return Qe()},s.prototype.sum=function(o,i){return Qe()},s.prototype.prod=function(o,i){return Qe()},s.prototype.unsortedSegmentSum=function(o,i,a){return Qe()},s.prototype.argMin=function(o,i){return Qe()},s.prototype.argMax=function(o,i){return Qe()},s.prototype.equal=function(o,i){return Qe()},s.prototype.notEqual=function(o,i){return Qe()},s.prototype.less=function(o,i){return Qe()},s.prototype.lessEqual=function(o,i){return Qe()},s.prototype.greater=function(o,i){return Qe()},s.prototype.greaterEqual=function(o,i){return Qe()},s.prototype.logicalNot=function(o){return Qe()},s.prototype.logicalAnd=function(o,i){return Qe()},s.prototype.logicalOr=function(o,i){return Qe()},s.prototype.where=function(o){return Qe()},s.prototype.select=function(o,i,a){return Qe()},s.prototype.topk=function(o,i,a){return Qe()},s.prototype.min=function(o,i){return Qe()},s.prototype.minimum=function(o,i){return Qe()},s.prototype.mod=function(o,i){return Qe()},s.prototype.max=function(o,i){return Qe()},s.prototype.maximum=function(o,i){return Qe()},s.prototype.all=function(o,i){return Qe()},s.prototype.any=function(o,i){return Qe()},s.prototype.squaredDifference=function(o,i){return Qe()},s.prototype.ceil=function(o){return Qe()},s.prototype.floor=function(o){return Qe()},s.prototype.round=function(o){return Qe()},s.prototype.sign=function(o){return Qe()},s.prototype.isNaN=function(o){return Qe()},s.prototype.isInf=function(o){return Qe()},s.prototype.isFinite=function(o){return Qe()},s.prototype.pow=function(o,i){return Qe()},s.prototype.exp=function(o){return Qe()},s.prototype.expm1=function(o){return Qe()},s.prototype.log=function(o){return Qe()},s.prototype.log1p=function(o){return Qe()},s.prototype.sqrt=function(o){return Qe()},s.prototype.rsqrt=function(o){return Qe()},s.prototype.square=function(o){return Qe()},s.prototype.reciprocal=function(o){return Qe()},s.prototype.relu=function(o){return Qe()},s.prototype.relu6=function(o){return Qe()},s.prototype.prelu=function(o,i){return Qe()},s.prototype.elu=function(o){return Qe()},s.prototype.eluDer=function(o,i){return Qe()},s.prototype.selu=function(o){return Qe()},s.prototype.int=function(o){return Qe()},s.prototype.clip=function(o,i,a){return Qe()},s.prototype.abs=function(o){return Qe()},s.prototype.complexAbs=function(o){return Qe()},s.prototype.sigmoid=function(o){return Qe()},s.prototype.softplus=function(o){return Qe()},s.prototype.sin=function(o){return Qe()},s.prototype.cos=function(o){return Qe()},s.prototype.tan=function(o){return Qe()},s.prototype.asin=function(o){return Qe()},s.prototype.acos=function(o){return Qe()},s.prototype.atan=function(o){return Qe()},s.prototype.atan2=function(o,i){return Qe()},s.prototype.sinh=function(o){return Qe()},s.prototype.cosh=function(o){return Qe()},s.prototype.tanh=function(o){return Qe()},s.prototype.asinh=function(o){return Qe()},s.prototype.acosh=function(o){return Qe()},s.prototype.atanh=function(o){return Qe()},s.prototype.erf=function(o){return Qe()},s.prototype.step=function(o,i){return Qe()},s.prototype.fusedConv2d=function(o){return Qe()},s.prototype.conv2d=function(o,i,a){return Qe()},s.prototype.conv2dDerInput=function(o,i,a){return Qe()},s.prototype.conv2dDerFilter=function(o,i,a){return Qe()},s.prototype.fusedDepthwiseConv2D=function(o){return Qe()},s.prototype.depthwiseConv2D=function(o,i,a){return Qe()},s.prototype.depthwiseConv2DDerInput=function(o,i,a){return Qe()},s.prototype.depthwiseConv2DDerFilter=function(o,i,a){return Qe()},s.prototype.conv3d=function(o,i,a){return Qe()},s.prototype.conv3dDerInput=function(o,i,a){return Qe()},s.prototype.conv3dDerFilter=function(o,i,a){return Qe()},s.prototype.maxPool=function(o,i){return Qe()},s.prototype.maxPoolBackprop=function(o,i,a,c){return Qe()},s.prototype.avgPool=function(o,i){return Qe()},s.prototype.avgPoolBackprop=function(o,i,a){return Qe()},s.prototype.avgPool3d=function(o,i){return Qe()},s.prototype.avgPool3dBackprop=function(o,i,a){return Qe()},s.prototype.maxPool3d=function(o,i){return Qe()},s.prototype.maxPool3dBackprop=function(o,i,a,c){return Qe()},s.prototype.reshape=function(o,i){return Qe()},s.prototype.cast=function(o,i){return Qe()},s.prototype.tile=function(o,i){return Qe()},s.prototype.pad=function(o,i,a){return Qe()},s.prototype.transpose=function(o,i){return Qe()},s.prototype.gather=function(o,i,a){return Qe()},s.prototype.gatherND=function(o,i){return Qe()},s.prototype.scatterND=function(o,i,a){return Qe()},s.prototype.batchToSpaceND=function(o,i,a){return Qe()},s.prototype.spaceToBatchND=function(o,i,a){return Qe()},s.prototype.resizeBilinear=function(o,i,a,c){return Qe()},s.prototype.resizeBilinearBackprop=function(o,i,a){return Qe()},s.prototype.resizeNearestNeighbor=function(o,i,a,c){return Qe()},s.prototype.resizeNearestNeighborBackprop=function(o,i,a){return Qe()},s.prototype.batchNormalization=function(o,i,a,c,u,p){return Qe()},s.prototype.localResponseNormalization4D=function(o,i,a,c,u){return Qe()},s.prototype.LRNGrad=function(o,i,a,c,u,p,m){return Qe()},s.prototype.multinomial=function(o,i,a,c){return Qe()},s.prototype.oneHot=function(o,i,a,c){return Qe()},s.prototype.cumsum=function(o,i,a,c){return Qe()},s.prototype.nonMaxSuppression=function(o,i,a,c,u){return Qe()},s.prototype.fft=function(o){return Qe()},s.prototype.ifft=function(o){return Qe()},s.prototype.complex=function(o,i){return Qe()},s.prototype.real=function(o){return Qe()},s.prototype.imag=function(o){return Qe()},s.prototype.cropAndResize=function(o,i,a,c,u,p){return Qe()},s.prototype.depthToSpace=function(o,i,a){return Qe()},s.prototype.split=function(o,i,a){return Qe()},s.prototype.sparseToDense=function(o,i,a,c){return Qe()},s.prototype.diag=function(o){return Qe()},s.prototype.fill=function(o,i,a){throw new Error("Not yet implemented.")},s.prototype.onesLike=function(o){return Qe()},s.prototype.zerosLike=function(o){return Qe()},s.prototype.linspace=function(o,i,a){return Qe()},s.prototype.dispose=function(){return Qe()},s}();function Qe(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Ki(s,o){for(var i=s.length,a=[],c=0;c<i;c++){var u=i-1-c;(o[o.length-1-c]||1)>1&&1===(s[u]||1)&&a.unshift(u)}return a}function Fr(s,o){for(var i=[],a=0;a<o.length;a++){var c=s[s.length-a-1],u=o.length-a-1;(null==c||1===c&&o[u]>1)&&i.unshift(u)}return i}function _i(s,o){for(var i=[],a=Math.max(s.length,o.length),c=0;c<a;c++){var u=s[s.length-c-1];null==u&&(u=1);var p=o[o.length-c-1];if(null==p&&(p=1),1===u)i.unshift(p);else if(1===p)i.unshift(u);else{if(u!==p)throw Error("Operands could not be broadcast together with shapes "+s+" and "+o+".");i.unshift(u)}}return i}function uu(s,o,i,a,c,u,p){void 0===p&&(p="channelsLast");var m,g=Kf(o),v=g[0],y=g[1];if("channelsLast"===p)m=[v,y,s[3],s[3]];else{if("channelsFirst"!==p)throw new Error("Unknown dataFormat "+p);m=[v,y,s[1],s[1]]}return bl(s,m,i,a,c,u,!1,p)}function hu(s,o,i,a,c,u,p){void 0===p&&(p="NDHWC");var m,g,v=ma(o),y=v[0],C=v[1],S=v[2];if("NDHWC"===p)g="channelsLast",m=[y,C,S,s[4],s[4]];else{if("NCDHW"!==p)throw new Error("Unknown dataFormat "+p);g="channelsFirst",m=[y,C,S,s[1],s[1]]}return Uh(s,m,i,a,c,!1,g,u)}function bl(s,o,i,a,c,u,p,m){void 0===p&&(p=!1),void 0===m&&(m="channelsLast");var g=[-1,-1,-1,-1],v=g[0],y=g[1],C=g[2],S=g[3];if("channelsLast"===m)v=s[0],y=s[1],C=s[2],S=s[3];else{if("channelsFirst"!==m)throw new Error("Unknown dataFormat "+m);v=s[0],S=s[1],y=s[2],C=s[3]}var M,O=o[0],N=o[1],P=o[3],B=Kf(i),W=B[0],G=B[1],X=Kf(a),Q=X[0],se=X[1],ue=Hc(O,Q),fe=Hc(N,se),_e=function(Xe,et,it,nt,je,ut,at,yt){var Gt,Xt,Mt;if("number"==typeof Xe){Gt={top:Xe,bottom:Xe,left:Xe,right:Xe,type:0===Xe?"VALID":"NUMBER"};var Hn=function(Jn,Gn,Ji,Hi,ra){null==Hi&&(Hi=Hh(Jn,Gn,Ji));var aa=Jn[1],Wa=pu((Jn[0]-Gn+2*Hi)/Ji+1,ra);L(ae(Wa),function(){return"The output # of rows ("+Wa+") must be an integer. Change the stride and/or zero pad parameters"});var Co=pu((aa-Gn+2*Hi)/Ji+1,ra);return L(ae(Co),function(){return"The output # of columns ("+Co+") must be an integer. Change the stride and/or zero pad parameters"}),[Wa,Co]}([et,it],ut,nt,Xe,yt);Xt=Hn[0],Mt=Hn[1]}else if("same"===Xe){Xt=Math.ceil(et/nt),Mt=Math.ceil(it/je);var si=Math.max(0,(Xt-1)*nt+ut-et),li=Math.max(0,(Mt-1)*je+at-it),ci=Math.floor(si/2),hr=si-ci,di=Math.floor(li/2);Gt={top:ci,bottom:hr,left:di,right:li-di,type:"SAME"}}else{if("valid"!==Xe)throw Error("Unknown padding parameter: "+Xe);Gt={top:0,bottom:0,left:0,right:0,type:"VALID"},Xt=Math.ceil((et-ut+1)/nt),Mt=Math.ceil((it-at+1)/je)}return{padInfo:Gt,outHeight:Xt,outWidth:Mt}}(c,y,C,W,G,ue,fe,u),Me=_e.outHeight,Te=_e.outWidth,Ue=p?P*S:P;return"channelsFirst"===m?M=[v,Ue,Me,Te]:"channelsLast"===m&&(M=[v,Me,Te,Ue]),{batchSize:v,dataFormat:m,inHeight:y,inWidth:C,inChannels:S,outHeight:Me,outWidth:Te,outChannels:Ue,padInfo:_e.padInfo,strideHeight:W,strideWidth:G,filterHeight:O,filterWidth:N,effectiveFilterHeight:ue,effectiveFilterWidth:fe,dilationHeight:Q,dilationWidth:se,inShape:s,outShape:M,filterShape:o}}function Uh(s,o,i,a,c,u,p,m){void 0===u&&(u=!1),void 0===p&&(p="channelsLast");var g=[-1,-1,-1,-1,-1],v=g[0],y=g[1],C=g[2],S=g[3],M=g[4];if("channelsLast"===p)v=s[0],y=s[1],C=s[2],S=s[3],M=s[4];else{if("channelsFirst"!==p)throw new Error("Unknown dataFormat "+p);v=s[0],M=s[1],y=s[2],C=s[3],S=s[4]}var O,N=o[0],P=o[1],B=o[2],W=o[4],G=ma(i),X=G[0],Q=G[1],se=G[2],ue=ma(a),fe=ue[0],_e=ue[1],me=ue[2],Me=Hc(N,fe),Te=Hc(P,_e),Ue=Hc(B,me),Xe=function(at,yt,Gt,Xt,Mt,Tn,Hn,si,li,ci,hr){var di,Ui,Jn,Gn;if("number"==typeof at){di={top:at,bottom:at,left:at,right:at,front:at,back:at,type:0===at?"VALID":"NUMBER"};var Hi=function(bi,Ln,ji,rn,mh,nl){null==mh&&(mh=Hh(bi,Ln,rn));var b0=bi[1],y0=bi[2],_f=pu((bi[0]-Ln+2*mh)/rn+1,nl);L(ae(_f),function(){return"The output # of depths ("+_f+") must be an integer. Change the stride and/or zero pad parameters"});var WS=pu((b0-Ln+2*mh)/rn+1,nl);L(ae(WS),function(){return"The output # of rows ("+WS+") must be an integer. Change the stride and/or zero pad parameters"});var GS=pu((y0-Ln+2*mh)/rn+1,nl);return L(ae(GS),function(){return"The output # of columns ("+GS+") must be an integer. Change the stride and/or zero pad parameters"}),[_f,WS,GS,1]}([yt,Gt,Xt,1],si,0,Mt,at,hr);Ui=Hi[0],Jn=Hi[1],Gn=Hi[2]}else if("same"===at){var ra=((Ui=Math.ceil(yt/Mt))-1)*Mt+si-yt,oa=((Jn=Math.ceil(Gt/Tn))-1)*Tn+li-Gt,aa=((Gn=Math.ceil(Xt/Hn))-1)*Hn+ci-Xt,Wa=Math.floor(ra/2),Co=ra-Wa,ss=Math.floor(oa/2),ui=oa-ss,rr=Math.floor(aa/2);di={top:ss,bottom:ui,left:rr,right:aa-rr,front:Wa,back:Co,type:"SAME"}}else{if("valid"!==at)throw Error("Unknown padding parameter: "+at);di={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ui=Math.ceil((yt-si+1)/Mt),Jn=Math.ceil((Gt-li+1)/Tn),Gn=Math.ceil((Xt-ci+1)/Hn)}return{padInfo:di,outDepth:Ui,outHeight:Jn,outWidth:Gn}}(c,y,C,S,X,Q,se,Me,Te,Ue,m),it=Xe.outDepth,nt=Xe.outHeight,je=Xe.outWidth,ut=u?W*M:W;return"channelsFirst"===p?O=[v,ut,it,nt,je]:"channelsLast"===p&&(O=[v,it,nt,je,ut]),{batchSize:v,dataFormat:p,inDepth:y,inHeight:C,inWidth:S,inChannels:M,outDepth:it,outHeight:nt,outWidth:je,outChannels:ut,padInfo:Xe.padInfo,strideDepth:X,strideHeight:Q,strideWidth:se,filterDepth:N,filterHeight:P,filterWidth:B,effectiveFilterDepth:Me,effectiveFilterHeight:Te,effectiveFilterWidth:Ue,dilationDepth:fe,dilationHeight:_e,dilationWidth:me,inShape:s,outShape:O,filterShape:o}}function Hh(s,o,i,a){void 0===a&&(a=1);var c=Hc(o,a);return Math.floor((s[0]*(i-1)-i+c)/2)}function Kf(s){return"number"==typeof s?[s,s,s]:2===s.length?[s[0],s[1],1]:s}function ma(s){return"number"==typeof s?[s,s,s]:s}function Hc(s,o){return o<=1?s:s+(s-1)*(o-1)}function pu(s,o){if(!o)return s;switch(o){case"round":return Math.round(s);case"ceil":return Math.ceil(s);case"floor":return Math.floor(s);default:throw new Error("Unknown roundingMode "+o)}}function _r(s){var o=Kf(s);return 1===o[0]&&1===o[1]&&1===o[2]}function qo(s,o){return _r(s)||_r(o)}function jc(s){if("NHWC"===s)return"channelsLast";if("NCHW"===s)return"channelsFirst";throw new Error("Unknown dataFormat "+s)}function Yo(s,o,i){if("complex64"===o){if("complex64"===s.dtype)return s.clone();var a=fn(s.shape),c=s.toFloat(),u=i.complex(c,a);return a.dispose(),c.dispose(),u}if(!zt(s.dtype,o))return Ie.makeTensorFromDataId(s.dataId,s.shape,o);if("complex64"===s.dtype){var p=i.real(s);return u=p.cast(o),p.dispose(),u}if("int32"===o)return i.int(s);if("bool"===o){var m=Nt(0,s.dtype);return u=i.notEqual(s,m),m.dispose(),u}throw new Error("Error in Cast: failed to cast "+s.dtype+" to "+o)}function Xf(s,o){return Ie.makeTensorFromDataId(s.dataId,o,s.dtype)}function Zf(s,o,i){var a=(o-s)/(i-1),c=be(i,"float32");c[0]=s;for(var u=1;u<c.length;u++)c[u]=c[u-1]+a;return Pn(c,"float32")}var fu=Object.freeze({castTensor:Yo,reshapeTensor:Xf,linspaceImpl:Zf,upcastType:dr,axesAreInnerMostDims:Fe,combineLocations:Ke,computeOutAndReduceShapes:Pe,expandShapeToKeepDim:gt,assertAxesAreInnerMostDims:lt,getAxesPermutation:At,getUndoAxesPermutation:vn,getInnerMostAxes:Dn,getBroadcastDims:Ki,getReductionAxes:Fr,assertAndGetBroadcastShape:_i,assertParamsConsistent:wn,computeOutShape:on,computePool2DInfo:uu,computePool3DInfo:hu,computeConv2DInfo:bl,computeConv3DInfo:Uh,computeDefaultPad:Hh,tupleValuesAreOne:_r,eitherStridesOrDilationsAreOne:qo,convertConv2DDataFormat:jc});function Ko(s,o){if(s.length!==o.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+s.length+", imag: "+o.length+".");for(var i=new Float32Array(2*s.length),a=0;a<i.length;a+=2)i[a]=s[a/2],i[a+1]=o[a/2];return i}function Vx(s,o){return{real:s[2*o],imag:s[2*o+1]}}function Qf(s,o,i,a){s[2*a]=o,s[2*a+1]=i}function hk(s,o,i){var a=(i?2:-2)*Math.PI*(s/o);return{real:Math.cos(a),imag:Math.sin(a)}}function Ps(s,o,i,a,c){for(var u=Array.from(o).map(function(M,O){return{score:M,boxIndex:O}}).filter(function(M){return M.score>c}).sort(function(M,O){return O.score-M.score}),p=[],m=0;m<u.length;m++){var g=u[m],y=g.boxIndex;if(g.score<c)break;for(var C=!1,S=p.length-1;S>=0;--S)if(Ux(s,y,p[S])>=a){C=!0;break}if(!C&&(p.push(y),p.length>=i))break}return Pn(p,"int32")}function Ux(s,o,i){var a=s.subarray(4*o,4*o+4),c=s.subarray(4*i,4*i+4),u=Math.min(a[0],a[2]),p=Math.min(a[1],a[3]),m=Math.max(a[0],a[2]),g=Math.max(a[1],a[3]),v=Math.min(c[0],c[2]),y=Math.min(c[1],c[3]),C=Math.max(c[0],c[2]),S=Math.max(c[1],c[3]),M=(m-u)*(g-p),O=(C-v)*(S-y);if(M<=0||O<=0)return 0;var N=Math.max(u,v),P=Math.max(p,y),B=Math.min(m,C),W=Math.min(g,S),G=Math.max(B-N,0)*Math.max(W-P,0);return G/(M+O-G)}function Jf(s,o,i){var a=new Array(s.rank).fill(0),c=s.shape.slice();return o.map(function(u){c[i]=u;var p=s.slice(a,c);return a[i]+=u,p})}function jn(s,o){for(var i=new Array(s.rank),a=0;a<i.length;a++)i[a]=s.shape[a]*o[a];var c=Rt(i,s.dtype);for(a=0;a<c.values.length;++a){for(var u=c.indexToLoc(a),p=new Array(s.rank),m=0;m<p.length;m++)p[m]=u[m]%s.shape[m];var g=s.locToIndex(p);c.values[a]=s.values[g]}return c.toTensor()}function Y_(s,o,i,a,c){for(var u=o[o.length-1],p=[s.length/u,u],m=p[0],g=p[1],v=pt(i,m*a),y=pt("int32",m*a),C=0;C<m;C++){for(var S=C*g,M=s.subarray(S,S+g),O=[],N=0;N<M.length;N++)O.push({value:M[N],index:N});O.sort(function(X,Q){return Q.value-X.value});var P=C*a,B=v.subarray(P,P+a),W=y.subarray(P,P+a);for(N=0;N<a;N++)B[N]=O[N].value,W[N]=O[N].index}var G=o.slice();return G[G.length-1]=a,[ei(v,G,i),ei(y,G,"int32")]}function Hx(s,o){for(var i=[],a=0;a<o.length;a++)o[a]&&i.push(a);var c=Rt(s,"int32"),u=Rt([i.length,s.length],"int32");for(a=0;a<i.length;a++){var p=c.indexToLoc(i[a]);u.values.set(p,a*s.length)}return u.toTensor()}var pk=function(s,o){this.outputShape=[],this.outputShape=s,this.variableNames=o.map(function(c,u){return"T"+u});var i=[];this.variableNames.forEach(function(c){i.push("float v"+c+" = get"+c+"AtOutCoords();")});var a=this.variableNames.map(function(c){return"v"+c}).join(" + ");this.userCode="\n      void main() {\n        "+i.join("\n        ")+"\n\n        float result = "+a+";\n        setOutput(result);\n      }\n    "},fk=function(s,o){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.variableNames=o.map(function(c,u){return"T"+u});var i=[];this.variableNames.forEach(function(c){i.push("vec4 v"+c+" = get"+c+"AtOutCoords();")});var a=this.variableNames.map(function(c){return"v"+c}).join(" + ");this.userCode="\n      void main() {\n        "+i.join("\n        ")+"\n\n        vec4 result = "+a+";\n        setOutput(result);\n      }\n    "},mk=function(s,o,i){this.variableNames=["A"];var a=s.windowSize,c=s.batchSize,p=Math.ceil(s.inSize/a);i||this.variableNames.push("bestIndicesA"),this.outputShape=[c,p],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+a+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+a+"; i++) {\n          int inIdx = "+(i?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===o?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function K_(s,o){return["x","y","z","w","u","v"].slice(0,o).map(function(i){return s+"."+i})}function ga(s,o){return 1===o?[s]:K_(s,o)}function zo(){var s,o,i,a,c,u,p,m,g,v;return 2===E().getNumber("WEBGL_VERSION")?(s="#version 300 es",o="in",i="out",a="in",c="texture",u="outputColor",p="out vec4 outputColor;",m="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",g="",v="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(s="",o="attribute",i="varying",a="varying",c="texture2D",u="gl_FragColor",p="",m="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",g="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",v="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:s,attribute:o,varyingVs:i,varyingFs:a,texture2D:c,output:u,defineOutput:p,defineSpecialNaN:m,defineSpecialInf:g,defineRound:v}}function vt(s,o,i){void 0===i&&(i="index");var a=q(o);return a.map(function(c,u){return"int "+s[u]+" = "+i+" / "+c+"; "+(u===a.length-1?"int "+s[u+1]+" = "+i+" - "+s[u]+" * "+c:"index -= "+s[u]+" * "+c)+";"}).join("")}function wi(s){var o=q(s).map(function(i){return i.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+o[0]+" + coords.y * "+o[1]+" + coords.z;\n  }\n"}var ts="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function hs(s,o,i,a){var c=[];s.forEach(function(M){var O=de(M.shapeInfo.logicalShape);M.shapeInfo.isUniform?c.push("uniform float "+M.name+(O>1?"["+O+"]":"")+";"):(c.push("uniform sampler2D "+M.name+";"),c.push("uniform int offset"+M.name+";"))});var u,p,M,m=c.join("\n"),g=s.map(function(M){return function(O,N,P){void 0===P&&(P=!1);var B="";return B+=P?X_(O):wr(O),O.shapeInfo.logicalShape.length<=N.logicalShape.length&&(B+=P?function(X,Q){var se,it,ue=X.name,fe=ue.charAt(0).toUpperCase()+ue.slice(1),_e="get"+fe+"AtOutCoords",me=X.shapeInfo.logicalShape.length,Me=Q.logicalShape.length,Te=Ki(X.shapeInfo.logicalShape,Q.logicalShape),Ue=Xi(Me),Xe=Me-me,et=["x","y","z","w","u","v"];se=0===me?"":Me<2&&Te.length>=1?"coords = 0;":Te.map(function(Gt){return"coords."+et[Gt+Xe]+" = 0;"}).join("\n"),it=Me<2&&me>0?"coords":X.shapeInfo.logicalShape.map(function(Gt,Xt){return"coords."+et[Xt+Xe]}).join(", ");var nt="return outputValue;",je=1===de(X.shapeInfo.logicalShape),ut=1===de(Q.logicalShape);if(1!==me||je||ut){if(je&&!ut)nt=1===Me?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(Te.length){var at=me-2,yt=me-1;Te.indexOf(at)>-1&&Te.indexOf(yt)>-1?nt="return vec4(outputValue.x);":Te.indexOf(at)>-1?nt="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":Te.indexOf(yt)>-1&&(nt="return vec4(outputValue.xx, outputValue.zz);")}}else nt="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+_e+"() {\n      "+Ue+" coords = getOutputCoords();\n      "+se+"\n      vec4 outputValue = get"+fe+"("+it+");\n      "+nt+"\n    }\n  "}(O,N):function(X,Q){var se=X.name,ue=se.charAt(0).toUpperCase()+se.slice(1),fe="get"+ue+"AtOutCoords",Me=X.shapeInfo.logicalShape.length,Te=Q.logicalShape.length;if(!X.shapeInfo.isUniform&&Me===Te&&null==X.shapeInfo.flatOffset&&ke(X.shapeInfo.texShape,Q.texShape))return"\n      float "+fe+"() {\n        return sampleTexture("+se+", resultUV);\n      }\n    ";var Xe=Xi(Te),et=Ki(X.shapeInfo.logicalShape,Q.logicalShape),it=Te-Me,nt=["x","y","z","w","u","v"];return"\n    float "+fe+"() {\n      "+Xe+" coords = getOutputCoords();\n      "+(0===Me?"":Te<2&&et.length>=1?"coords = 0;":et.map(function(ut){return"coords."+nt[ut+it]+" = 0;"}).join("\n"))+"\n      return get"+ue+"("+(Te<2&&Me>0?"coords":X.shapeInfo.logicalShape.map(function(ut,at){return"coords."+nt[at+it]}).join(", "))+");\n    }\n  "}(O,N)),B}(M,o,a)}).join("\n"),v=o.texShape,y=zo(),C="\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+y.texture2D+"(textureSampler, uv).r;\n    }\n  ",S=(M=y).version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+M.varyingFs+" vec2 resultUV;\n    "+M.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+M.defineSpecialNaN+"\n    "+M.defineSpecialInf+"\n    "+M.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+jh+"\n    "+Ls+"\n    "+Z_+"\n  ";return o.isPacked?(u=function(M,O){switch(M.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return Q=O,1===(se=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+se[1]+".0);\n      }\n    ":1===se[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+se[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+se[0]+", "+se[1]+"));\n      return 2 * (resTexRC.x * "+se[1]+" + resTexRC.y);\n    }\n  ";case 2:return function(X,Q){var se=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)];if(ke(X,Q))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+se[0]+", "+se[1]+"));\n      }\n    ";var ue=Math.ceil(X[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+se[0]+", "+se[1]+"));\n\n      int index = resTexRC.x * "+se[1]+" + resTexRC.y;\n      int r = 2 * (index / "+ue+");\n      int c = imod(index, "+ue+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(M,O);case 3:return N=M,P=O,B=[Math.ceil(P[0]/2),Math.ceil(P[1]/2)],G=(W=Math.ceil(N[2]/2))*Math.ceil(N[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+B[0]+", "+B[1]+"));\n      int index = resTexRC.x * "+B[1]+" + resTexRC.y;\n\n      int b = index / "+G+";\n      index -= b * "+G+";\n\n      int r = 2 * (index / "+W+");\n      int c = imod(index, "+W+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(X,Q){for(var se=[Math.ceil(Q[0]/2),Math.ceil(Q[1]/2)],ue=Math.ceil(X[X.length-1]/2),fe=ue*Math.ceil(X[X.length-2]/2),_e=fe,me="",Me="b, r, c",Te=2;Te<X.length-1;Te++)me="\n      int b"+Te+" = index / "+(_e*=X[X.length-Te-1])+";\n      index -= b"+Te+" * "+_e+";\n    "+me,Me="b"+Te+", "+Me;return"\n    ivec"+X.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+se[0]+", "+se[1]+"));\n      int index = resTexRC.x * "+se[1]+" + resTexRC.y;\n\n      "+me+"\n\n      int b = index / "+fe+";\n      index -= b * "+fe+";\n\n      int r = 2 * (index / "+ue+");\n      int c = imod(index, "+ue+") * 2;\n\n      return ivec"+X.length+"("+Me+");\n    }\n  "}(M,O)}var Q,se,N,P,B,W,G}(o.logicalShape,v),p=function(M){return"\n    void setOutput(vec4 val) {\n      "+M.output+" = val;\n    }\n  "}(y)):(u=function(M,O){switch(M.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(W=O)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+W[1]+".0);\n      }\n    ":1===W[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+W[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+W[0]+", "+W[1]+"));\n      return resTexRC.x * "+W[1]+" + resTexRC.y;\n    }\n  ";case 2:return function(B,W){return ke(B,W)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+W[0]+", "+W[1]+"));\n      }\n    ":1===B[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+W[0]+", "+W[1]+"));\n        int index = resTexRC.x * "+W[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===B[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+W[0]+", "+W[1]+"));\n        int index = resTexRC.x * "+W[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+W[0]+", "+W[1]+"));\n      int index = resTexRC.x * "+W[1]+" + resTexRC.y;\n      int r = index / "+B[1]+";\n      int c = index - r * "+B[1]+";\n      return ivec2(r, c);\n    }\n  "}(M,O);case 3:return N=O,P=vt(["r","c","d"],M),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+N[0]+", "+N[1]+"));\n      int index = resTexRC.x * "+N[1]+" + resTexRC.y;\n      "+P+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(B,W){var G=vt(["r","c","d","d2"],B);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+W[0]+", "+W[1]+"));\n      int index = resTexRC.x * "+W[1]+" + resTexRC.y;\n      "+G+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(M,O);case 5:return function(B,W){var G=vt(["r","c","d","d2","d3"],B);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+W[0]+",\n                             "+W[1]+"));\n\n      int index = resTexRC.x * "+W[1]+" + resTexRC.y;\n\n      "+G+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(M,O);case 6:return function(B,W){var G=vt(["r","c","d","d2","d3","d4"],B);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+W[0]+", "+W[1]+"));\n      int index = resTexRC.x * "+W[1]+" + resTexRC.y;\n\n      "+G+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(M,O);default:throw new Error(M.length+"-D output sampling is not yet supported")}var W,N,P}(o.logicalShape,v),p=function(M){return"\n    void setOutput(float val) {\n      "+M.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(y)),a&&(S+=Q_),[S,C,p,m,u,g,i].join("\n")}function wr(s){var o=s.shapeInfo.logicalShape;switch(o.length){case 0:return function(i){var a=i.name,c="get"+a.charAt(0).toUpperCase()+a.slice(1);if(i.shapeInfo.isUniform)return"float "+c+"() {return "+a+";}";var u=i.shapeInfo.texShape;if(1===u[0]&&1===u[1])return"\n      float "+c+"() {\n        return sampleTexture("+a+", halfCR);\n      }\n    ";var g=i.shapeInfo.texShape;return"\n    float "+c+"() {\n      vec2 uv = uvFromFlat("+g[0]+", "+g[1]+", "+Wc(a)+");\n      return sampleTexture("+a+", uv);\n    }\n  "}(s);case 1:return function(i){var a=i.name,c="get"+a.charAt(0).toUpperCase()+a.slice(1);if(i.shapeInfo.isUniform)return"\n      float "+c+"(int index) {\n        "+Wh(i)+"\n      }\n    ";var u=i.shapeInfo.texShape,p=u[0],m=u[1];if(1===m&&1===p)return"\n      float "+c+"(int index) {\n        return sampleTexture("+a+", halfCR);\n      }\n    ";var g=Wc(a);return 1===m?"\n      float "+c+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+g+") + 0.5) / "+p+".0);\n        return sampleTexture("+a+", uv);\n      }\n    ":1===p?"\n      float "+c+"(int index) {\n        vec2 uv = vec2((float(index + "+g+") + 0.5) / "+m+".0, 0.5);\n        return sampleTexture("+a+", uv);\n      }\n    ":"\n    float "+c+"(int index) {\n      vec2 uv = uvFromFlat("+p+", "+m+", index + "+g+");\n      return sampleTexture("+a+", uv);\n    }\n  "}(s);case 2:return function(i){var a=i.shapeInfo.logicalShape,c=i.name,u="get"+c.charAt(0).toUpperCase()+c.slice(1),p=i.shapeInfo.texShape;if(null!=p&&ke(a,p))return"\n    float "+u+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+p[1]+".0, "+p[0]+".0);\n      return sampleTexture("+c+", uv);\n    }\n  ";var v=Ve(a),y=v.newShape,C=v.keptDims;if(y.length<a.length)return"\n      "+wr(Hr(i,y))+"\n      float "+u+"(int row, int col) {\n        return "+u+"("+_a(["row","col"],C)+");\n      }\n    ";if(i.shapeInfo.isUniform)return"\n      float "+u+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+a[1]+", 1)));\n        "+Wh(i)+"\n      }\n    ";var O=p[0],N=p[1],P=Wc(c);return 1===N?"\n    float "+u+"(int row, int col) {\n      float index = dot(vec3(row, col, "+P+"), vec3("+a[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+O+".0);\n      return sampleTexture("+c+", uv);\n    }\n  ":1===O?"\n    float "+u+"(int row, int col) {\n      float index = dot(vec3(row, col, "+P+"), vec3("+a[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+N+".0, 0.5);\n      return sampleTexture("+c+", uv);\n    }\n  ":"\n  float "+u+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+a[1]+" + col + "+P+";\n    vec2 uv = uvFromFlat("+O+", "+N+", index);\n    return sampleTexture("+c+", uv);\n  }\n"}(s);case 3:return function(i){var a=i.shapeInfo.logicalShape,c=i.name,u="get"+c.charAt(0).toUpperCase()+c.slice(1),p=a[1]*a[2],m=a[2],g=Ve(a),v=g.newShape,y=g.keptDims;if(v.length<a.length)return"\n        "+wr(Hr(i,v))+"\n        float "+u+"(int row, int col, int depth) {\n          return "+u+"("+_a(["row","col","depth"],y)+");\n        }\n      ";if(i.shapeInfo.isUniform)return"\n      float "+u+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+p+", "+m+", 1)));\n        "+Wh(i)+"\n      }\n    ";var M=i.shapeInfo.texShape,O=M[0],N=M[1],P=i.shapeInfo.flatOffset;return N===p&&null==P?"\n        float "+u+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+m+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+N+".0, "+O+".0);\n          return sampleTexture("+c+", uv);\n        }\n      ":N===m&&null==P?"\n    float "+u+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+a[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+N+".0, "+O+".0);\n      return sampleTexture("+c+", uv);\n    }\n  ":"\n      float "+u+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+p+" + col * "+m+" + depth + "+Wc(c)+";\n        vec2 uv = uvFromFlat("+O+", "+N+", index);\n        return sampleTexture("+c+", uv);\n      }\n  "}(s);case 4:return function(i){var a=i.shapeInfo.logicalShape,c=i.name,u="get"+c.charAt(0).toUpperCase()+c.slice(1),p=a[3],m=a[2]*p,g=a[1]*m,v=Ve(a),y=v.newShape,C=v.keptDims;if(y.length<a.length)return"\n      "+wr(Hr(i,y))+"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        return "+u+"("+_a(["row","col","depth","depth2"],C)+");\n      }\n    ";if(i.shapeInfo.isUniform)return"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+g+", "+m+", "+p+", 1)));\n        "+Wh(i)+"\n      }\n    ";var M=i.shapeInfo.flatOffset,O=i.shapeInfo.texShape,N=O[0],P=O[1];return P===g&&null==M?"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+m+", "+p+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+P+".0, "+N+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":P===p&&null==M?"\n      float "+u+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+a[1]*a[2]+", "+a[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+P+".0, "+N+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":"\n    float "+u+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+g+" + col * "+m+" +\n          depth * "+p+" + depth2;\n      vec2 uv = uvFromFlat("+N+", "+P+", index + "+Wc(c)+");\n      return sampleTexture("+c+", uv);\n    }\n  "}(s);case 5:return function(i){var a=i.shapeInfo.logicalShape,c=i.name,u="get"+c.charAt(0).toUpperCase()+c.slice(1),p=a[4],m=a[3]*p,g=a[2]*m,v=a[1]*g,y=Ve(a),C=y.newShape,S=y.keptDims;if(C.length<a.length)return"\n      "+wr(Hr(i,C))+"\n      float "+u+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+u+"("+_a(["row","col","depth","depth2","depth3"],S)+");\n      }\n    ";if(i.shapeInfo.isUniform)return"\n      float "+u+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+v+", "+g+", "+m+", "+p+")) +\n          depth3;\n        "+Wh(i)+"\n      }\n    ";var O=i.shapeInfo.flatOffset,N=i.shapeInfo.texShape,P=N[0],B=N[1];return B===v&&null==O?"\n      float "+u+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+g+", "+m+", "+p+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+B+".0, "+P+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":B===p&&null==O?"\n      float "+u+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+a[1]*a[2]*a[3]+",\n               "+a[2]*a[3]+", "+a[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+B+".0, "+P+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":"\n    float "+u+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+v+" + col * "+g+" + depth * "+m+" +\n          depth2 * "+p+" + depth3 + "+Wc(c)+";\n      vec2 uv = uvFromFlat("+P+", "+B+", index);\n      return sampleTexture("+c+", uv);\n    }\n  "}(s);case 6:return function(i){var a=i.shapeInfo.logicalShape,c=i.name,u="get"+c.charAt(0).toUpperCase()+c.slice(1),p=Ve(a),m=p.newShape,g=p.keptDims;if(m.length<a.length)return"\n      "+wr(Hr(i,m))+"\n      float "+u+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+u+"("+_a(["row","col","depth","depth2","depth3","depth4"],g)+");\n      }\n    ";var y=a[5],C=a[4]*y,S=a[3]*C,M=a[2]*S,O=a[1]*M;if(i.shapeInfo.isUniform)return"\n      float "+u+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+O+", "+M+", "+S+", "+C+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+y+", 1)));\n        "+Wh(i)+"\n      }\n    ";var N=i.shapeInfo.flatOffset,P=i.shapeInfo.texShape,B=P[0],W=P[1];return W===O&&null==N?"\n      float "+u+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+M+", "+S+", "+C+", "+y+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+W+".0, "+B+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":W===y&&null==N?"\n      float "+u+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+a[1]*a[2]*a[3]*a[4]+",\n               "+a[2]*a[3]*a[4]+",\n               "+a[3]*a[4]+",\n               "+a[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+W+".0, "+B+".0);\n        return sampleTexture("+c+", uv);\n      }\n    ":"\n    float "+u+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+O+" + col * "+M+" + depth * "+S+" +\n          depth2 * "+C+" + depth3 * "+y+" + depth4 + "+Wc(c)+";\n      vec2 uv = uvFromFlat("+B+", "+W+", index);\n      return sampleTexture("+c+", uv);\n    }\n  "}(s);default:throw new Error(o.length+"-D input sampling is not yet supported")}}function X_(s){var o,c,u,p,m,g,v;switch(s.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(o=s.name).charAt(0).toUpperCase()+o.slice(1)+"() {\n      return "+zo().texture2D+"("+o+", halfCR);\n    }\n  ";case 1:return p="get"+(u=(c=s).name).charAt(0).toUpperCase()+u.slice(1),m=c.shapeInfo.texShape,g=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],v=zo(),"\n    vec4 "+p+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+g[0]+", "+g[1]+", index);\n      return "+v.texture2D+"("+u+", uv);\n    }\n  ";case 2:return function(c){var u=c.shapeInfo.logicalShape,p=c.name,m="get"+p.charAt(0).toUpperCase()+p.slice(1),g=c.shapeInfo.texShape,v=g[0],y=g[1],C=zo();if(null!=g&&ke(u,g))return"\n      vec4 "+m+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+y+".0, "+v+".0);\n\n        return "+C.texture2D+"("+p+", uv);\n      }\n    ";var S=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)];return"\n    vec4 "+m+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(u[1]/2)+", "+S[0]+", "+S[1]+", row, col);\n      return "+C.texture2D+"("+p+", uv);\n    }\n  "}(s);case 3:return function(c){var u=c.shapeInfo.logicalShape,p=c.name,m="get"+p.charAt(0).toUpperCase()+p.slice(1),g=c.shapeInfo.texShape,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)];if(1===u[0])return"\n        "+X_(Hr(c,u.slice(1)))+"\n        vec4 "+m+"(int b, int row, int col) {\n          return "+m+"("+_a(["b","row","col"],[1,2])+");\n        }\n      ";var S=v[0],M=v[1],O=Math.ceil(u[2]/2);return"\n    vec4 "+m+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+S+", "+M+", "+O*Math.ceil(u[1]/2)+", "+O+", b, row, col);\n      return "+zo().texture2D+"("+p+", uv);\n    }\n  "}(s);default:return function(c){for(var u=c.shapeInfo.logicalShape,p=u.length,m=c.name,g="get"+m.charAt(0).toUpperCase()+m.slice(1),v=c.shapeInfo.texShape,y=[Math.ceil(v[0]/2),Math.ceil(v[1]/2)],C=y[0],S=y[1],M=Math.ceil(u[p-1]/2),O=M*Math.ceil(u[p-2]/2),N="int b, int row, int col",P="b * "+O+" + (row / 2) * "+M+" + (col / 2)",B=2;B<p-1;B++)N="int b"+B+", "+N,P="b"+B+" * "+(O*=u[p-B-1])+" + "+P;return"\n    vec4 "+g+"("+N+") {\n      int index = "+P+";\n      int texR = index / "+S+";\n      int texC = index - texR * "+S+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+S+", "+C+");\n      return "+zo().texture2D+"("+m+", uv);\n    }\n  "}(s)}}var jh="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ls="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Z_="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Q_="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Wc(s){return"offset"+s}function Wh(s){var o=s.name,i=de(s.shapeInfo.logicalShape);return i<2?"return "+o+";":"\n    for (int i = 0; i < "+i+"; i++) {\n      if (i == index) {\n        return "+o+"[i];\n      }\n    }\n  "}function Xi(s){if(s<=1)return"int";if(2===s)return"ivec2";if(3===s)return"ivec3";if(4===s)return"ivec4";if(5===s)return"ivec5";if(6===s)return"ivec6";throw Error("GPU for rank "+s+" is not yet supported")}function Hr(s,o){var i=JSON.parse(JSON.stringify(s));return i.shapeInfo.logicalShape=o,i}function _a(s,o){return o.map(function(i){return s[i]}).join(", ")}var jx=function(s,o,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L(s.length>2,function(){return"Packed arg"+(i.charAt(0).toUpperCase()+i.slice(1))+" supports only inputs with rank above 2."});var u=Math.ceil(s[s.length-1]/o);this.outputShape=s.slice(0,-1),u>1&&this.outputShape.push(u),a||this.variableNames.push("bestIndicesA");var p,m,g=this.outputShape,v=g.length,y=Xi(v),C=ga("coords",v);if(1===u){var S=Xi(m=v+1);p="\n        "+S+" sourceLocR = "+S+"("+C.join()+", 0);\n        ++"+C[v-1]+";\n        "+S+" sourceLocG = "+S+"("+C.join()+", 0);\n        ++"+C[v-2]+";\n        "+S+" sourceLocA = "+S+"("+C.join()+", 0);\n        --"+C[v-1]+";\n        "+S+" sourceLocB = "+S+"("+C.join()+", 0);\n        --"+C[v-2]+";"}else m=v,p="\n        "+y+" sourceLocR = coords;\n        ++"+C[v-1]+";\n        "+y+" sourceLocG = coords;\n        ++"+C[v-2]+";\n        "+y+" sourceLocA = coords;\n        --"+C[v-1]+";\n        "+y+" sourceLocB = coords;\n        --"+C[v-2]+";";var M=["x","y","z","w","u","v"].slice(0,m),O="."+M[m-1],N=M.map(function(fe){return"int "+fe}),P=ga("sourceLocR",m-1).concat("inIdx.r"),B=ga("sourceLocG",m-1).concat("inIdx.g"),W=ga("sourceLocB",m-1).concat("inIdx.b"),G=ga("sourceLocA",m-1).concat("inIdx.a"),X="max"===i?"greaterThan":"lessThan",Q=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+P.join()+"),\n                             getBestIndicesAChannel("+B.join()+"),\n                             getBestIndicesAChannel("+W.join()+"),\n                             getBestIndicesAChannel("+G.join()+")));",se="vec4(\n            getAChannel("+P.join()+"),\n            hasNextCol ? getAChannel("+B.join()+") : 0.,\n            hasNextRow ? getAChannel("+W.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+G.join()+") : 0.)",ue=a?"":"\n      float getBestIndicesAChannel("+N.join()+") {\n        return getChannel(getBestIndicesA("+M.join()+"),\n                                          vec2("+M.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+N.join()+") {\n        return getChannel(getA("+M.join()+"),\n                               vec2("+M.slice(-2).join()+"));\n      }\n      "+ue+"\n      void main() {\n        "+y+" coords = getOutputCoords();\n        bool hasNextCol = "+C[v-1]+" < "+(g[v-1]-1)+";\n        bool hasNextRow = "+C[v-2]+" < "+(g[v-2]-1)+";\n        "+p+"\n        ivec4 srcIdx = ivec4(sourceLocR"+O+", sourceLocG"+O+",\n          sourceLocB"+O+", sourceLocA"+O+") * "+o+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+se+";\n\n        for (int i = 0; i < "+o+"; i++) {\n          inIdx = srcIdx;\n          "+Q+"\n          vec4 candidate = "+se+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+X+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},mu=function(s){this.variableNames=["dy"],this.outputShape=s.inShape;var m=s.effectiveFilterHeight,g=s.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(m-1-s.padInfo.top)+", "+(g-1-s.padInfo.left)+");\n      const float avgMultiplier = float("+1/(s.filterHeight*s.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+m+";\n            wR += "+s.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+s.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+g+";\n            wC+= "+s.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yl=function(s){this.variableNames=["dy"],this.outputShape=s.inShape;var y=s.effectiveFilterDepth,C=s.effectiveFilterHeight,S=s.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(y-1-s.padInfo.front)+", "+(C-1-s.padInfo.top)+", "+(S-1-s.padInfo.left)+");\n      const float avgMultiplier = float("+1/(s.filterDepth*s.filterHeight*s.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+y+";\n            wD += "+s.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+s.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+s.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+C+";\n              wR += "+s.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+s.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+S+";\n                wC += "+s.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},gk=function(s,o,i,a,c,u){this.outputShape=[],this.variableNames=["x","mean","variance"],_i(s,o),_i(s,i);var p="0.0";null!=a&&(_i(s,a),this.variableNames.push("offset"),p="getOffsetAtOutCoords()");var m="1.0";null!=c&&(_i(s,c),this.variableNames.push("scale"),m="getScaleAtOutCoords()"),this.outputShape=s,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+p+";\n        float scale = "+m+";\n        float inv = scale * inversesqrt(variance + float("+u+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Wx=function(s,o,i,a,c,u){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],_i(s,o),_i(s,i);var p="vec4(0.0)";null!=a&&(_i(s,a),this.variableNames.push("offset"),p="getOffsetAtOutCoords()");var m="vec4(1.0)";null!=c&&(_i(s,c),this.variableNames.push("scale"),m="getScaleAtOutCoords()"),this.outputShape=s,this.userCode="\n      void main() {\n        vec4 offset = "+p+";\n        vec4 scale = "+m+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+u+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},em=function(s,o,i){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=_i(o,i),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+s+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Gh="return a + b;",tm="return a - b;",nm="return a * b;",Gx="return (a < 0.) ? b * a : a;",vr=function(s,o,i){this.variableNames=["A","B"],this.outputShape=_i(o,i),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+s+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},im="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Bs=function(s,o,i,a){void 0===a&&(a=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_i(o,i);var c=this.outputShape.length,u="";if(a)if(0===c||1===de(this.outputShape))u="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(u="\n          "+Xi(c)+" coords = getOutputCoords();\n        ",1===c)u+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var p=ga("coords",c);u+="\n            bool nextRowOutOfBounds =\n              ("+p[c-2]+" + 1) >= "+this.outputShape[c-2]+";\n            bool nextColOutOfBounds =\n              ("+p[c-1]+" + 1) >= "+this.outputShape[c-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+s+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+u+"\n\n        setOutput(result);\n      }\n    "},$x=function(){function s(o){this.variableNames=["A"],this.outputShape=o,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return s.prototype.getCustomSetupFunc=function(o,i){var a=this;return function(c,u){null==a.minLoc&&(a.minLoc=c.getUniformLocationNoThrow(u,"minVal"),a.maxLoc=c.getUniformLocationNoThrow(u,"maxVal")),c.gl.uniform1f(a.minLoc,o),c.gl.uniform1f(a.maxLoc,i)}},s}(),qx=function(){function s(o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return s.prototype.getCustomSetupFunc=function(o,i){var a=this;return function(c,u){null==a.minLoc&&(a.minLoc=c.getUniformLocationNoThrow(u,"minVal"),a.maxLoc=c.getUniformLocationNoThrow(u,"maxVal")),c.gl.uniform1f(a.minLoc,o),c.gl.uniform1f(a.maxLoc,i)}},s}(),Yx=function(s){this.variableNames=["real","imag"],this.outputShape=s,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},J_=function(s){this.outputShape=[],this.outputShape=on(s,1),this.variableNames=s.map(function(m,g){return"T"+g});var o=new Array(s.length-1);o[0]=s[0][1];for(var i=1;i<o.length;i++)o[i]=o[i-1]+s[i][1];var a=["if (yC < "+o[0]+") setOutput(getT0(yR, yC));"];for(i=1;i<o.length;i++)a.push("else if (yC < "+o[i]+") setOutput(getT"+i+"(yR, yC-"+o[i-1]+"));");a.push("else setOutput(getT"+o.length+"(yR, yC-"+o[o.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+a.join("\n        ")+"\n      }\n    "},bk=function(s,o){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=on(s,o);var i=this.outputShape,a=i.length,c=Xi(a),u=ga("coords",a),p=["x","y","z","w","u","v"].slice(0,a);this.variableNames=s.map(function(P,B){return"T"+B});var m=new Array(s.length-1);m[0]=s[0][o];for(var g=1;g<m.length;g++)m[g]=m[g-1]+s[g][o];var v=p[o],y=p.slice(-2),C=p.join(),S="if ("+v+" < "+m[0]+") {\n        return getChannel(\n            getT0("+C+"), vec2("+y.join()+"));\n        }";for(g=1;g<m.length;g++){var M=m[g-1];S+="\n        if ("+v+" < "+m[g]+"  && "+v+" >= "+m[g-1]+") {\n          return getChannel(\n            getT"+g+"("+rm(p,v,M)+"),\n            vec2("+rm(y,v,M)+"));\n        }"}var N=m[m.length-1];S+="\n        return getChannel(\n          getT"+m.length+"("+rm(p,v,N)+"),\n          vec2("+rm(y,v,N)+"));",this.userCode="\n      float getValue("+p.map(function(P){return"int "+P})+") {\n        "+S+"\n      }\n\n      void main() {\n        "+c+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+u+"), 0., 0., 0.);\n\n        "+u[a-1]+" = "+u[a-1]+" + 1;\n        if ("+u[a-1]+" < "+i[a-1]+") {\n          result.g = getValue("+u+");\n        }\n\n        "+u[a-2]+" = "+u[a-2]+" + 1;\n        if ("+u[a-2]+" < "+i[a-2]+") {\n          result.a = getValue("+u+");\n        }\n\n        "+u[a-1]+" = "+u[a-1]+" - 1;\n        if ("+u[a-2]+" < "+i[a-2]+" &&\n            "+u[a-1]+" < "+i[a-1]+") {\n          result.b = getValue("+u+");\n        }\n        setOutput(result);\n      }\n    "};function rm(s,o,i){var a=s.indexOf(o);return s.map(function(c,u){return u===a?c+" - "+i:c}).join()}var Xo=function(s){this.variableNames=["x","dy"],this.outputShape=s.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+s.batchSize+"; b++) {\n          for (int yR = 0; yR < "+s.outHeight+"; yR++) {\n            int xR = wR + yR * "+s.strideHeight+" - "+s.padInfo.top+";\n\n            if (xR < 0 || xR >= "+s.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+s.outWidth+"; yC++) {\n              int xC = wC + yC * "+s.strideWidth+" - "+s.padInfo.left+";\n\n              if (xC < 0 || xC >= "+s.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===s.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Gc=function(s){this.variableNames=["dy","W"],this.outputShape=s.inShape;var o=s.filterHeight,i=s.filterWidth,u="channelsLast"===s.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(o-1-s.padInfo.top)+", "+(i-1-s.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(u?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(u?1:2)+"], coords["+(u?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+s.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+o+" - 1 - wR;\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+i+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+s.outChannels+"; d2++) {\n\n              if ("+u+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},br=function(s){this.variableNames=["x","dy"],this.outputShape=s.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+s.batchSize+"; b++) {\n          for (int yF = 0; yF < "+s.outDepth+"; yF++) {\n            int xF = wF + yF * "+s.strideDepth+" - "+s.padInfo.front+";\n\n            if (xF < 0 || xF >= "+s.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+s.outHeight+"; yR++) {\n              int xR = wR + yR * "+s.strideHeight+" - "+s.padInfo.top+";\n\n              if (xR < 0 || xR >= "+s.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+s.outWidth+"; yC++) {\n                int xC = wC + yC * "+s.strideWidth+" - "+s.padInfo.left+";\n\n                if (xC < 0 || xC >= "+s.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},$h=function(s){this.variableNames=["dy","W"],this.outputShape=s.inShape;var o=s.filterDepth,i=s.filterHeight,a=s.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(o-1-s.padInfo.front)+", "+(i-1-s.padInfo.top)+", "+(a-1-s.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+o+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+s.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+s.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+o+" - 1 - wF;\n\n          for (int wR = 0; wR < "+i+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+s.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+i+" - 1 - wR;\n\n            for (int wC = 0; wC < "+a+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+a+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+s.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yk=function(s){this.variableNames=["x","dy"],this.outputShape=s.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+s.outChannels/s.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+s.batchSize+"; b++) {\n          for (int yR = 0; yR < "+s.outHeight+"; yR++) {\n            int xR = wR + yR * "+s.strideHeight+" - "+s.padInfo.top+";\n\n            if (xR < 0 || xR >= "+s.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+s.outWidth+"; yC++) {\n              int xC = wC + yC * "+s.strideWidth+" - "+s.padInfo.left+";\n\n              if (xC < 0 || xC >= "+s.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},qh=function(s){this.variableNames=["dy","W"],this.outputShape=s.inShape;var o=s.filterHeight,i=s.filterWidth,m=s.outChannels/s.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(o-1-s.padInfo.top)+", "+(i-1-s.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+o+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+s.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+o+" - 1 - wR;\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+i+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+m+"; dm++) {\n              int d2 = d1 * "+m+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Kx=function(s,o,i,a){void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["x","W"],this.outputShape=s.outShape;var c=s.padInfo.top,u=s.padInfo.left,p=s.strideHeight,m=s.strideWidth,g=s.dilationHeight,v=s.dilationWidth,y=s.filterHeight,C=s.filterWidth,S=4*Math.floor(s.inChannels/4),M=s.inChannels%4,O="channelsLast"===s.dataFormat,N=O?1:2,P=O?2:3,B=O?3:1,W="",G="";i&&(W=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"\n          float activation(float x) {\n            "+i+"\n          }\n        ",G="result = activation(result);");var X=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+W+"\n\n      const ivec2 strides = ivec2("+p+", "+m+");\n      const ivec2 pads = ivec2("+c+", "+u+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+B+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+N+"], coords["+P+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+y+"; wR++) {\n          int xR = xRCorner + wR * "+g+";\n\n          if (xR < 0 || xR >= "+s.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+C+"; wC++) {\n            int xC = xCCorner + wC * "+v+";\n\n            if (xC < 0 || xC >= "+s.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+S+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+O+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===M)+") {\n\n              if ("+O+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+S+") *\n                    getW(wR, wC, "+S+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+S+", xR, xC) *\n                    getW(wR, wC, "+S+", d2);\n              }\n\n            } else if ("+(2===M)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+S+", d2),\n                getW(wR, wC, "+S+" + 1, d2)\n              );\n\n              if ("+O+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+S+"),\n                  getX(batch, xR, xC, "+S+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+S+", xR, xC),\n                  getX(batch, "+S+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===M)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+S+", d2),\n                getW(wR, wC, "+S+" + 1, d2),\n                getW(wR, wC, "+S+" + 2, d2)\n              );\n\n              if ("+O+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+S+"),\n                  getX(batch, xR, xC, "+S+" + 1),\n                  getX(batch, xR, xC, "+S+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+S+", xR, xC),\n                  getX(batch, "+S+" + 1, xR, xC),\n                  getX(batch, "+S+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+X+"\n        "+G+"\n        setOutput(result);\n      }\n    "},xk=function(s){this.variableNames=["x","W"],this.outputShape=s.outShape;var o=s.padInfo.front,i=s.padInfo.top,a=s.padInfo.left,c=s.strideDepth,u=s.strideHeight,p=s.strideWidth,m=s.dilationDepth,g=s.dilationHeight,v=s.dilationWidth,y=s.filterDepth,C=s.filterHeight,S=s.filterWidth,M=4*Math.floor(s.inChannels/4),O=s.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+c+", "+u+", "+p+");\n      const ivec3 pads = ivec3("+o+", "+i+", "+a+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+y+"; wF++) {\n          int xF = xFCorner + wF * "+m+";\n\n          if (xF < 0 || xF >= "+s.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+C+"; wR++) {\n            int xR = xRCorner + wR * "+g+";\n\n            if (xR < 0 || xR >= "+s.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+S+"; wC++) {\n              int xC = xCCorner + wC * "+v+";\n\n              if (xC < 0 || xC >= "+s.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+M+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===O)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+M+") *\n                  getW(wF, wR, wC, "+M+", d2);\n              } else if ("+(2===O)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+M+"),\n                  getX(batch, xF, xR, xC, "+M+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+M+", d2),\n                  getW(wF, wR, wC, "+M+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===O)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+M+"),\n                  getX(batch, xF, xR, xC, "+M+" + 1),\n                  getX(batch, xF, xR, xC, "+M+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+M+", d2),\n                  getW(wF, wR, wC, "+M+" + 1, d2),\n                  getW(wF, wR, wC, "+M+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Xx=function(s,o,i,a){void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["x","W"],this.outputShape=s.outShape;var c=s.inHeight,u=s.inWidth,p=s.padInfo.top,m=s.padInfo.left,g=s.strideHeight,v=s.strideWidth,y=s.dilationHeight,C=s.dilationWidth,S=s.filterHeight,M=s.filterWidth,O=s.outChannels/s.inChannels,N="",P="";i&&(N=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"\n          float activation(float x) {\n            "+i+"\n          }\n        ",P="result = activation(result);");var B=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+N+"\n\n      const ivec2 strides = ivec2("+g+", "+v+");\n      const ivec2 pads = ivec2("+p+", "+m+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+O+";\n        int q = d2 - d1 * "+O+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+S+"; wR++) {\n          int xR = xRCorner + wR * "+y+";\n\n          if (xR < 0 || xR >= "+c+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+M+"; wC++) {\n            int xC = xCCorner + wC * "+C+";\n\n            if (xC < 0 || xC >= "+u+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+B+"\n        "+P+"\n        setOutput(result);\n      }\n    "},Yh=function(s,o,i,a){void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s.outShape;for(var c=s.inHeight,u=s.inWidth,p=s.padInfo.top,m=s.padInfo.left,g=s.strideHeight,v=s.strideWidth,y=s.dilationHeight,C=s.dilationWidth,S=s.filterHeight,M=s.filterWidth,O=M,N="int xR; int xC; int xCOffset;",P=0;P<S;P++)for(var B=0;B<M;B++)N+="\n          vec4 xTexelR"+P+"C"+2*B+" = vec4(0.);\n          vec4 wR"+P+"C"+B+" = vec4(0.);\n          vec4 xR"+P+"C"+B+" = vec4(0.);";for(P=0;P<S;P++)for(var W=0;W<O;W++){if(N+="\n          xR = xRCorner + "+P*y+";\n          xC = xCCorner + "+(B=2*W)*C+";\n        ",1===v){if(B<M&&(N+=m%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+c+" && xCOffset >= 0 && xCOffset < "+u+") {\n                  xTexelR"+P+"C"+B+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+P+"C"+B+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+c+" && xCOffset >= 0 && xCOffset < "+u+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+P+"C"+B+" = vec4(previous.zw, xTexelR"+P+"C"+B+".xy);\n                } else {\n                  xR"+P+"C"+B+" = vec4(0, 0, xTexelR"+P+"C"+B+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+c+" && xC >= 0 && xC < "+u+") {\n                  xTexelR"+P+"C"+B+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+P+"C"+B+" = vec4(0.);\n                }\n\n                xR"+P+"C"+B+" = xTexelR"+P+"C"+B+";\n              ",B+1<M)){var G=m%2==0?R(C):C;C%2==0&&m%2==1||C%2!=0&&m%2!=1?(N+="\n                  xCOffset = xC + "+m%2+" + "+G+";\n\n                  if(xR >= 0 && xR < "+c+" &&\n                    xCOffset >= 0 && xCOffset < "+u+") {\n                    xTexelR"+P+"C"+(B+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",C>1&&(N+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+c+" &&\n                      xCOffset >= 0 && xCOffset < "+u+") {\n                      xTexelR"+P+"C"+B+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+P+"C"+B+" = vec4(0.);\n                    }\n                  "),N+="\n                  xR"+P+"C"+(B+1)+" = vec4(\n                    xTexelR"+P+"C"+B+".zw, xTexelR"+P+"C"+(B+2)+".xy);\n                "):N+="\n                  xCOffset = xC + "+G+";\n\n                  if(xR >= 0 && xR < "+c+" &&\n                    xCOffset >= 0 && xCOffset < "+u+") {\n                    xTexelR"+P+"C"+(B+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+P+"C"+(B+1)+" = xTexelR"+P+"C"+(B+2)+";\n                "}}else B<M&&(N+="\n              if(xR >= 0 && xR < "+c+") {\n            ",m%2==1?(N+="\n                xCOffset = xC + 1 - "+v+";\n                if(xCOffset >= 0 && xCOffset < "+u+") {\n                  xTexelR"+P+"C"+B+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+P+"C"+B+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+u+") {\n                  xTexelR"+P+"C"+(B+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+P+"C"+(B+2)+" = vec4(0.);\n                }\n\n                xR"+P+"C"+B+" = vec4(\n                  xTexelR"+P+"C"+B+".zw, xTexelR"+P+"C"+(B+2)+".zw);\n              ",B+1<M&&(N+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+v+";\n                  if(xCOffset >= 0 && xCOffset < "+u+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+P+"C"+(B+1)+" = vec4(xTexelR"+P+"C"+(B+2)+".xy, final.xy);\n                ")):(N+="\n                if(xC >= 0 && xC < "+u+") {\n                  xTexelR"+P+"C"+B+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+P+"C"+B+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+v+";\n                if(xCOffset >= 0 && xCOffset < "+u+") {\n                  xTexelR"+P+"C"+(B+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+P+"C"+(B+2)+" = vec4(0.);\n                }\n\n                xR"+P+"C"+B+" = vec4(\n                  xTexelR"+P+"C"+B+".xy, xTexelR"+P+"C"+(B+2)+".xy);\n              ",B+1<M&&(N+="\n                  xR"+P+"C"+(B+1)+" = vec4(\n                    xTexelR"+P+"C"+B+".zw, xTexelR"+P+"C"+(B+2)+".zw);\n                ")),N+="}");B<M&&(N+="\n            vec4 wTexelR"+P+"C"+B+" = getW("+P+", "+B+", d1, q);\n            wR"+P+"C"+B+" = vec4(wTexelR"+P+"C"+B+".xz, wTexelR"+P+"C"+B+".xz);\n          ",B+1<M&&(N+="\n              vec4 wTexelR"+P+"C"+(B+1)+" = getW("+P+", "+(B+1)+", d1, q);\n              wR"+P+"C"+(B+1)+" =\n                vec4(wTexelR"+P+"C"+(B+1)+".xz, wTexelR"+P+"C"+(B+1)+".xz);"))}for(P=0;P<S;P++)for(B=0;B<M;B++)N+="dotProd += xR"+P+"C"+B+" * wR"+P+"C"+B+";";var X="",Q="";i&&(X=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",Q="result = activation(result);");var se=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+X+"\n\n      const ivec2 strides = ivec2("+g+", "+v+");\n      const ivec2 pads = ivec2("+p+", "+m+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+N+"\n\n        vec4 result = dotProd;\n        "+se+"\n        "+Q+"\n        setOutput(result);\n      }\n    "},om=function(s,o,i,a,c){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var u=s[0],p=s[1],m=s[2],y=i[0],C=i[1];this.outputShape=[o[0],y,C,s[3]];var M=[p-1+".0",m-1+".0"],O=M[0],N=M[1],P=y>1?[""+(p-1)/(y-1),"(y2-y1) * height_ratio","y1*"+O+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+O],X=C>1?[""+(m-1)/(C-1),"(x2-x1) * width_ratio","x1*"+N+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+N];this.userCode="\n      const float height_ratio = float("+P[0]+");\n      const float width_ratio = float("+X[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+u+") {\n          return;\n        }\n\n        float height_scale = "+P[1]+";\n        float width_scale = "+X[1]+";\n\n        float in_y = "+P[2]+";\n        if( in_y < 0.0 || in_y > "+O+" ) {\n          setOutput(float("+c+"));\n          return;\n        }\n        float in_x = "+X[2]+";\n        if( in_x < 0.0 || in_x > "+N+" ) {\n          setOutput(float("+c+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===a?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},am=function(s,o,i){this.variableNames=["x"],this.outputShape=s;var a=s.length,c=s[s.length-1],u=i?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(i?"return "+c+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Xi(a)+" coords = getOutputCoords();\n        int end = "+sm(a,"coords")+";\n        float val = 0.0;\n        for (int i = "+c+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+u+" end) {\n            continue;\n          }\n          if (idx == end && "+o+") {\n            continue;\n          }\n          "+sm(a,"coords")+" = idx;\n          val += getX("+function(p,m){if(1===p)return""+m;if(2===p)return m+".x, "+m+".y";if(3===p)return m+".x, "+m+".y, "+m+".z";if(4===p)return m+".x, "+m+".y, "+m+".z, "+m+".w";throw Error("Cumulative sum for rank "+p+" is not yet supported")}(a,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function sm(s,o){if(1===s)return""+o;if(2===s)return o+".y";if(3===s)return o+".z";if(4===s)return o+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}var Zx=function(s){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Fo.DENSE;var o=ro(s),i=zo();this.outputShape=s,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+vt(["r","c","d"],s)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+o[0]+", "+o[1]+"));\n        int index = 4 * (resTexRC.x * "+o[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+i.output+" = result;\n      }\n    "},wk=function(s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Fo.DENSE;var o=ro(s),i=zo();this.outputShape=s,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+vt(["r","c","d"],s)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+o[0]+", "+o[1]+"));\n        int index = 4 * (resTexRC.x * "+o[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+i.output+" = result;\n      }\n    "},gu=function(){function s(o,i,a){this.variableNames=["x"],this.outputShape=[],this.outputShape=o,this.blockSize=i,this.dataFormat=a,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+i+";\n      int offset_h = imod(h, "+i+");\n      int in_w = w / "+i+";\n      int offset_w = imod(w, "+i+");\n      int offset_d = (offset_h * "+i+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return s.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},s.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},s.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},s.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},s.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},s}(),Kh=function(s){this.variableNames=["X"],this.outputShape=[s,s],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Ck=function(s){this.variableNames=["A"],this.outTexUsage=fo.DOWNLOAD;var o=zo();this.outputShape=s,this.userCode="\n      "+ts+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+o.output+" = encode_float(x);\n      }\n    "},rF=function(s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=fo.DOWNLOAD;var o=zo();this.outputShape=s,this.userCode="\n      "+ts+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+o.output+" = encode_float(x);\n      }\n    "},ev=function(s,o,i){void 0===i&&(i=!1),this.variableNames=["A"];var a=zo(),c=o[0],u=o[1];this.outputShape=s;var p="result";i&&(p="floor(result * 255. + 0.5)"),this.userCode="\n      "+wi(s)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+u+";\n        int c = imod(flatIndex, "+u+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+u+".0, "+c+".0);\n        vec4 values = "+a.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+a.output+" = vec4("+p+", 0., 0., 0.);\n      }\n    "},oF=function(s,o,i){void 0===i&&(i=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=zo(),c=o[0],u=o[1];this.outputShape=s;var p="",m="result";i&&(m="floor(result * 255. + 0.5)");for(var g=0;g<=1;g++)for(var v=0;v<=1;v++){var y=2*g+v;p+="\n          localCoords = coords;\n          if(localCoords[2] + "+v+" < "+s[2]+") {\n            localCoords[2] += "+v+";\n            if(localCoords[1] + "+g+" < "+s[1]+") {\n              localCoords[1] += "+g+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+u+";\n              c = imod(flatIndex, "+u+");\n              uv = (vec2(c, r) + halfCR) / vec2("+u+".0, "+c+".0);\n              values = "+a.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+y+"] = values[0];\n              } else if(offset == 1) {\n                result["+y+"] = values[1];\n              } else if(offset == 2) {\n                result["+y+"] = values[2];\n              } else {\n                result["+y+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+wi(s)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+p+"\n\n        "+a.output+" = "+m+";\n      }\n    "},Ek=function(s,o,i){this.variableNames=["real","imag"];var a=o[1];this.outputShape=o;var c=i?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+c+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+s+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+a+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+a+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(i?a+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},aF=function(){function s(o,i){this.outputShape=[],this.variableNames=["x"],this.outputShape=o,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return s.prototype.getCustomSetupFunc=function(o){var i=this;return function(a,c){null==i.valueLoc&&(i.valueLoc=a.getUniformLocationNoThrow(c,"value")),a.gl.uniform1f(i.valueLoc,o)}},s}(),tv=function(s){this.variableNames=["A"];var o=zo(),i=s[0],a=s[1];this.outputShape=s,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+a+".0, "+i+".0);\n\n        vec4 values = "+o.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Qx=function(s){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var o=zo(),i=s[0],a=s[1];this.outputShape=s,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+a+".0, "+i+".0);\n            vec4 values = "+o.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+o.output+" = result;\n      }\n    "},Jx=function(s,o,i){this.variableNames=["A","indices"];var a=s.slice();a[i]=o,this.outputShape=a,this.rank=a.length;var c=Xi(this.rank),u=function(p,m){var g=p.length;if(g>4)throw Error("Gather for rank "+g+" is not yet supported");if(1===g)return"int(getIndices(resRC))";for(var v=["resRC.x","resRC.y","resRC.z","resRC.w"],y=[],C=0;C<p.length;C++)y.push(C===m?"int(getIndices("+v[C]+"))":""+v[C]);return y.join()}(s,i);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        setOutput(getA("+u+"));\n      }\n    "},Xh=function(s,o,i){this.sliceDim=s,this.strides=o,this.variableNames=["x","indices"],this.outputShape=i;var a=Xi(o.length),c=Xi(i.length);this.userCode="\n        "+a+" strides = "+a+"("+this.strides+");\n         void main() {\n          "+c+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function nv(s,o){var i=zo();return Tc(s,o,i.version+"\n    precision highp float;\n    "+i.attribute+" vec3 clipSpacePos;\n    "+i.attribute+" vec2 uv;\n    "+i.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function iv(s,o){return eu(s,o,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Zh(s,o){return Fi(s,o,new Uint16Array([0,1,2,2,1,3]))}function Qh(s,o,i,a,c,u,p){Vf(i,a);var m=Rc(s,o),g=s.TEXTURE_2D;return Zt(s,o,function(){return s.bindTexture(g,m)}),Zt(s,o,function(){return s.texParameteri(g,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE)}),Zt(s,o,function(){return s.texParameteri(g,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE)}),Zt(s,o,function(){return s.texParameteri(g,s.TEXTURE_MIN_FILTER,s.NEAREST)}),Zt(s,o,function(){return s.texParameteri(g,s.TEXTURE_MAG_FILTER,s.NEAREST)}),Zt(s,o,function(){return s.texImage2D(g,0,c,i,a,0,u,p,null)}),Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,null)}),m}function Jh(s,o,i,a,c){var u=ds(i,a);return Qh(s,o,u[0],u[1],c.internalFormatFloat,c.textureFormatFloat,s.FLOAT)}function lm(s,o,i,a,c){var u=ds(i,a);return Qh(s,o,u[0],u[1],c.internalFormatHalfFloat,c.textureFormatFloat,c.textureTypeHalfFloat)}function ep(s,o,i,a,c){var u=ds(i,a);return Qh(s,o,u[0],u[1],s.RGBA,s.RGBA,s.UNSIGNED_BYTE)}function kk(s,o,i,a,c){var u=Ar(i,a);return Qh(s,o,u[0],u[1],c.internalFormatPackedFloat,s.RGBA,s.FLOAT)}function rv(s,o,i,a,c){var u=Ar(i,a);return Qh(s,o,u[0],u[1],c.internalFormatPackedHalfFloat,s.RGBA,c.textureTypeHalfFloat)}function ov(s,o,i,a){return Zt(s,o,function(){return s.bindBuffer(s.ARRAY_BUFFER,a)}),_n(s,o,i,"clipSpacePos",a,3,20,0)&&_n(s,o,i,"uv",a,2,20,12)}function ew(s,o,i,a,c,u,p){var m,g,v;Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,i)}),u instanceof Uint8Array?(m=new Uint8Array(a*c*4),g=s.UNSIGNED_BYTE,v=s.RGBA):(m=new Float32Array(a*c*4),g=s.FLOAT,v=p.internalFormatPackedFloat),m.set(u),Zt(s,o,function(){return s.texImage2D(s.TEXTURE_2D,0,v,a,c,0,s.RGBA,g,m)}),Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,null)})}function ps(s,o,i,a){Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,i)}),a.data instanceof Uint8Array?Zt(s,o,function(){return s.texImage2D(s.TEXTURE_2D,0,s.RGBA,a.width,a.height,0,s.RGBA,s.UNSIGNED_BYTE,a.data)}):Zt(s,o,function(){return s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,a)}),Zt(s,o,function(){return s.bindTexture(s.TEXTURE_2D,null)})}function tw(s,o,i,a,c){var u=s.createBuffer();Zt(s,o,function(){return s.bindBuffer(s.PIXEL_PACK_BUFFER,u)});var p=16*i*a;return Zt(s,o,function(){return s.bufferData(s.PIXEL_PACK_BUFFER,p,s.STREAM_READ)}),Zt(s,o,function(){return s.readPixels(0,0,a,i,s.RGBA,s.FLOAT,0)}),Zt(s,o,function(){return s.bindBuffer(s.PIXEL_PACK_BUFFER,null)}),u}function tp(s,o,i){var a=s,c=new Float32Array(i);return a.bindBuffer(a.PIXEL_PACK_BUFFER,o),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,c),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),c}function cm(s,o,i,a,c){var u=ds(i,a),p=u[0],m=u[1],g=new Uint8Array(i*a*4);return Zt(s,o,function(){return s.readPixels(0,0,p,m,c.downloadTextureFormat,s.UNSIGNED_BYTE,g)}),new Float32Array(g.buffer)}function av(s,o,i,a,c,u,p,m){var S,g=s,v=new Float32Array((S=Ar(u,p))[0]*S[1]*4);return g.bindBuffer(g.PIXEL_PACK_BUFFER,o),g.getBufferSubData(g.PIXEL_PACK_BUFFER,0,v),g.bindBuffer(g.PIXEL_PACK_BUFFER,null),v}function dm(s,o,i,a){var c=new Float32Array(i*a*4);return Zt(s,o,function(){return s.readPixels(0,0,a,i,s.RGBA,s.FLOAT,c)}),c}var sv=Object.freeze({createVertexShader:nv,createVertexBuffer:iv,createIndexBuffer:Zh,createFloat32MatrixTexture:Jh,createFloat16MatrixTexture:lm,createUnsignedBytesMatrixTexture:ep,createPackedMatrixTexture:kk,createFloat16PackedMatrixTexture:rv,bindVertexProgramAttributeStreams:ov,uploadDenseMatrixToTexture:ew,uploadPixelDataToTexture:ps,createBufferFromOutputTexture:tw,downloadFloat32MatrixFromBuffer:tp,downloadByteEncodedFloatMatrixFromOutputTexture:cm,downloadPackedMatrixFromBuffer:av,downloadMatrixFromPackedOutputTexture:dm}),nw=function(){function s(o){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var i=E().getNumber("WEBGL_VERSION");if(null!=o?(this.gl=o,R_(i,o)):this.gl=Zr(i),1===E().getNumber("WEBGL_VERSION"))this.textureFloatExtension=Jd(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=Jd(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(Fa(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!Fa(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=iv(this.gl,this.debug),this.indexBuffer=Zh(this.gl,this.debug),this.framebuffer=Yn(this.gl,this.debug),this.textureConfig=Zd(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(s.prototype,"debug",{get:function(){return E().getBool("DEBUG")},enumerable:!0,configurable:!0}),s.prototype.dispose=function(){var o=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var i=this.gl;Zt(i,this.debug,function(){return i.finish()}),Zt(i,this.debug,function(){return i.bindFramebuffer(i.FRAMEBUFFER,null)}),Zt(i,this.debug,function(){return i.deleteFramebuffer(o.framebuffer)}),Zt(i,this.debug,function(){return i.bindBuffer(i.ARRAY_BUFFER,null)}),Zt(i,this.debug,function(){return i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null)}),Zt(i,this.debug,function(){return i.deleteBuffer(o.indexBuffer)}),this.disposed=!0}},s.prototype.createFloat32MatrixTexture=function(o,i){return this.throwIfDisposed(),Jh(this.gl,this.debug,o,i,this.textureConfig)},s.prototype.createFloat16MatrixTexture=function(o,i){return this.throwIfDisposed(),lm(this.gl,this.debug,o,i,this.textureConfig)},s.prototype.createUnsignedBytesMatrixTexture=function(o,i){return this.throwIfDisposed(),ep(this.gl,this.debug,o,i)},s.prototype.uploadPixelDataToTexture=function(o,i){this.throwIfDisposed(),ps(this.gl,this.debug,o,i)},s.prototype.uploadDenseMatrixToTexture=function(o,i,a,c){this.throwIfDisposed(),ew(this.gl,this.debug,o,i,a,c,this.textureConfig)},s.prototype.createFloat16PackedMatrixTexture=function(o,i){return this.throwIfDisposed(),rv(this.gl,this.debug,o,i,this.textureConfig)},s.prototype.createPackedMatrixTexture=function(o,i){return this.throwIfDisposed(),kk(this.gl,this.debug,o,i,this.textureConfig)},s.prototype.deleteMatrixTexture=function(o){var i=this;this.throwIfDisposed(),this.outputTexture===o&&(Vl(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Zt(this.gl,this.debug,function(){return i.gl.deleteTexture(o)})},s.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(o,i,a){var c=this;return this.downloadMatrixDriver(o,function(){return cm(c.gl,c.debug,i,a,c.textureConfig)})},s.prototype.downloadPackedMatrixFromBuffer=function(o,i,a,c,u,p){return av(this.gl,o,0,0,0,u,p)},s.prototype.downloadFloat32MatrixFromBuffer=function(o,i){return tp(this.gl,o,i)},s.prototype.createBufferFromTexture=function(o,i,a){this.bindTextureToFrameBuffer(o);var c=tw(this.gl,this.debug,i,a);return this.unbindTextureToFrameBuffer(),c},s.prototype.createAndWaitForFence=function(){var o=this.createFence(this.gl);return this.pollFence(o)},s.prototype.createFence=function(o){var i,a,c=this;if(E().getBool("WEBGL_FENCE_API_ENABLED")){var u=o,p=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);o.flush(),a=function(){var m=u.clientWaitSync(p,0,0);return m===u.ALREADY_SIGNALED||m===u.CONDITION_SATISFIED},i=p}else E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(i=this.beginQuery(),this.endQuery(),a=function(){return c.isQueryAvailable(i,E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):a=function(){return!0};return{query:i,isFencePassed:a}},s.prototype.downloadMatrixFromPackedTexture=function(o,i,a){var c=this;return this.downloadMatrixDriver(o,function(){return dm(c.gl,c.debug,i,a)})},s.prototype.createProgram=function(o){this.throwIfDisposed();var i=this.gl,a=Fs(i,this.debug,o),c=nv(i,this.debug),u=hl(i,this.debug);return Zt(i,this.debug,function(){return i.attachShader(u,c)}),Zt(i,this.debug,function(){return i.attachShader(u,a)}),Ac(i,this.debug,u),this.debug&&Ri(i,this.debug,u),this.vertexAttrsAreBound||(this.setProgram(u),this.vertexAttrsAreBound=ov(i,this.debug,this.program,this.vertexBuffer)),u},s.prototype.deleteProgram=function(o){var i=this;this.throwIfDisposed(),o===this.program&&(this.program=null),null!=o&&Zt(this.gl,this.debug,function(){return i.gl.deleteProgram(o)})},s.prototype.setProgram=function(o){var i=this;this.throwIfDisposed(),this.program=o,null!=this.program&&this.debug&&Ri(this.gl,this.debug,this.program),Zt(this.gl,this.debug,function(){return i.gl.useProgram(o)})},s.prototype.getUniformLocation=function(o,i,a){return void 0===a&&(a=!0),this.throwIfDisposed(),a?tu(this.gl,this.debug,o,i):F_(this.gl,o,i)},s.prototype.getAttributeLocation=function(o,i){var a=this;return this.throwIfDisposed(),Zt(this.gl,this.debug,function(){return a.gl.getAttribLocation(o,i)})},s.prototype.getUniformLocationNoThrow=function(o,i){return this.throwIfDisposed(),this.gl.getUniformLocation(o,i)},s.prototype.setInputMatrixTexture=function(o,i,a){this.throwIfDisposed(),this.throwIfNoProgram(),zl(this.gl,this.debug,0,o,i,a)},s.prototype.setOutputMatrixTexture=function(o,i,a){this.setOutputMatrixTextureDriver(o,a,i)},s.prototype.setOutputPackedMatrixTexture=function(o,i,a){this.throwIfDisposed();var c=Ar(i,a);this.setOutputMatrixTextureDriver(o,c[0],c[1])},s.prototype.setOutputMatrixWriteRegion=function(o,i,a,c){this.setOutputMatrixWriteRegionDriver(a,o,c,i)},s.prototype.setOutputPackedMatrixWriteRegion=function(o,i,a,c){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},s.prototype.debugValidate=function(){null!=this.program&&Ri(this.gl,this.debug,this.program),An(this.gl)},s.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var o=this.gl;this.debug&&this.debugValidate(),Zt(o,this.debug,function(){return o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)})},s.prototype.blockUntilAllProgramsCompleted=function(){var o=this;this.throwIfDisposed(),Zt(this.gl,this.debug,function(){return o.gl.finish()})},s.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Jd(this.gl,this.debug,2===E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},s.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},s.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},s.prototype.beginQuery=function(){if(2===E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var o=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=o.createQuery();return o.beginQuery(i.TIME_ELAPSED_EXT,a),a}var c=this.getQueryTimerExtensionWebGL1(),u=c.createQueryEXT();return c.beginQueryEXT(c.TIME_ELAPSED_EXT,u),u},s.prototype.endQuery=function(){if(2!==E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var o=this.getQueryTimerExtensionWebGL1();o.endQueryEXT(o.TIME_ELAPSED_EXT)}else{var i=this.gl,a=this.getQueryTimerExtensionWebGL2();i.endQuery(a.TIME_ELAPSED_EXT)}},s.prototype.waitForQueryAndGetTime=function(o){return J(this,void 0,void 0,function(){var i=this;return K(this,function(a){switch(a.label){case 0:return[4,ht(function(){return i.disposed||i.isQueryAvailable(o,E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return a.sent(),[2,this.getQueryTime(o,E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},s.prototype.getQueryTime=function(o,i){if(0===i)return null;if(2===i){var a=this.gl;return a.getQueryParameter(o,a.QUERY_RESULT)/1e6}var c=this.getQueryTimerExtensionWebGL1();return c.getQueryObjectEXT(o,c.QUERY_RESULT_EXT)/1e6},s.prototype.isQueryAvailable=function(o,i){if(0===i)return!0;if(2===i){var a=this.gl,c=this.getQueryTimerExtensionWebGL2(),u=a.getQueryParameter(o,a.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(c.GPU_DISJOINT_EXT)),u&&!this.disjoint}return u=(c=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(o,c.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(c.GPU_DISJOINT_EXT)),u&&!this.disjoint},s.prototype.pollFence=function(o){var i=this;return new Promise(function(a){i.addItemToPoll(function(){return o.isFencePassed()},function(){return a()})})},s.prototype.pollItems=function(){for(var o=function(a){for(var c=0;c<a.length&&a[c]();++c);return c-1}(this.itemsToPoll.map(function(a){return a.isDoneFn})),i=0;i<=o;++i)(0,this.itemsToPoll[i].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(o+1)},s.prototype.addItemToPoll=function(o,i){var a=this;this.itemsToPoll.push({isDoneFn:o,resolveFn:i}),this.itemsToPoll.length>1||ht(function(){return a.pollItems(),0===a.itemsToPoll.length})},s.prototype.bindTextureToFrameBuffer=function(o){this.throwIfDisposed(),ot(this.gl,this.debug,o,this.framebuffer),this.debug&&An(this.gl)},s.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(ot(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&An(this.gl)):Vl(this.gl,this.debug,this.framebuffer)},s.prototype.downloadMatrixDriver=function(o,i){this.bindTextureToFrameBuffer(o);var a=i();return this.unbindTextureToFrameBuffer(),a},s.prototype.setOutputMatrixTextureDriver=function(o,i,a){this.throwIfDisposed();var c=this.gl;ot(c,this.debug,o,this.framebuffer),this.debug&&An(c),this.outputTexture=o,Zt(c,this.debug,function(){return c.viewport(0,0,i,a)}),Zt(c,this.debug,function(){return c.scissor(0,0,i,a)})},s.prototype.setOutputMatrixWriteRegionDriver=function(o,i,a,c){var u=this;this.throwIfDisposed(),Zt(this.gl,this.debug,function(){return u.gl.scissor(o,i,a,c)})},s.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},s.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},s}();function lv(s,o){if(s.length!==o.length)throw Error("Binary was compiled with "+s.length+" inputs, but was executed with "+o.length+" inputs");s.forEach(function(i,a){var c=i.logicalShape,u=o[a],p=u.shape;if(!ke(c,p))throw Error("Binary was compiled with different shapes than the current args. Shapes "+c+" and "+p+" must match");if(!i.isUniform||!u.isUniform){var m=i.texShape,g=u.isUniform?null:u.texData.texShape;if(!ke(m,g))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+m+" and "+g+" must match")}})}var iw=function(s,o,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;for(var c=i.inChannels,u=i.strideWidth,p=i.strideHeight,m=i.padInfo,g=i.outWidth,v=i.dilationWidth,y=i.dilationHeight,C=i.dataFormat,S=m.left,M=m.top,O=c*i.filterWidth,N=zo(),P="channelsLast"===C,B=P?0:1,W=P?1:2,G="",X=0;X<=1;X++)for(var Q=0;Q<=1;Q++)G+="\n          blockIndex = rc.y + "+Q+";\n          pos = rc.x + "+X+";\n\n          if(blockIndex < "+s[1]+" && pos < "+s[0]+") {\n            offsetY = int(blockIndex / ("+g+")) * "+p+" - "+M+";\n            d0 = offsetY + "+y+" * (pos / "+O+");\n\n            if(d0 < "+o[B]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+g+".) * "+u+". - "+S+".);\n              d1 = offsetX + "+v+" * (int(mod(float(pos), "+O+".) / "+c+".));\n\n              if(d1 < "+o[W]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+c+".));\n\n                if ("+P+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*X+Q)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*X+Q)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+G+"\n\n        "+N.output+" = result;\n      }\n    "},rw=function(s,o,i,a,c){this.variableNames=["x"],this.outputShape=[];var p=o,m=s[3]-1;this.outputShape=s;var g="float("+i+") + float("+a+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+p+"; j <= "+p+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+m+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===c?"inversesqrt("+g+")":1===c?"1.0/("+g+")":"exp(log("+g+") * float(-"+c+"));")+";\n        setOutput(val);\n      }\n    "},ow=function(s,o,i,a,c){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=s,this.depth=s[3],this.depthRadius=o,this.bias=i,this.alpha=a,this.beta=c,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+o+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+o+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+a+") * norm + float("+i+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+a+")\n                * float("+c+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+c+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Mk=function(s,o,i,a,c){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var p=o,m=s[3]-1;this.outputShape=s;var g="float("+i+") + float("+a+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+p+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+p+"; j <= "+p+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+m+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===c?"inversesqrt("+g+")":1===c?"1.0/("+g+")":"exp(log("+g+") * float(-"+c+"));")+";\n        setOutput(result);\n      }\n    "},um=function(s){this.variableNames=["dy","maxPos"],this.outputShape=s.inShape;var c=s.effectiveFilterHeight,u=s.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(c-1-s.padInfo.top)+", "+(u-1-s.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+c+";\n          wR += "+s.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+s.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(c*u-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+u+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},$c=function(s){this.variableNames=["dy","maxPos"],this.outputShape=s.inShape;var m=s.effectiveFilterDepth,g=s.effectiveFilterHeight,v=s.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(m-1-s.padInfo.front)+", "+(g-1-s.padInfo.top)+", "+(v-1-s.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+m+";\n           wD += "+s.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+s.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+s.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+g+";\n              wR += "+s.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+s.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+s.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+v+";\n                wC += "+s.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+s.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+s.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(m*g*v-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+g+" * "+v+" +\n                  wR * "+v+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},cv=function(s,o,i,a,c,u,p){void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===c&&(c=!1),void 0===u&&(u=null),void 0===p&&(p=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;var g=Math.ceil((i?s[1]:s[2])/2),v=i?"i * 2, rc.y":"rc.y, i * 2",y=a?"rc.z, i * 2":"i * 2, rc.z",C=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],S=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],M="",O="";u&&(M=p?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+u+"\n        }":"vec4 activation(vec4 x) {\n          "+u+"\n        }",O="result = activation(result);");var N=c?"result += getBiasAtOutCoords();":"";c&&this.variableNames.push("bias"),p&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+M+"\n\n      const float sharedDimension = "+g+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+g+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+v+");\n          vec4 b = getMatrixB(rc.x, "+y+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+C[0]+" * "+S[0]+");\n          result += ("+C[1]+" * "+S[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+N+"\n\n        "+O+"\n\n        setOutput(result);\n      }\n    "},aw=function(){function s(o,i,a){this.variableNames=["probs"],this.outputShape=[o,a],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(i-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(i-1)+"));\n      }\n    "}return s.prototype.getCustomSetupFunc=function(o){var i=this;return function(a,c){null==i.seedLoc&&(i.seedLoc=a.getUniformLocation(c,"seed")),a.gl.uniform1f(i.seedLoc,o)}},s}(),sw=function(s,o,i,a){this.variableNames=["indices"],this.outputShape=[s,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+a+"), float("+i+"),\n                      float(index == coords.y)));\n      }\n    "},_u=function(s){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=s;var m,v,y,o=s.length;if(0===o)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var i=ga("rc",o),a=Xi(o),c=function(m,g,v){if(1===m)return"rc > "+g[0];for(var y="",C=m-2;C<m;C++)y+=v[C]+" >= "+g[C],C<m-1&&(y+="||");return y}(o,s,i),u=function(m,g,v,y){if(1===m)return"";var C=y.slice(-2);return"\n    int r = "+C[0]+";\n    int c = "+C[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+g+";\n    bool rEdge = rp1 >= "+v+";\n  "}(o,s[s.length-1],s[s.length-2],i),p=(y=function(C,S){for(var M=[],O=0;O<=1;O++)for(var N=0;N<=1;N++){for(var P=(0===O?"r":"rp1")+", "+(0===N?"c":"cp1"),B=2;B<C;B++)P=S[S.length-1-B]+","+P;M.push(P)}return M}(v=(m=s).length,i),1===v?"getA(rc),\n            rc + 1 >= "+m[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+y[0]+"),\n          cEdge ? 0. : getA("+y[1]+"),\n          rEdge ? 0. : getA("+y[2]+"),\n          rEdge || cEdge ? 0. : getA("+y[3]+")");this.userCode="\n        void main() {\n          "+a+" rc = getOutputCoords();\n\n          if("+c+") {\n            setOutput(vec4(0));\n          } else {\n            "+u+"\n\n            setOutput(vec4("+p+"));\n          }\n        }\n      "}},Tk=function(s,o,i){this.variableNames=["x"],this.outputShape=o.map(function(g,v){return g[0]+s[v]+g[1]});var a=s.length,c=Xi(a),u=o.map(function(g){return g[0]}).join(","),p=o.map(function(g,v){return g[0]+s[v]}).join(","),m=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      "+c+" start = "+c+"("+u+");\n      "+c+" end = "+c+"("+p+");\n\n      void main() {\n        "+c+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+i+"));\n        } else {\n          "+c+" coords = outC - start;\n          setOutput(getX("+m+"));\n        }\n      }\n    ":"\n        int start = "+u+";\n        int end = "+p+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+i+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Fn=function(s,o,i){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o.map(function(P,B){return P[0]+s[B]+P[1]});for(var a=s.length,c=Xi(a),u=o.map(function(P){return P[0]}).join(","),p=o.map(function(P,B){return P[0]+s[B]}).join(","),m=ga("rc",a),g=ga("source",a),v=m[a-1]+" < "+this.outputShape[a-1],y=1===a?"source":"vec2("+g.slice(-2).join()+")",C=[c+" rc = outputLoc;",m[a-1]+" += 1;\n       if("+v+") {\n      ",1===a?"":"}\n       rc = outputLoc;\n       "+m[a-2]+" += 1;\n       if("+m[a-2]+" < "+this.outputShape[a-2]+") {",1===a?"":"  "+m[a-1]+" += 1;\n         if("+v+") {"],S=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",M="",O=0,N=1===a?2:4;O<N;O++)M+="\n        "+C[O]+"\n        if ("+S+") {\n          result["+O+"] = float("+i+");\n        } else {\n          "+c+" source = rc - start;\n          result["+O+"] = getChannel(getX("+g.join()+"), "+y+");\n        }\n      ";this.userCode="\n      const "+c+" start = "+c+"("+u+");\n      const "+c+" end = "+c+"("+p+");\n\n      void main() {\n        "+c+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(M+=1===a?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},np=function(s,o,i){if(this.variableNames=["x"],"avg"===o&&i)throw new Error("Cannot compute positions for average pool.");var a=s.filterWidth,c=s.strideHeight,u=s.strideWidth,p=s.dilationHeight,m=s.dilationWidth,g=s.effectiveFilterHeight,v=s.effectiveFilterWidth,y=s.padInfo.top,C=s.padInfo.left;this.outputShape=s.outShape;var S="avg"===o,M="0.0";if(S||(M="-1.0 / 1e-20"),i)this.userCode="\n        const ivec2 strides = ivec2("+c+", "+u+");\n        const ivec2 pads = ivec2("+y+", "+C+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+g+";\n              wR += "+p+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+s.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+v+";\n                wC += "+m+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+s.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+v+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var O=o+"("+o+"("+o+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===o&&(O="avgValue / count");var N=4*Math.floor(a/4),P=a%4,B="\n      if ("+S+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+c+", "+u+");\n      const ivec2 pads = ivec2("+y+", "+C+");\n      const float initializationValue = "+M+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+s.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+M+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+g+";\n            wR += "+p+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+s.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+N+"; wC += 4) {\n            int xC = xCCorner + wC * "+m+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+m+", d),\n              getValue(batch, xR, xC + 2 * "+m+", d),\n              getValue(batch, xR, xC + 3 * "+m+", d)\n            );\n\n            "+B+"\n          }\n\n          int xC = xCCorner + "+N+";\n          if ("+(1===P)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+B+"\n          } else if ("+(2===P)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+m+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+B+"\n          } else if ("+(3===P)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+m+", d),\n              getValue(batch, xR, xC + 2 * "+m+", d),\n              initializationValue\n            );\n\n            "+B+"\n          }\n        }\n        setOutput("+O+");\n      }\n    "}},dv=function(s,o,i){if(this.variableNames=["x"],"avg"===o&&i)throw new Error("Cannot compute positions for average pool.");var a=s.filterWidth,c=s.strideDepth,u=s.strideHeight,p=s.strideWidth,m=s.dilationDepth,g=s.dilationHeight,v=s.dilationWidth,y=s.effectiveFilterDepth,C=s.effectiveFilterHeight,S=s.effectiveFilterWidth,M=s.padInfo.front,O=s.padInfo.top,N=s.padInfo.left;this.outputShape=s.outShape;var P="avg"===o,B="0.0";if(P||(B="-1.0 / 1e-20"),i)this.userCode="\n        const ivec3 strides =\n            ivec3("+c+", "+u+", "+p+");\n        const ivec3 pads = ivec3("+M+", "+O+", "+N+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+y+";\n              wD += "+m+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+s.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+C+";\n                wR += "+g+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+s.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+S+";\n                  wC += "+v+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+s.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+C+" * "+S+" +\n                      wR * "+S+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var W=o+"("+o+"("+o+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===o&&(W="avgValue / count");var G=4*Math.floor(a/4),X=a%4,Q="\n      if ("+P+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+c+", "+u+", "+p+");\n      const ivec3 pads = ivec3("+M+", "+O+", "+N+");\n      const float initializationValue = "+B+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+s.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+B+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+y+";\n            wD += "+m+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+s.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+C+";\n            wR += "+g+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+s.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+G+"; wC += 4) {\n              int xC = xCCorner + wC * "+v+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+v+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+v+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+v+", ch)\n              );\n\n              "+Q+"\n            }\n\n            int xC = xCCorner + "+G+";\n            if ("+(1===X)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+Q+"\n            } else if ("+(2===X)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+v+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+Q+"\n            } else if ("+(3===X)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+v+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+v+", ch),\n                initializationValue\n              );\n\n              "+Q+"\n            }\n          }\n          setOutput("+W+");\n        }\n      }\n    "}},lw=function(s,o){this.variableNames=["x"];var i=s.windowSize,a=s.batchSize,c=s.inSize,u=Math.ceil(c/i);this.outputShape=[a,u];var p="0.0",m="";"prod"===o?p="1.0":"min"===o?(p="1.0 / 1e-20",m="min"):"max"===o&&(p="-1.0 / 1e-20",m="max");var g=o+"("+o+"("+o+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===o?g="sumValue":"prod"===o?g="prodValue":"all"===o?g="allValue":"any"===o&&(g="anyValue");var v=4*Math.floor(i/4),y=i%4,C="\n      if ("+("sum"===o)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===o)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+m+"(values, minMaxValue);\n      }\n    ",S="vec4";"all"===o?(p="1.0",C="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",S="bvec4"):"any"===o&&(p="0.0",C="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",S="bvec4");var M="";c%i>0&&(M="\n        if (inIdx < 0 || inIdx >= "+c+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+p+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+M+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+i+";\n\n        vec4 minMaxValue = vec4("+p+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+v+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+S+" values = "+S+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+C+"\n        }\n\n        int inIdx = inOffset + "+v+";\n        if ("+(1===y)+") {\n          "+S+" values = "+S+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+C+"\n        } else if ("+(2===y)+") {\n          "+S+" values = "+S+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+C+"\n        } else if ("+(3===y)+") {\n          "+S+" values = "+S+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+C+"\n        }\n        setOutput("+g+");\n      }\n    "},va=function(s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;for(var i="",a=0;a<4;a++){var c="thisRC = rc;";a%2==1&&(c+="thisRC.z += 1;"),a>1&&(c+="thisRC.y += 1;"),i+="\n        "+c+"\n        "+(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+a+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(a>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+vt(["r","c","d"],o)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+wi(s)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+s[1]+";\n        int cols = "+s[2]+";\n\n        "+i+"\n\n        setOutput(result);\n      }\n    "},vu=function(s,o,i){this.variableNames=["dy"],this.outputShape=[],this.outputShape=o.shape;var a=o.shape,c=a[1],u=a[2],p=s.shape,m=p[1],g=p[2],v=[i&&m>1?c-1:c,i&&g>1?u-1:u],y=[i&&m>1?m-1:m,i&&g>1?g-1:g],C=v[0]/y[0],S=v[1]/y[1],M=1/C,O=1/S,N=2*Math.ceil(M)+2,P=2*Math.ceil(O)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+C+");\n        const float widthScale = float("+S+");\n\n        const float invHeightScale = float("+M+");\n        const float invWidthScale = float("+O+");\n\n        const int winHeight = int("+N+");\n        const int winWidth = int("+P+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+m+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+g+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(c-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(u-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},bu=function(s,o,i,a){this.variableNames=["A"],this.outputShape=[];var u=s[1],p=s[2];this.outputShape=[s[0],o,i,s[3]];var g=[a&&o>1?u-1:u,a&&i>1?p-1:p],v=[a&&o>1?o-1:o,a&&i>1?i-1:i];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+g[0]/v[0]+",\n          "+g[1]/v[1]+");\n      const vec2 inputShapeRC = vec2("+u+".0, "+p+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},yu=function(s,o,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var u=s[1],p=s[2],m=s[3];this.outputShape=[s[0],o,i,m];var g=[a&&o>1?u-1:u,a&&i>1?p-1:p],v=[a&&o>1?o-1:o,a&&i>1?i-1:i];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+g[0]/v[0]+",\n          "+g[1]/v[1]+",\n          "+g[1]/v[1]+");\n      const vec3 inputShapeRC = vec3("+u+".0, "+p+".0,\n                                     "+p+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(m-1)+";\n        bool hasNextRow = coords.z < "+(i-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},cw=function(s,o,i){this.variableNames=["dy"],this.outputShape=[],this.outputShape=o.shape;var a=o.shape,c=a[1],u=a[2],p=s.shape,m=p[1],g=p[2],v=[i&&m>1?c-1:c,i&&g>1?u-1:u],y=[i&&m>1?m-1:m,i&&g>1?g-1:g],C=v[0]/y[0],S=v[1]/y[1],M=1/C,O=1/S,N=2*Math.ceil(M)+2,P=2*Math.ceil(O)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+C+");\n        const float widthScale = float("+S+");\n\n        const float invHeightScale = float("+M+");\n        const float invWidthScale = float("+O+");\n\n        const int winHeight = int("+N+");\n        const int winWidth = int("+P+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+m+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+g+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+v[0]+") *\n                (float(dyR) / float("+y[0]+"));\n\n            float sourceFracCol =\n                float("+v[1]+") *\n                  (float(dyC) / float("+y[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+c+") - 1),\n                "+i+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+u+") - 1),\n                "+i+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},uv=function(s,o,i,a){this.variableNames=["A"],this.outputShape=[];var u=s[1],p=s[2];this.outputShape=[s[0],o,i,s[3]];var g=[a&&o>1?u-1:u,a&&i>1?p-1:p],v=[a&&o>1?o-1:o,a&&i>1?i-1:i];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+g[0]/v[0]+",\n          "+g[1]/v[1]+");\n      const vec2 inputShapeRC = vec2("+u+".0, "+p+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(a?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},xu=function(s,o){this.variableNames=["x"];var i=s.length;if(i>4)throw new Error("WebGL backend: Reverse of rank-"+i+" tensor is not yet supported");if(this.outputShape=s,1!==i){var a=s.map(function(u,p){return-1!==o.indexOf(m=p)&&1!==s[m]?s[m]+" - coords["+m+"] - 1":"coords["+m+"]";var m}).join(","),c=Xi(i);this.userCode="\n      void main() {\n        "+c+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+s[0]+" - coord - 1));\n        }\n      "},sF=function(s,o){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var i=s.length;if(i>4)throw new Error("WebGL backend: Reverse of rank-"+i+" tensor is not yet supported");this.outputShape=s;var g,a=ga("rc",i),c=a[i-1]+" + 1 < "+this.outputShape[i-1],u=a[i-2]+" + 1 < "+this.outputShape[i-2],p=Xi(i);function m(g){var v=s.map(function(y,C){return M=g,-1!==o.indexOf(S=C)&&1!==s[S]?s[S]+" - "+M[S]+" - 1":""+M[S];var S,M});return"getChannel(getX("+v.join(",")+"), vec2("+v.slice(-2).join(",")+"))"}this.userCode=1===i?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+s[0]+" - rc - 1),\n            "+s[0]+" - rc - 1);\n          if("+c+"){\n              result.g = getChannel(getX("+s[0]+" - (rc  + 1) - 1),\n                "+s[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+p+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+m(a.slice())+";\n          if("+c+"){\n            result.g = "+((g=a.slice())[i-1]="("+g[i-1]+" + 1)",m(g)+";\n          }\n          if(")+u+") {\n            result.b = "+function(g){return g[i-2]="("+g[i-2]+" + 1)",m(g)}(a.slice())+";\n            if("+c+") {\n              result.a = "+function(g){return g[i-1]="("+g[i-1]+" + 1)",g[i-2]="("+g[i-2]+" + 1)",m(g)}(a.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},dw=function(s,o,i,a,c,u,p){void 0===p&&(p=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=u;var m=Xi(c.length),g=Xi(u.length),v="";1===i?v="i":2===i&&(v="i, j");var C="";1===a?C="i":2===a&&(C="i, coords[1]"),this.userCode="\n        "+m+" strides = "+m+"("+c+");\n\n        void main() {\n          "+g+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+s+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+o+"; j++) {\n              int index = round(getIndices("+v+"));\n              flattenedIndex += index * "+(o>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+C+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Ye=function(s,o){this.variableNames=["x","segmentIds"];var i=s.windowSize,a=s.batchSize,c=s.inSize,u=s.numSegments,p=u*Math.ceil(c/i);this.outputShape=[a,p];var m=4*Math.floor(i/4),g=i%4,v="\n        sumValue += dot(values, segFilter);\n    ",y="";c%i>0&&(y="\n        if (inIdx < 0 || inIdx >= "+c+") {\n          return initializationValue;\n        }\n      ");var C="";c%i>0&&(C="\n        if (inIdx < 0 || inIdx >= "+c+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+y+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+C+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+u+")) * float("+i+"));\n        int currentSeg = int(mod(float(outIdx), float("+u+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+m+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+v+"\n        }\n\n        int inIdx = inOffset + "+m+";\n        if ("+(1===g)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+v+"\n        } else if ("+(2===g)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+v+"\n        } else if ("+(3===g)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+v+"\n        }\n        setOutput(sumValue);\n      }\n    "},lF=function(s,o,i){var a,c;if(this.variableNames=["c","a","b"],this.outputShape=o,i>4)throw Error("Where for rank "+i+" is not yet supported");if(1===i)c="resRC",a="resRC";else{for(var u=["resRC.x","resRC.y","resRC.z","resRC.w"],p=[],m=[],g=0;g<o.length;g++)m.push(""+u[g]),g<s&&p.push(""+u[g]);a=p.join(),c=m.join()}var v=Xi(i);this.userCode="\n      void main() {\n        "+v+" resRC = getOutputCoords();\n        float cVal = getC("+a+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+c+"));\n        } else {\n          setOutput(getB("+c+"));\n        }\n      }\n    "},cF=function(){function s(o){this.variableNames=["source"],this.outputShape=o,this.rank=o.length;var i,a=Xi(this.rank),c="uniform int start["+this.rank+"];",u=function(p){if(1===p)return"sourceLoc";if(p<=6)return uw.slice(0,p).map(function(m){return"sourceLoc."+m}).join(",");throw Error("Slicing for rank "+p+" is not yet supported")}(this.rank);i="\n        "+a+" sourceLoc;\n        "+a+" coords = getOutputCoords();\n        "+o.map(function(p,m){return"sourceLoc."+uw[m]+" = start["+m+"] + coords."+uw[m]+";"}).join("\n")+"\n      ",this.userCode="\n      "+c+"\n      void main() {\n        "+i+"\n        setOutput(getSource("+u+"));\n      }\n    "}return s.prototype.getCustomSetupFunc=function(o){var i=this;if(o.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+o.length+")");return function(a,c){null==i.startLoc&&(i.startLoc=a.getUniformLocationNoThrow(c,"start"),null==i.startLoc)||a.gl.uniform1iv(i.startLoc,o)}},s}(),uw=["x","y","z","w","u","v"],dF=function(){function s(o){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o,this.rank=o.length;var i=Xi(this.rank),a=ga("coords",this.rank),c=ga("sourceLoc",this.rank),u=1===this.rank?"sourceLoc":"vec2("+c.slice(-2).join()+")",p="getChannel(getSource("+c.join()+"), "+u+")",m="\n      result.x = "+p+";\n      if (++"+a[this.rank-1]+" < "+o[this.rank-1]+") {\n        ++"+c[this.rank-1]+";\n        result.y = "+p+";\n        --"+c[this.rank-1]+";\n      }\n    ",g=1===this.rank?"":"\n      --"+a[this.rank-1]+";\n      if (++"+a[this.rank-2]+" < "+o[this.rank-2]+") {\n        ++"+c[this.rank-2]+";\n        result.z = "+p+";\n        if (++"+a[this.rank-1]+" < "+o[this.rank-1]+") {\n          ++"+c[this.rank-1]+";\n          result.w = "+p+";\n        }\n      }\n    ",v=this.rank<=4?"sourceLoc = coords +\n            "+i+"("+o.map(function(y,C){return"start["+C+"]"}).join()+");":o.map(function(y,C){return c[C]+" = "+a[C]+" + start["+C+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+i+" coords = getOutputCoords();\n        "+i+" sourceLoc;\n        "+v+"\n        vec4 result = vec4(0.);\n        "+m+"\n        "+g+"\n        setOutput(result);\n      }\n    "}return s.prototype.getCustomSetupFunc=function(o){var i=this;if(o.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+o.length+")");return function(a,c){null==i.startLoc&&(i.startLoc=a.getUniformLocationNoThrow(c,"start"),null==i.startLoc)||a.gl.uniform1iv(i.startLoc,o)}},s}(),uF=function(s,o,i){this.variableNames=["x"],this.outputShape=i;var a=i.length,c=Xi(i.length),u=Xi(i.length),p="";if(1===a)p="coords * strides + begin";else{var m=0;p=i.map(function(g,v){return m++,1===i.length?"coords * strides["+v+"] + begin["+v+"]":"coords["+(m-1)+"] * strides["+v+"] + begin["+v+"]"}).join(",")}this.userCode="\n      "+c+" begin = "+c+"("+s+");\n      "+c+" strides = "+c+"("+o+");\n\n      void main() {\n        "+u+" coords = getOutputCoords();\n        setOutput(getX("+p+"));\n      }\n    "},hF=function(){function s(o){this.gpgpu=o,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return s.prototype.acquireTexture=function(o,i,a){var c,u=Ik(i,a),p=wu(o,u,a);if(p in this.freeTextures||(this.freeTextures[p]=[]),p in this.usedTextures||(this.usedTextures[p]=[]),this.freeTextures[p].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var m=this.freeTextures[p].shift();return this.usedTextures[p].push(m),m}return this.numUsedTextures++,this.log(),u===Mi.PACKED_2X2_FLOAT32?c=this.gpgpu.createPackedMatrixTexture(o[0],o[1]):u===Mi.PACKED_2X2_FLOAT16?c=this.gpgpu.createFloat16PackedMatrixTexture(o[0],o[1]):u===Mi.UNPACKED_FLOAT32?c=this.gpgpu.createFloat32MatrixTexture(o[0],o[1]):u===Mi.UNPACKED_FLOAT16?c=this.gpgpu.createFloat16MatrixTexture(o[0],o[1]):u===Mi.PACKED_4X1_UNSIGNED_BYTE&&(c=this.gpgpu.createUnsignedBytesMatrixTexture(o[0],o[1])),this.usedTextures[p].push(c),c},s.prototype.releaseTexture=function(o,i,a,c){if(null!=this.freeTextures){var u=wu(i,Ik(a,c),c);u in this.freeTextures||(this.freeTextures[u]=[]),this.freeTextures[u].push(o),this.numFreeTextures++,this.numUsedTextures--;var p=this.usedTextures[u],m=p.indexOf(o);if(m<0)throw new Error("Cannot release a texture that was never provided by this texture manager");p.splice(m,1),this.log()}},s.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},s.prototype.getNumUsedTextures=function(){return this.numUsedTextures},s.prototype.getNumFreeTextures=function(){return this.numFreeTextures},s.prototype.dispose=function(){var o=this;if(null!=this.freeTextures){for(var i in this.freeTextures)this.freeTextures[i].forEach(function(a){o.gpgpu.deleteMatrixTexture(a)});for(var i in this.usedTextures)this.usedTextures[i].forEach(function(c){o.gpgpu.deleteMatrixTexture(c)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},s}();function Ik(s,o){if(s===fo.UPLOAD)return Mi.PACKED_2X2_FLOAT32;if(s===fo.RENDER||null==s)return i=o,E().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?i?Mi.PACKED_2X2_FLOAT32:Mi.UNPACKED_FLOAT32:i?Mi.PACKED_2X2_FLOAT16:Mi.UNPACKED_FLOAT16;var i;if(s===fo.DOWNLOAD||s===fo.PIXELS)return Mi.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+s)}function wu(s,o,i){return s[0]+"_"+s[1]+"_"+o+"_"+i}var pF=function(s,o){this.variableNames=["A"];for(var i=new Array(s.length),a=0;a<i.length;a++)i[a]=s[a]*o[a];this.outputShape=i,this.rank=i.length;var c=Xi(this.rank),u=function(p){var m=p.length;if(m>5)throw Error("Tile for rank "+m+" is not yet supported");if(1===m)return"imod(resRC, "+p[0]+")";for(var g=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],v=[],y=0;y<p.length;y++)v.push("imod("+g[y]+", "+p[y]+")");return v.join()}(s);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        setOutput(getA("+u+"));\n      }\n    "},fF=function(s,o){this.variableNames=["A"];for(var i=new Array(s.length),a=0;a<i.length;a++)i[a]=s[o[a]];this.outputShape=i,this.rank=i.length;var c=Xi(this.rank),u=function(p){var m=p.length;if(m>6)throw Error("Transpose for rank "+m+" is not yet supported");for(var g=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],v=new Array(m),y=0;y<p.length;y++)v[p[y]]=g[y];return v.join()}(o);this.userCode="\n    void main() {\n      "+c+" resRC = getOutputCoords();\n      setOutput(getA("+u+"));\n    }\n    "},eo=function(s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var i=new Array(s.length),a=0;a<i.length;a++)i[a]=s[o[a]];if(this.outputShape=i,this.rank=i.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var c=Xi(this.rank),u=K_("rc",this.rank),p=new Array(this.rank);for(a=0;a<o.length;a++)p[o[a]]=u[a];var m="vec2("+p.slice(-2).join()+")",g="++"+u[this.rank-1]+" < "+i[this.rank-1],v="getChannel(getA("+p.join()+"), "+m+")";this.userCode="\n    void main() {\n      "+c+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+v+";\n      if("+g+") {\n        result[1] = "+v+";\n      }\n      --"+u[this.rank-1]+";\n      if(++"+u[this.rank-2]+" < "+i[this.rank-2]+") {\n        result[2] = "+v+";\n        if("+g+") {\n          result[3] = "+v+";\n        }\n      }\n      setOutput(result);\n    }\n    "},ti=function(s,o){this.variableNames=["A"],this.outputShape=s,this.userCode="\n      float unaryOperation(float x) {\n        "+o+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Cr="if (isnan(x)) return x;",hv="return abs(x);",rp=Cr+"\n  return (x < 0.0) ? 0.0 : x;\n",Cu=Cr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",hw="return (x >= 0.0) ? x : (exp(x) - 1.0);",pw="return -x;",Ak="return ceil(x);",ba="return floor(x);",hm="return exp(x);",Kc="return exp(x) - 1.0;",Su="return x;",op="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Vo="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",pv="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Uo=function(s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+o+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Bk=function(s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=s;var o=s.length,i=ga("rc",o),a=Xi(o),c=function(m,g){if(1===m)return"rc";for(var v="",y=0;y<m;y++)v+=g[y],y<m-1&&(v+=",");return v}(o,i),u=i.slice(-2),p=o<=1?"rc":"vec2("+u.join(",")+")";this.userCode="\n      void main() {\n        "+a+" rc = getOutputCoords();\n        vec4 packedInput = getA("+c+");\n\n        setOutput(getChannel(packedInput, "+p+"));\n      }\n    "},ap={};function Wl(s,o){if(void 0===o&&(o=!1),"linear"===s)return"return x;";if("relu"===s)return o?op:rp;if("elu"===s)return o?pv:hw;if("relu6"===s)return o?Vo:Cu;if("prelu"===s)return o?im:Gx;throw new Error("Activation "+s+" has not been implemented for the WebGL backend.")}var fv=function(s){function o(i){var a,c=s.call(this)||this;if(c.gpgpu=i,c.pendingRead=new WeakMap,c.pendingDisposal=new WeakSet,c.dataRefCount=new WeakMap,c.numBytesInGPU=0,c.uploadWaitMs=0,c.downloadWaitMs=0,c.warnedAboutMemory=!1,c.pendingDeletes=0,c.disposed=!1,!E().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==i){var u=Zr(E().getNumber("WEBGL_VERSION"));c.binaryCache=((a=E().getNumber("WEBGL_VERSION"))in ap||(ap[a]={}),ap[a]),c.gpgpu=new nw(u),c.canvas=u.canvas,c.gpgpuCreatedLocally=!0}else c.binaryCache={},c.gpgpuCreatedLocally=!1,c.canvas=i.gl.canvas;return c.textureManager=new hF(c.gpgpu),c.numMBBeforeWarning=null==E().global.screen?1024:E().global.screen.height*E().global.screen.width*window.devicePixelRatio*600/1024/1024,c.texData=new zx(c,Ie),c}return j(o,s),o.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},o.prototype.fromPixels=function(i,a){if(null==i)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var c=typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement,u=i.data instanceof Uint8Array,p=typeof ImageData<"u"&&i instanceof ImageData,m=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,g=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,v=m?[i.videoWidth,i.videoHeight]:[i.width,i.height],y=v[0],C=v[1],S=[C,y],M=[C,y,a];if(!(c||u||p||m||g))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+i.constructor.name);(g||m)&&(null==this.fromPixels2DContext&&(this.fromPixels2DContext=Mc(E().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=y,this.fromPixels2DContext.canvas.height=C,this.fromPixels2DContext.drawImage(i,0,0,y,C),i=this.fromPixels2DContext.canvas);var O,N,P=this.makeTensorInfo(S,"int32");return this.texData.get(P.dataId).usage=fo.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(P.dataId),i),E().getBool("WEBGL_PACK")?(O=new Qx(M),N=this.compileAndRun(O,[P])):(O=new tv(M),N=this.compileAndRun(O,[P])),this.disposeData(P.dataId),N},o.prototype.write=function(i,a,c){if(E().getBool("DEBUG")&&this.checkNumericalProblems(i),"complex64"===c&&null!=i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var u={};return this.texData.set(u,{shape:a,dtype:c,values:i,usage:fo.UPLOAD}),u},o.prototype.move=function(i,a,c,u){if(E().getBool("DEBUG")&&this.checkNumericalProblems(a),"complex64"===u)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(i,{shape:c,dtype:u,values:a,usage:fo.UPLOAD})},o.prototype.readSync=function(i){var a=this.texData.get(i),c=a.values,u=a.dtype,p=a.complexTensors,g=a.shape;if(null!=a.slice){var y;y=a.isPacked?new Uo(g,Su):new ti(g,Su);var C=this.runWebGLProgram(y,[{dataId:i,shape:g,dtype:u}],u),S=this.readSync(C.dataId);return this.disposeData(C.dataId),S}if(null!=c)return this.convertAndCacheOnCPU(i);if("string"===u)return c;var M,O,N=null!=this.activeTimers;return N&&(M=Oe()),O="complex64"===u?Ko(p.real.dataSync(),p.imag.dataSync()):this.getValuesFromTexture(i),N&&(this.downloadWaitMs+=Oe()-M),this.convertAndCacheOnCPU(i,O)},o.prototype.read=function(i){return J(this,void 0,void 0,function(){var a,c,u,p,g,v,y,C,S,M,O,N,P,B,W,Q,se,ue,fe;return K(this,function(_e){switch(_e.label){case 0:if(this.pendingRead.has(i))return a=this.pendingRead.get(i),[2,new Promise(function(me){return a.push(me)})];if(c=this.texData.get(i),u=c.values,p=c.shape,g=c.dtype,v=c.complexTensors,y=c.isPacked,null!=c.slice)return C=y?new Uo(p,Su):new ti(p,Su),S=this.runWebGLProgram(C,[{dataId:i,shape:p,dtype:g}],g),M=this.read(S.dataId),this.disposeData(S.dataId),[2,M];if(null!=u)return[2,this.convertAndCacheOnCPU(i)];if(!E().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===E().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return O=null,"complex64"!==g&&E().get("WEBGL_BUFFER_SUPPORTED")&&(N=this.decode(i),P=this.texData.get(N.dataId),O=(fe=this.gpgpu).createBufferFromTexture.apply(fe,[P.texture].concat(ro(p)))),this.pendingRead.set(i,[]),"complex64"===g?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:_e.sent(),_e.label=2;case 2:return"complex64"!==g?[3,4]:[4,Promise.all([v.real.data(),v.imag.data()])];case 3:return W=_e.sent(),B=Ko(W[0],W[1]),[3,5];case 4:null==O?B=this.getValuesFromTexture(i):(Q=de(p),B=this.gpgpu.downloadFloat32MatrixFromBuffer(O,Q)),_e.label=5;case 5:return null!=N&&this.disposeData(N.dataId),se=this.convertAndCacheOnCPU(i,B),ue=this.pendingRead.get(i),this.pendingRead.delete(i),ue.forEach(function(me){return me(se)}),this.pendingDisposal.has(i)&&(this.pendingDisposal.delete(i),this.disposeData(i),this.pendingDeletes--),[2,se]}})})},o.prototype.checkNumericalProblems=function(i){if(null!=i)for(var a=0;a<i.length;a++){var c=i[a];if(!Ih(c))throw E().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+c+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+c+" cannot be represented on this device.")}},o.prototype.getValuesFromTexture=function(i){var a,c=this.texData.get(i),u=c.shape,p=c.dtype,m=c.isPacked,g=de(u);if(E().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var v=this.decode(i),y=this.texData.get(v.dataId),C=(a=this.gpgpu).downloadMatrixFromPackedTexture.apply(a,[y.texture].concat(ro(u))).subarray(0,g);return this.disposeData(v.dataId),C}var S=E().getBool("WEBGL_PACK")&&!0===m,M=S?Qr(u):u,O=S?new rF(M):new Ck(M),N=this.runWebGLProgram(O,[{shape:M,dtype:p,dataId:i}],"float32"),P=this.texData.get(N.dataId),B=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(P.texture,P.texShape[0],P.texShape[1]).subarray(0,g);return this.disposeData(N.dataId),B},o.prototype.time=function(i){return J(this,void 0,void 0,function(){var a,c,u,p,m,g,v;return K(this,function(y){switch(y.label){case 0:return a=this.activeTimers,c=[],u=!1,null==this.programTimersStack?(this.programTimersStack=c,u=!0):this.activeTimers.push(c),this.activeTimers=c,i(),p=we(this.activeTimers.map(function(C){return C.query})).filter(function(C){return null!=C}),m=we(this.activeTimers.map(function(C){return C.name})).filter(function(C){return null!=C}),this.activeTimers=a,u&&(this.programTimersStack=null),[4,Promise.all(p)];case 1:return g=y.sent(),v={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:H(g),getExtraProfileInfo:function(){return g.map(function(C,S){return{name:m[S],ms:C}}).map(function(C){return C.name+": "+C.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,v]}})})},o.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},o.prototype.startTimer=function(){return E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:Oe(),endMs:null}},o.prototype.endTimer=function(i){return E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),i):(i.endMs=Oe(),i)},o.prototype.getQueryTime=function(i){return J(this,void 0,void 0,function(){var a;return K(this,function(c){return E().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(i)]:[2,(a=i).endMs-a.startMs]})})},o.prototype.disposeData=function(i){if(!this.pendingDisposal.has(i)){if(this.pendingRead.has(i))return this.pendingDisposal.add(i),void this.pendingDeletes++;if(this.texData.has(i)){this.releaseGPUData(i);var a=this.texData.get(i).complexTensors;null!=a&&(a.real.dispose(),a.imag.dispose()),this.texData.delete(i)}}},o.prototype.releaseGPUData=function(i){var a=this.texData.get(i),c=a.texture,u=a.dtype,p=a.texShape,m=a.usage,g=a.isPacked,v=a.slice,y=v&&v.origDataId||i,C=this.dataRefCount.get(y);C>1?this.dataRefCount.set(y,C-1):(this.dataRefCount.delete(y),null!=c&&(this.numBytesInGPU-=this.computeBytes(p,u),this.textureManager.releaseTexture(c,p,m,g)));var S=this.texData.get(i);S.texture=null,S.texShape=null,S.isPacked=!1,S.slice=null},o.prototype.getTexture=function(i){return this.uploadToGPU(i),this.texData.get(i).texture},o.prototype.getDataInfo=function(i){return this.texData.get(i)},o.prototype.getCPUBackend=function(){return E().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Ie.findBackend("cpu")),this.cpuBackend):null},o.prototype.shouldExecuteOnCPU=function(i,a){var c=this;return void 0===a&&(a=128),null!=this.getCPUBackend()&&i.every(function(u){return null==c.texData.get(u.dataId).texture&&u.size<a})},o.prototype.getGPGPUContext=function(){return this.gpgpu},o.prototype.complex=function(i,a){var c=this.makeOutput(i.shape,"complex64");return this.texData.get(c.dataId).complexTensors={real:Ie.keep(i.clone()),imag:Ie.keep(a.clone())},c},o.prototype.real=function(i){return this.texData.get(i.dataId).complexTensors.real.clone()},o.prototype.imag=function(i){return this.texData.get(i.dataId).complexTensors.imag.clone()},o.prototype.slice=function(i,a,c){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.slice(i,a,c);if(0===de(c))return ei([],c,i.dtype);var u=this.texData.get(i.dataId).isPacked,p=Lx(i.shape,a,c);if(u||!p){var m=E().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dF(c):new cF(c),g=m.getCustomSetupFunc(a);return this.compileAndRun(m,[i],null,g)}return this.uploadToGPU(i.dataId),this.shallowSlice(i,a,c)},o.prototype.shallowSlice=function(i,a,c){var u=this.texData.get(i.dataId),p=this.makeOutput(c,i.dtype),m=this.texData.get(p.dataId);Object.assign(m,u),m.shape=c,m.dtype=i.dtype;var g=Bx(a,i.strides);u.slice&&(g+=u.slice.flatOffset),m.slice={flatOffset:g,origDataId:u.slice&&u.slice.origDataId||i.dataId};var v=this.dataRefCount.get(m.slice.origDataId)||1;return this.dataRefCount.set(m.slice.origDataId,v+1),p},o.prototype.stridedSlice=function(i,a,c,u){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.stridedSlice(i,a,c,u);var p=$_(a,c,u);if(p.some(function(g){return 0===g}))return ei([],p);var m=new uF(a,u,p);return this.compileAndRun(m,[i])},o.prototype.reverse=function(i,a){var c=E().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sF(i.shape,a):new xu(i.shape,a);return this.compileAndRun(c,[i])},o.prototype.concat=function(i,a){if("complex64"===i[0].dtype){var c=i.map(function(M){return Ft(M)}),u=i.map(function(M){return Xn(M)});return Cn(this.concat(c,a),this.concat(u,a))}if(this.shouldExecuteOnCPU(i))return this.cpuBackend.concat(i,a);if(1===i.length)return i[0];if(i.length>E().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var p=Math.floor(i.length/2),m=this.concat(i.slice(0,p),a),g=this.concat(i.slice(p),a);return this.concat([m,g],a)}if(E().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].rank>1){var v=new bk(i.map(function(M){return M.shape}),a);return this.compileAndRun(v,i)}var y=on(i.map(function(M){return M.shape}),a),C=i.map(function(M){return M.as2D(-1,de(M.shape.slice(a)))}),S=new J_(C.map(function(M){return M.shape}));return this.compileAndRun(S,C).reshape(y)},o.prototype.neg=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.neg(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,pw,i.dtype);var a=new ti(i.shape,pw);return this.compileAndRun(a,[i])},o.prototype.batchMatMul=function(i,a,c,u){var p=c?i.shape[2]:i.shape[1],m=u?a.shape[1]:a.shape[2],g=c?i.shape[1]:i.shape[2],v=i.shape[0];if((1===p||1===m)&&g>1e3){c&&(i=i.transpose([0,2,1])),u&&(a=a.transpose([0,2,1]));var y=1===m?i:i.as3D(v,g,1),C=1===m?2:1,S=1===m?a.as3D(v,1,g):a;return this.multiply(y,S).sum(C,!0)}var M=dr(i.dtype,a.dtype),O=new cv(i.shape,[v,p,m],c,u);return this.compileAndRun(O,[i,a],M)},o.prototype.fusedBatchMatMul=function(i){var a=i.a,c=i.b,u=i.transposeA,p=i.transposeB,m=i.bias,g=i.activation,v=i.preluActivationWeights,y=u?a.shape[2]:a.shape[1],C=p?c.shape[1]:c.shape[2],S=a.shape[0],M=dr(a.dtype,c.dtype),O=null!=m,N=null!=v,P=g?Wl(g,!0):null,B=new cv(a.shape,[S,y,C],u,p,O,P,N),W=[a,c];return m&&W.push(m),v&&W.push(v),this.compileAndRun(B,W,M)},o.prototype.multiply=function(i,a){if("complex64"===i.dtype){var c=this.texData.get(i.dataId),u=this.texData.get(a.dataId),p=new em("return areal * breal - aimag * bimag;",i.shape,a.shape),m=new em("return areal * bimag + aimag * breal;",i.shape,a.shape),g=[this.makeComplexComponentTensorInfo(i,c.complexTensors.real),this.makeComplexComponentTensorInfo(i,c.complexTensors.imag),this.makeComplexComponentTensorInfo(a,u.complexTensors.real),this.makeComplexComponentTensorInfo(a,u.complexTensors.imag)],v=this.compileAndRun(p,g),y=this.compileAndRun(m,g),C=this.complex(v,y);return v.dispose(),y.dispose(),C}if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.multiply(i,a);if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,nm,i.dtype);var S=new vr(nm,i.shape,a.shape);return this.compileAndRun(S,[i,a],i.dtype)},o.prototype.batchNormalization=function(i,a,c,u,p,m){var g=[i,a,c],v=null;null!=m&&(v=m.shape,g.push(m));var y=null;if(null!=p&&(y=p.shape,g.push(p)),E().getBool("WEBGL_PACK_NORMALIZATION")){var C=new Wx(i.shape,a.shape,c.shape,v,y,u);return this.compileAndRun(C,g)}var S=new gk(i.shape,a.shape,c.shape,v,y,u);return this.compileAndRun(S,g)},o.prototype.localResponseNormalization4D=function(i,a,c,u,p){var m=E().getBool("WEBGL_PACK_NORMALIZATION")?new Mk(i.shape,a,c,u,p):new rw(i.shape,a,c,u,p);return this.compileAndRun(m,[i])},o.prototype.LRNGrad=function(i,a,c,u,p,m,g){var v=new ow(a.shape,u,p,m,g);return this.compileAndRun(v,[a,c,i])},o.prototype.tile=function(i,a){if("string"===i.dtype){var c=this.readSync(i.dataId).map(function(p){return We(p)});return jn(Rt(i.shape,i.dtype,c),a)}var u=new pF(i.shape,a);return this.compileAndRun(u,[i])},o.prototype.pad=function(i,a,c){var u=E().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fn(i.shape,a,c):new Tk(i.shape,a,c);return this.compileAndRun(u,[i])},o.prototype.transpose=function(i,a){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.transpose(i,a);var c=E().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eo(i.shape,a):new fF(i.shape,a);return this.compileAndRun(c,[i])},o.prototype.gather=function(i,a,c){if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.gather(i,a,c);var u=new Jx(i.shape,a.size,c);return this.compileAndRun(u,[i,a])},o.prototype.batchToSpaceND=function(i,a,c){L(i.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var u=a.reduce(function(C,S){return C*S}),p=W_(i.shape,a,u),m=Bo(p.length,a.length),g=fa(i.shape,a,u),v=qf(c,a.length),y=cu(g,c,a.length);return i.reshape(p).transpose(m).reshape(g).slice(v,y)},o.prototype.spaceToBatchND=function(i,a,c){L(i.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var u=a.reduce(function(S,M){return S*M}),p=[[0,0]];p.push.apply(p,c);for(var m=1+a.length;m<i.shape.length;++m)p.push([0,0]);var g=i.pad(p),v=W_(g.shape,a,u,!1),y=Bo(v.length,a.length,!1),C=fa(g.shape,a,u,!1);return g.reshape(v).transpose(y).reshape(C)},o.prototype.reduce=function(i,a,c){var u=i.shape[0],p=i.shape[1],m=G_(p),g=new lw({windowSize:m,inSize:p,batchSize:u},a),v=this.compileAndRun(g,[i],c);return 1===v.shape[1]?v:this.reduce(v,a,c)},o.prototype.argReduce=function(i,a,c){void 0===c&&(c=null);var u=i.shape[0],p=i.shape[1];null!=c&&(u=c.shape[0],p=c.shape[1]);var m=G_(p),g=new mk({windowSize:m,inSize:p,batchSize:u},a,null==c),v=[i];null!=c&&v.push(c);var y=this.compileAndRun(g,v,"int32");return 1===y.shape[1]?y:this.argReduce(i,a,y)},o.prototype.argReducePacked=function(i,a,c){void 0===c&&(c=null);var u=null!=c?c.shape:i.shape,p=G_(u[u.length-1]),m=new jx(u,p,a,null==c),v=this.compileAndRun(m,null==c?[i]:[i,c],"int32");return v.rank===i.rank?this.argReducePacked(i,a,v):v},o.prototype.sum=function(i,a){lt("sum",a,i.rank);var c=Pe(i.shape,a),u=c[0],p=de(c[1]),m=i.as2D(-1,p),g=kc(i.dtype);return this.reduce(m,"sum",g).reshape(u)},o.prototype.prod=function(i,a){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.prod(i,a);var c=Pe(i.shape,a),u=c[0],p=de(c[1]),m=i.as2D(-1,p),g=kc(i.dtype);return this.reduce(m,"prod",g).reshape(u)},o.prototype.unsortedSegmentSum=function(i,a,c){var u=0,p=At([u],i.rank),m=i;null!=p&&(m=i.transpose(p),u=Dn(1,i.rank)[0]);var g=function(M,O,N){for(var P=[],B=M.length,W=0;W<B;W++)P.push(W!==O?M[W]:N);return P}(m.shape,u,c),v=de([m.shape[u]]),y=m.as2D(-1,v),C=kc(i.dtype),S=this.segOpCompute(y,"unsortedSegmentSum",a,C,c).reshape(g);return null!=p&&(S=S.transpose(vn(p))),S},o.prototype.segOpCompute=function(i,a,c,u,p){var m=i.shape[0],g=i.shape[1],v=function(S,M){var O,N=!1;for(S<=30?(O=S,N=!0):O=zr(S,Math.floor(Math.sqrt(S)));!N;)O>M||O===S?N=!0:O=zr(S,O+1);return O}(g,p),y=new Ye({windowSize:v,inSize:g,batchSize:m,numSegments:p},a),C=this.compileAndRun(y,[i,c],u);return C.shape[1]===p?C:(c=au(0,p).tile([g/v]),this.segOpCompute(C,a,c,u,p))},o.prototype.argMinMaxReduce=function(i,a,c){var u=[a];if(lt("arg"+c.charAt(0).toUpperCase()+c.slice(1),u,i.rank),!E().getBool("WEBGL_PACK_REDUCE")||i.rank<=2){var p=Pe(i.shape,u),m=p[0],g=de(p[1]),v=i.as2D(-1,g);return this.argReduce(v,c).reshape(m)}return this.argReducePacked(i,c)},o.prototype.argMin=function(i,a){return this.argMinMaxReduce(i,a,"min")},o.prototype.argMax=function(i,a){return this.argMinMaxReduce(i,a,"max")},o.prototype.cumsum=function(i,a,c,u){if(a!==i.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(i.rank-1)+" but got axis="+a);var p=new am(i.shape,c,u);return this.compileAndRun(p,[i])},o.prototype.equal=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(equal(a, b));\n","bool");var c=new vr("return float(a == b);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.notEqual=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(notEqual(a, b));\n","bool");var c=new vr("return float(a != b);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.less=function(i,a){if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.less(i,a);if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(lessThan(a, b));\n","bool");var c=new vr("return float(a < b);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.lessEqual=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(lessThanEqual(a, b));\n","bool");var c=new vr("return float(a <= b);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.greater=function(i,a){if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.greater(i,a);if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(greaterThan(a, b));\n","bool");var c=new vr("return float(a > b);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.greaterEqual=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var c=new vr("return float(a >= b);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.logicalNot=function(i){var a=new ti(i.shape,"return float(!(x >= 1.0));");return this.compileAndRun(a,[i])},o.prototype.logicalAnd=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var c=new vr("return float(a >= 1.0 && b >= 1.0);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.logicalOr=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var c=new vr("return float(a >= 1.0 || b >= 1.0);",i.shape,a.shape);return this.compileAndRun(c,[i,a],"bool")},o.prototype.select=function(i,a,c){var u=new lF(i.rank,a.shape,a.rank);return this.compileAndRun(u,[i,a,c],dr(a.dtype,c.dtype))},o.prototype.where=function(i){Lh("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var a=i.dataSync();return Hx(i.shape,a)},o.prototype.topk=function(i,a,c){return Y_(i.dataSync(),i.shape,i.dtype,a)},o.prototype.min=function(i,a){lt("min",a,i.rank);var c=Pe(i.shape,a),u=c[0],p=de(c[1]),m=i.as2D(-1,p);return this.reduce(m,"min",m.dtype).reshape(u)},o.prototype.minimum=function(i,a){if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.minimum(i,a);var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",i.shape,a.shape):new vr("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.mod=function(i,a){var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",i.shape,a.shape):new vr("if (b == 0.0) return NAN;\n  return mod(a, b);",i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.max=function(i,a){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.max(i,a);lt("max",a,i.rank);var c=Pe(i.shape,a),u=c[0],p=de(c[1]),m=i.as2D(-1,p);return this.reduce(m,"max",m.dtype).reshape(u)},o.prototype.maximum=function(i,a){if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.maximum(i,a);var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",i.shape,a.shape):new vr("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.all=function(i,a){lt("all",a,i.rank);var c=Pe(i.shape,a),u=c[0],p=de(c[1]),m=i.as2D(-1,p);return this.reduce(m,"all",m.dtype).reshape(u)},o.prototype.any=function(i,a){lt("any",a,i.rank);var c=Pe(i.shape,a),u=c[0],p=de(c[1]),m=i.as2D(-1,p);return this.reduce(m,"any",m.dtype).reshape(u)},o.prototype.squaredDifference=function(i,a){var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("return (a - b) * (a - b);",i.shape,a.shape):new vr("return (a - b) * (a - b);",i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.realDivide=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var c=new vr("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",i.shape,a.shape);return this.compileAndRun(c,[i,a],"float32")},o.prototype.floorDiv=function(i,a){if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var c=new vr("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",i.shape,a.shape);return this.compileAndRun(c,[i,a],"int32")},o.prototype.add=function(i,a){if("complex64"===i.dtype&&"complex64"===a.dtype)return this.complexSeparableBinaryOp(i,a,Gh);if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.add(i,a);var c=dr(i.dtype,a.dtype);if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,Gh,c);var u=new vr(Gh,i.shape,a.shape);return this.compileAndRun(u,[i,a],c)},o.prototype.packedUnaryOp=function(i,a,c){var u=new Uo(i.shape,a);return this.compileAndRun(u,[i],c)},o.prototype.packedBinaryOp=function(i,a,c,u,p){void 0===p&&(p=!1);var m=new Bs(c,i.shape,a.shape,p);return this.compileAndRun(m,[i,a],u)},o.prototype.complexSeparableBinaryOp=function(i,a,c){var u=this,p=this.texData.get(i.dataId),m=this.texData.get(a.dataId),g=[[p.complexTensors.real,m.complexTensors.real],[p.complexTensors.imag,m.complexTensors.imag]].map(function(S){var M=S[0],O=S[1],N=u.makeComplexComponentTensorInfo(i,M),P=u.makeComplexComponentTensorInfo(a,O),B=new vr(c,i.shape,a.shape);return u.compileAndRun(B,[N,P],dr(M.dtype,O.dtype))}),v=g[0],y=g[1],C=this.complex(v,y);return v.dispose(),y.dispose(),C},o.prototype.makeComplexComponentTensorInfo=function(i,a){return{dataId:a.dataId,dtype:a.dtype,shape:i.shape}},o.prototype.addN=function(i){if(1===i.length)return i[0];if(i.length>E().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(i.length/2),c=this.addN(i.slice(0,a)),u=this.addN(i.slice(a));return this.addN([c,u])}var p=i.map(function(v){return v.dtype}).reduce(function(v,y){return dr(v,y)}),m=i.map(function(v){return v.shape}),g=E().getBool("WEBGL_PACK")?new fk(i[0].shape,m):new pk(i[0].shape,m);return this.compileAndRun(g,i,p)},o.prototype.subtract=function(i,a){if("complex64"===i.dtype&&"complex64"===a.dtype)return this.complexSeparableBinaryOp(i,a,tm);if(this.shouldExecuteOnCPU([i,a]))return this.cpuBackend.subtract(i,a);var c=dr(i.dtype,a.dtype);if(E().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(i,a,tm,i.dtype);var u=new vr(tm,i.shape,a.shape);return this.compileAndRun(u,[i,a],c)},o.prototype.pow=function(i,a){var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",i.shape,a.shape):new vr("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",i.shape,a.shape),u=dr(i.dtype,a.dtype);return this.compileAndRun(c,[i,a],u)},o.prototype.ceil=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.ceil(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,Ak,i.dtype);var a=new ti(i.shape,Ak);return this.compileAndRun(a,[i])},o.prototype.floor=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.floor(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,ba,i.dtype);var a=new ti(i.shape,ba);return this.compileAndRun(a,[i])},o.prototype.sign=function(i){var a=new ti(i.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(a,[i])},o.prototype.isNaN=function(i){var a=new ti(i.shape,"return float(isnan(x));");return this.compileAndRun(a,[i],"bool")},o.prototype.isInf=function(i){var a=new ti(i.shape,"return float(isinf(x));");return this.compileAndRun(a,[i],"bool")},o.prototype.isFinite=function(i){var a=new ti(i.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(a,[i],"bool")},o.prototype.round=function(i){var a=new ti(i.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(a,[i])},o.prototype.exp=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.exp(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,hm,i.dtype);var a=new ti(i.shape,hm);return this.compileAndRun(a,[i])},o.prototype.expm1=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.expm1(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,Kc,i.dtype);var a=new ti(i.shape,Kc);return this.compileAndRun(a,[i])},o.prototype.log=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.log(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",i.dtype);var a=new ti(i.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(a,[i])},o.prototype.log1p=function(i){var a=new ti(i.shape,"return log(1.0 + x);");return this.compileAndRun(a,[i])},o.prototype.sqrt=function(i){var a=new ti(i.shape,"return sqrt(x);");return this.compileAndRun(a,[i])},o.prototype.rsqrt=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.rsqrt(i);var a=new ti(i.shape,"return inversesqrt(x);");return this.compileAndRun(a,[i])},o.prototype.reciprocal=function(i){var a=new ti(i.shape,"return 1.0 / x;");return this.compileAndRun(a,[i])},o.prototype.relu=function(i){var a;return a=E().getBool("WEBGL_PACK")?new Uo(i.shape,op):new ti(i.shape,rp),this.compileAndRun(a,[i])},o.prototype.relu6=function(i){var a;return a=E().getBool("WEBGL_PACK")?new Uo(i.shape,Vo):new ti(i.shape,Cu),this.compileAndRun(a,[i])},o.prototype.prelu=function(i,a){var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs(im,i.shape,a.shape):new vr(Gx,i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.elu=function(i){if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,pv,i.dtype);var a=new ti(i.shape,hw);return this.compileAndRun(a,[i])},o.prototype.eluDer=function(i,a){var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",i.shape,a.shape):new vr("return (b >= 1.0) ? a : a * (b + 1.0);",i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.selu=function(i){var a=new ti(i.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(a,[i])},o.prototype.int=function(i){var a=new ti(i.shape,"return float(int(x));");return this.compileAndRun(a,[i],"int32")},o.prototype.clip=function(i,a,c){var u,p=(u=E().getBool("WEBGL_PACK_CLIP")?new qx(i.shape):new $x(i.shape)).getCustomSetupFunc(a,c);return this.compileAndRun(u,[i],null,p)},o.prototype.abs=function(i){if(this.shouldExecuteOnCPU([i]))return this.cpuBackend.abs(i);if(E().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(i,hv,i.dtype);var a=new ti(i.shape,hv);return this.compileAndRun(a,[i])},o.prototype.complexAbs=function(i){var a=this.texData.get(i.dataId),c=new Yx(i.shape),u=[this.makeComplexComponentTensorInfo(i,a.complexTensors.real),this.makeComplexComponentTensorInfo(i,a.complexTensors.imag)];return this.compileAndRun(c,u)},o.prototype.sigmoid=function(i){var a=new ti(i.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(a,[i])},o.prototype.softplus=function(i){var a=new ti(i.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(a,[i])},o.prototype.sin=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(a,[i])},o.prototype.cos=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(a,[i])},o.prototype.tan=function(i){var a=new ti(i.shape,"return tan(x);");return this.compileAndRun(a,[i])},o.prototype.asin=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(a,[i])},o.prototype.acos=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(a,[i])},o.prototype.atan=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(a,[i])},o.prototype.atan2=function(i,a){var c=E().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bs("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",i.shape,a.shape):new vr("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",i.shape,a.shape);return this.compileAndRun(c,[i,a])},o.prototype.sinh=function(i){var a=new ti(i.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(a,[i])},o.prototype.cosh=function(i){var a=new ti(i.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(a,[i])},o.prototype.tanh=function(i){var a=new ti(i.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(a,[i])},o.prototype.asinh=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(a,[i])},o.prototype.acosh=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(a,[i])},o.prototype.atanh=function(i){var a=new ti(i.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(a,[i])},o.prototype.erf=function(i){var a=new ti(i.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(a,[i])},o.prototype.step=function(i,a){var u,c=new ti(i.shape,(void 0===(u=a)&&(u=0),Cr+"\n    return x > 0.0 ? 1.0 : float("+u+");\n  "));return this.compileAndRun(c,[i])},o.prototype.conv2dByMatMul=function(i,a,c,u,p,m){var g=i.shape,v=this.texData.get(i.dataId),M="channelsLast"===c.dataFormat,N=g[2]%2!=0&&!!v.isPacked;if((1==g[0]*g[1]*g[2]||1===c.outChannels)&&c.inChannels>1e3||!E().getBool("WEBGL_LAZILY_UNPACK")||!E().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!N){var B=this.reshape(i,[1,M?g[0]*g[1]*g[2]:g[0]*g[2]*g[3],c.inChannels]),W=this.reshape(a,[1,c.inChannels,c.outChannels]);return this.reshape(this.fusedBatchMatMul({a:B,b:W,transposeA:!1,transposeB:!1,bias:u,activation:p,preluActivationWeights:m}),c.outShape)}var X={dataId:i.dataId,shape:[1,M?g[0]*g[1]*(g[2]+1):g[0]*g[2]*(g[3]+1),c.inChannels],dtype:i.dtype},Q=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,L(pl(v.shape,X.shape),function(){return"packed reshape "+v.shape+" to "+X.shape+" isn't free"});var se=this.reshape(a,[1,c.inChannels,c.outChannels]),ue=this.fusedBatchMatMul({a:X,b:se,transposeA:!1,transposeB:!1,bias:u,activation:p,preluActivationWeights:m}),fe=this.texData.get(ue.dataId);return L(fe.isPacked,function(){return"batchMatMul result is expected to be packed"}),v.shape=Q,fe.shape=c.outShape,Ie.makeTensorFromDataId(ue.dataId,c.outShape,ue.dtype)},o.prototype.conv2dWithIm2Row=function(i,a,c,u,p,m){var C=c.outWidth,S=c.outHeight,M="channelsLast"===c.dataFormat,O=c.filterWidth*c.filterHeight*c.inChannels,N=S*C,P=[O,N],B=i.squeeze([0]),W=a.reshape([1,O,-1]),G=new iw(P,B.shape,c),X=this.compileAndRun(G,[B]).reshape([1,P[0],P[1]]),Q=null!=u,se=null!=m,ue=p?Wl(p,!0):null,fe=new cv(X.shape,[1,N,c.outChannels],!0,!1,Q,ue,se),_e=[X,W];return u&&_e.push(u),se&&_e.push(m),this.compileAndRun(fe,_e).reshape(M?[1,S,C,c.outChannels]:[1,c.outChannels,S,C])},o.prototype.fusedConv2d=function(i){var a=i.input,c=i.filter,u=i.convInfo,p=i.bias,m=i.activation,g=i.preluActivationWeights;if(1===u.filterHeight&&1===u.filterWidth&&1===u.dilationHeight&&1===u.dilationWidth&&1===u.strideHeight&&1===u.strideWidth&&("SAME"===u.padInfo.type||"VALID"===u.padInfo.type))return this.conv2dByMatMul(a,c,u,p,m,g);if(E().getBool("WEBGL_CONV_IM2COL")&&1===a.shape[0])return this.conv2dWithIm2Row(a,c,u,p,m,g);var v=null!=p,y=null!=g,C=m?Wl(m,!1):null,S=new Kx(u,v,C,y),M=[a,c];return p&&M.push(p),g&&M.push(g),this.compileAndRun(S,M)},o.prototype.conv2d=function(i,a,c){if(1===c.filterHeight&&1===c.filterWidth&&1===c.dilationHeight&&1===c.dilationWidth&&1===c.strideHeight&&1===c.strideWidth&&("SAME"===c.padInfo.type||"VALID"===c.padInfo.type))return this.conv2dByMatMul(i,a,c);if(E().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])return this.conv2dWithIm2Row(i,a,c);var u=new Kx(c);return this.compileAndRun(u,[i,a])},o.prototype.conv2dDerInput=function(i,a,c){var u=new Gc(c);return this.compileAndRun(u,[i,a])},o.prototype.conv2dDerFilter=function(i,a,c){var u=new Xo(c);return this.compileAndRun(u,[i,a])},o.prototype.fusedDepthwiseConv2D=function(i){var a,c=i.input,u=i.filter,p=i.convInfo,m=i.bias,g=i.activation,v=i.preluActivationWeights,y=E().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels==1,C=g?Wl(g,y):null,S=[c,u],M=null!=m,O=null!=v;return M&&S.push(m),O&&S.push(v),y?(a=new Yh(p,M,C,O),this.compileAndRun(a,S)):(a=new Xx(p,M,C,O),this.compileAndRun(a,S))},o.prototype.depthwiseConv2D=function(i,a,c){var u;return E().getBool("WEBGL_PACK_DEPTHWISECONV")&&c.strideWidth<=2&&c.outChannels/c.inChannels==1?(u=new Yh(c),this.compileAndRun(u,[i,a])):(u=new Xx(c),this.compileAndRun(u,[i,a]))},o.prototype.depthwiseConv2DDerInput=function(i,a,c){var u=new qh(c);return this.compileAndRun(u,[i,a])},o.prototype.depthwiseConv2DDerFilter=function(i,a,c){var u=new yk(c);return this.compileAndRun(u,[i,a])},o.prototype.conv3d=function(i,a,c){var u=new xk(c);return this.compileAndRun(u,[i,a])},o.prototype.conv3dDerInput=function(i,a,c){var u=new $h(c);return this.compileAndRun(u,[i,a])},o.prototype.conv3dDerFilter=function(i,a,c){var u=new br(c);return this.compileAndRun(u,[i,a])},o.prototype.maxPool=function(i,a){var c=new np(a,"max",!1);return this.compileAndRun(c,[i])},o.prototype.avgPool=function(i,a){var c=new np(a,"avg",!1);return this.compileAndRun(c,[i],"float32")},o.prototype.maxPoolBackprop=function(i,a,c,u){var p=new np(u,"max",!0),m=this.compileAndRun(p,[a]),g=new um(u),v=this.compileAndRun(g,[i,m],a.dtype);return m.dispose(),v},o.prototype.avgPoolBackprop=function(i,a,c){var u=new mu(c);return this.compileAndRun(u,[i],a.dtype)},o.prototype.cast=function(i,a){return Yo(i,a,this)},o.prototype.unstack=function(i,a){for(var c=i.shape[a],u=new Array(i.rank-1),p=0,m=0;m<i.rank;m++)m!==a&&(u[p++]=i.shape[m]);var g=new Array(i.rank).fill(0),v=i.shape.slice();v[a]=1;var y=new Array(c);for(m=0;m<y.length;m++)g[a]=m,y[m]=this.slice(i,g,v).reshape(u);return y},o.prototype.avgPool3d=function(i,a){var c=new dv(a,"avg",!1);return this.compileAndRun(c,[i],"float32")},o.prototype.avgPool3dBackprop=function(i,a,c){var u=new yl(c);return this.compileAndRun(u,[i],a.dtype)},o.prototype.maxPool3d=function(i,a){var c=new dv(a,"max",!1);return this.compileAndRun(c,[i],"float32")},o.prototype.maxPool3dBackprop=function(i,a,c,u){var p=new dv(u,"max",!0),m=this.compileAndRun(p,[a]),g=new $c(u),v=this.compileAndRun(g,[i,m],a.dtype);return m.dispose(),v},o.prototype.reshape=function(i,a){var c=this.texData.get(i.dataId);if(c.isPacked&&!pl(i.shape,a)&&(null===c.texture||!pl(c.shape,a))){var u=this.packedReshape(i,a);return Ie.makeTensorFromDataId(u.dataId,u.shape,u.dtype)}return Xf(i,a)},o.prototype.resizeBilinear=function(i,a,c,u){var p=E().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new yu(i.shape,a,c,u):new bu(i.shape,a,c,u);return this.compileAndRun(p,[i])},o.prototype.resizeBilinearBackprop=function(i,a,c){var u=new vu(i,a,c);return this.compileAndRun(u,[i])},o.prototype.resizeNearestNeighbor=function(i,a,c,u){var p=new uv(i.shape,a,c,u);return this.compileAndRun(p,[i])},o.prototype.resizeNearestNeighborBackprop=function(i,a,c){var u=new cw(i,a,c);return this.compileAndRun(u,[i])},o.prototype.multinomial=function(i,a,c,u){var p=a?i:du(i),v=new aw(p.shape[0],p.shape[1],c),y=v.getCustomSetupFunc(u);return this.compileAndRun(v,[p],"int32",y)},o.prototype.oneHot=function(i,a,c,u){var p=new sw(i.size,a,c,u);return this.compileAndRun(p,[i])},o.prototype.diag=function(i){var a=new Kh(i.size);return this.compileAndRun(a,[i])},o.prototype.nonMaxSuppression=function(i,a,c,u,p){return Lh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Ps(i.dataSync(),a.dataSync(),c,u,p)},o.prototype.cropAndResize=function(i,a,c,u,p,m){var g=new om(i.shape,a.shape,u,p,m);return this.compileAndRun(g,[i,a,c])},o.prototype.depthToSpace=function(i,a,c){L(a>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+a});var u=i.shape[0],v=("NHWC"===c?i.shape[1]:i.shape[2])*a,y=("NHWC"===c?i.shape[2]:i.shape[3])*a,C=("NHWC"===c?i.shape[3]:i.shape[1])/(a*a),S=new gu("NHWC"===c?[u,v,y,C]:[u,C,v,y],a,c);return this.compileAndRun(S,[i])},o.prototype.split=function(i,a,c){return Jf(i,a,c)},o.prototype.scatterND=function(i,a,c){var u=Yf(0,i,c),p=u.sliceRank,m=u.numUpdates,g=u.sliceSize,v=u.strides,y=u.outputSize,C=[y/g,g],S=i.reshape([m,p]),M=a.reshape([m,g]);if(0===y)return Xf(ei([]),c);var O=Nt(0),N=new dw(m,p,S.rank,M.rank,v,C);return this.compileAndRun(N,[M,S,O]).reshape(c)},o.prototype.sparseToDense=function(i,a,c,u){var p=Yf(0,i,c),C=new dw(p.numUpdates,p.sliceRank,i.rank,a.rank,p.strides,[p.outputSize,1],!1);return this.compileAndRun(C,[a,i,u]).reshape(c)},o.prototype.fft=function(i){return this.fftImpl(i,!1)},o.prototype.ifft=function(i){return this.fftImpl(i,!0)},o.prototype.fftImpl=function(i,a){var c=this.texData.get(i.dataId),u=new Ek("return real * expR - imag * expI;",i.shape,a),p=new Ek("return real * expI + imag * expR;",i.shape,a),m=[this.makeComplexComponentTensorInfo(i,c.complexTensors.real),this.makeComplexComponentTensorInfo(i,c.complexTensors.imag)],g=this.compileAndRun(u,m),v=this.compileAndRun(p,m),y=this.complex(g,v).as2D(i.shape[0],i.shape[1]);return g.dispose(),v.dispose(),y},o.prototype.gatherND=function(i,a){var c=a.shape,u=c[c.length-1],p=zh(i,a),m=p[0],g=p[1],v=p[2],y=p[3],C=a.reshape([g,u]),S=i.reshape([i.size/v,v]),M=new Xh(u,y,[g,v]);return this.compileAndRun(M,[S,C]).reshape(m)},o.prototype.fill=function(i,a,c){if("string"===(c=c||Pt(a))){var u=ze(c,de(i));return u.fill(a),Ie.makeTensor(u,i,c,this)}var p=new aF(i,a),m=p.getCustomSetupFunc(a);return this.compileAndRun(p,[],c,m)},o.prototype.onesLike=function(i){if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(i.shape,1,i.dtype)},o.prototype.zerosLike=function(i){return this.fill(i.shape,"string"===i.dtype?"":0,i.dtype)},o.prototype.linspace=function(i,a,c){return Zf(i,a,c)},o.prototype.makeTensorInfo=function(i,a){var c=this.write(null,i,a);return this.texData.get(c).usage=null,{dataId:c,shape:i,dtype:a}},o.prototype.makeOutput=function(i,a){var c=this.makeTensorInfo(i,a).dataId;return Ie.makeTensorFromDataId(c,i,a,this)},o.prototype.unpackTensor=function(i){var a=new Bk(i.shape);return this.runWebGLProgram(a,[i],i.dtype)},o.prototype.packTensor=function(i){var a=new _u(i.shape);return this.runWebGLProgram(a,[i],i.dtype,null,!0)},o.prototype.packedReshape=function(i,a){var c=[Oc(i.shape)].concat(No(i.shape)),u={dtype:i.dtype,shape:c,dataId:i.dataId},p=[Oc(a)].concat(No(a)),m=new va(p,c),g=this.runWebGLProgram(m,[u],i.dtype,null,!0);return{dataId:g.dataId,shape:a,dtype:g.dtype}},o.prototype.decode=function(i){var a,c=this.texData.get(i),u=c.isPacked,p=c.shape,m=c.dtype,g=Qr(p);return a=u?new wk(g):new Zx(g),{dtype:m,shape:p,dataId:this.runWebGLProgram(a,[{shape:g,dtype:m,dataId:i}],m,null,!0).dataId}},o.prototype.runWebGLProgram=function(i,a,c,u,p){var m=this;void 0===p&&(p=!1);var g=this.makeTensorInfo(i.outputShape,c),v=this.texData.get(g.dataId);if(i.packedOutput&&(v.isPacked=!0),i.outPackingScheme===Fo.DENSE){var y=ro(i.outputShape);v.texShape=y.map(function(G){return 2*G})}if(null!=i.outTexUsage&&(v.usage=i.outTexUsage),0===de(g.shape))return v.values=pt(g.dtype,0),g;var C=[],S=a.map(function(G){if("complex64"===G.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var X=m.texData.get(G.dataId);if(null==X.texture){if(!i.packedInputs&&de(G.shape)<=E().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:G.shape,texData:null,isUniform:!0,uniformValues:X.values};i.packedInputs&&(X.isPacked=!0,X.shape=G.shape)}else if(!!X.isPacked!=!!i.packedInputs)G=X.isPacked?m.unpackTensor(G):m.packTensor(G),C.push(G),X=m.texData.get(G.dataId);else if(X.isPacked&&!pl(X.shape,G.shape)){var Q=G,se=G.shape;G.shape=X.shape,G=m.packedReshape(G,se),C.push(G),X=m.texData.get(G.dataId),Q.shape=se}return m.uploadToGPU(G.dataId),{shape:G.shape,texData:X,isUniform:!1}});this.uploadToGPU(g.dataId);var M,G,se,O={shape:g.shape,texData:v,isUniform:!1},N=(G=i,se="",S.concat(O).forEach(function(_e){se+=_e.shape+"_"+(_e.isUniform?"uniform":_e.texData.texShape)+"_"+(null!=_e.texData&&null!=_e.texData.slice&&_e.texData.slice.flatOffset>0)}),G.constructor.name+"_"+se+"_"+G.userCode),P=this.getAndSaveBinary(N,function(){return function(G,X,Q,se){var ue=X.userCode,fe=Q.map(function(je,ut){var at={logicalShape:je.shape,texShape:je.isUniform?null:je.texData.texShape,isUniform:je.isUniform,isPacked:!je.isUniform&&je.texData.isPacked,flatOffset:null};return null!=je.texData&&null!=je.texData.slice&&je.texData.slice.flatOffset>0&&(at.flatOffset=je.texData.slice.flatOffset),{name:X.variableNames[ut],shapeInfo:at}}),_e=fe.map(function(je){return je.shapeInfo}),me={logicalShape:se.shape,texShape:se.texData.texShape,isUniform:!1,isPacked:se.texData.isPacked,flatOffset:null},Me=hs(fe,me,ue,X.packedInputs),Te=G.createProgram(Me),Ue=null,Xe=G.getUniformLocation(Te,"NAN",!1);1===E().getNumber("WEBGL_VERSION")&&(Ue=G.getUniformLocation(Te,"INFINITY",!1));for(var et={},it=0;it<X.variableNames.length;it++){var nt=X.variableNames[it];et[nt]=G.getUniformLocation(Te,nt,!1),et["offset"+nt]=G.getUniformLocation(Te,"offset"+nt,!1)}return{program:X,source:Me,webGLProgram:Te,uniformLocations:et,inShapeInfos:_e,outShapeInfo:me,infLoc:Ue,nanLoc:Xe}}(m.gpgpu,i,S,O)}),B=null!=this.activeTimers;if(B&&(M=this.startTimer()),function(G,X,Q,se,ue){lv(X.inShapeInfos,Q),lv([X.outShapeInfo],[se]);var fe=se.texData.texture,_e=se.texData.texShape;se.texData.isPacked?G.setOutputPackedMatrixTexture(fe,_e[0],_e[1]):G.setOutputMatrixTexture(fe,_e[0],_e[1]),G.setProgram(X.webGLProgram),1===E().getNumber("WEBGL_VERSION")&&null!==X.infLoc&&G.gl.uniform1f(X.infLoc,1/0),null!==X.nanLoc&&G.gl.uniform1f(X.nanLoc,NaN),Q.forEach(function(me,Me){var Te=X.program.variableNames[Me],Ue=X.uniformLocations[Te],Xe=X.uniformLocations["offset"+Te];if(null!=Ue)if(me.isUniform)if(de(me.shape)<2)G.gl.uniform1f(Ue,me.uniformValues[0]);else{var et=me.uniformValues;et instanceof Float32Array||(et=new Float32Array(et)),G.gl.uniform1fv(Ue,et)}else null!=me.texData.slice&&null!=Xe&&G.gl.uniform1i(Xe,me.texData.slice.flatOffset),G.setInputMatrixTexture(me.texData.texture,Ue,Me)}),ue?.(G,X.webGLProgram),G.executeProgram()}(this.gpgpu,P,S,O,u),C.forEach(function(G){return m.disposeData(G.dataId)}),B&&(M=this.endTimer(M),this.activeTimers.push({name:i.constructor.name,query:this.getQueryTime(M)})),!E().getBool("WEBGL_LAZILY_UNPACK")&&v.isPacked&&!1===p){var W=this.unpackTensor(g);return this.disposeData(g.dataId),W}return g},o.prototype.compileAndRun=function(i,a,c,u,p){void 0===p&&(p=!1);var m=this.runWebGLProgram(i,a,c=c||a[0].dtype,u,p);return Ie.makeTensorFromDataId(m.dataId,m.shape,m.dtype)},o.prototype.getAndSaveBinary=function(i,a){return i in this.binaryCache||(this.binaryCache[i]=a()),this.binaryCache[i]},o.prototype.getTextureManager=function(){return this.textureManager},o.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},o.prototype.floatPrecision=function(){var i=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=$e(function(){if(!E().get("WEBGL_RENDER_FLOAT32_ENABLED")){var a=E().getBool("DEBUG");E().set("DEBUG",!1);var c=i.abs(Nt(1e-8)).dataSync()[0];if(E().set("DEBUG",a),c>0)return 32}return 16})),this.floatPrecisionValue},o.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},o.prototype.uploadToGPU=function(i){var a,c=this.texData.get(i),u=c.shape,p=c.dtype,m=c.values,v=c.usage,y=c.isPacked;if(null==c.texture){var C,S=null!=this.activeTimers;S&&(C=Oe());var M=c.texShape;if(null==M&&(M=N_(u,y),c.texShape=M),null!=m){var O=Qr(u),N=void 0,P=M[1],B=M[0],W=m instanceof Uint8Array;y?(P=(a=Ar(M[0],M[1]))[0],N=new oF(O,[B=a[1],P],W)):N=new ev(O,[B,P],W);var G=this.makeTensorInfo([B,P],p);this.texData.get(G.dataId).usage=W?fo.PIXELS:fo.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(G.dataId),P,B,m);var X=this.runWebGLProgram(N,[G],p,null,!0),Q=this.texData.get(X.dataId);c.texture=Q.texture,c.texShape=Q.texShape,c.isPacked=Q.isPacked,c.usage=Q.usage,this.disposeData(G.dataId),this.texData.delete(X.dataId),c.values=null,S&&(this.uploadWaitMs+=Oe()-C)}else{var se=this.acquireTexture(M,v,p,y);c.texture=se}}},o.prototype.convertAndCacheOnCPU=function(i,a){var c=this.texData.get(i),u=c.dtype;return this.releaseGPUData(i),null!=a&&(c.values=function(p,m){if("float32"===m||"complex64"===m)return p;if("int32"===m||"bool"===m){for(var g="int32"===m?new Int32Array(p.length):new Uint8Array(p.length),v=0;v<g.length;++v)g[v]=Math.round(p[v]);return g}throw new Error("Unknown dtype "+m)}(a,u)),c.values},o.prototype.acquireTexture=function(i,a,c,u){if(this.numBytesInGPU+=this.computeBytes(i,c),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var p=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+p+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(i,a,u)},o.prototype.computeBytes=function(i,a){return i[0]*i[1]*Di(a)},o}(vl);Aa()&&Ie.registerBackend("webgl",function(){return new fv},2);var mv=ee({square_:function(s){var o=F(s,"x","square");return Ie.runKernelFunc(function(a,c){return c([o]),a.square(o)},{x:o},function(a,c){var u=c[0];return{x:function(){return a.mul(u.toFloat().mul(2))}}},"Square",{},[o],[])}}),Gl=ee({abs_:function(s){var o=F(s,"x","abs");return"complex64"===o.dtype?Ie.runKernelFunc(function(i){return i.complexAbs(o)},{$x:o}):Ie.runKernelFunc(function(i,a){var c=i.abs(o);return a([o]),c},{x:o},function(i,a){var c=a[0];return{x:function(){return i.mul(c.toFloat().step(-1))}}},"Abs")}}),$l=ee({acos_:function(s){var o=F(s,"x","acos");return Ie.runKernelFunc(function(i,a){var c=i.acos(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.divStrict(Nt(1).sub(c.toFloat().square()).sqrt()).neg()}}})}}),Xc=ee({acosh_:function(s){var o=F(s,"x","acosh");return Ie.runKernelFunc(function(i,a){var c=i.acosh(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.divStrict(c.toFloat().square().sub(1).sqrt())}}})}}),gv=ee({asin_:function(s){var o=F(s,"x","asin");return Ie.runKernelFunc(function(i,a){var c=i.asin(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.divStrict(Nt(1).sub(c.toFloat().square()).sqrt())}}})}}),mw=ee({asinh_:function(s){var o=F(s,"x","asinh");return Ie.runKernelFunc(function(i,a){var c=i.asinh(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.divStrict(Nt(1).add(c.toFloat().square()).sqrt())}}})}}),mm=ee({atan_:function(s){var o=F(s,"x","atan");return Ie.runKernelFunc(function(i,a){var c=i.atan(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.toFloat().square().add(1))}}})}}),_v=ee({atanh_:function(s){var o=F(s,"x","atanh");return Ie.runKernelFunc(function(i,a){var c=i.atanh(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(Nt(1).sub(c.toFloat().square()))}}})}}),gw=ee({ceil_:function(s){var o=F(s,"x","ceil");return Ie.runKernelFunc(function(i){return i.ceil(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),Zo=ee({clipByValue_:function(s,o,i){var a=F(s,"x","clipByValue");return L(o<=i,function(){return"Error in clip: min ("+o+") must be less than or equal to max ("+i+")."}),Ie.runKernelFunc(function(c,u){var p=c.clip(a,o,i);return u([a]),p},{$x:a},function(c,u){var p=u[0];return{$x:function(){return c.where(p.greaterEqual(o).logicalAnd(p.lessEqual(i)),$n(c))}}})}}),vv=ee({cos_:function(s){var o=F(s,"x","cos");return Ie.runKernelFunc(function(i,a){var c=i.cos(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return c.toFloat().sin().neg().mul(i)}}})}}),bv=ee({cosh_:function(s){var o=F(s,"x","cosh");return Ie.runKernelFunc(function(i,a){var c=i.cosh(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return c.toFloat().sinh().mulStrict(i)}}})}}),Du=ee({erf_:function(s){var o=F(s,"x","erf");return L("int32"===o.dtype||"float32"===o.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===o.dtype&&(o=o.toFloat()),Ie.runKernelFunc(function(i,a){var c=i.erf(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.mul(c.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),gm=ee({exp_:function(s){var o=F(s,"x","exp");return Ie.runKernelFunc(function(i,a){var c=i.exp(o);return a([c]),c},{$x:o},function(i,a){return{$x:function(){return i.mulStrict(a[0])}}})}}),yv=ee({expm1_:function(s){var o=F(s,"x","expm1");return Ie.runKernelFunc(function(i,a){var c=i.expm1(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.mul(c.exp())}}})}}),sp=ee({floor_:function(s){var o=F(s,"x","floor");return Ie.runKernelFunc(function(i){return i.floor(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),ql=ee({log_:function(s){var o=F(s,"x","log");return Ie.runKernelFunc(function(i,a){var c=i.log(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.toFloat())}}})}}),_m=ee({log1p_:function(s){var o=F(s,"x","log1p");return Ie.runKernelFunc(function(i,a){var c=i.log1p(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.add(1))}}})}}),zk=ee({logSigmoid_:function(s){var o=F(s,"x","logSigmoid");return Ie.runKernelFunc(function(i,a){var c=i.softplus(o.neg()).neg();return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.mul(c.neg().sigmoid())}}})}}),Zc=ee({neg_:function(s){var o=F(s,"x","neg");return Ie.runKernelFunc(function(i){return i.neg(o)},{$x:o},function(i){return{$x:function(){return i.neg()}}})}}),xv=ee({reciprocal_:function(s){var o=F(s,"x","reciprocal");return Ie.runKernelFunc(function(i,a){var c=i.reciprocal(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.square().neg())}}})}}),lp=ee({round_:function(s){var o=F(s,"x","round");return Ie.runKernelFunc(function(i){return i.round(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),wv=ee({rsqrt_:function(s){var o=F(s,"x","rsqrt");return Ie.runKernelFunc(function(i,a){var c=i.rsqrt(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.pow(1.5).mul(2)).neg()}}})}}),Cv=ee({sigmoid_:function(s){var o=F(s,"x","sigmoid");return Ie.runKernelFunc(function(i,a){var c=i.sigmoid(o);return a([c]),c},{x:o},function(i,a){var c=a[0];return{x:function(){return i.mul(c.mul(Nt(1).sub(c)))}}},"Sigmoid")}}),cp=ee({sign_:function(s){var o=F(s,"x","sign");return Ie.runKernelFunc(function(i){return i.sign(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),Vk=ee({isNaN_:function(s){var o=F(s,"x","isNaN");return Ie.runKernelFunc(function(i){return i.isNaN(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),Uk=ee({isInf_:function(s){var o=F(s,"x","isInf");return Ie.runKernelFunc(function(i){return i.isInf(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),Hk=ee({isFinite_:function(s){var o=F(s,"x","isFinite");return Ie.runKernelFunc(function(i){return i.isFinite(o)},{$x:o},function(i){return{$x:function(){return $n(i)}}})}}),_w=ee({sin_:function(s){var o=F(s,"x","sin");return Ie.runKernelFunc(function(i,a){var c=i.sin(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return c.toFloat().cos().mul(i)}}})}}),vw=ee({sinh_:function(s){var o=F(s,"x","sinh");return Ie.runKernelFunc(function(i,a){var c=i.sinh(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return c.toFloat().cosh().mulStrict(i)}}})}}),dp=ee({softplus_:function(s){var o=F(s,"x","softplus");return Ie.runKernelFunc(function(i,a){var c=i.softplus(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.mul(c.sigmoid())}}})}}),Eu=ee({sqrt_:function(s){var o=F(s,"x","sqrt");return Ie.runKernelFunc(function(i,a){var c=i.sqrt(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.toFloat().sqrt().mul(2))}}})}}),vm=ee({step_:function(s,o){void 0===o&&(o=0);var i=F(s,"x","step");return Ie.runKernelFunc(function(a){return a.step(i,o)},{$x:i},function(a){return{$x:function(){return $n(a)}}})}}),bm=ee({tan_:function(s){var o=F(s,"x","tan");return Ie.runKernelFunc(function(i,a){var c=i.tan(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.div(c.cos().square())}}})}}),up=ee({tanh_:function(s){var o=F(s,"x","tanh");return Ie.runKernelFunc(function(i,a){var c=i.tanh(o);return a([c]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return Nt(1).sub(c.square()).mulStrict(i)}}})}});function Sv(s,o,i,a,c,u){var p,m,g=F(s,"x","batchNorm"),v=F(o,"mean","batchNorm"),y=F(i,"variance","batchNorm");return null!=c&&(p=F(c,"scale","batchNorm")),null!=a&&(m=F(a,"offset","batchNorm")),L(2===g.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+g.rank+"."}),L(2===v.rank||1===v.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+v.rank+"."}),L(2===y.rank||1===y.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+y.rank+"."}),null!=p&&L(2===p.rank||1===p.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+p.rank+"."}),null!=m&&L(2===m.rank||1===m.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+m.rank+"."}),hp(g,v,y,m,p,u)}function Qo(s,o,i,a,c,u){var p,m,g=F(s,"x","batchNorm"),v=F(o,"mean","batchNorm"),y=F(i,"variance","batchNorm");return null!=c&&(p=F(c,"scale","batchNorm")),null!=a&&(m=F(a,"offset","batchNorm")),L(3===g.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+g.rank+"."}),L(3===v.rank||1===v.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+v.rank+"."}),L(3===y.rank||1===y.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+y.rank+"."}),null!=p&&L(3===p.rank||1===p.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+p.rank+"."}),null!=m&&L(3===m.rank||1===m.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+m.rank+"."}),hp(g,v,y,m,p,u)}function bw(s,o,i,a,c,u){var p,m,g=F(s,"x","batchNorm"),v=F(o,"mean","batchNorm"),y=F(i,"variance","batchNorm");return null!=c&&(p=F(c,"scale","batchNorm")),null!=a&&(m=F(a,"offset","batchNorm")),L(4===g.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+g.rank+"."}),L(4===v.rank||1===v.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+v.rank+"."}),L(4===y.rank||1===y.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+y.rank+"."}),null!=p&&L(4===p.rank||1===p.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+p.rank+"."}),null!=m&&L(4===m.rank||1===m.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+m.rank+"."}),hp(g,v,y,m,p,u)}function hp(s,o,i,a,c,u){null==u&&(u=.001);var p,m,g,v=F(s,"x","batchNorm"),y=F(o,"mean","batchNorm"),C=F(i,"variance","batchNorm");return null!=c&&(p=F(c,"scale","batchNorm")),null!=a&&(m=F(a,"offset","batchNorm")),L(y.rank===C.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),L(null==m||y.rank===m.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),L(null==p||y.rank===p.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),g=0===v.rank||1===v.rank?v.as4D(1,1,1,v.size):2===v.rank?v.as4D(1,1,v.shape[0],v.shape[1]):3===v.rank?v.as4D(1,v.shape[0],v.shape[1],v.shape[2]):v,Ie.runKernelFunc(function(M,O){var N=M.batchNormalization(g,ym(y),ym(C),u,ym(p),ym(m));return O([v,y,C,p]),N},{x:v,mean:y,variance:C,scale:p,offset:m},function(M,O){var P=O[0],B=O[1],W=O[2],X=O[3]??Nt(1),Q=Fr(B.shape,g.shape),se=[];if(1===B.rank){for(var ue=0;ue<g.shape.length-1;++ue)se.push(g.shape[ue]);se.push(1)}var fe=P.sub(B),_e=M.mul(X),me=wv(W.add(Nt(u))),Me=me.mul(me).mul(me).mul(Nt(-.5));return{x:function(){return 1===B.rank?M.mul(us(me.as4D(1,1,1,B.shape[0]),se)).mul(X).reshape(P.shape):M.mul(me).mul(X).reshape(P.shape)},mean:function(){var Te=me.mul(Nt(-1)).mul(_e);return 1===B.rank&&(Te=Te.sum(Q)),Te.reshape(B.shape)},variance:function(){var Te=Me.mul(fe).mul(_e);return 1===B.rank&&(Te=Te.sum(Q)),Te.reshape(B.shape)},scale:function(){var Te=fe.mul(me),Ue=M.mul(Te);return 1===B.rank&&(Ue=Ue.sum(Q)),Ue.reshape(B.shape)},offset:function(){var Te=M;return 1===B.rank&&(Te=Te.sum(Q)),Te.reshape(B.shape)}}},"BatchNormalization",{varianceEpsilon:u},[v,y,C,p]).reshape(v.shape)}function ym(s){return null==s?null:0===s.rank?s.as1D():1===s.rank?s:2===s.rank?s.as4D(1,1,s.shape[0],s.shape[1]):3===s.rank?s.as4D(1,s.shape[0],s.shape[1],s.shape[2]):s}function pp(){St("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var xm=ee({batchNormalization2d_:function(s,o,i,a,c,u){return void 0===a&&(a=.001),pp(),Sv(s,o,i,u,c,a)}}),yw=ee({batchNormalization3d_:function(s,o,i,a,c,u){return void 0===a&&(a=.001),pp(),Qo(s,o,i,u,c,a)}}),xw=ee({batchNormalization4d_:function(s,o,i,a,c,u){return void 0===a&&(a=.001),pp(),bw(s,o,i,u,c,a)}}),ww=ee({batchNormalization_:function(s,o,i,a,c,u){return void 0===a&&(a=.001),pp(),hp(s,o,i,u,c,a)}}),wm=ee({batchNorm_:hp}),Dv=ee({batchNorm2d_:Sv}),Ev=ee({batchNorm3d_:Qo}),Ho=ee({batchNorm4d_:bw}),fs=ee({logicalAnd_:function(s,o){var i=F(s,"a","logicalAnd","bool"),a=F(o,"b","logicalAnd","bool");return _i(i.shape,a.shape),Ie.runKernelFunc(function(c){return c.logicalAnd(i,a)},{$a:i,$b:a})}}),Cm=ee({logicalNot_:function(s){var o=F(s,"x","logicalNot","bool");return Ie.runKernelFunc(function(i){return i.logicalNot(o)},{$x:o})}}),ku=ee({logicalOr_:function(s,o){var i=F(s,"a","logicalOr","bool"),a=F(o,"b","logicalOr","bool");return _i(i.shape,a.shape),Ie.runKernelFunc(function(c){return c.logicalOr(i,a)},{$a:i,$b:a})}}),vo=ee({logicalXor_:function(s,o){var i=F(s,"a","logicalXor","bool"),a=F(o,"b","logicalXor","bool");return _i(i.shape,a.shape),ku(s,o).logicalAnd(fs(s,o).logicalNot())}}),Na=ee({where_:function(s,o,i){var a=F(o,"a","where"),c=F(i,"b","where"),u=F(s,"condition","where","bool");return oe(a.shape,c.shape,"Error in where: "),1===u.rank?L(u.shape[0]===a.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):oe(u.shape,c.shape,"Error in where: "),Ie.runKernelFunc(function(p,m){var g=p.select(u,a,c);return m([u]),g},{$condition:u,$a:a,$b:c},function(p,m){var g=m[0];return{$condition:function(){return $n(g).toFloat()},$a:function(){return p.mul(g.cast(p.dtype))},$b:function(){return p.mul(g.logicalNot().cast(p.dtype))}}})}}),fp=function(s){return J(this,void 0,void 0,function(){var o,i,a;return K(this,function(c){switch(c.label){case 0:return[4,(o=F(s,"condition","whereAsync","bool")).data()];case 1:return i=c.sent(),a=Hx(o.shape,i),s!==o&&o.dispose(),[2,a]}})})},ai=ee({add_:function(s,o){var i,a=F(s,"a","add"),c=F(o,"b","add");i=er(a,c);var u=_i((a=i[0]).shape,(c=i[1]).shape);return Ie.runKernelFunc(function(p){return p.add(a,c)},{a,b:c},function(p){return{a:function(){var m=p,g=Fr(a.shape,u);return g.length>0&&(m=m.sum(g)),m.reshape(a.shape)},b:function(){var m=p,g=Fr(c.shape,u);return g.length>0&&(m=m.sum(g)),m.reshape(c.shape)}}},"Add")}}),kv=ee({addN_:function(s){L(Array.isArray(s),function(){return"The argument passed to tf.addN() must be a list of tensors"}),L(s.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+s.length});var o=s.map(function(c,u){return F(c,"tensors"+u,"addN")}),i=o[0];return o.forEach(function(c){if(c.dtype!==i.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),o.forEach(function(c){if(!ke(c.shape,i.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),Ie.runKernelFunc(function(c){return c.addN(o)},o,function(c){var u={};return o.forEach(function(p,m){u[m]=function(){return c.clone()}}),u})}}),Mv=ee({addStrict_:function(s,o){var i=F(s,"a","addStrict"),a=F(o,"b","addStrict");return oe(i.shape,a.shape,"Error in addStrict: "),i.add(a)}}),Tv=ee({atan2_:function(s,o){var i,a=F(s,"a","atan2"),c=F(o,"b","atan2");i=er(a,c);var u=_i((a=i[0]).shape,(c=i[1]).shape);return Ie.runKernelFunc(function(p,m){var g=p.atan2(a,c);return m([a,c]),g},{$a:a,$b:c},function(p,m){var g=m[0],v=m[1];return{$a:function(){var y=ai(g.square(),v.square()),C=p.mul(v.div(y)),S=Fr(g.shape,u);return S.length>0&&(C=C.sum(S)),C.reshape(g.shape)},$b:function(){var y=ai(g.square(),v.square()),C=Zc(p.mul(g.div(y))),S=Fr(v.shape,u);return S.length>0&&(C=C.sum(S)),C.reshape(v.shape)}}})}}),bo=ee({div_:function(s,o){var i,a=F(s,"a","div"),c=F(o,"b","div");if(i=er(a,c),c=i[1],"int32"===(a=i[0]).dtype&&"int32"===c.dtype)return mp(a,c);var u=_i(a.shape,c.shape);return Ie.runKernelFunc(function(p,m){var g=p.realDivide(a,c);return m([a,c]),g},{a,b:c},function(p,m){var g=m[0],v=m[1];return{a:function(){var y=p.div(v.toFloat()),C=Fr(g.shape,u);return C.length>0?y.sum(C).reshape(g.shape):y},b:function(){var y=p.mul(g.toFloat()),C=Fr(v.shape,u);C.length>0&&(y=y.sum(C).reshape(v.shape));var S=v.square();return y.div(S.toFloat()).neg()}}},"Div")}}),Cw=ee({divStrict_:function(s,o){var i=F(s,"a","div"),a=F(o,"b","div");return oe(i.shape,a.shape,"Error in divideStrict: "),i.div(a)}}),mp=ee({floorDiv_:function(s,o){var i,a=F(s,"a","floorDiv"),c=F(o,"b","floorDiv");i=er(a,c);var u=_i((a=i[0]).shape,(c=i[1]).shape);return Ie.runKernelFunc(function(p,m){var g=p.floorDiv(a,c);return m([a,c]),g},{$a:a,$b:c},function(p,m){var g=m[0],v=m[1];return{$a:function(){var y=p.div(v.toFloat()),C=Fr(g.shape,u);return C.length>0?y.sum(C).reshape(g.shape):y},$b:function(){var y=p.mul(g.toFloat()),C=Fr(v.shape,u);C.length>0&&(y=y.sum(C).reshape(v.shape));var S=v.square();return y.div(S.toFloat()).neg()}}})}}),zs=ee({maximum_:function(s,o){var i,a=F(s,"a","maximum"),c=F(o,"b","maximum");return i=er(a,c),c=i[1],"bool"===(a=i[0]).dtype&&(a=a.toInt(),c=c.toInt()),_i(a.shape,c.shape),Ie.runKernelFunc(function(u,p){var m=u.maximum(a,c);return p([a,c]),m},{$a:a,$b:c},function(u,p){var m=p[0],g=p[1];return{$a:function(){return u.mul(m.greaterEqual(g).toFloat())},$b:function(){return u.mul(m.less(g).toFloat())}}})}}),Sw=ee({maximumStrict_:function(s,o){var i=F(s,"a","maximumStrict"),a=F(o,"b","maximumStrict");return oe(i.shape,a.shape,"Error in maximumStrict: "),i.maximum(a)}}),Yl=ee({minimum_:function(s,o){var i,a=F(s,"a","minimum"),c=F(o,"b","minimum");return i=er(a,c),c=i[1],"bool"===(a=i[0]).dtype&&(a=a.toInt(),c=c.toInt()),_i(a.shape,c.shape),Ie.runKernelFunc(function(u,p){var m=u.minimum(a,c);return p([a,c]),m},{$a:a,$b:c},function(u,p){var m=p[0],g=p[1];return{$a:function(){return u.mul(m.lessEqual(g).toFloat())},$b:function(){return u.mul(m.greater(g).toFloat())}}})}}),Sm=ee({minimumStrict_:function(s,o){var i=F(s,"a","minimumStrict"),a=F(o,"b","minimumStrict");return oe(i.shape,a.shape,"Error in minimumStrict: "),i.minimum(a)}}),Iv=ee({mod_:function(s,o){var i,a=F(s,"a","mod"),c=F(o,"b","mod");i=er(a,c);var u=_i((a=i[0]).shape,(c=i[1]).shape);return Ie.runKernelFunc(function(p,m){var g=p.mod(a,c);return m([a,c]),g},{$a:a,$b:c},function(p,m){var g=m[0],v=m[1];return{$a:function(){var y=Fr(g.shape,u);return y.length>0?p.sum(y).reshape(g.shape):p},$b:function(){var y=p.mul(g.div(v).floor().neg()),C=Fr(v.shape,u);return C.length>0?y.sum(C).reshape(v.shape):y}}})}}),Mu=ee({modStrict_:function(s,o){var i=F(s,"a","modStrict"),a=F(o,"b","modStrict");return oe(i.shape,a.shape,"Error in modStrict: "),i.mod(a)}}),Vn=ee({mul_:function(s,o){var i,a=F(s,"a","mul"),c=F(o,"b","mul");i=er(a,c);var u=_i((a=i[0]).shape,(c=i[1]).shape);return Ie.runKernelFunc(function(p,m){var g=p.multiply(a,c);return m([a,c]),g},{a,b:c},function(p,m){var g=m[0],v=m[1];return{a:function(){var y=p.mul(v.toFloat()),C=Fr(g.shape,u);return C.length>0?y.sum(C).reshape(g.shape):y},b:function(){var y=p.mul(g.toFloat()),C=Fr(v.shape,u);return C.length>0?y.sum(C).reshape(v.shape):y}}},"Mul")}}),Dm=ee({mulStrict_:function(s,o){var i=F(s,"a","mul"),a=F(o,"b","mul");return oe(i.shape,a.shape,"Error in multiplyStrict: "),i.mul(a)}}),Kl=ee({pow_:function(s,o){var i=F(s,"base","pow"),a=F(o,"exp","pow"),c=_i(i.shape,a.shape);return s=i.cast(dr(i.dtype,a.dtype)),o=a.cast(dr(i.dtype,a.dtype)),Ie.runKernelFunc(function(u,p){var m=u.pow(i,a);return p([i,a,m]),m},{$base:i,$exp:a},function(u,p){var m=p[0],g=p[1],v=p[2];return{$base:function(){var y=g.toFloat(),C=u.mul(y.mul(m.pow(y.sub(Nt(1))))),S=Fr(m.shape,c);return S.length>0&&(C=C.sum(S)),C.reshape(m.shape)},$exp:function(){var y=m.greater(0),C=m.log().where(y,$n(m)),S=u.mul(v.mul(C)),M=Fr(g.shape,c);return M.length>0&&(S=S.sum(M)),S.reshape(g.shape)}}})}}),Em=ee({powStrict_:function(s,o){return oe(s.shape,o.shape,"Error in powStrict: "),s.pow(o)}}),km=ee({squaredDifference_:function(s,o){var i,a=F(s,"a","squaredDifference"),c=F(o,"b","squaredDifference");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u,p){var m=u.squaredDifference(a,c);return p([a,c]),m},{$a:a,$b:c},function(u,p){var m=p[0],g=p[1],v=Nt(2);return{$a:function(){return u.mul(m.sub(g).mul(v))},$b:function(){return u.mul(g.sub(m).mul(v))}}})}}),Qc=ee({squaredDifferenceStrict_:function(s,o){var i=F(s,"a","squaredDifferenceStrict"),a=F(o,"b","squaredDifferenceStrict");return oe(i.shape,a.shape,"Error in squaredDifferenceStrict: "),i.squaredDifference(a)}}),jr=ee({sub_:function(s,o){var i,a=F(s,"a","sub"),c=F(o,"b","sub");i=er(a,c);var u=_i((a=i[0]).shape,(c=i[1]).shape);return Ie.runKernelFunc(function(p){return p.subtract(a,c)},{a,b:c},function(p){return{a:function(){var m=p,g=Fr(a.shape,u);return g.length>0&&(m=m.sum(g)),m.reshape(a.shape)},b:function(){var m=p,g=Fr(c.shape,u);return g.length>0&&(m=m.sum(g)),m.neg().reshape(c.shape)}}},"Sub")}}),Av=ee({subStrict_:function(s,o){var i=F(s,"a","subStrict"),a=F(o,"b","subStrict");return oe(i.shape,a.shape,"Error in subStrict: "),i.sub(a)}}),Jc=ee({equal_:function(s,o){var i,a=F(s,"a","equal"),c=F(o,"b","equal");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u){return u.equal(a,c)},{$a:a,$b:c})}}),Mm=ee({equalStrict_:function(s,o){var i=F(s,"a","equalStrict"),a=F(o,"b","equalStrict");return oe(i.shape,a.shape,"Error in equalStrict: "),i.equal(a)}}),Tu=ee({greater_:function(s,o){var i,a=F(s,"a","greater"),c=F(o,"b","greater");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u){return u.greater(a,c)},{$a:a,$b:c})}}),gp=ee({greaterEqual_:function(s,o){var i,a=F(s,"a","greaterEqual"),c=F(o,"b","greaterEqual");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u,p){var m=u.greaterEqual(a,c);return p([a,c]),m},{$a:a,$b:c},function(u,p){var m=p[0],g=p[1];return{$a:function(){return $n(m)},$b:function(){return $n(g)}}})}}),Dw=ee({greaterEqualStrict_:function(s,o){var i=F(s,"a","greaterEqualStrict"),a=F(o,"b","greaterEqualStrict");return oe(i.shape,a.shape,"Error in greaterEqualStrict: "),i.greaterEqual(a)}}),Ew=ee({greaterStrict_:function(s,o){var i=F(s,"a","greaterStrict"),a=F(o,"b","greaterStrict");return oe(i.shape,a.shape,"Error in greaterStrict: "),i.greater(a)}}),Rv=ee({less_:function(s,o){var i,a=F(s,"a","less"),c=F(o,"b","less");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u){return u.less(a,c)},{$a:a,$b:c})}}),Fv=ee({lessEqual_:function(s,o){var i,a=F(s,"a","lessEqual"),c=F(o,"b","lessEqual");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u){return u.lessEqual(a,c)},{$a:a,$b:c})}}),Ov=ee({lessEqualStrict_:function(s,o){var i=F(s,"a","lessEqualStrict"),a=F(o,"b","lessEqualStrict");return oe(i.shape,a.shape,"Error in lessEqualStrict: "),i.lessEqual(a)}}),Tm=ee({lessStrict_:function(s,o){var i=F(s,"a","lessStrict"),a=F(o,"b","lessStrict");return oe(i.shape,a.shape,"Error in lessStrict: "),i.less(a)}}),ed=ee({notEqual_:function(s,o){var i,a=F(s,"a","notEqual"),c=F(o,"b","notEqual");return i=er(a,c),_i((a=i[0]).shape,(c=i[1]).shape),Ie.runKernelFunc(function(u){return u.notEqual(a,c)},{$a:a,$b:c})}}),Im=ee({notEqualStrict_:function(s,o){var i=F(s,"a","notEqualStrict"),a=F(o,"b","notEqualStrict");return oe(i.shape,a.shape,"Error in notEqualStrict: "),i.notEqual(a)}});function kw(s,o){for(var i=[],a=s;a<o;++a)i.push(a);return i}function Mw(s){for(var o=[],i=0;i<s.length;++i)for(var a=0;a<s[i].length;++a)o.push(s[i][a]);return o}var td=ee({gather_:function(s,o,i){void 0===i&&(i=0);var a=F(s,"x","gather"),c=F(o,"indices","gather","int32");i=kt(i,a.shape)[0];var u=function(p,m,g){for(var v=p.shape[g],y=[],C=1,S=1,M=0;M<g;M++)y.push(p.shape[M]),C*=p.shape[M];for(M=0;M<m.rank;M++)y.push(m.shape[M]);for(M=g+1;M<p.rank;M++)y.push(p.shape[M]),S*=p.shape[M];return{batchSize:C,sliceSize:S,dimSize:v,outputShape:y}}(a,c,i);return Ie.runKernelFunc(function(p,m){var g=p.gather(a,c.flatten(),i);return m([c]),g},{$x:a},function(p,m){var g=m[0];return{$x:function(){var v=a.shape,y=g.size,C=v.slice(0,i),S=C.length,M=v.slice(i,v.length).slice(1),O=M.length,N=kw(0,S),P=kw(S+1,S+1+O),B=Mw([C,[y],M]),W=p.reshape(B),G=g.reshape([y]),X=Mw([[S],N,P]),Q=W.transpose(X),se=Am(Q,G,a.shape[i]),ue=vn(X);return se.transpose(ue)}}}).reshape(u.outputShape)}}),Am=ee({unsortedSegmentSum_:function(s,o,i){var a=F(s,"x","unsortedSegmentSum"),c=F(o,"segmentIds","unsortedSegmentSum","int32");return L(ae(i),function(){return"numSegments must be of dtype int"}),Ie.runKernelFunc(function(u,p){var m=u.unsortedSegmentSum(a,c,i);return p([c]),m},{$x:a},function(u,p){var m=p[0];return{$x:function(){return function(g,v){for(var y=zs(v,$n(v)),C=td(g,y),S=gp(v,Nt(0,"int32")),M=C.rank-S.rank,O=0;O<M;++O)S=Lo(S,O+1);S=fs(S,ao(C.shape,"bool"));var N=$n(C);return Na(S,C,N)}(u,m)}}})}}),Xl=function(s,o,i){return J(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C,S,M,O,N;return K(this,function(P){switch(P.label){case 0:for(a=F(s,"tensor","boolMask"),c=F(o,"mask","boolMask","bool"),u=i??0,m=a.shape,L((p=c.rank)>0,function(){return"mask cannot be scalar"}),oe(m.slice(u,u+p),c.shape,"mask's shape must match the first K dimensions of tensor's shape,"),g=1,v=u;v<u+p;v++)g*=m[v];return y=m.slice(0,u).concat([g],m.slice(u+p)),C=a.reshape(y),S=c.reshape([-1]),[4,fp(S)];case 1:return M=P.sent(),O=M.squeeze([1]),N=td(C,O,u),s!==a&&a.dispose(),o!==c&&c.dispose(),O.dispose(),C.dispose(),S.dispose(),M.dispose(),[2,N]}})})};function Nv(s,o,i,a,c,u,p){void 0===u&&(u="NHWC"),L(s.length===o.rank,function(){return"Length of inShape ("+s.length+") and rank of dy ("+o.rank+") must match"});var m=s,g=o,v=!1;3===o.rank&&(v=!0,g=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]),m=[1,s[0],s[1],s[2]]),L(4===m.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+m.length+"."}),L(4===g.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+g.rank}),L(4===i.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+i.rank});var y="NHWC"===u?m[3]:m[1],C="NHWC"===u?g.shape[3]:g.shape[1];L(y===i.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+y+") must match input depth for filter "+i.shape[2]+"."}),L(C===i.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+C+") must match output depth for filter "+i.shape[3]+"."}),null!=p&&L(ae(c),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+c+"."});var S=jc(u),M=bl(m,i.shape,a,1,c,p,!1,S),O=Ie.runKernelFunc(function(N,P){var B=N.conv2dDerInput(g,i,M);return P([i,g]),B},{dy4D:g,filter:i},function(N,P){var B=P[0],W=P[1];return{dy4D:function(){return Vs(N,B,a,c,u,1,p)},filter:function(){return Om(N,W,B.shape,a,c,u,p)}}});return v?O.as3D(O.shape[1],O.shape[2],O.shape[3]):O}function Rm(s){var u,o="number"==typeof(u=s)?[u,u,u]:2===u.length?[u[0],u[1],1]:u;return 1===o[0]&&1===o[1]&&1===o[2]}function Tw(s,o,i,a,c){L(s.length===o.rank,function(){return"Length of inShape ("+s.length+") and rank of dy ("+o.rank+") must match"});var u=s,p=o,m=!1;4===o.rank&&(m=!0,p=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]),u=[1,s[0],s[1],s[2],s[3]]);var g=u[4],v=p.shape[4];L(5===u.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+u.length+"."}),L(5===p.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+p.rank}),L(5===i.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+i.rank}),L(g===i.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+g+") must match input depth for filter "+i.shape[3]+"."}),L(v===i.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+v+") must match output depth for filter "+i.shape[4]+"."});var y=Uh(u,i.shape,a,1,c),C=Ie.runKernelFunc(function(S){return S.conv3dDerInput(p,i,y)},{dy5D:p});return m?C.as4D(C.shape[1],C.shape[2],C.shape[3],C.shape[4]):C}var Pv=ee({conv1d_:function(s,o,i,a,c,u,p){void 0===c&&(c="NWC"),void 0===u&&(u=1);var m=F(s,"x","conv1d"),g=F(o,"filter","conv1d"),v=m,y=!1;2===m.rank&&(y=!0,v=m.as3D(1,m.shape[0],m.shape[1])),L(3===v.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+v.rank+"."}),L(3===g.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+g.rank+"."}),null!=p&&L(ae(a),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+a+"."}),L(v.shape[2]===g.shape[1],function(){return"Error in conv1d: depth of input ("+v.shape[2]+") must match input depth for filter "+g.shape[1]+"."}),L(qo(i,u),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+i+" and dilation '"+u+"'"}),L("NWC"===c,function(){return"Error in conv1d: got dataFormat of "+c+" but only NWC is currently supported."});var C=g.as4D(1,g.shape[0],g.shape[1],g.shape[2]),S=v.as4D(v.shape[0],1,v.shape[1],v.shape[2]),M=Vs(S,C,[1,i],a,"NHWC",[1,u],p);return y?M.as2D(M.shape[2],M.shape[3]):M.as3D(M.shape[0],M.shape[2],M.shape[3])}}),Vs=ee({conv2d_:function(s,o,i,a,c,u,p){void 0===c&&(c="NHWC"),void 0===u&&(u=[1,1]);var m=F(s,"x","conv2d"),g=F(o,"filter","conv2d"),v=m,y=!1;3===m.rank&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),L(4===v.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+v.rank+"."}),L(4===g.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+g.rank+"."}),null!=p&&L(ae(a),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+a+"."});var C="NHWC"===c?v.shape[3]:v.shape[1];L(C===g.shape[2],function(){return"Error in conv2d: depth of input ("+C+") must match input depth for filter "+g.shape[2]+"."}),L(qo(i,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+u+"'"});var S=jc(c),M=bl(v.shape,g.shape,i,u,a,p,!1,S),O=Ie.runKernelFunc(function(N,P){var B=N.conv2d(v,g,M);return P([g,v]),B},{x:v,$filter:g},function(N,P){var W=P[0],G=P[1];return L(_r(u),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}),{x:function(){return Lv(G.shape,N,W,i,a,c)},$filter:function(){return Om(G,N,W.shape,i,a,c)}}});return y?O.as3D(O.shape[1],O.shape[2],O.shape[3]):O}}),Fm=ee({conv3d_:function(s,o,i,a,c,u){void 0===c&&(c="NDHWC"),void 0===u&&(u=[1,1,1]);var M,p=F(s,"x","conv3d"),m=F(o,"filter","conv3d"),g=p,v=!1;4===p.rank&&(v=!0,g=p.as5D(1,p.shape[0],p.shape[1],p.shape[2],p.shape[3])),L(5===g.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+g.rank+"."}),L(5===m.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+m.rank+"."}),L(g.shape[4]===m.shape[3],function(){return"Error in conv3d: depth of input ("+g.shape[4]+") must match input depth for filter "+m.shape[3]+"."}),L((M=u,Rm(i)||Rm(M)),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+u+"'"}),L("NDHWC"===c,function(){return"Error in conv3d: got dataFormat of "+c+" but only NDHWC is currently supported."});var y=Uh(g.shape,m.shape,i,u,a),C=Ie.runKernelFunc(function(S,M){var O=S.conv3d(g,m,y);return M([g,m]),O},{x:g,$filter:m},function(S,M){L(Rm(u),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var O=M[0],N=M[1];return{x:function(){return Tw(O.shape,S,N,i,a)},$filter:function(){return function(P,B,W,G,X){var Q=P;4===P.rank&&(Q=P.as5D(1,P.shape[0],P.shape[1],P.shape[2],P.shape[3]));var se=B;4===se.rank&&(se=B.as5D(1,B.shape[0],B.shape[1],B.shape[2],B.shape[3])),L(5===Q.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+Q.shape+"."}),L(5===se.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+se.shape+"."}),L(5===W.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+W+"."}),L(Q.shape[4]===W[3],function(){return"Error in conv3dDerFilter: depth of input "+Q.shape[4]+") must match input depth in filter ("+W[3]+"."}),L(se.shape[4]===W[4],function(){return"Error in conv3dDerFilter: depth of dy ("+se.shape[4]+") must match output depth for filter ("+W[4]+")."});var ue=Uh(Q.shape,W,G,1,X);return Ie.runKernelFunc(function(fe){return fe.conv3dDerFilter(Q,se,ue)},{x5D:Q,dy5D:se})}(O,S,N.shape,i,a)}}});return v?C.as4D(C.shape[1],C.shape[2],C.shape[3],C.shape[4]):C}}),Om=ee({conv2dDerFilter_:function(s,o,i,a,c,u,p){void 0===u&&(u="NHWC");var m=s;3===s.rank&&(m=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]));var g=o;3===g.rank&&(g=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),L(4===m.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+m.shape+"."}),L(4===g.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+g.shape+"."}),L(4===i.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+i+"."});var v="NHWC"===u?m.shape[3]:m.shape[1],y="NHWC"===u?g.shape[3]:g.shape[1];L(v===i[2],function(){return"Error in conv2dDerFilter: depth of input "+v+") must match input depth in filter ("+i[2]+"."}),L(y===i[3],function(){return"Error in conv2dDerFilter: depth of dy ("+y+") must match output depth for filter ("+i[3]+")."}),null!=p&&L(ae(c),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+c+"."});var C=jc(u),S=bl(m.shape,i,a,1,c,p,!1,C);return Ie.runKernelFunc(function(M){return M.conv2dDerFilter(m,g,S)},{x4D:m,dy4D:g})}}),Lv=ee({conv2dDerInput_:Nv}),nd=ee({depthwiseConv2d_:function(s,o,i,a,c,u,p){void 0===c&&(c="NHWC"),void 0===u&&(u=[1,1]);var m=F(s,"x","depthwiseConv2d"),g=F(o,"filter","depthwiseConv2d"),v=m,y=!1;3===m.rank&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),L(4===v.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),L(4===g.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),L(v.shape[3]===g.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),null==u&&(u=[1,1]),L(qo(i,u),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+u+"'"}),null!=p&&L(ae(a),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+p+" but got pad "+a+"."});var C=bl(v.shape,g.shape,i,u,a,p,!0),S=Ie.runKernelFunc(function(M,O){var N=M.depthwiseConv2D(v,g,C);return O([v,g]),N},{x:v,$filter:g},function(M,O){L(_r(u),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var N=O[0],P=O[1];return{x:function(){return Nm(N.shape,M,P,C)},$filter:function(){return Bv(N,M,P.shape,C)}}});return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),Nm=ee({depthwiseConv2dDerInput_:function(s,o,i,a){var c=o,u=!1;3===o.rank&&(u=!0,c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var p=Ie.runKernelFunc(function(m){return m.depthwiseConv2DDerInput(c,i,a)},{dy4D:c});return u?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Bv=ee({depthwiseConv2dDerFilter_:function(s,o,i,a){var c=s;3===s.rank&&(c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]));var u=o;return 3===u.rank&&(u=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Ie.runKernelFunc(function(p){return p.depthwiseConv2DDerFilter(c,u,a)},{x4D:c,dy4D:u})}}),Iu=ee({separableConv2d_:function(s,o,i,a,c,u,p){void 0===u&&(u=[1,1]),void 0===p&&(p="NHWC");var m=F(s,"x","separableConv2d"),g=F(o,"depthwiseFilter","separableConv2d"),v=F(i,"pointwiseFilter","separableConv2d"),y=m,C=!1;if(3===m.rank&&(C=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),"NCHW"===p)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(4===y.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+y.rank+"."}),L(4===g.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+g.rank+"."}),L(4===v.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+g.rank+"."}),L(1===v.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+v.shape[0]+"."}),L(1===v.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+v.shape[1]+"."});var S=g.shape[2],M=g.shape[3];L(v.shape[2]===S*M,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+S*M+", but got "+v.shape[2]+"."});var O=nd(y,g,a,c,p,u),N=Vs(O,v,1,"valid",p);return C?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),id=ee({conv2dTranspose_:function(s,o,i,a,c,u){return Nv(i,F(s,"x","conv2dTranspose"),F(o,"filter","conv2dTranspose"),a,c,"NHWC",u)}}),zv=ee({conv3dTranspose_:function(s,o,i,a,c){return Tw(i,F(s,"x","conv3dTranspose"),F(o,"filter","conv3dTranspose"),a,c)}}),Au=ee({matMul_:function(s,o,i,a){var c;void 0===i&&(i=!1),void 0===a&&(a=!1);var u=F(s,"a","matMul"),p=F(o,"b","matMul");c=er(u,p),u=c[0],p=c[1];var m=i?u.shape[u.rank-2]:u.shape[u.rank-1],g=a?p.shape[p.rank-1]:p.shape[p.rank-2],v=i?u.shape[u.rank-1]:u.shape[u.rank-2],y=a?p.shape[p.rank-2]:p.shape[p.rank-1],C=u.shape.slice(0,-2),S=p.shape.slice(0,-2),M=de(C),O=de(S);L(u.rank>=2&&p.rank>=2&&u.rank===p.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+u.rank+" and "+p.rank+"."}),L(ke(C,S),function(){return"Error in matMul: outer dimensions ("+C+") and ("+S+") of Tensors with shapes "+u.shape+" and "+p.shape+" must match."}),L(m===g,function(){return"Error in matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+u.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+a+" must match."});var N=u.shape.slice(0,-2).concat([v,y]),P=i?u.as3D(M,m,v):u.as3D(M,v,m),B=a?p.as3D(O,y,g):p.as3D(O,g,y);return Ie.runKernelFunc(function(G,X){var Q=G.batchMatMul(P,B,i,a);return X([P,B]),Q},{a:P,b:B},function(G,X){var se=X[0],ue=X[1];return i||a?!i&&a?{a:function(){return G.matMul(ue,!1,!1)},b:function(){return G.matMul(se,!0,!1)}}:i&&!a?{a:function(){return ue.matMul(G,!1,!0)},b:function(){return se.matMul(G,!1,!1)}}:{a:function(){return ue.matMul(G,!0,!0)},b:function(){return G.matMul(se,!0,!0)}}:{a:function(){return G.matMul(ue,!1,!0)},b:function(){return se.matMul(G,!0,!1)}}},"BatchMatMul",{transposeA:i,transposeB:a}).reshape(N)}}),Pm=ee({dot_:function(s,o){var i=F(s,"t1","dot"),a=F(o,"t2","dot");L(!(1!==i.rank&&2!==i.rank||1!==a.rank&&2!==a.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+i.rank+" and "+a.rank+"."});var c=1===i.rank?i.size:i.shape[1],u=1===a.rank?a.size:a.shape[0];return L(c===u,function(){return"Error in dot: inner dimensions of inputs must match, but got "+c+" and "+u+"."}),1===i.rank&&1===a.rank?i.as2D(1,-1).matMul(a.as2D(-1,1)).asScalar():1===i.rank&&2===a.rank?i.as2D(1,-1).matMul(a.as2D(a.shape[0],a.shape[1])).as1D():2===i.rank&&1===a.rank?i.matMul(a.as2D(-1,1)).as1D():i.matMul(a.as2D(a.shape[0],a.shape[1]))}}),Lm=ee({outerProduct_:function(s,o){var i=F(s,"v1","outerProduct"),a=F(o,"v2","outerProduct");return L(1===i.rank&&1===a.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+i.rank+" and "+a.rank+"."}),i.as2D(-1,1).matMul(a.as2D(1,-1))}}),ya=ee({reverse_:function(s,o){var i=F(s,"x","reverse");if(0===i.rank)return i.clone();var a=kt(o,i.shape);return Ie.runKernelFunc(function(c){return c.reverse(i,a)},{$x:i},function(c){return{$x:function(){return c.reverse(a)}}}).reshapeAs(i)}}),Iw=ee({reverse1d_:function(s){var o=F(s,"x","reverse");return L(1===o.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+o.rank+"."}),ya(o,0)}}),Vv=ee({reverse2d_:function(s,o){var i=F(s,"x","reverse");return L(2===i.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+i.rank+"."}),ya(i,o)}}),Aw=ee({reverse3d_:function(s,o){var i=F(s,"x","reverse");return L(3===i.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+i.rank+"."}),ya(i,o)}}),Rw=ee({reverse4d_:function(s,o){var i=F(s,"x","reverse");return L(4===i.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+i.rank+"."}),ya(i,o)}});function Fw(s,o,i,a,c,u){var p=F(s,"x","maxPool"),m=p,g=!1;3===p.rank&&(g=!0,m=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),null==a&&(a=[1,1]),L(4===m.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+m.rank+"."}),L(qo(i,a),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}),null!=u&&L(ae(c),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+c+"."});var v=uu(m.shape,o,i,a,c,u),y=Ie.runKernelFunc(function(C,S){var M=C.maxPool(m,v);return S([m,M]),M},{x:m},function(C,S){var M=S[0],O=S[1];return{x:function(){return function(N,P,B,W,G,X,Q,se){var ue=F(N,"dy","maxPoolBackprop"),fe=F(P,"input","maxPoolBackprop"),_e=F(B,"output","maxPoolBackprop");L(fe.rank===ue.rank,function(){return"Rank of input ("+fe.rank+") does not match rank of dy ("+ue.rank+")"}),null==X&&(X=[1,1]),L(qo(G,X),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+G+" and dilations '"+X+"'"}),L(4===ue.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+ue.rank+"."}),L(4===fe.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+fe.rank+"."});var me=uu(fe.shape,W,G,X,Q,void 0);return Ie.runKernelFunc(function(Me){return Me.maxPoolBackprop(ue,fe,_e,me)},{$dy:ue,$input:fe})}(C,M,O,o,i,a,c)}}});return g?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}function Uv(s,o,i,a,c,u){var p=F(s,"x","avgPool","float32");null==a&&(a=[1,1]),L(qo(i,a),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var m=p,g=!1;3===p.rank&&(g=!0,m=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),L(4===m.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+m.rank+"."}),null!=u&&L(ae(c),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+c+"."});var v=uu(m.shape,o,i,a,c,u),y=Ie.runKernelFunc(function(C){return C.avgPool(m,v)},{x:m},function(C){return{x:function(){return function(S,M,O,N,P,B){var W=F(S,"dy","avgPoolBackprop"),G=F(M,"input","avgPoolBackprop");L(G.rank===W.rank,function(){return"Rank of input ("+G.rank+") does not match rank of dy ("+W.rank+")"}),null==P&&(P=[1,1]),L(qo(N,P),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+N+" and dilations '"+P+"'"});var X=G,Q=W,se=!1;3===G.rank&&(se=!0,X=G.as4D(1,G.shape[0],G.shape[1],G.shape[2]),Q=W.as4D(1,W.shape[0],W.shape[1],W.shape[2])),L(4===Q.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+Q.rank+"."}),L(4===X.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+X.rank+"."});var ue=uu(X.shape,O,N,P,B),fe=Ie.runKernelFunc(function(_e){return _e.avgPoolBackprop(Q,X,ue)},{dy4D:Q,input4D:X});return se?fe.as3D(fe.shape[1],fe.shape[2],fe.shape[3]):fe}(C,m,o,i,a,c)}}});return y=y.cast(p.dtype),g?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}var _p=ee({maxPool_:function(s,o,i,a,c){return Fw(s,o,i,1,a,c)}}),rd=ee({avgPool_:function(s,o,i,a,c){return Uv(s,o,i,1,a,c)}}),Bm=ee({pool_:function(s,o,i,a,c,u){null==c&&(c=[1,1]),null==u&&(u=1),0===a&&(a="valid");var p=F(s,"x","maxPool"),m=p,g=!1;3===p.rank&&(g=!0,m=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),L(qo(u,c),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+u+" and dilations '"+c+"'"});var v,Q,se,ue,fe,y=uu(m.shape,o,u,c,a),C=[y.dilationHeight,y.dilationWidth];v="same"===a?(Q=C,se=[y.filterHeight,y.filterWidth].map(function(_e,me){return _e+(_e-1)*(Q[me]-1)}).map(function(_e){return _e-1}),ue=se.map(function(_e){return Math.floor(_e/2)}),fe=se.map(function(_e,me){return _e-ue[me]}),se.map(function(_e,me){return[ue[me],fe[me]]})):[[0,0],[0,0]];var S=1===C[0]&&1===C[1],M=function(X,Q,se){var ue=se.map(function(Xe){return Xe[0]}),fe=se.map(function(Xe){return Xe[1]}),_e=X.concat(ue,fe),me=Q.map(function(Xe,et){return(Xe-_e[et]%Xe)%Xe}),Me=fe.map(function(Xe,et){return Xe+me[et]});return[Q.map(function(Xe,et){return[ue[et],Me[et]]}),Q.map(function(Xe,et){return[0,me[et]]})]}([y.inHeight,y.inWidth],C,v),N=M[1],P=S?a:"valid",B=S?m:j_(m,C,M[0]),W=("avg"===i?function(){return Uv(B,o,u,1,P)}:function(){return Fw(B,o,u,1,P)})(),G=S?W:pa(W,C,N);return g?G.as3D(G.shape[1],G.shape[2],G.shape[3]):G}}),Us=ee({maxPool3d_:function(s,o,i,a,c,u,p){void 0===u&&(u="NDHWC");var m=F(s,"x","maxPool3d"),g=m,v=!1;4===m.rank&&(v=!0,g=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),null==p&&(p=[1,1,1]),L(5===g.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+g.rank+"."}),L("NDHWC"===u,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+u}),L(qo(i,p),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+p+"'"}),null!=c&&L(ae(a),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."});var y=hu(g.shape,o,i,p,a,c,u),C=Ie.runKernelFunc(function(S,M){var O=S.maxPool3d(g,y);return M([g,O]),O},{x:g},function(S,M){var O=M[0],N=M[1];return{x:function(){return function(P,B,W,G,X,Q,se,ue){var fe=F(P,"dy","maxPool3dBackprop"),_e=F(B,"input","maxPool3dBackprop"),me=F(W,"output","maxPool3dBackprop"),Me=fe,Te=_e,Ue=me,Xe=!1;4===_e.rank&&(Xe=!0,Me=fe.as5D(1,fe.shape[0],fe.shape[1],fe.shape[2],fe.shape[3]),Te=_e.as5D(1,_e.shape[0],_e.shape[1],_e.shape[2],_e.shape[3]),Ue=me.as5D(1,me.shape[0],me.shape[1],me.shape[2],me.shape[3])),L(5===Me.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+Me.rank+"."}),L(5===Te.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+Te.rank+"."}),L(5===Ue.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+Ue.rank+"."}),null==Q&&(Q=[1,1,1]),L(qo(X,Q),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+X+" and dilations '"+Q+"'"}),null!=ue&&L(ae(se),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+ue+" but got pad "+se+"."});var et=hu(Te.shape,G,X,Q,se,ue),it=Ie.runKernelFunc(function(nt){return nt.maxPool3dBackprop(Me,Te,Ue,et)},{dy5D:Me,input5D:Te});return Xe?it.as4D(it.shape[1],it.shape[2],it.shape[3],it.shape[4]):it}(S,O,N,o,i,p,a,c)}}});return v?C.as4D(C.shape[1],C.shape[2],C.shape[3],C.shape[4]):C}}),zm=ee({avgPool3d_:function(s,o,i,a,c,u,p){void 0===u&&(u="NDHWC");var m=F(s,"x","avgPool3d","float32"),g=m,v=!1;4===m.rank&&(v=!0,g=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),null==p&&(p=[1,1,1]),L(5===g.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+g.rank+"."}),L("NDHWC"===u,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+u}),L(qo(i,p),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+p+"'"}),null!=c&&L(ae(a),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."});var y=hu(g.shape,o,i,p,a,c,u),C=Ie.runKernelFunc(function(S){return S.avgPool3d(g,y)},{x:g},function(S){return{x:function(){return function(M,O,N,P,B,W,G){var X=F(M,"dy","avgPool3dBackprop"),Q=F(O,"input","avgPool3dBackprop"),se=X,ue=Q,fe=!1;4===Q.rank&&(fe=!0,se=X.as5D(1,X.shape[0],X.shape[1],X.shape[2],X.shape[3]),ue=Q.as5D(1,Q.shape[0],Q.shape[1],Q.shape[2],Q.shape[3])),L(5===se.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+se.rank+"."}),L(5===ue.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+ue.rank+"."}),null==B&&(B=[1,1,1]),L(qo(P,B),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+P+" and dilations '"+B+"'"}),null!=G&&L(ae(W),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+G+" but got pad "+W+"."});var _e=hu(ue.shape,N,P,B,W,G),me=Ie.runKernelFunc(function(Me){return Me.avgPool3dBackprop(se,ue,_e)},{dy5D:se,input5D:ue});return fe?me.as4D(me.shape[1],me.shape[2],me.shape[3],me.shape[4]):me}(S,g,o,i,p,a,c)}}});return C=C.cast(g.dtype),v?C.as4D(C.shape[1],C.shape[2],C.shape[3],C.shape[4]):C}}),Pa=ee({slice_:function(s,o,i){var a,c,u=F(s,"x","slice");if(0===u.rank)throw new Error("Slicing scalar is not possible");(a="number"==typeof o?[o].concat(new Array(u.rank-1).fill(0)):o.length<u.rank?o.concat(new Array(u.rank-o.length).fill(0)):o.slice()).forEach(function(g){L(-1!==g,function(){return"slice() does not support negative begin indexing."})}),c=(c=null==i?new Array(u.rank).fill(-1):"number"==typeof i?[i].concat(new Array(u.rank-1).fill(-1)):i.length<u.rank?i.concat(new Array(u.rank-i.length).fill(-1)):i).map(function(g,v){return g>=0?g:(L(-1===g,function(){return"Negative size values should be exactly -1 but got "+g+" for the slice() size at index "+v+"."}),u.shape[v]-a[v])}),Nx(u,a,c);var p=u.shape;return Ie.runKernelFunc(function(g){return g.slice(u,a,c)},{x:u},function(g){for(var v=[],y=0;y<g.rank;y++)v.push([a[y],p[y]-a[y]-c[y]]);return{x:function(){return g.pad(v)}}},"Slice",{begin:a,size:c})}}),Vm=ee({slice1d_:function(s,o,i){var a=F(s,"x","slice1d");return L(1===a.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+a.rank+" tensor"}),Pa(a,[o],[i])}}),Um=ee({slice2d_:function(s,o,i){var a=F(s,"x","slice2d");return L(2===a.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+a.rank+" tensor"}),Pa(a,o,i)}}),od=ee({slice3d_:function(s,o,i){var a=F(s,"x","slice3d");return L(3===a.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+a.rank+" tensor"}),Pa(a,o,i)}}),Ru=ee({slice4d_:function(s,o,i){var a=F(s,"x","slice4d");return L(4===a.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+a.rank+" tensor"}),Pa(a,o,i)}});function Hv(s,o,i,a,c){return o.rank<i.rank&&(o=o.reshape(gt(o.shape,a))),s.rank<i.rank&&(s=s.reshape(gt(s.shape,a))),{$x:function(){var u=s.mul(i.equal(o).cast(s.dtype));return null==c?u:u.transpose(c)}}}var ad=ee({all_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","all","bool"),c=kt(o,a.shape),u=c,p=At(u,a.rank);null!=p&&(a=a.transpose(p),u=Dn(u.length,a.rank));var m=Ie.runKernelFunc(function(v){return v.all(a,u)},{$x:a});if(i){var g=gt(m.shape,c);return m.reshape(g)}return m}}),sd=ee({any_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","any","bool"),c=kt(o,a.shape),u=c,p=At(u,a.rank);null!=p&&(a=a.transpose(p),u=Dn(u.length,a.rank));var m=Ie.runKernelFunc(function(v){return v.any(a,u)},{$x:a});if(i){var g=gt(m.shape,c);return m.reshape(g)}return m}}),Fu=ee({argMax_:function(s,o){void 0===o&&(o=0);var i=F(s,"x","argMax");null==o&&(o=0);var a=kt(o,i.shape),c=At(a,i.rank);return null!=c&&(i=i.transpose(c),a=Dn(a.length,i.rank)),Ie.runKernelFunc(function(u,p){var m=u.argMax(i,a[0]);return p([i]),m},{$x:i},function(u,p){var m=p[0];return{$x:function(){return $n(m)}}})}}),Hm=ee({argMin_:function(s,o){void 0===o&&(o=0);var i=F(s,"x","argMin");null==o&&(o=0);var a=kt(o,i.shape),c=At(a,i.rank);return null!=c&&(i=i.transpose(c),a=Dn(a.length,i.rank)),Ie.runKernelFunc(function(u,p){var m=u.argMin(i,a[0]);return p([i]),m},{$x:i},function(u,p){var m=p[0];return{$x:function(){return $n(m)}}})}}),jv=ee({logSumExp_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","logSumExp"),c=kt(o,a.shape),u=a.max(c,!0),p=a.sub(u).exp().sum(c).log(),m=u.reshape(p.shape).add(p);if(i){var g=gt(m.shape,c);return m.reshape(g)}return m}}),xa=ee({max_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","max"),c=a,u=kt(o,a.shape),p=u,m=At(p,a.rank);null!=m&&(a=a.transpose(m),p=Dn(p.length,a.rank));var g=Ie.runKernelFunc(function(y,C){var S=y.max(a,p);return C([c,S]),S},{$x:a},function(y,C){return Hv(y,C[1],C[0],u,m)});if(i){var v=gt(g.shape,u);g=g.reshape(v)}return g}}),Or=ee({mean_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","mean"),c=kt(o,a.shape),u=de(Pe(a.shape,c)[1]);return Uc(function(p){var m=Nt(u);return{value:(m.dtype===p.dtype?p:p.cast(m.dtype)).div(m).sum(o,i),gradFunc:function(g){var v=p.shape.slice();return c.forEach(function(y){v[y]=1}),g.reshape(v).mul(ao(p.shape,"float32")).div(u)}}})(a)}}),jm=ee({min_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","min"),c=a,u=kt(o,a.shape),p=u,m=At(p,a.rank);null!=m&&(a=a.transpose(m),p=Dn(p.length,a.rank));var g=Ie.runKernelFunc(function(y,C){var S=y.min(a,p);return C([c,S]),S},{$x:a},function(y,C){return Hv(y,C[1],C[0],u,m)});if(i){var v=gt(g.shape,u);g=g.reshape(v)}return g}}),vp=ee({moments_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=kt(o,(s=F(s,"x","moments")).shape),c=s.mean(a,i),u=c.shape;i||(u=gt(c.shape,a));var p=s.toFloat().sub(c.reshape(u)).square();return{mean:c,variance:p.mean(a,i)}}}),wa=ee({sum_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","sum");"bool"===a.dtype&&(a=a.toInt());var c=kt(o,a.shape);return Uc(function(u){var p=At(c,u.rank),m=c,g=u;null!=p&&(g=u.transpose(p),m=Dn(m.length,u.rank));var v=Ie.runKernelFunc(function(C){return C.sum(g,m)},{permutedX:g});if(i){var y=gt(v.shape,c);v=v.reshape(y)}return{value:v,gradFunc:function(C){var S=u.shape.slice();return c.forEach(function(M){S[M]=1}),C.reshape(S).mul(ao(u.shape,"float32"))}}})(a)}}),Wm=ee({prod_:function(s,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=F(s,"x","prod");"bool"===a.dtype&&(a=a.toInt());var c=kt(o,a.shape),u=At(c,a.rank),p=c,m=a;null!=u&&(m=a.transpose(u),p=Dn(p.length,a.rank));var g=Ie.runKernelFunc(function(y){return y.prod(m,p)},{permutedX:m});if(i){var v=gt(g.shape,c);g=g.reshape(v)}return g}}),so=ee({elu_:function(s){var o=F(s,"x","elu");return Ie.runKernelFunc(function(i,a){var c=i.elu(o);return a([c]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return Ie.runKernelFunc(function(u){return u.eluDer(i,c)},{dy:i,y:c})}}})}}),La=ee({leakyRelu_:function(s,o){void 0===o&&(o=.2);var i=F(s,"x","leakyRelu");return zs(Nt(o).mul(i),i)}}),Gm=ee({prelu_:function(s,o){var i=F(s,"x","prelu"),a=F(o,"alpha","prelu");return Ie.runKernelFunc(function(c,u){var p=c.prelu(i,a);return u([i,a]),p},{x:i,alpha:a},function(c,u){var p=u[0],m=u[1],g=p.greater(0);return{x:function(){return Na(g,c,c.mul(m))},alpha:function(){var v=Na(g,$n(c),c.mul(p)),y=Fr(m.shape,c.shape);return y.length>0&&(v=v.sum(y)),v.reshape(m.shape)}}},"Prelu")}}),Zl=ee({relu_:function(s){var o=F(s,"x","relu");return"bool"===o.dtype?o.toInt():Ie.runKernelFunc(function(i,a){var c=i.relu(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){return i.mulStrict(c.step().toFloat())}}})}}),Wv=ee({relu6_:function(s){var o=F(s,"x","relu6");return"bool"===o.dtype?o.toInt():Ie.runKernelFunc(function(i,a){var c=i.relu6(o);return a([o]),c},{$x:o},function(i,a){var c=a[0],u=c.lessEqual(6).mul(c.step());return{$x:function(){return i.mulStrict(u.toFloat())}}})}}),$m=ee({selu_:function(s){var o=F(s,"x","selu");return Ie.runKernelFunc(function(i,a){var c=i.selu(o);return a([o]),c},{$x:o},function(i,a){var c=a[0];return{$x:function(){var u=c.greater(Nt(0)),p=Nt(1.7580993408473768),m=Nt(1.0507009873554805),g=i.mul(m),v=i.mul(p).mul(c.toFloat().exp());return Na(u,g,v)}}})}}),ur=ee({transpose_:function(s,o){var i=F(s,"x","transpose");return null==o&&(o=i.shape.map(function(a,c){return c}).reverse()),L(i.rank===o.length,function(){return"Error in transpose: rank of input "+i.rank+" must match length of perm "+o+"."}),o.forEach(function(a){L(a>=0&&a<i.rank,function(){return"All entries in 'perm' must be between 0 and "+(i.rank-1)+" but got "+o})}),i.rank<=1?i.clone():Ie.runKernelFunc(function(a){return a.transpose(i,o)},{$x:i},function(a){var c=vn(o);return{$x:function(){return a.transpose(c)}}})}}),Gv=ee({localResponseNormalization_:function(s,o,i,a,c){void 0===o&&(o=5),void 0===i&&(i=1),void 0===a&&(a=1),void 0===c&&(c=.5);var u=F(s,"x","localResponseNormalization");L(4===u.rank||3===u.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+u.rank+"."}),L(ae(o),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+o+"."});var p=u,m=!1;3===u.rank&&(m=!0,p=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]));var g=Ie.runKernelFunc(function(v,y){var C=v.localResponseNormalization4D(p,o,i,a,c);return y([p,C]),C},{x4D:p},function(v,y){var C=y[0],S=y[1];return{x4D:function(){return Ie.runKernelFunc(function(M){return M.LRNGrad(v,C,S,o,i,a,c)},{})}}});return m?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),qm=ee({norm_:function(s,o,i,a){void 0===o&&(o="euclidean"),void 0===i&&(i=null),void 0===a&&(a=!1);var c=function m(g,v,y){if(void 0===y&&(y=null),0===g.rank)return g.abs();if(1!==g.rank&&null===y)return m(g.reshape([-1]),v,y);if(1===g.rank||"number"==typeof y||Array.isArray(y)&&1===y.length){if(1===v)return g.abs().sum(y);if(v===1/0)return g.abs().max(y);if(v===-1/0)return g.abs().min(y);if("euclidean"===v||2===v)return g.abs().pow(Nt(2,"int32")).sum(y).sqrt();throw new Error("Error in norm: invalid ord value: "+v)}if(Array.isArray(y)&&2===y.length){if(1===v)return g.abs().sum(y[0]).max(y[1]-1);if(v===1/0)return g.abs().sum(y[1]).max(y[0]);if(v===-1/0)return g.abs().sum(y[1]).min(y[0]);if("fro"===v||"euclidean"===v)return g.square().sum(y).sqrt();throw new Error("Error in norm: invalid ord value: "+v)}throw new Error("Error in norm: invalid axis: "+y)}(s=F(s,"x","norm"),o,i),u=c.shape;if(a){var p=kt(i,s.shape);u=gt(c.shape,p)}return c.reshape(u)}}),Ow=ee({basicLSTMCell_:function(s,o,i,a,c,u){var p=F(s,"forgetBias","basicLSTMCell"),m=F(o,"lstmKernel","basicLSTMCell"),g=F(i,"lstmBias","basicLSTMCell"),v=F(a,"data","basicLSTMCell"),y=F(c,"c","basicLSTMCell"),C=F(u,"h","basicLSTMCell"),S=v.concat(C,1).matMul(m).add(g),O=S.shape[1]/4,N=[S.shape[0],O],P=S.slice([0,0],N),B=S.slice([0,O],N),W=S.slice([0,2*O],N),G=S.slice([0,3*O],N),X=P.sigmoid().mulStrict(B.tanh()).addStrict(y.mulStrict(p.add(W).sigmoid())),Q=X.tanh().mulStrict(G.sigmoid());return[X,Q]}}),Nw=ee({multiRNNCell_:function(s,o,i,a){for(var c=F(o,"data","multiRNNCell"),u=ge(i,"c","multiRNNCell"),p=ge(a,"h","multiRNNCell"),m=c,g=[],v=0;v<s.length;v++){var y=s[v](m,u[v],p[v]);g.push(y[0]),g.push(y[1]),m=y[1]}var C=[],S=[];for(v=0;v<g.length;v+=2)C.push(g[v]),S.push(g[v+1]);return[C,S]}}),Pw=ee({movingAverage_:function(s,o,i,a,c){void 0===c&&(c=!0);var u=F(s,"v","movingAverage"),p=F(o,"x","movingAverage"),m=F(i,"decay","movingAverage");xr(u,p),L(ke(u.shape,p.shape),function(){return"Shape mismatch in v and x"});var g=Nt(1),v=g.sub(m),y=p.sub(u).mul(v);if(c){L(null!=a,function(){return"When using zeroDebias: true, step is required."});var C=F(a,"step","movingAverage");y=y.div(g.sub(Kl(m,C)))}return u.add(y)}}),$v=ee({stridedSlice_:function(s,o,i,a,c,u,p,m,g){if(void 0===c&&(c=0),void 0===u&&(u=0),void 0===p&&(p=0),void 0===m&&(m=0),void 0===g&&(g=0),null==a&&(a=new Array(o.length)),0!==p)throw new Error("ellipsis mask is not yet supported");var v=F(s,"x","stridedSlice"),y=Px(m),C=v.shape.slice();y.forEach(function(P){o[P]=0,i[P]=1,C.splice(P,0,1)}),v=v.reshape(C);for(var S=0;S<v.rank;S++)o[S]=ck(c,o,a,v.shape,S),i[S]=dk(u,i,a,v.shape,S),a[S]=a[S]||1;var M=Px(g);M.forEach(function(P){i[P]=o[P]+1,a[P]=1});var O=$_(o,i,a),N=O.filter(function(P,B){return-1===M.indexOf(B)});return a.every(function(P){return 1===P})?Pa(v,o,O).reshape(N):Ie.runKernelFunc(function(P){return P.stridedSlice(v,o,i,a)},{$x:v}).reshape(N)}}),Ou=ee({topk_:function(s,o,i){void 0===o&&(o=1),void 0===i&&(i=!0);var a=F(s,"x","topk");if(0===a.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var c=a.shape[a.shape.length-1];if(o>c)throw new Error("'k' passed to topk() must be <= the last dimension ("+c+") but got "+o);var u=Ie.runKernelFunc(function(p){return p.topk(a,o,i)},{$x:a});return{values:u[0],indices:u[1]}}}),ms=ee({scatterND_:function(s,o,i){var a=F(s,"indices","scatterND","int32"),c=F(o,"updates","scatterND");return function QR(s,o,i){if(o.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+o.rank+".");if(s.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+s.rank+".");if("int32"!==o.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+o.dtype);if(i.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+i);if(0===i.length){if(0===o.size)throw new Error("Indices specified for empty output. indices shape: "+o.shape);if(0===s.size)throw new Error("Updates specified for empty output. updates shape: "+s.shape)}!function(a,c,u){var p=c.rank>1?c.shape[c.rank-1]:1,m=c.rank>1?c.rank-1:1,g="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+u.shape+", indices.shape: "+c.shape+", shape: "+a+", sliceDim: "+p+", and batchDim: "+m+".";if(u.rank<m)throw new Error(g+" update.rank < "+m+". ");if(a.length<p+(u.rank-m))throw new Error(g+" Output shape length < "+(p+(u.rank-m)));if(u.rank!==m+a.length-p)throw new Error(g+" update.rank != "+(m+a.length-p));for(var v=0;v<m;++v)if(u.shape[v]!==c.shape[v])throw new Error(g+" updates.shape["+v+"] ("+u.shape[v]+") != indices.shape["+v+"] ("+c.shape[v]+").");for(v=0;v<u.rank-m;++v)if(u.shape[v+m]!==a[v+p])throw new Error(g+" updates.shape["+(v+m)+"] ("+u.shape[v+m]+") != shape["+(v+m)+"] ("+a[v+m]+")")}(i,o,s)}(c,a,i),Ie.runKernelFunc(function(u){return u.scatterND(a,c,i)},{$indices:a,$updates:c})}}),xl=ee({fft_:function(s){L("complex64"===s.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+s.dtype+"."});var o=s.shape[s.shape.length-1],a=s.as2D(s.size/o,o);return Ie.runKernelFunc(function(c){return c.fft(a)},{input:s}).reshape(s.shape)}}),ld=ee({ifft_:function(s){L("complex64"===s.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+s.dtype+"."});var o=s.shape[s.shape.length-1],a=s.as2D(s.size/o,o);return Ie.runKernelFunc(function(c){return c.ifft(a)},{input:s}).reshape(s.shape)}}),Nu=ee({rfft_:function(s,o){L("float32"===s.dtype,function(){return"The dtype for rfft() must be real value but got "+s.dtype});var i,a=s.shape[s.shape.length-1],c=s.size/a;if(null!=o&&o<a){var u=s.shape.map(function(B){return 0}),p=s.shape.map(function(B){return B});p[s.shape.length-1]=o,i=s.slice(u,p),a=o}else if(null!=o&&o>a){var m=s.shape.map(function(B){return B});m[s.shape.length-1]=o-a,i=s.concat(fn(m),s.shape.length-1),a=o}else i=s;var g=i.zerosLike(),v=Cn(i,g).as2D(c,a),y=xl(v),C=Math.floor(a/2)+1,S=Ft(y),M=Xn(y),O=S.split([C,a-C],S.shape.length-1),N=M.split([C,a-C],M.shape.length-1),P=i.shape.slice();return P[i.shape.length-1]=C,Cn(O[0],N[0]).reshape(P)}}),bp=ee({irfft_:function(s){var o=s.shape[s.shape.length-1],i=s.size/o;if(o<=2){var a=s.as2D(i,o),c=ld(a);return Ft(c)}var u=[i,2*(o-1)],p=Ft(s).as2D(i,o),m=Xn(s).as2D(i,o),g=p.slice([0,1],[i,o-2]).reverse(1),v=m.slice([0,1],[i,o-2]).reverse(1).mul(Nt(-1)),y=p.concat(g,1),C=m.concat(v,1);return a=Cn(y,C).as2D(u[0],u[1]),c=ld(a),Ft(c)}}),jk=Object.freeze({fft:xl,ifft:ld,rfft:Nu,irfft:bp}),qv=ee({sparseToDense_:function(s,o,i,a){void 0===a&&(a=0);var c=F(s,"sparseIndices","sparseToDense","int32"),u=F(o,"sparseValues","sparseToDense"),p=F(a,"defaultValue","sparseToDense",u.dtype);return function(m,g,v,y){if("int32"!==m.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+m.dtype+".");if(m.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+m.shape+".");var C=m.rank>0?m.shape[0]:1,S=m.rank>1?m.shape[1]:1;if(v.length!==S)throw new Error("outputShape has incorrect number of elements:, "+v.length+", should be: "+S+".");if(0!==g.rank&&(1!==g.rank||g.size!==C))throw new Error("sparseValues has incorrect shape "+g.shape+", should be [] or ["+C+"]");if(g.dtype!==y.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(c,u,i,p),Ie.runKernelFunc(function(m){return m.sparseToDense(c,u,i,p)},{$sparseIndices:c,$sparseValues:u,$defaultValue:p})}}),Lw=ee({gatherND_:function(s,o){var i=F(o,"indices","gatherND","int32"),a=F(s,"x","gatherND");return Ie.runKernelFunc(function(c){return c.gatherND(a,i)},{$x:a,$indices:i})}}),Ym=ee({diag_:function(s){var o=F(s,"x","diag").flatten(),i=s.shape.concat(s.shape);return Ie.runKernelFunc(function(a){return a.diag(o)},{$x:o}).reshape(i)}}),yp=ee({dropout_:function(s,o,i,a){var c=F(s,"x","dropout");if(L("float32"===c.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+c.dtype+" tensor instead."}),L(o>=0&&o<1,function(){return"rate must be a float in the range [0, 1), but got "+o+"."}),0===o)return s instanceof ki?c.clone():c;var u=function(g,v){if(null==v)return g.shape.slice();if(ke(g.shape,v))return v;if(g.shape.length===v.length){for(var y=[],C=0;C<g.shape.length;C++)y.push(null==v[C]&&null!=g.shape[C]?g.shape[C]:v[C]);return y}return v}(c,i),p=1-o,m=Hl(u,0,1,"float32",a).add(p).floor().div(p);return c.mul(m)}});function Wk(s,o,i){for(var a=1-s%2,c=new Float32Array(s),u=0;u<s;++u){var p=2*Math.PI*u/(s+a-1);c[u]=o-i*Math.cos(p)}return Pn(c,"float32")}var yo,Yv=ee({hannWindow_:function(s){return Wk(s,.5,.5)}}),Km=ee({hammingWindow_:function(s){return Wk(s,.54,.46)}}),Xm=ee({frame_:function(s,o,i,a,c){void 0===a&&(a=!1),void 0===c&&(c=0);for(var u=0,p=[];u+o<=s.size;)p.push(Pa(s,u,o)),u+=i;if(a)for(;u<s.size;){var m=u+o-s.size,g=Ur([Pa(s,u,o-m),ml([m],c)]);p.push(g),u+=i}return 0===p.length?qi([],[0,o]):Ur(p).as2D(p.length,o)}}),Kv=ee({stft_:function(s,o,i,a,c){void 0===c&&(c=Yv),null==a&&(a=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var p=Xm(s,o,i),m=Vn(p,c(o)),g=[],v=0;v<p.shape[0];v++)g.push(Nu(m.slice([v,0],[1,o]),a));return Ur(g)}}),Bw=Object.freeze({hannWindow:Yv,hammingWindow:Km,frame:Xm,stft:Kv}),Xv=function(s,o,i){return void 0===i&&(i=1),J(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C,S,M,O,N,P;return K(this,function(B){switch(B.label){case 0:return a=F(s,"predictions","inTopK"),c=F(o,"targets","inTopK"),L(a.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+a.rank}),L(a.rank-1===c.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+a.rank+" and targets rank "+c.rank}),oe(a.shape.slice(0,a.shape.length-1),c.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),u=a.shape[a.shape.length-1],L(i>0&&i<=u,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+u+"), but got "+i}),[4,a.data()];case 1:return p=B.sent(),[4,c.data()];case 2:for(m=B.sent(),y=(g=[p.length/u,u])[1],C=pt("bool",v=g[0]),S=0;S<v;S++){for(O=p.subarray(M=S*y,M+y),N=[],P=0;P<O.length;P++)N.push({value:O[P],index:P});for(N.sort(function(W,G){return G.value-W.value}),C[S]=0,P=0;P<i;P++)if(N[P].index===m[S]){C[S]=1;break}}return s!==a&&a.dispose(),o!==c&&c.dispose(),[2,ei(C,c.shape,"bool")]}})})};!function(s){s[s.NONE=0]="NONE",s[s.MEAN=1]="MEAN",s[s.SUM=2]="SUM",s[s.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(yo||(yo={}));var Zm=ee({absoluteDifference_:function(s,o,i,a){void 0===a&&(a=yo.SUM_BY_NONZERO_WEIGHTS);var c=F(s,"labels","absoluteDifference"),u=F(o,"predictions","absoluteDifference"),p=null;null!=i&&(p=F(i,"weights","absoluteDifference")),oe(c.shape,u.shape,"Error in absoluteDifference: ");var m=c.sub(u).abs();return Hs(m,p,a)}}),Hs=ee({computeWeightedLoss_:function(s,o,i){void 0===i&&(i=yo.SUM_BY_NONZERO_WEIGHTS);var a=F(s,"losses","computeWeightedLoss"),c=null;null!=o&&(c=F(o,"weights","computeWeightedLoss"));var u=null==c?a:a.mul(c);if(i===yo.NONE)return u;if(i===yo.SUM)return u.sum();if(i===yo.MEAN){if(null==c)return u.mean();var p=a.size/c.size,m=u.sum().div(c.sum());return p>1?m.div(Nt(p)):m}if(i===yo.SUM_BY_NONZERO_WEIGHTS){if(null==c)return u.sum().div(Nt(a.size));var g=c.mul(ao(a.shape)).notEqual(Nt(0)).sum().toFloat();return u.sum().div(g)}throw Error("Unknown reduction: "+i)}}),Zv=ee({cosineDistance_:function(s,o,i,a,c){void 0===c&&(c=yo.SUM_BY_NONZERO_WEIGHTS);var u=F(s,"labels","cosineDistance"),p=F(o,"predictions","cosineDistance"),m=null;null!=a&&(m=F(a,"weights","cosineDistance")),oe(u.shape,p.shape,"Error in cosineDistance: ");var g=Nt(1).sub(u.mul(p).sum(i,!0));return Hs(g,m,c)}}),Gk=ee({hingeLoss_:function(s,o,i,a){void 0===a&&(a=yo.SUM_BY_NONZERO_WEIGHTS);var c=F(s,"labels","hingeLoss"),u=F(o,"predictions","hingeLoss"),p=null;null!=i&&(p=F(i,"weights","hingeLoss")),oe(c.shape,u.shape,"Error in hingeLoss: ");var m=Nt(1);c=Nt(2).mul(c).sub(m);var g=m.sub(c.mul(u)).relu();return Hs(g,p,a)}}),zi=ee({huberLoss_:function(s,o,i,a,c){void 0===a&&(a=1),void 0===c&&(c=yo.SUM_BY_NONZERO_WEIGHTS);var u=F(s,"labels","huberLoss"),p=F(o,"predictions","huberLoss"),m=null;null!=i&&(m=F(i,"weights","huberLoss")),oe(u.shape,p.shape,"Error in huberLoss: ");var g=Nt(a),v=p.sub(u).abs(),y=Yl(v,g),C=v.sub(y),S=Nt(.5).mul(y.square()).add(g.mul(C));return Hs(S,m,c)}}),$k=ee({logLoss_:function(s,o,i,a,c){void 0===a&&(a=1e-7),void 0===c&&(c=yo.SUM_BY_NONZERO_WEIGHTS);var u=F(s,"labels","logLoss"),p=F(o,"predictions","logLoss"),m=null;null!=i&&(m=F(i,"weights","logLoss")),oe(u.shape,p.shape,"Error in logLoss: ");var g=Nt(1),v=Nt(a),y=u.mul(p.add(v).log()).neg().sub(g.sub(u).mul(g.sub(p).add(v).log()));return Hs(y,m,c)}}),qk=ee({meanSquaredError_:function(s,o,i,a){void 0===a&&(a=yo.SUM_BY_NONZERO_WEIGHTS);var c=F(s,"labels","meanSquaredError"),u=F(o,"predictions","meanSquaredError"),p=null;null!=i&&(p=F(i,"weights","meanSquaredError")),oe(c.shape,u.shape,"Error in meanSquaredError: ");var m=c.squaredDifference(u);return Hs(m,p,a)}}),Qm=ee({sigmoidCrossEntropy_:function(s,o,i,a,c){void 0===a&&(a=0),void 0===c&&(c=yo.SUM_BY_NONZERO_WEIGHTS);var u=F(s,"multiClassLabels","sigmoidCrossEntropy"),p=F(o,"logits","sigmoidCrossEntropy"),m=null;if(null!=i&&(m=F(i,"weights","sigmoidCrossEntropy")),oe(u.shape,p.shape,"Error in sigmoidCrossEntropy: "),a>0){var g=Nt(a),v=Nt(1),y=Nt(.5);u=u.mul(v.sub(g)).add(y.mul(g))}var C=function(S,M){var O=F(S,"labels","sigmoidCrossEntropyWithLogits"),N=F(M,"logits","sigmoidCrossEntropyWithLogits");oe(O.shape,N.shape,"Error in sigmoidCrossEntropyWithLogits: ");var P=N.relu(),B=N.mul(O),W=N.abs().neg().exp().log1p();return P.sub(B).add(W)}(u,p);return Hs(C,m,c)}}),zw=ee({softmaxCrossEntropy_:function(s,o,i,a,c){void 0===a&&(a=0),void 0===c&&(c=yo.SUM_BY_NONZERO_WEIGHTS);var u=F(s,"onehotLabels","softmaxCrossEntropy"),p=F(o,"logits","softmaxCrossEntropy"),m=null;if(null!=i&&(m=F(i,"weights","softmaxCrossEntropy")),oe(u.shape,p.shape,"Error in softmaxCrossEntropy: "),a>0){var g=Nt(a),v=Nt(1),y=Nt(u.shape[1]);u=u.mul(v.sub(g)).add(g.div(y))}var C=function(S,M,O){if(void 0===O&&(O=-1),-1===O&&(O=M.rank-1),O!==M.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+M.rank+" and dim was "+O);return Uc(function(N,P,B){var W=P.logSumExp([O],!0),G=P.toFloat().sub(W);return B([N,G]),{value:G.mul(N).neg().sum([O]),gradFunc:function(X,Q){var se=Q[0],ue=Q[1],fe=gt(X.shape,[O]);return[X.reshape(fe).mul(se.toFloat().sub(ue.exp())),X.reshape(fe).mul(ue.exp().sub(se.toFloat()))]}}})(S,M)}(u,p);return Hs(C,m,c)}}),Vw=Object.freeze({get Reduction(){return yo},absoluteDifference:Zm,computeWeightedLoss:Hs,cosineDistance:Zv,hingeLoss:Gk,huberLoss:zi,logLoss:$k,meanSquaredError:qk,sigmoidCrossEntropy:Qm,softmaxCrossEntropy:zw});function Uw(s,o){return void 0===o&&(o=!1),Ie.tidy(function(){if(2!==s.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+s.shape.length+"D Tensor.");for(var i=s.shape[0],a=s.shape[1],c=Lc(i),u=s.clone(),p=qi([[1]],[1,1]),m=p.clone(),g=i>=a?a:i,v=function(C){var S,M=u,O=m,N=c;S=Ie.tidy(function(){var P=u.slice([C,C],[i-C,1]),B=P.norm(),W=u.slice([C,C],[1,1]),G=qi([[-1]]).where(W.greater(0),qi([[1]])),X=W.sub(G.mul(B)),Q=P.div(X);m=1===Q.shape[0]?p.clone():p.concat(Q.slice([1,0],[Q.shape[0]-1,Q.shape[1]]),0);var se=G.matMul(X).div(B).neg(),ue=u.slice([C,0],[i-C,a]),fe=se.mul(m);if(0===C)u=ue.sub(fe.matMul(m.transpose().matMul(ue)));else{var _e=ue.sub(fe.matMul(m.transpose().matMul(ue)));u=u.slice([0,0],[C,a]).concat(_e,0)}var me=c.slice([0,C],[i,c.shape[1]-C]);if(0===C)c=me.sub(me.matMul(m).matMul(fe.transpose()));else{var Me=me.sub(me.matMul(m).matMul(fe.transpose()));c=c.slice([0,0],[i,C]).concat(Me,1)}return[m,u,c]}),m=S[0],u=S[1],c=S[2],Kn([M,O,N])},y=0;y<g;++y)v(y);return!o&&i>a&&(c=c.slice([0,0],[i,a]),u=u.slice([0,0],[a,a])),[c,u]})}var Yk=ee({gramSchmidt_:function(s){var o;if(Array.isArray(s)){o=!1,L(null!=s&&s.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var i=s[0].shape[0],a=function(g){L(s[g].shape[0]===i,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+s[g].shape[0]+" vs. "+i+")"})},c=1;c<s.length;++c)a(c)}else o=!0,s=Os(s,s.shape[0],0).map(function(g){return Vc(g,[0])});L(s.length<=s[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+s.length+") exceeds number of dimensions ("+s[0].shape[0]+")."});var u=[],p=s,m=function(g){u.push(Ie.tidy(function(){var v=p[g];if(g>0)for(var y=0;y<g;++y){var C=wa(u[y].mulStrict(v)).mul(u[y]);v=v.sub(C)}return v.div(qm(v,"euclidean"))}))};for(c=0;c<s.length;++c)m(c);return o?Qa(u,0):u}}),Kk=ee({qr_:function(s,o){if(void 0===o&&(o=!1),s.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+s.rank);if(2===s.rank)return Uw(s,o);var i=s.shape.slice(0,s.shape.length-2).reduce(function(p,m){return p*m}),a=Ja(s.reshape([i,s.shape[s.shape.length-2],s.shape[s.shape.length-1]]),0),c=[],u=[];return a.forEach(function(p){var m=Uw(p,o),v=m[1];c.push(m[0]),u.push(v)}),[Qa(c,0).reshape(s.shape),Qa(u,0).reshape(s.shape)]}}),Jm=Object.freeze({gramSchmidt:Yk,qr:Kk});function Xk(s,o,i,a,c){null==a&&(a=.5),null==c&&(c=Number.NEGATIVE_INFINITY);var u=s.shape[0];return i=Math.min(i,u),L(0<=a&&a<=1,function(){return"iouThreshold must be in [0, 1], but was '"+a+"'"}),L(2===s.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+s.rank+"'"}),L(4===s.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+s.shape[1]}),L(1===o.rank,function(){return"scores must be a 1D tensor"}),L(o.shape[0]===u,function(){return"scores has incompatible shape with boxes. Expected "+u+", but was "+o.shape[0]}),{maxOutputSize:i,iouThreshold:a,scoreThreshold:c}}var _F=ee({resizeBilinear_:function(s,o,i){void 0===i&&(i=!1);var a=F(s,"images","resizeBilinear");L(3===a.rank||4===a.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+a.rank+"."}),L(2===o.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+o+"."});var c=a,u=!1;3===a.rank&&(u=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var p=o[0],m=o[1],g=Ie.runKernelFunc(function(v,y){return y([c]),v.resizeBilinear(c,p,m,i)},{batchImages:c},function(v,y){return{batchImages:function(){return Ie.runKernelFunc(function(C){return C.resizeBilinearBackprop(v,y[0],i)},{})}}});return u?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),xp=ee({resizeNearestNeighbor_:function(s,o,i){void 0===i&&(i=!1);var a=F(s,"images","resizeNearestNeighbor");L(3===a.rank||4===a.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+a.rank+"."}),L(2===o.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+o+"."}),L("float32"===a.dtype||"int32"===a.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var c=a,u=!1;3===a.rank&&(u=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var p=o[0],m=o[1],g=Ie.runKernelFunc(function(v,y){return y([c]),v.resizeNearestNeighbor(c,p,m,i)},{batchImages:c},function(v,y){return{batchImages:function(){return Ie.runKernelFunc(function(C){return C.resizeNearestNeighborBackprop(v,y[0],i)},{})}}});return u?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),eg=ee({nonMaxSuppression_:function(s,o,i,a,c){void 0===a&&(a=.5),void 0===c&&(c=Number.NEGATIVE_INFINITY);var u=F(s,"boxes","nonMaxSuppression"),p=F(o,"scores","nonMaxSuppression"),m=Xk(u,p,i,a,c);return i=m.maxOutputSize,a=m.iouThreshold,c=m.scoreThreshold,Ie.runKernelFunc(function(g){return g.nonMaxSuppression(u,p,i,a,c)},{$boxes:u})}}),jw=ee({cropAndResize_:function(s,o,i,a,c,u){var p=F(s,"image","cropAndResize","float32"),m=F(o,"boxes","cropAndResize","float32"),g=F(i,"boxInd","cropAndResize","int32");c=c||"bilinear",u=u||0;var v=m.shape[0];return L(4===p.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+p.rank+"."}),L(2===m.rank&&4===m.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+v+",4] but had shape "+m.shape+"."}),L(1===g.rank&&g.shape[0]===v,function(){return"Error in cropAndResize: boxInd must be have size ["+v+"] but had shape "+m.shape+"."}),L(2===a.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+a.length+"."}),L(a[0]>=1&&a[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+a}),L("bilinear"===c||"nearest"===c,function(){return"method must be bilinear or nearest, but was "+c}),Ie.runKernelFunc(function(y,C){return y.cropAndResize(p,m,g,a,c,u)},{$image:p,$boxes:m})}}),Ql=Object.freeze({resizeBilinear:_F,resizeNearestNeighbor:xp,nonMaxSuppression:eg,nonMaxSuppressionAsync:function(s,o,i,a,c){return void 0===a&&(a=.5),void 0===c&&(c=Number.NEGATIVE_INFINITY),J(this,void 0,void 0,function(){var u,p,m,g,C;return K(this,function(S){switch(S.label){case 0:return u=F(s,"boxes","nonMaxSuppressionAsync"),p=F(o,"scores","nonMaxSuppressionAsync"),m=Xk(u,p,i,a,c),i=m.maxOutputSize,a=m.iouThreshold,c=m.scoreThreshold,[4,Promise.all([u.data(),p.data()])];case 1:return g=S.sent(),C=Ps(g[0],g[1],i,a,c),u!==s&&u.dispose(),p!==o&&p.dispose(),[2,C]}})})},cropAndResize:jw}),Ww=function(s,o){return!(s>0||"linear"!==o&&"relu"!==o)},Qv=function(s,o,i){if(null==i||"linear"===i)return s;if("relu"===i)return s.mul(o.step());throw new Error("Gradient for activation "+i+" has not been implemented yet.")},tg=function(s,o){var i=o,a=Fr(s.shape,o.shape);return a.length>0&&(i=i.sum(a)),i.reshape(s.shape)},ng=function(s,o,i){if("linear"===o)return s;if("relu"===o)return Zl(s);if("elu"===o)return so(s);if("relu6"===o)return Wv(s);if("prelu"===o)return Gm(s,i);throw new Error("Unknown fused activation "+o+".")},Jv=ee({matMul_:function(s){var o,i=s.a,a=s.b,c=s.transposeA,u=void 0!==c&&c,p=s.transposeB,m=void 0!==p&&p,g=s.bias,v=s.activation,y=void 0===v?"linear":v,C=s.preluActivationWeights;if(!1===Ww(Ie.state.gradientDepth,y)){var S=Au(i,a,u,m);return null!=g&&(S=ai(S,g)),ng(S,y,C)}var M=F(i,"a","fused matMul"),O=F(a,"b","fused matMul");o=er(M,O),M=o[0],O=o[1];var N=u?M.shape[M.rank-2]:M.shape[M.rank-1],P=m?O.shape[O.rank-1]:O.shape[O.rank-2],B=u?M.shape[M.rank-1]:M.shape[M.rank-2],W=m?O.shape[O.rank-2]:O.shape[O.rank-1],G=M.shape.slice(0,-2),X=O.shape.slice(0,-2),Q=de(G),se=de(X);L(M.rank>=2&&O.rank>=2&&M.rank===O.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+M.rank+" and "+O.rank+"."}),L(ke(G,X),function(){return"Error in fused matMul: outer dimensions ("+G+") and ("+X+") of Tensors with shapes "+M.shape+" and "+O.shape+" must match."}),L(N===P,function(){return"Error in fused matMul: inner shapes ("+N+") and ("+P+") of Tensors with shapes "+M.shape+" and "+O.shape+" and transposeA="+u+" and transposeB="+m+" must match."});var ue,fe,_e=M.shape.slice(0,-2).concat([B,W]),me=u?M.as3D(Q,N,B):M.as3D(Q,B,N),Me=m?O.as3D(se,W,P):O.as3D(se,P,W);null!=g&&_i(_e,(ue=er(ue=F(g,"bias","fused matMul"),M)[0]).shape),null!=C&&(fe=F(C,"prelu weights","fused matMul"));var Te={$a:me,$b:Me};return null!=g&&(Te.$bias=ue),null!=C&&(Te.$preluActivationWeights=fe),Ie.runKernelFunc(function(Ue,Xe){var et=Ue.fusedBatchMatMul({a:me,b:Me,transposeA:u,transposeB:m,bias:ue,activation:y,preluActivationWeights:fe});return Xe([me,Me,et]),et},Te,function(Ue,Xe){var et=Xe[0],it=Xe[1],je=Qv(Ue,Xe[2],y),ut={};return null!=g&&(ut={$bias:function(){return tg(ue,je)}}),Object.assign(u||m?!u&&m?{$a:function(){return je.matMul(it,!1,!1)},$b:function(){return je.matMul(et,!0,!1)}}:u&&!m?{$a:function(){return it.matMul(je,!1,!0)},$b:function(){return et.matMul(je,!1,!1)}}:{$a:function(){return it.matMul(je,!0,!0)},$b:function(){return je.matMul(et,!0,!0)}}:{$a:function(){return je.matMul(it,!1,!0)},$b:function(){return et.matMul(je,!0,!1)}},ut)}).reshape(_e)}}),vF=ee({conv2d_:function(s){var o=s.x,i=s.filter,a=s.strides,c=s.pad,u=s.dataFormat,p=void 0===u?"NHWC":u,m=s.dilations,g=void 0===m?[1,1]:m,v=s.dimRoundingMode,y=s.bias,C=s.activation,S=void 0===C?"linear":C,M=s.preluActivationWeights;if(!1===Ww(Ie.state.gradientDepth,S=S||"linear")){var O=Vs(o,i,a,c,p,g,v);return null!=y&&(O=ai(O,y)),ng(O,S,M)}var N=F(o,"x","conv2d"),P=F(i,"filter","conv2d"),B=N,W=!1;3===N.rank&&(W=!0,B=N.as4D(1,N.shape[0],N.shape[1],N.shape[2])),L(4===B.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+B.rank+"."}),L(4===P.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+P.rank+"."}),null!=v&&L(ae(c),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+v+" but got pad "+c+"."}),L(B.shape[3]===P.shape[2],function(){return"Error in conv2d: depth of input ("+B.shape[3]+") must match input depth for filter "+P.shape[2]+"."}),L(qo(a,g),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+g+"'"}),L("NHWC"===p,function(){return"Error in conv2d: got dataFormat of "+p+" but only NHWC is currently supported."});var G,X,Q=bl(B.shape,P.shape,a,g,c,v);null!=y&&(G=er(G=F(y,"bias","fused conv2d"),N)[0],_i(Q.outShape,G.shape)),null!=M&&(X=F(M,"prelu weights","fused conv2d"));var se={x:B,$filter:P};null!=y&&(se.$bias=G),null!=M&&(se.$preluActivationWeights=X);var ue=Ie.runKernelFunc(function(fe,_e){var me=fe.fusedConv2d({input:B,filter:P,convInfo:Q,bias:G,activation:S,preluActivationWeights:X});return _e([P,B,me]),me},se,function(fe,_e){var Me=_e[0],Te=_e[1],Xe=Qv(fe,_e[2],S);L(_r(g),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+g+"'"});var et={};return null!=y&&(et={$bias:function(){return tg(G,Xe)}}),Object.assign({x:function(){return Lv(Te.shape,Xe,Me,a,c)},$filter:function(){return Om(Te,Xe,Me.shape,a,c)}},et)});return W?ue.as3D(ue.shape[1],ue.shape[2],ue.shape[3]):ue}}),eb=ee({depthwiseConv2d_:function(s){var o=s.x,i=s.filter,a=s.strides,c=s.pad,u=s.dataFormat,p=void 0===u?"NHWC":u,m=s.dilations,g=void 0===m?[1,1]:m,v=s.dimRoundingMode,y=s.bias,C=s.activation,S=void 0===C?"linear":C,M=s.preluActivationWeights;if(!1===Ww(Ie.state.gradientDepth,S)){var O=nd(o,i,a,c,p,g,v);return null!=y&&(O=ai(O,y)),ng(O,S,M)}var N=F(o,"x","depthwiseConv2d"),P=F(i,"filter","depthwiseConv2d"),B=N,W=!1;3===N.rank&&(W=!0,B=N.as4D(1,N.shape[0],N.shape[1],N.shape[2])),L(4===B.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+B.rank+"."}),L(4===P.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+P.rank+"."}),L(B.shape[3]===P.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+B.shape[3]+") must match the inChannels dimension in filter "+P.shape[2]+"."}),null==g&&(g=[1,1]),L(qo(a,g),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+g+"'"}),null!=v&&L(ae(c),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+v+" but got pad "+c+"."});var G,X,Q=bl(B.shape,P.shape,a,g,c,v,!0);null!=y&&(G=er(G=F(y,"bias","fused conv2d"),N)[0],_i(Q.outShape,G.shape)),null!=M&&(X=F(M,"prelu weights","fused depthwiseConv2d"));var se={x:B,$filter:P};null!=y&&(se.$bias=G),null!=M&&(se.$preluActivationWeights=X);var ue=Ie.runKernelFunc(function(fe,_e){var me=fe.fusedDepthwiseConv2D({input:B,filter:P,convInfo:Q,bias:G,activation:S,preluActivationWeights:X});return _e([B,P,me]),me},se,function(fe,_e){L(_r(g),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+g+"'"});var me=_e[0],Me=_e[1],Ue=Qv(fe,_e[2],S),Xe={};return null!=y&&(Xe={$bias:function(){return tg(G,Ue)}}),Object.assign({x:function(){return Nm(me.shape,Ue,Me,Q)},$filter:function(){return Bv(me,Ue,Me.shape,Q)}},Xe)});return W?ue.as3D(ue.shape[1],ue.shape[2],ue.shape[3]):ue}}),Pu=Object.freeze({matMul:Jv,conv2d:vF,depthwiseConv2d:eb}),tb=Object.freeze({image:Ql,linalg:Jm,losses:Vw,spectral:jk,fused:Pu,signal:Bw,square:mv,conv1d:Pv,conv2d:Vs,conv3d:Fm,depthwiseConv2d:nd,separableConv2d:Iu,conv2dTranspose:id,conv3dTranspose:zv,op:ee,batchNormalization2d:xm,batchNormalization3d:yw,batchNormalization4d:xw,batchNormalization:ww,batchNorm:wm,batchNorm2d:Dv,batchNorm3d:Ev,batchNorm4d:Ho,booleanMaskAsync:Xl,complex:Cn,real:Ft,imag:Xn,concat:Ur,concat1d:V_,concat2d:Mn,concat3d:U_,concat4d:$f,split:Os,matMul:Au,dot:Pm,outerProduct:Lm,reverse:ya,reverse1d:Iw,reverse2d:Vv,reverse3d:Aw,reverse4d:Rw,maxPool:_p,avgPool:rd,pool:Bm,maxPool3d:Us,avgPool3d:zm,slice:Pa,slice1d:Vm,slice2d:Um,slice3d:od,slice4d:Ru,abs:Gl,acos:$l,acosh:Xc,asin:gv,asinh:mw,atan:mm,atanh:_v,ceil:gw,clipByValue:Zo,cos:vv,cosh:bv,erf:Du,exp:gm,expm1:yv,floor:sp,log:ql,log1p:_m,logSigmoid:zk,neg:Zc,reciprocal:xv,round:lp,rsqrt:wv,sigmoid:Cv,sign:cp,isNaN:Vk,isInf:Uk,isFinite:Hk,sin:_w,sinh:vw,softplus:dp,sqrt:Eu,step:vm,tan:bm,tanh:up,all:ad,any:sd,argMax:Fu,argMin:Hm,logSumExp:jv,max:xa,mean:Or,min:jm,moments:vp,sum:wa,prod:Wm,equal:Jc,equalStrict:Mm,greater:Tu,greaterEqual:gp,greaterEqualStrict:Dw,greaterStrict:Ew,less:Rv,lessEqual:Fv,lessEqualStrict:Ov,lessStrict:Tm,notEqual:ed,notEqualStrict:Im,add:ai,addN:kv,addStrict:Mv,atan2:Tv,div:bo,divStrict:Cw,floorDiv:mp,maximum:zs,maximumStrict:Sw,minimum:Yl,minimumStrict:Sm,mod:Iv,modStrict:Mu,mul:Vn,mulStrict:Dm,pow:Kl,powStrict:Em,squaredDifference:km,squaredDifferenceStrict:Qc,sub:jr,subStrict:Av,elu:so,leakyRelu:La,prelu:Gm,relu:Zl,relu6:Wv,selu:$m,logicalAnd:fs,logicalNot:Cm,logicalOr:ku,logicalXor:vo,where:Na,whereAsync:fp,buffer:Rt,print:mr,batchToSpaceND:pa,cast:Ns,clone:mo,cumsum:Pc,depthToSpace:gr,expandDims:Lo,eye:Lc,multinomial:Zn,oneHot:Ul,pad:Xa,pad1d:H_,pad2d:Bc,pad3d:go,pad4d:su,rand:zc,randomNormal:Za,randomGamma:lu,randomUniform:Hl,reshape:Yi,spaceToBatchND:j_,squeeze:Vc,stack:Qa,tile:us,truncatedNormal:jl,unstack:Ja,setdiff1dAsync:_o,fill:ml,linspace:Bh,ones:ao,range:au,scalar:Nt,tensor:ei,tensor1d:Pn,tensor2d:qi,tensor3d:Jr,tensor4d:oo,tensor5d:ak,tensor6d:sk,variable:Oa,zeros:fn,onesLike:ua,zerosLike:$n,transpose:ur,softmax:du,logSoftmax:q_,localResponseNormalization:Gv,norm:qm,gather:td,unsortedSegmentSum:Am,basicLSTMCell:Ow,multiRNNCell:Nw,movingAverage:Pw,stridedSlice:$v,topk:Ou,scatterND:ms,fft:xl,ifft:ld,rfft:Nu,irfft:bp,sparseToDense:qv,gatherND:Lw,diag:Ym,dropout:yp,hannWindow:Yv,hammingWindow:Km,frame:Xm,stft:Kv,inTopKAsync:Xv});function wt(s,o){Array.isArray(s)||(s=[s]),s.forEach(function(i){null!=i&&L("complex64"!==i.dtype,function(){return o+" does not support complex64 tensors."})})}function ig(s,o,i,a){if("linear"===i)return s.linear(o);if("relu"===i)return s.relu(o);if("elu"===i)return s.elu(o);if("relu6"===i)return s.relu6(o);if("prelu"===i)return s.prelu(o,a);throw new Error("Activation "+i+" has not been implemented for the CPU backend.")}var cd=function(s){function o(){var i=s.call(this)||this;if(i.blockSize=48,i.firstUse=!0,E().get("IS_BROWSER")){var a=typeof OffscreenCanvas<"u"?new OffscreenCanvas(300,150):typeof document<"u"?document.createElement("canvas"):null;null!==a&&(i.fromPixels2DContext=a.getContext("2d"))}return i.data=new zx(i,Ie),i}return j(o,s),o.prototype.write=function(i,a,c){this.firstUse&&(this.firstUse=!1,E().get("IS_NODE")&&Lh("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n"));var u={};return this.data.set(u,{values:i,dtype:c}),u},o.prototype.move=function(i,a,c,u){this.data.set(i,{values:a,dtype:u})},o.prototype.numDataIds=function(){return this.data.numDataIds()},o.prototype.fromPixels=function(i,a){if(null==i)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var c,u,p=i.data instanceof Uint8Array,m=typeof ImageData<"u"&&i instanceof ImageData,g=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,v=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,y=g?[i.videoWidth,i.videoHeight]:[i.width,i.height],C=y[0],S=y[1];if(E().get("IS_NODE")&&null==i.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=i.getContext)c=i.getContext("2d").getImageData(0,0,C,S).data;else if(m||p)c=i.data;else{if(!v&&!g)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+i.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=C,this.fromPixels2DContext.canvas.height=S,this.fromPixels2DContext.drawImage(i,0,0,C,S),c=this.fromPixels2DContext.getImageData(0,0,C,S).data}if(4===a)u=new Int32Array(c);else{var M=C*S;u=new Int32Array(M*a);for(var O=0;O<M;O++)for(var N=0;N<a;++N)u[O*a+N]=c[4*O+N]}return Jr(u,[S,C,a],"int32")},o.prototype.read=function(i){return J(this,void 0,void 0,function(){return K(this,function(a){return[2,this.readSync(i)]})})},o.prototype.readSync=function(i){var a=this.data.get(i),u=a.complexTensors;return"complex64"===a.dtype?Ko(this.readSync(u.real.dataId),this.readSync(u.imag.dataId)):this.data.get(i).values},o.prototype.bufferSync=function(i){var a=this.readSync(i.dataId),c=a;if("string"===i.dtype)try{c=a.map(function(u){return We(u)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Rt(i.shape,i.dtype,c)},o.prototype.makeOutput=function(i,a,c){var u=this.write(i,a,c);return Ie.makeTensorFromDataId(u,a,c,this)},o.prototype.disposeData=function(i){if(this.data.has(i)){var a=this.data.get(i).complexTensors;null!=a&&(a.real.dispose(),a.imag.dispose()),this.data.delete(i)}},o.prototype.time=function(i){return J(this,void 0,void 0,function(){var a;return K(this,function(c){return a=Oe(),i(),[2,{kernelMs:Oe()-a}]})})},o.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},o.prototype.complex=function(i,a){var c=this.makeOutput(null,i.shape,"complex64");return this.data.get(c.dataId).complexTensors={real:Ie.keep(i.clone()),imag:Ie.keep(a.clone())},c},o.prototype.real=function(i){return this.data.get(i.dataId).complexTensors.real.clone()},o.prototype.imag=function(i){return this.data.get(i.dataId).complexTensors.imag.clone()},o.prototype.slice=function(i,a,c){if(wt(i,"slice"),Lx(i.shape,a,c)){var u=Bx(a,i.strides),p=de(c);return ei(this.readSync(i.dataId).subarray(u,u+p),c,i.dtype)}for(var m=Rt(c,i.dtype),g=this.bufferSync(i),v=0;v<m.size;++v){var y=m.indexToLoc(v).map(function(C,S){return C+a[S]});m.values[v]=g.get.apply(g,y)}return m.toTensor()},o.prototype.stridedSlice=function(i,a,c,u){wt(i,"stridedSlice");var p=$_(a,c,u);if(p.some(function(M){return 0===M}))return ei([],p);for(var m=Rt(p,i.dtype),g=this.bufferSync(i),v=0;v<m.size;v++){for(var y=m.indexToLoc(v),C=new Array(y.length),S=0;S<C.length;S++)C[S]=y[S]*u[S]+a[S];m.set.apply(m,[g.get.apply(g,C)].concat(y))}return m.toTensor()},o.prototype.diag=function(i){for(var a=this.readSync(i.dataId),c=Rt([i.size,i.size],i.dtype),u=c.values,p=0;p<a.length;p++)u[p*i.size+p]=a[p];return c.toTensor()},o.prototype.unstack=function(i,a){for(var c=i.shape[a],u=new Array(i.rank-1),p=0,m=0;m<i.rank;m++)m!==a&&(u[p++]=i.shape[m]);var g=new Array(i.rank).fill(0),v=i.shape.slice();v[a]=1;var y=new Array(c);for(m=0;m<y.length;m++)g[a]=m,y[m]=this.slice(i,g,v).reshape(u);return y},o.prototype.reverse=function(i,a){wt(i,"reverse");for(var c=Rt(i.shape,i.dtype),u=this.bufferSync(i),p=function(g){var v=c.indexToLoc(g),y=v.slice();a.forEach(function(C){return y[C]=i.shape[C]-1-y[C]}),c.set.apply(c,[u.get.apply(u,y)].concat(v))},m=0;m<c.size;m++)p(m);return c.toTensor()},o.prototype.concat=function(i,a){var c=this;if("complex64"===i[0].dtype){var u=i.map(function(M){return Ft(M)}),p=i.map(function(M){return Xn(M)});return Cn(this.concat(u,a),this.concat(p,a))}var m=i.map(function(M){var O=de(M.shape.slice(a));return M.as2D(-1,O)}),g=on(m.map(function(M){return M.shape}),1),v=Rt(g,i[0].dtype).values;if(1===m[0].shape[0]){var y=0;m.forEach(function(M){v.set(c.readSync(M.dataId),y),y+=M.size})}else{var C=0;m.forEach(function(M){for(var O=c.readSync(M.dataId),N=0,P=0;P<M.shape[0];++P)for(var B=P*g[1]+C,W=0;W<M.shape[1];++W)v[B+W]=O[N++];C+=M.shape[1]})}var S=on(i.map(function(M){return M.shape}),a);return ei(v,S,i[0].dtype)},o.prototype.neg=function(i){return wt(i,"neg"),this.multiply(Nt(-1),i)},o.prototype.add=function(i,a){return"complex64"===i.dtype||"complex64"===a.dtype?this.broadcastedBinaryComplexOp(i.cast("complex64"),a.cast("complex64"),function(c,u,p,m){return{real:c+p,imag:u+m}}):this.broadcastedBinaryOp(i,a,dr(i.dtype,a.dtype),function(c,u){return c+u})},o.prototype.addN=function(i){var a=this;wt(i,"addN");for(var c=i.map(function(y){return a.readSync(y.dataId)}),u=Rt(i[0].shape,i[0].dtype),p=u.values,m=0;m<i.length;m++)for(var g=c[m],v=0;v<p.length;v++)p[v]+=g[v];return u.toTensor()},o.prototype.subtract=function(i,a){return"complex64"===i.dtype||"complex64"===a.dtype?this.broadcastedBinaryComplexOp(i.cast("complex64"),a.cast("complex64"),function(c,u,p,m){return{real:c-p,imag:u-m}}):this.broadcastedBinaryOp(i,a,dr(i.dtype,a.dtype),function(c,u){return c-u})},o.prototype.pow=function(i,a){return wt([i,a],"pow"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){return Math.pow(c,u)})},o.prototype.batchMatMul=function(i,a,c,u){wt([i,a],"matMul");for(var p=c?i.shape[1]:i.shape[2],m=c?i.shape[2]:i.shape[1],g=u?a.shape[1]:a.shape[2],v=i.shape[0],y=this.readSync(i.dataId),C=this.readSync(a.dataId),S=c?[i.strides[0],1,i.strides[1]]:[i.strides[0],i.strides[1],1],M=S[0],O=S[1],N=S[2],P=u?[1,a.strides[1],a.strides[0]]:[a.strides[1],1,a.strides[0]],B=P[0],W=P[1],G=P[2],X=m*g,Q=Rt([v,m,g],i.dtype),se=Q.values,ue=this.blockSize,fe=0;fe<v;fe++)for(var _e=0;_e<m;_e+=ue)for(var me=0;me<g;me+=ue)for(var Me=0;Me<p;Me+=ue)for(var Te=Math.min(_e+ue,m),Ue=Math.min(me+ue,g),Xe=Math.min(Me+ue,p),et=_e;et<Te;et++)for(var it=me;it<Ue;it++){for(var nt=0,je=Me;je<Xe;je++)nt+=y[fe*M+et*O+je*N]*C[je*B+it*W+fe*G];se[fe*X+(et*g+it)]+=nt}return Q.toTensor()},o.prototype.fusedBatchMatMul=function(i){var m=i.bias,g=i.activation,v=i.preluActivationWeights,y=this.batchMatMul(i.a,i.b,i.transposeA,i.transposeB);return m&&(y=this.add(y,m)),g&&(y=ig(this,y,g,v)),y},o.prototype.multiply=function(i,a){return"complex64"===i.dtype||"complex64"===a.dtype?this.broadcastedBinaryComplexOp(i.cast("complex64"),a.cast("complex64"),function(c,u,p,m){return{real:c*p-u*m,imag:c*m+u*p}}):this.broadcastedBinaryOp(i,a,dr(i.dtype,a.dtype),function(c,u){return c*u})},o.prototype.realDivide=function(i,a){return wt([i,a],"realDivide"),this.broadcastedBinaryOp(i,a,"float32",function(c,u){return c/u})},o.prototype.floorDiv=function(i,a){return wt([i,a],"floorDiv"),this.broadcastedBinaryOp(i,a,"int32",function(c,u){return Math.floor(c/u)})},o.prototype.sum=function(i,a){wt(i,"sum"),lt("sum",a,i.rank);for(var c=Pe(i.shape,a),p=c[1],m=fn(c[0],dr(i.dtype,"int32")),g=de(p),v=this.readSync(m.dataId),y=this.readSync(i.dataId),C=0;C<v.length;++C){for(var S=C*g,M=0,O=0;O<g;++O)M+=y[S+O];v[C]=M}return m},o.prototype.prod=function(i,a){wt(i,"sum");for(var c=Pe(i.shape,a),p=c[1],m=fn(c[0],dr(i.dtype,"int32")),g=de(p),v=this.readSync(m.dataId),y=this.readSync(i.dataId),C=0;C<v.length;++C){for(var S=C*g,M=1,O=0;O<g;++O)M*=y[S+O];v[C]=M}return m},o.prototype.unsortedSegmentSum=function(i,a,c){wt(i,"unsortedSegmentSum");for(var u=[],p=i.rank-a.rank,m=0;m<p;++m)a=a.expandDims(m+1);for(m=0;m<c;++m){var g=Nt(m,"int32"),v=Jc(g,a).asType("float32").mul(i).sum(0);u.push(v)}return Qa(u)},o.prototype.argMin=function(i,a){wt(i,"argMin");var c=[a];lt("argMin",c,i.rank);for(var u=Pe(i.shape,c),m=u[1],g=fn(u[0],"int32"),v=de(m),y=this.readSync(g.dataId),C=this.readSync(i.dataId),S=0;S<y.length;++S){for(var M=S*v,O=C[M],N=0,P=0;P<v;++P){var B=C[M+P];B<O&&(O=B,N=P)}y[S]=N}return g},o.prototype.argMax=function(i,a){wt(i,"argMax");var c=[a];lt("argMax",c,i.rank);for(var u=Pe(i.shape,c),m=u[1],g=fn(u[0],"int32"),v=de(m),y=this.readSync(g.dataId),C=this.readSync(i.dataId),S=0;S<y.length;++S){for(var M=S*v,O=C[M],N=0,P=0;P<v;++P){var B=C[M+P];B>O&&(O=B,N=P)}y[S]=N}return g},o.prototype.cumsum=function(i,a,c,u){if(wt(i,"cumsum"),a!==i.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(i.rank-1)+" but got axis="+a);for(var p=dr(i.dtype,"int32"),m=fn(i.shape,p),g=this.readSync(m.dataId),v=this.readSync(i.dataId),y=i.shape[i.rank-1],C=u?function(P,B){return P+y-B-1}:function(P,B){return P+B},S=0;S<v.length;S+=y)for(var M=0;M<y;M++){var O=C(S,M);if(0===M)g[O]=c?0:v[O];else{var N=C(S,M-1);g[O]=c?v[N]+g[N]:v[O]+g[N]}}return m},o.prototype.equal=function(i,a){return wt([i,a],"equal"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c===u?1:0})},o.prototype.notEqual=function(i,a){return wt([i,a],"notEqual"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c!==u?1:0})},o.prototype.less=function(i,a){return wt([i,a],"less"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c<u?1:0})},o.prototype.lessEqual=function(i,a){return wt([i,a],"lessEqual"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c<=u?1:0})},o.prototype.greater=function(i,a){return wt([i,a],"greater"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c>u?1:0})},o.prototype.greaterEqual=function(i,a){return wt([i,a],"greaterEqual"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c>=u?1:0})},o.prototype.logicalNot=function(i){wt(i,"logicalNot");for(var a=this.readSync(i.dataId),c=new Uint8Array(a.length),u=0;u<a.length;++u)c[u]=a[u]?0:1;return this.makeOutput(c,i.shape,"bool")},o.prototype.logicalAnd=function(i,a){return wt([i,a],"logicalAnd"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c&&u})},o.prototype.logicalOr=function(i,a){return wt([i,a],"logicalOr"),this.broadcastedBinaryOp(i,a,"bool",function(c,u){return c||u})},o.prototype.select=function(i,a,c){wt([i,a,c],"select");for(var u=this.readSync(i.dataId),p=this.readSync(a.dataId),m=this.readSync(c.dataId),g=fn(a.shape,dr(a.dtype,c.dtype)),v=this.readSync(g.dataId),y=0,C=0===i.rank||i.rank>1||1===a.rank?1:de(a.shape.slice(1)),S=0;S<u.length;S++)for(var M=0;M<C;M++)v[y++]=1===u[S]?p[S]:m[S];return g},o.prototype.where=function(i){wt([i],"where");var a=this.readSync(i.dataId);return Hx(i.shape,a)},o.prototype.topk=function(i,a,c){return wt(i,"topk"),Y_(this.readSync(i.dataId),i.shape,i.dtype,a)},o.prototype.min=function(i,a){wt(i,"min"),lt("min",a,i.rank);for(var c=Pe(i.shape,a),p=c[1],m=fn(c[0],i.dtype),g=de(p),v=this.readSync(m.dataId),y=this.readSync(i.dataId),C=0;C<v.length;++C){for(var S=C*g,M=y[S],O=0;O<g;++O){var N=y[S+O];N<M&&(M=N)}v[C]=M}return m},o.prototype.minimum=function(i,a){return wt([i,a],"minimum"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){return Math.min(c,u)})},o.prototype.mod=function(i,a){return wt([i,a],"mod"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){var p=c%u;return c<0&&u<0||c>=0&&u>=0?p:(p+u)%u})},o.prototype.max=function(i,a){wt(i,"max"),lt("max",a,i.rank);for(var c=Pe(i.shape,a),p=c[1],m=fn(c[0],i.dtype),g=de(p),v=this.readSync(m.dataId),y=this.readSync(i.dataId),C=0;C<v.length;++C){for(var S=C*g,M=y[S],O=0;O<g;++O){var N=y[S+O];N>M&&(M=N)}v[C]=M}return m},o.prototype.maximum=function(i,a){return wt([i,a],"maximum"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){return Math.max(c,u)})},o.prototype.all=function(i,a){wt(i,"all"),lt("all",a,i.rank);for(var c=Pe(i.shape,a),p=c[1],m=fn(c[0],i.dtype),g=de(p),v=this.readSync(m.dataId),y=this.readSync(i.dataId),C=0;C<v.length;++C){for(var S=C*g,M=y[S],O=0;O<g;++O)M=M&&y[S+O];v[C]=M}return m},o.prototype.any=function(i,a){wt(i,"any"),lt("any",a,i.rank);for(var c=Pe(i.shape,a),p=c[1],m=fn(c[0],i.dtype),g=de(p),v=this.readSync(m.dataId),y=this.readSync(i.dataId),C=0;C<v.length;++C){for(var S=C*g,M=y[S],O=0;O<g;++O)M=M||y[S+O];v[C]=M}return m},o.prototype.squaredDifference=function(i,a){return wt([i,a],"squaredDifference"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){var p=c-u;return p*p})},o.prototype.ceil=function(i){wt(i,"ceil");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.ceil(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.floor=function(i){wt(i,"floor");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.floor(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.sign=function(i){wt(i,"x");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=a[u]<0?-1:a[u]>0?1:0;return this.makeOutput(c,i.shape,"float32")},o.prototype.isNaN=function(i){wt(i,"x");for(var a=this.readSync(i.dataId),c=new Uint8Array(a.length),u=0;u<a.length;++u)Number.isNaN(a[u])&&(c[u]=1);return this.makeOutput(c,i.shape,"bool")},o.prototype.isInf=function(i){wt(i,"x");for(var a=this.readSync(i.dataId),c=new Uint8Array(a.length),u=0;u<a.length;++u)Math.abs(a[u])===1/0&&(c[u]=1);return this.makeOutput(c,i.shape,"bool")},o.prototype.isFinite=function(i){wt(i,"x");for(var a=this.readSync(i.dataId),c=new Uint8Array(a.length),u=0;u<a.length;++u)Number.isFinite(a[u])&&(c[u]=1);return this.makeOutput(c,i.shape,"bool")},o.prototype.round=function(i){wt(i,"round");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u){var p=Math.floor(a[u]);c[u]=a[u]-p<.5?Math.floor(a[u]):a[u]-p>.5?Math.ceil(a[u]):p%2==0?p:p+1}return this.makeOutput(c,i.shape,"float32")},o.prototype.exp=function(i){wt(i,"exp");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.exp(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.expm1=function(i){wt(i,"expm1");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.expm1(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.log=function(i){wt(i,"log");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.log(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.log1p=function(i){wt(i,"log1p");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.log1p(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.sqrt=function(i){wt(i,"sqrt");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=Math.sqrt(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.rsqrt=function(i){wt(i,"rsqrt");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=1/Math.sqrt(a[u]);return this.makeOutput(c,i.shape,"float32")},o.prototype.reciprocal=function(i){wt(i,"reciprocal");for(var a=this.readSync(i.dataId),c=new Float32Array(a.length),u=0;u<a.length;++u)c[u]=1/a[u];return this.makeOutput(c,i.shape,"float32")},o.prototype.linear=function(i){return i},o.prototype.relu=function(i){wt(i,"relu");for(var a=fn(i.shape,i.dtype),c=this.readSync(a.dataId),u=this.readSync(i.dataId),p=0;p<u.length;++p)c[p]=Math.max(0,u[p]);return a},o.prototype.relu6=function(i){wt(i,"relu");for(var a=fn(i.shape,i.dtype),c=this.readSync(a.dataId),u=this.readSync(i.dataId),p=0;p<u.length;++p)c[p]=Math.min(Math.max(0,u[p]),6);return a},o.prototype.prelu=function(i,a){return wt([i,a],"prelu"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){return c<0?u*c:c})},o.prototype.elu=function(i){wt(i,"elu");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u){var p=c[u];a[u]=p>=0?p:Math.exp(p)-1}return this.makeOutput(a,i.shape,"float32")},o.prototype.eluDer=function(i,a){wt([i,a],"eluDer");for(var c=new Float32Array(a.size),u=this.readSync(a.dataId),p=this.readSync(i.dataId),m=0;m<u.length;++m){var g=u[m];c[m]=g>=1?p[m]:p[m]*(g+1)}return this.makeOutput(c,a.shape,"float32")},o.prototype.selu=function(i){wt(i,"selu");for(var u=new Float32Array(i.size),p=this.readSync(i.dataId),m=0;m<p.length;++m){var g=p[m];u[m]=g>=0?1.0507009873554805*g:1.7580993408473768*(Math.exp(g)-1)}return this.makeOutput(u,i.shape,"float32")},o.prototype.clip=function(i,a,c){wt(i,"clip");for(var u=new Float32Array(i.size),p=this.readSync(i.dataId),m=0;m<p.length;++m){var g=p[m];u[m]=g>c?c:g<a?a:g}return this.makeOutput(u,i.shape,"float32")},o.prototype.abs=function(i){for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.abs(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.complexAbs=function(i){for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<i.size;++u)a[u]=Math.hypot(c[2*u],c[2*u+1]);return this.makeOutput(a,i.shape,"float32")},o.prototype.int=function(i){wt(i,"int");for(var a=new Int32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=c[u];return this.makeOutput(a,i.shape,"int32")},o.prototype.sigmoid=function(i){wt(i,"sigmoid");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=1/(1+Math.exp(-c[u]));return this.makeOutput(a,i.shape,"float32")},o.prototype.softplus=function(i){wt(i,"softplus");for(var a=Math.log(1.1920928955078125e-7)+2,c=new Float32Array(i.size),u=this.readSync(i.dataId),p=0;p<u.length;++p){var y,m=u[p]>-a,g=u[p]<a,v=Math.exp(u[p]);y=g?v:m?u[p]:Math.log(1+v),c[p]=y}return this.makeOutput(c,i.shape,"float32")},o.prototype.sin=function(i){wt(i,"sin");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.sin(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.cos=function(i){wt(i,"cos");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.cos(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.tan=function(i){wt(i,"tan");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.tan(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.asin=function(i){wt(i,"asin");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.asin(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.acos=function(i){wt(i,"acos");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.acos(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.atan=function(i){wt(i,"atan");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.atan(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.atan2=function(i,a){return wt([i,a],"atan2"),this.broadcastedBinaryOp(i,a,i.dtype,function(c,u){return Math.atan2(c,u)})},o.prototype.sinh=function(i){wt(i,"sinh");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.sinh(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.cosh=function(i){wt(i,"cosh");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.cosh(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.tanh=function(i){wt(i,"tanh");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=De(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.asinh=function(i){wt(i,"asinh");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.asinh(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.acosh=function(i){wt(i,"acosh");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.acosh(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.atanh=function(i){wt(i,"atanh");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u)a[u]=Math.atanh(c[u]);return this.makeOutput(a,i.shape,"float32")},o.prototype.erf=function(i){wt(i,"erf");for(var a=new Float32Array(i.size),c=this.readSync(i.dataId),u=0;u<c.length;++u){var p=Math.sign(c[u]),m=Math.abs(c[u]),g=1/(1+.3275911*m);a[u]=p*(1-((((1.061405429*g-1.453152027)*g+1.421413741)*g-.284496736)*g+.254829592)*g*Math.exp(-m*m))}return this.makeOutput(a,i.shape,"float32")},o.prototype.step=function(i,a){void 0===a&&(a=0),wt(i,"step");for(var c=new Float32Array(i.size),u=this.readSync(i.dataId),p=0;p<u.length;++p){var m=u[p];c[p]=isNaN(m)?NaN:m>0?1:a}return this.makeOutput(c,i.shape,"float32")},o.prototype.fusedConv2d=function(i){var p=i.bias,m=i.activation,g=i.preluActivationWeights,v=this.conv2d(i.input,i.filter,i.convInfo);return p&&(v=this.add(v,p)),m&&(v=ig(this,v,m,g)),v},o.prototype.conv2d=function(i,a,c){wt([i,a],"conv2d");for(var u=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,v=c.padInfo.left,y=c.padInfo.top,C="channelsLast"===c.dataFormat,S=Rt(c.outShape,i.dtype),M=i.strides[0],O=C?i.strides[1]:i.strides[2],N=C?i.strides[2]:1,P=C?1:i.strides[1],B=S.strides[0],W=C?S.strides[1]:S.strides[2],G=C?S.strides[2]:1,X=C?1:S.strides[1],Q=this.readSync(i.dataId),se=this.readSync(a.dataId),ue=S.values,fe=0;fe<c.batchSize;++fe)for(var _e=fe*M,me=fe*B,Me=0;Me<c.outHeight;++Me)for(var Te=me+Me*W,Ue=Me*c.strideHeight-y,Xe=0;Xe<u;Xe++){var et=Ue+Xe*m;if(!(et<0||et>=c.inHeight))for(var it=Xe*a.strides[0],nt=_e+et*O,je=0;je<c.outWidth;++je)for(var ut=Te+je*G,at=je*c.strideWidth-v,yt=0;yt<p;yt++){var Gt=at+yt*g;if(!(Gt<0||Gt>=c.inWidth))for(var Xt=nt+Gt*N,Mt=it+yt*a.strides[1],Tn=0;Tn<c.inChannels;++Tn){for(var Hn=Q[Xt+Tn*P],si=0;si<c.outChannels;++si)ue[ut+si*X]+=Hn*se[Mt+si];Mt+=c.outChannels}}}return S.toTensor()},o.prototype.conv3d=function(i,a,c){for(var u=c.filterDepth,p=c.filterHeight,m=c.filterWidth,g=c.dilationDepth,v=c.dilationHeight,y=c.dilationWidth,C=c.padInfo.front,S=c.padInfo.left,M=c.padInfo.top,O=Rt(c.outShape,i.dtype),N=this.readSync(i.dataId),P=this.readSync(a.dataId),B=O.values,W=0;W<c.batchSize;++W)for(var G=W*i.strides[0],X=W*O.strides[0],Q=0;Q<c.outDepth;++Q)for(var se=X+Q*O.strides[1],ue=Q*c.strideDepth-C,fe=0;fe<u;fe++){var _e=ue+fe*g;if(!(_e<0||_e>=c.inDepth))for(var me=fe*a.strides[0],Me=G+_e*i.strides[1],Te=0;Te<c.outHeight;++Te)for(var Ue=se+Te*O.strides[2],Xe=Te*c.strideHeight-M,et=0;et<p;et++){var it=Xe+et*v;if(!(it<0||it>=c.inHeight))for(var nt=me+et*a.strides[1],je=Me+it*i.strides[2],ut=0;ut<c.outWidth;++ut)for(var at=Ue+ut*c.outChannels,yt=ut*c.strideWidth-S,Gt=0;Gt<m;Gt++){var Xt=yt+Gt*y;if(!(Xt<0||Xt>=c.inWidth))for(var Tn=je+Xt*c.inChannels,Hn=nt+Gt*a.strides[2],si=0;si<c.inChannels;++si){for(var li=N[Tn+si],ci=0;ci<c.outChannels;++ci)B[at+ci]+=li*P[Hn+ci];Hn+=c.outChannels}}}}return O.toTensor()},o.prototype.conv2dDerInput=function(i,a,c){wt([i,a],"conv2dDerInput");for(var u=Rt(c.inShape,"float32"),p=u.values,m=this.readSync(i.dataId),g=this.readSync(a.dataId),v=a.strides,y=v[0],C=v[1],S=v[2],M=c.batchSize,O=c.filterHeight,N=c.filterWidth,P=c.inChannels,B=c.inHeight,W=c.inWidth,G=c.outChannels,X=c.outHeight,Q=c.outWidth,se=c.strideHeight,ue=c.strideWidth,_e=O-1-c.padInfo.top,me=N-1-c.padInfo.left,Me="channelsLast"===c.dataFormat,Te=u.strides[0],Ue=Me?u.strides[1]:u.strides[2],Xe=Me?u.strides[2]:1,et=Me?1:u.strides[1],it=i.strides[0],nt=Me?i.strides[1]:i.strides[2],je=Me?i.strides[2]:1,ut=Me?1:i.strides[1],at=0;at<M;++at)for(var yt=0;yt<P;++yt)for(var Gt=0;Gt<B;++Gt)for(var Xt=Gt-_e,Mt=Math.max(0,Math.ceil(Xt/se)),Tn=Math.min(X,(O+Xt)/se),Hn=0;Hn<W;++Hn){for(var si=Hn-me,li=Math.max(0,Math.ceil(si/ue)),ci=Math.min(Q,(N+si)/ue),hr=0,di=Mt;di<Tn;++di)for(var Ui=di*se-Xt,Jn=li;Jn<ci;++Jn)for(var Gn=it*at+nt*di+je*Jn,Ji=y*(O-1-Ui)+C*(N-1-(Jn*ue-si))+S*yt,Hi=0;Hi<G;++Hi)hr+=m[Gn+ut*Hi]*g[Ji+Hi];p[Te*at+Ue*Gt+Xe*Hn+et*yt]=hr}return u.toTensor()},o.prototype.conv3dDerInput=function(i,a,c){for(var u=Rt(c.inShape,"float32"),p=u.values,m=u.strides,g=m[0],v=m[1],y=m[2],C=m[3],S=this.readSync(i.dataId),M=i.strides,O=M[0],N=M[1],P=M[2],B=M[3],W=this.readSync(a.dataId),G=a.strides,X=G[0],Q=G[1],se=G[2],ue=G[3],fe=c.batchSize,_e=c.filterDepth,me=c.filterHeight,Me=c.filterWidth,Te=c.inChannels,Ue=c.inDepth,Xe=c.inHeight,et=c.inWidth,it=c.outChannels,nt=c.outDepth,je=c.outHeight,ut=c.outWidth,at=c.strideDepth,yt=c.strideHeight,Gt=c.strideWidth,Xt=_e-1-c.padInfo.front,Mt=me-1-c.padInfo.top,Tn=Me-1-c.padInfo.left,Hn=0;Hn<fe;++Hn)for(var si=0;si<Te;++si)for(var li=0;li<Ue;++li)for(var ci=li-Xt,hr=Math.max(0,Math.ceil(ci/at)),di=Math.min(nt,(_e+ci)/at),Ui=0;Ui<Xe;++Ui)for(var Jn=Ui-Mt,Gn=Math.max(0,Math.ceil(Jn/yt)),Ji=Math.min(je,(me+Jn)/yt),Hi=0;Hi<et;++Hi){for(var ra=Hi-Tn,oa=Math.max(0,Math.ceil(ra/Gt)),aa=Math.min(ut,(Me+ra)/Gt),Wa=0,Co=hr;Co<di;++Co)for(var ss=Co*at-ci,ui=Gn;ui<Ji;++ui)for(var rr=ui*yt-Jn,mi=oa;mi<aa;++mi)for(var bi=O*Hn+N*Co+P*ui+B*mi,Ln=X*(_e-1-ss)+Q*(me-1-rr)+se*(Me-1-(mi*Gt-ra))+ue*si,ji=0;ji<it;++ji)Wa+=S[bi+ji]*W[Ln+ji];p[g*Hn+v*li+y*Ui+C*Hi+si]=Wa}return u.toTensor()},o.prototype.conv2dDerFilter=function(i,a,c){wt([i,a],"conv2dDerFilter");for(var u=c.strideHeight,p=c.strideWidth,m=c.filterHeight,g=c.filterWidth,v="channelsLast"===c.dataFormat,y=Rt(c.filterShape,"float32"),C=c.padInfo.left,S=c.padInfo.top,M=this.bufferSync(i),O=this.bufferSync(a),N=0;N<m;++N)for(var P=Math.max(0,Math.ceil((S-N)/u)),B=Math.min(c.outHeight,(c.inHeight+S-N)/u),W=0;W<g;++W)for(var G=Math.max(0,Math.ceil((C-W)/p)),X=Math.min(c.outWidth,(c.inWidth+C-W)/p),Q=0;Q<c.inChannels;++Q)for(var se=0;se<c.outChannels;++se){for(var ue=0,fe=0;fe<c.batchSize;++fe)for(var _e=P;_e<B;++_e)for(var me=N+_e*u-S,Me=G;Me<X;++Me){var Te=W+Me*p-C;ue+=v?M.get(fe,me,Te,Q)*O.get(fe,_e,Me,se):M.get(fe,Q,me,Te)*O.get(fe,se,_e,Me)}y.set(ue,N,W,Q,se)}return y.toTensor()},o.prototype.conv3dDerFilter=function(i,a,c){for(var u=c.strideDepth,p=c.strideHeight,m=c.strideWidth,g=c.filterDepth,v=c.filterHeight,y=c.filterWidth,C=Rt(c.filterShape,"float32"),S=C.values,M=C.strides,O=M[0],N=M[1],P=M[2],B=M[3],W=this.readSync(a.dataId),G=a.strides,X=G[0],Q=G[1],se=G[2],ue=G[3],fe=this.readSync(i.dataId),_e=i.strides,me=_e[0],Me=_e[1],Te=_e[2],Ue=_e[3],Xe=c.padInfo.front,et=c.padInfo.left,it=c.padInfo.top,nt=0;nt<g;++nt)for(var je=Math.max(0,Math.ceil((Xe-nt)/u)),ut=Math.min(c.outDepth,(c.inDepth+Xe-nt)/u),at=nt*O,yt=0;yt<v;++yt)for(var Gt=Math.max(0,Math.ceil((it-yt)/p)),Xt=Math.min(c.outHeight,(c.inHeight+it-yt)/p),Mt=yt*N+at,Tn=0;Tn<y;++Tn)for(var Hn=Math.max(0,Math.ceil((et-Tn)/m)),si=Math.min(c.outWidth,(c.inWidth+et-Tn)/m),li=Tn*P+Mt,ci=0;ci<c.inChannels;++ci)for(var hr=ci*B+li,di=0;di<c.outChannels;++di){for(var Ui=0,Jn=0;Jn<c.batchSize;++Jn)for(var Gn=Jn*me,Ji=Jn*X,Hi=je;Hi<ut;++Hi)for(var ra=(nt+Hi*u-Xe)*Me+Gn,oa=Hi*Q+Ji,aa=Gt;aa<Xt;++aa)for(var Wa=(yt+aa*p-it)*Te+ra,Co=aa*se+oa,ss=Hn;ss<si;++ss)Ui+=fe[(Tn+ss*m-et)*Ue+Wa+ci]*W[ss*ue+Co+di];S[hr+di]=Ui}return C.toTensor()},o.prototype.fusedDepthwiseConv2D=function(i){var p=i.bias,m=i.activation,g=i.preluActivationWeights,v=this.depthwiseConv2D(i.input,i.filter,i.convInfo);return p&&(v=this.add(v,p)),m&&(v=ig(this,v,m,g)),v},o.prototype.depthwiseConv2D=function(i,a,c){wt([i,a],"depthwiseConv2D");for(var u=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,v=c.padInfo.left,y=c.padInfo.top,C=c.outChannels/c.inChannels,S=Rt(c.outShape,i.dtype),M=this.readSync(i.dataId),O=this.readSync(a.dataId),N=S.values,P=0;P<c.batchSize;++P)for(var B=P*i.strides[0],W=P*S.strides[0],G=0;G<c.outHeight;++G)for(var X=W+G*S.strides[1],Q=G*c.strideHeight-v,se=0;se<u;++se){var ue=Q+se*m;if(!(ue<0||ue>=c.inHeight))for(var fe=se*a.strides[0],_e=B+ue*i.strides[1],me=0;me<c.outWidth;++me)for(var Me=X+me*S.strides[2],Te=me*c.strideWidth-y,Ue=0;Ue<p;++Ue){var Xe=Te+Ue*g;if(!(Xe<0||Xe>=c.inWidth))for(var it=_e+Xe*c.inChannels,nt=Me,je=fe+Ue*a.strides[1],ut=0;ut<c.inChannels;++ut){for(var at=M[it+ut],yt=0;yt<C;++yt)N[nt+yt]+=at*O[je+yt];nt+=C,je+=C}}}return S.toTensor()},o.prototype.depthwiseConv2DDerInput=function(i,a,c){wt([i,a],"depthwiseConv2DDerInput");for(var u=Rt(c.inShape,"float32"),p=u.values,m=u.strides,g=m[0],v=m[1],y=m[2],C=this.readSync(i.dataId),S=i.strides,M=S[0],O=S[1],N=S[2],P=this.readSync(a.dataId),B=a.strides,W=B[0],G=B[1],X=B[2],Q=c.batchSize,se=c.filterHeight,ue=c.filterWidth,fe=c.inChannels,_e=c.inHeight,me=c.inWidth,Te=c.outHeight,Ue=c.outWidth,Xe=c.strideHeight,et=c.strideWidth,it=se-1-c.padInfo.top,nt=ue-1-c.padInfo.left,je=c.outChannels/fe,ut=0;ut<Q;++ut)for(var at=0;at<fe;++at)for(var yt=0;yt<_e;++yt)for(var Gt=yt-it,Xt=Math.max(0,Math.ceil(Gt/Xe)),Mt=Math.min(Te,(se+Gt)/Xe),Tn=0;Tn<me;++Tn){for(var Hn=Tn-nt,si=Math.max(0,Math.ceil(Hn/et)),li=Math.min(Ue,(ue+Hn)/et),ci=0,hr=Xt;hr<Mt;++hr)for(var di=hr*Xe-Gt,Ui=si;Ui<li;++Ui)for(var Jn=M*ut+O*hr+N*Ui,Gn=W*(se-1-di)+G*(ue-1-(Ui*et-Hn))+X*at,Ji=0;Ji<je;++Ji)ci+=C[Jn+(at*je+Ji)]*P[Gn+Ji];p[g*ut+v*yt+y*Tn+at]=ci}return u.toTensor()},o.prototype.depthwiseConv2DDerFilter=function(i,a,c){wt([i,a],"depthwiseConv2DDerFilter");for(var u=c.strideHeight,p=c.strideWidth,m=c.filterHeight,g=c.filterWidth,v=Rt(c.filterShape,"float32"),y=c.padInfo.left,C=c.padInfo.top,S=c.outChannels/c.inChannels,M=this.bufferSync(i),O=this.bufferSync(a),N=0;N<m;++N)for(var P=Math.max(0,Math.ceil((C-N)/u)),B=Math.min(c.outHeight,(c.inHeight+C-N)/u),W=0;W<g;++W)for(var G=Math.max(0,Math.ceil((y-W)/p)),X=Math.min(c.outWidth,(c.inWidth+y-W)/p),Q=0;Q<c.outChannels;++Q){for(var se=Math.trunc(Q/S),ue=Q%S,fe=0,_e=0;_e<c.batchSize;++_e)for(var me=P;me<B;++me)for(var Me=N+me*u-C,Te=G;Te<X;++Te)fe+=M.get(_e,Me,W+Te*p-y,se)*O.get(_e,me,Te,Q);v.set(fe,N,W,se,ue)}return v.toTensor()},o.prototype.tile=function(i,a){return wt(i,"tile"),jn(this.bufferSync(i),a)},o.prototype.pad=function(i,a,c){wt(i,"pad");var u=a.map(function(S,M){return S[0]+i.shape[M]+S[1]}),p=a.map(function(S){return S[0]}),m=this.bufferSync(i),g=Rt(u,i.dtype);0!==c&&g.values.fill(c);for(var v=0;v<i.size;v++){var y=m.indexToLoc(v),C=y.map(function(S,M){return S+p[M]});g.set.apply(g,[m.get.apply(m,y)].concat(C))}return g.toTensor()},o.prototype.transpose=function(i,a){wt(i,"transpose");for(var c=new Array(i.rank),u=0;u<c.length;u++)c[u]=i.shape[a[u]];var p=this.readSync(i.dataId),m=Rt(c,i.dtype),g=this.bufferSync(i);for(u=0;u<i.size;++u){for(var v=g.indexToLoc(u),y=new Array(v.length),C=0;C<y.length;C++)y[C]=v[a[C]];var S=m.locToIndex(y);m.values[S]=p[u]}return m.toTensor()},o.prototype.gather=function(i,a,c){wt([i,a],"gather");var u=i.shape.slice(),p=this.readSync(a.dataId);u[c]=p.length;for(var m=Rt(u,i.dtype),g=this.bufferSync(i),v=0;v<m.size;++v){var y=m.indexToLoc(v),C=y.slice();C[c]=p[y[c]];var S=g.locToIndex(C);m.values[v]=g.values[S]}return m.toTensor()},o.prototype.batchToSpaceND=function(i,a,c){wt([i],"batchToSpaceND");var u=a.reduce(function(C,S){return C*S}),p=W_(i.shape,a,u),m=Bo(p.length,a.length),g=fa(i.shape,a,u),v=qf(c,a.length),y=cu(g,c,a.length);return i.reshape(p).transpose(m).reshape(g).slice(v,y)},o.prototype.spaceToBatchND=function(i,a,c){wt([i],"spaceToBatchND");var u=a.reduce(function(S,M){return S*M}),p=[[0,0]];p.push.apply(p,c);for(var m=1+a.length;m<i.shape.length;++m)p.push([0,0]);var g=i.pad(p),v=W_(g.shape,a,u,!1),y=Bo(v.length,a.length,!1),C=fa(g.shape,a,u,!1);return g.reshape(v).transpose(y).reshape(C)},o.prototype.pool=function(i,a,c){wt(i,"pool");for(var u=a.strideHeight,p=a.strideWidth,m=a.dilationHeight,g=a.dilationWidth,v=a.effectiveFilterHeight,y=a.effectiveFilterWidth,C=a.padInfo.top,S=a.padInfo.left,M="max"===c?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,O=this.readSync(i.dataId),N=Rt(a.outShape,i.dtype),P=N.values,B=a.outShape[1]*a.outShape[2]*a.outShape[3],W=a.outShape[2]*a.outShape[3],G=a.outShape[3],X=0;X<a.batchSize;++X)for(var Q=X*B,se=X*i.strides[0],ue=0;ue<a.inChannels;++ue)for(var fe=0;fe<a.outHeight;++fe)for(var _e=fe*u-C,me=Math.max(0,_e),Me=Math.min(a.inHeight,v+_e),Te=Q+fe*W,Ue=0;Ue<a.outWidth;++Ue){for(var Xe=Ue*p-S,et=Math.max(0,Xe),it=Math.min(a.inWidth,y+Xe),nt=M,je=0,ut=0,at=me;at<Me;at+=m){for(var yt=se+at*i.strides[1],Gt=et;Gt<it;Gt+=g){var Xt=O[yt+Gt*i.strides[2]+ue];"max"===c&&Xt>nt?nt=Xt:"avg"===c&&(je+=Xt,ut++)}if(isNaN(nt))break}P[Te+Ue*G+ue]="avg"===c?je/ut:nt}return N.toTensor()},o.prototype.maxPool=function(i,a){return this.pool(i,a,"max")},o.prototype.maxPoolPositions=function(i,a){for(var c=Rt(a.outShape,"int32"),u=a.strideHeight,p=a.strideWidth,m=a.dilationHeight,g=a.dilationWidth,v=a.effectiveFilterHeight,y=a.effectiveFilterWidth,C=a.padInfo.top,S=a.padInfo.left,M=this.bufferSync(i),O=0;O<a.batchSize;++O)for(var N=0;N<a.inChannels;++N)for(var P=0;P<a.outHeight;++P){for(var B=P*u-C,W=B;W<0;)W+=m;for(var G=Math.min(a.inHeight,v+B),X=0;X<a.outWidth;++X){for(var Q=X*p-S,se=Q;se<0;)se+=g;for(var ue=Math.min(a.inWidth,y+Q),fe=Number.NEGATIVE_INFINITY,_e=-1,me=W;me<G;me+=m)for(var Me=me-B,Te=se;Te<ue;Te+=g){var Ue=Te-Q,Xe=M.get(O,me,Te,N);Xe>fe&&(fe=Xe,_e=Me*y+Ue)}c.set(_e,O,P,X,N)}}return c.toTensor()},o.prototype.maxPoolBackprop=function(i,a,c,u){wt([a,c],"maxPoolBackprop");for(var p=this.maxPoolPositions(a,u),m=u.strideHeight,g=u.strideWidth,v=u.dilationHeight,y=u.dilationWidth,C=u.effectiveFilterHeight,S=u.effectiveFilterWidth,M=S-1-u.padInfo.left,O=C-1-u.padInfo.top,N=Rt(a.shape,"float32"),P=this.bufferSync(p),B=this.bufferSync(i),W=0;W<u.batchSize;++W)for(var G=0;G<u.inChannels;++G)for(var X=0;X<u.inHeight;++X)for(var Q=0;Q<u.inWidth;++Q){for(var se=X-O,ue=Q-M,fe=0,_e=0;_e<C;_e+=v){var me=(se+_e)/m;if(!(me<0||me>=u.outHeight||Math.floor(me)!==me))for(var Me=0;Me<S;Me+=y){var Te=(ue+Me)/g;if(!(Te<0||Te>=u.outWidth||Math.floor(Te)!==Te)){var Ue=C*S-1-P.get(W,me,Te,G)===_e*S+Me?1:0;0!==Ue&&(fe+=B.get(W,me,Te,G)*Ue)}}}N.set(fe,W,X,Q,G)}return N.toTensor()},o.prototype.avgPoolBackprop=function(i,a,c){wt([i,a],"avgPoolBackprop");for(var u=c.strideHeight,p=c.strideWidth,m=c.filterHeight,g=c.filterWidth,v=c.dilationHeight,y=c.dilationWidth,C=c.effectiveFilterHeight,S=c.effectiveFilterWidth,M=S-1-c.padInfo.left,O=C-1-c.padInfo.top,N=Rt(a.shape,"float32"),P=1/(m*g),B=this.bufferSync(i),W=0;W<c.batchSize;++W)for(var G=0;G<c.inChannels;++G)for(var X=0;X<c.inHeight;++X)for(var Q=0;Q<c.inWidth;++Q){for(var se=X-O,ue=Q-M,fe=0,_e=0;_e<C;_e+=v){var me=(se+_e)/u;if(!(me<0||me>=c.outHeight||Math.floor(me)!==me))for(var Me=0;Me<S;Me+=y){var Te=(ue+Me)/p;Te<0||Te>=c.outWidth||Math.floor(Te)!==Te||(fe+=B.get(W,me,Te,G))}}N.set(fe*P,W,X,Q,G)}return N.toTensor()},o.prototype.pool3d=function(i,a,c){wt(i,"pool3d");for(var u=a.strideDepth,p=a.strideHeight,m=a.strideWidth,g=a.dilationDepth,v=a.dilationHeight,y=a.dilationWidth,C=a.effectiveFilterDepth,S=a.effectiveFilterHeight,M=a.effectiveFilterWidth,O=a.padInfo.front,N=a.padInfo.top,P=a.padInfo.left,B="max"===c?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,W=this.readSync(i.dataId),G=Rt(a.outShape,i.dtype),X=G.values,Q=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],se=a.outShape[2]*a.outShape[3]*a.outShape[4],ue=a.outShape[3]*a.outShape[4],fe=a.outShape[4],_e=0;_e<a.batchSize;++_e)for(var me=_e*Q,Me=_e*i.strides[0],Te=0;Te<a.inChannels;++Te)for(var Ue=0;Ue<a.outDepth;++Ue){for(var Xe=Ue*u-O,et=Xe;et<0;)et+=g;for(var it=Math.min(a.inDepth,C+Xe),nt=me+Ue*se,je=0;je<a.outHeight;++je){for(var ut=je*p-N,at=ut;at<0;)at+=v;for(var yt=Math.min(a.inHeight,S+ut),Gt=nt+je*ue,Xt=0;Xt<a.outWidth;++Xt){for(var Mt=Xt*m-P,Tn=Mt;Tn<0;)Tn+=y;for(var Hn=Math.min(a.inWidth,M+Mt),si=Gt+Xt*fe,li=B,ci=0,hr=0,di=et;di<it;di+=g){for(var Ui=Me+di*i.strides[1],Jn=at;Jn<yt;Jn+=v){for(var Gn=Ui+Jn*i.strides[2],Ji=Tn;Ji<Hn;Ji+=y){var Hi=W[Gn+Ji*i.strides[3]+Te];if("max"===c&&Hi>li?li=Hi:"avg"===c&&(ci+=Hi,hr++),isNaN(li))break}if(isNaN(li))break}if(isNaN(li))break}X[si+Te]="avg"===c?ci/hr:li}}}return G.toTensor()},o.prototype.avgPool3d=function(i,a){return wt(i,"avgPool3d"),this.pool3d(i,a,"avg").toFloat()},o.prototype.avgPool3dBackprop=function(i,a,c){wt([i,a],"avgPool3dBackprop");for(var u=c.strideDepth,p=c.strideHeight,m=c.strideWidth,g=c.filterDepth,v=c.filterHeight,y=c.filterWidth,C=c.dilationDepth,S=c.dilationHeight,M=c.dilationWidth,O=c.effectiveFilterDepth,N=c.effectiveFilterHeight,P=c.effectiveFilterWidth,B=O-1-c.padInfo.front,W=P-1-c.padInfo.left,G=N-1-c.padInfo.top,X=Rt(a.shape,"float32"),Q=1/(g*v*y),se=this.bufferSync(i),ue=0;ue<c.batchSize;++ue)for(var fe=0;fe<c.inChannels;++fe)for(var _e=0;_e<c.inDepth;++_e)for(var me=0;me<c.inHeight;++me)for(var Me=0;Me<c.inWidth;++Me){for(var Te=_e-B,Ue=me-G,Xe=Me-W,et=0,it=0;it<O;it+=C){var nt=(Te+it)/u;if(!(nt<0||nt>=c.outDepth||Math.floor(nt)!==nt))for(var je=0;je<N;je+=S){var ut=(Ue+je)/p;if(!(ut<0||ut>=c.outHeight||Math.floor(ut)!==ut))for(var at=0;at<P;at+=M){var yt=(Xe+at)/m;yt<0||yt>=c.outWidth||Math.floor(yt)!==yt||(et+=se.get(ue,nt,ut,yt,fe))}}}X.set(et*Q,ue,_e,me,Me,fe)}return X.toTensor()},o.prototype.maxPool3d=function(i,a){return wt(i,"maxPool3d"),this.pool3d(i,a,"max").toFloat()},o.prototype.maxPool3dPositions=function(i,a){for(var c=Rt(a.outShape,"int32"),u=a.strideDepth,p=a.strideHeight,m=a.strideWidth,g=a.dilationDepth,v=a.dilationHeight,y=a.dilationWidth,C=a.effectiveFilterDepth,S=a.effectiveFilterHeight,M=a.effectiveFilterWidth,O=a.padInfo.front,N=a.padInfo.top,P=a.padInfo.left,B=this.bufferSync(i),W=0;W<a.batchSize;++W)for(var G=0;G<a.inChannels;++G)for(var X=0;X<a.outDepth;++X){for(var Q=X*u-O,se=Q;se<0;)se+=g;for(var ue=Math.min(a.inDepth,C+Q),fe=0;fe<a.outHeight;++fe){for(var _e=fe*p-N,me=_e;me<0;)me+=v;for(var Me=Math.min(a.inHeight,S+_e),Te=0;Te<a.outWidth;++Te){for(var Ue=Te*m-P,Xe=Ue;Xe<0;)Xe+=y;for(var et=Math.min(a.inWidth,M+Ue),it=Number.NEGATIVE_INFINITY,nt=-1,je=se;je<ue;je+=g)for(var ut=je-Q,at=me;at<Me;at+=v)for(var yt=at-_e,Gt=Xe;Gt<et;Gt+=y){var Xt=Gt-Ue,Mt=B.get(W,je,at,Gt,G);Mt>=it&&(it=Mt,nt=ut*S*M+yt*S+Xt)}c.set(nt,W,X,fe,Te,G)}}}return c.toTensor()},o.prototype.maxPool3dBackprop=function(i,a,c,u){wt([a,c],"maxPool3dBackprop");for(var p=this.maxPool3dPositions(a,u),m=u.strideDepth,g=u.strideHeight,v=u.strideWidth,y=u.dilationDepth,C=u.dilationHeight,S=u.dilationWidth,M=u.effectiveFilterDepth,O=u.effectiveFilterHeight,N=u.effectiveFilterWidth,P=M-1-u.padInfo.front,B=N-1-u.padInfo.left,W=O-1-u.padInfo.top,G=Rt(a.shape,"float32"),X=this.bufferSync(p),Q=this.bufferSync(i),se=0;se<u.batchSize;++se)for(var ue=0;ue<u.inChannels;++ue)for(var fe=0;fe<u.inDepth;++fe)for(var _e=0;_e<u.inHeight;++_e)for(var me=0;me<u.inWidth;++me){for(var Me=fe-P,Te=_e-W,Ue=me-B,Xe=0,et=0;et<M;et+=y){var it=(Me+et)/m;if(!(it<0||it>=u.outDepth||Math.floor(it)!==it))for(var nt=0;nt<O;nt+=C){var je=(Te+nt)/g;if(!(je<0||je>=u.outHeight||Math.floor(je)!==je))for(var ut=0;ut<N;ut+=S){var at=(Ue+ut)/v;if(!(at<0||at>=u.outWidth||Math.floor(at)!==at)){var yt=M*O*N-1-X.get(se,it,je,at,ue)===et*O*N+nt*N+ut?1:0;0!==yt&&(Xe+=Q.get(se,it,je,at,ue)*yt)}}}}G.set(Xe,se,fe,_e,me,ue)}return G.toTensor()},o.prototype.cast=function(i,a){return Yo(i,a,this)},o.prototype.reshape=function(i,a){return Xf(i,a)},o.prototype.avgPool=function(i,a){return wt(i,"avgPool"),this.pool(i,a,"avg").toFloat()},o.prototype.resizeBilinear=function(i,a,c,u){wt(i,"resizeBilinear");for(var p=i.shape,m=p[0],g=p[1],v=p[2],y=p[3],C=this.readSync(i.dataId),S=new Float32Array(de([m,a,c,y])),M=[u&&a>1?g-1:g,u&&c>1?v-1:v],O=[u&&a>1?a-1:a,u&&c>1?c-1:c],N=0,P=M[0]/O[0],B=M[1]/O[1],W=0;W<m;W++)for(var G=0;G<a;G++)for(var X=P*G,Q=Math.floor(X),se=X-Q,ue=Math.min(g-1,Math.ceil(X)),fe=W*i.strides[0]+Q*i.strides[1],_e=W*i.strides[0]+ue*i.strides[1],me=0;me<c;me++)for(var Me=B*me,Te=Math.floor(Me),Ue=Me-Te,Xe=Math.min(v-1,Math.ceil(Me)),et=fe+Te*i.strides[2],it=_e+Te*i.strides[2],nt=fe+ +Xe*i.strides[2],je=_e+Xe*i.strides[2],ut=0;ut<y;ut++){var at=C[et+ut],yt=C[it+ut],Gt=at+(C[nt+ut]-at)*Ue;S[N++]=Gt+(yt+(C[je+ut]-yt)*Ue-Gt)*se}return ei(S,[m,a,c,y])},o.prototype.resizeBilinearBackprop=function(i,a,c){wt([i,a],"resizeBilinearBackprop");for(var u=a.shape,p=u[0],m=u[1],g=u[2],v=u[3],y=i.shape,C=y[1],S=y[2],M=new Float32Array(p*m*g*v),O=[c&&C>1?m-1:m,c&&S>1?g-1:g],N=[c&&C>1?C-1:C,c&&S>1?S-1:S],P=O[0]/N[0],B=O[1]/N[1],W=this.readSync(i.dataId),G=0,X=0;X<p;X++)for(var Q=X*a.strides[0],se=0;se<C;se++)for(var ue=se*P,fe=Math.floor(ue),_e=Math.min(Math.ceil(ue),m-1),me=Q+fe*a.strides[1],Me=Q+_e*a.strides[1],Te=ue-fe,Ue=1-Te,Xe=0;Xe<S;Xe++)for(var et=Xe*B,it=Math.floor(et),nt=Math.min(Math.ceil(et),g-1),je=et-it,ut=1-je,at=me+it*a.strides[2],yt=me+nt*a.strides[2],Gt=Me+it*a.strides[2],Xt=Me+nt*a.strides[2],Mt=Ue*ut,Tn=Ue*je,Hn=Te*ut,si=Te*je,li=0;li<v;li++){var ci=W[G++];M[at+li]+=ci*Mt,M[yt+li]+=ci*Tn,M[Gt+li]+=ci*Hn,M[Xt+li]+=ci*si}return oo(M,[p,g,m,v],a.dtype)},o.prototype.resizeNearestNeighbor=function(i,a,c,u){wt(i,"resizeNearestNeighbor");for(var p=i.shape,m=p[0],g=p[1],v=p[2],y=p[3],C=this.readSync(i.dataId),S=new Float32Array(m*a*c*y),M=[u&&a>1?g-1:g,u&&c>1?v-1:v],O=[u&&a>1?a-1:a,u&&c>1?c-1:c],N=M[0]/O[0],P=M[1]/O[1],B=0,W=0;W<m;W++)for(var G=W*i.strides[0],X=0;X<a;X++)for(var Q=N*X,se=G+Math.min(g-1,u?Math.round(Q):Math.floor(Q))*i.strides[1],ue=0;ue<c;ue++)for(var fe=P*ue,_e=se+Math.min(v-1,u?Math.round(fe):Math.floor(fe))*i.strides[2],me=0;me<y;me++)S[B++]=C[_e+me];return ei(S,[m,a,c,y],i.dtype)},o.prototype.resizeNearestNeighborBackprop=function(i,a,c){wt([i,a],"resizeNearestNeighborBackprop");for(var u=a.shape,p=u[0],m=u[1],g=u[2],v=u[3],y=i.shape,C=y[1],S=y[2],M=new Float32Array(p*m*g*v),O=this.readSync(i.dataId),N=[c&&C>1?m-1:m,c&&S>1?g-1:g],P=[c&&C>1?C-1:C,c&&S>1?S-1:S],B=N[0]/P[0],W=N[1]/P[1],G=1/B,X=1/W,Q=2*Math.ceil(G)+2,se=2*Math.ceil(X)+2,ue=0;ue<p;ue++)for(var fe=ue*a.strides[0],_e=0;_e<m;_e++)for(var me=fe+_e*a.strides[1],Me=Math.floor(_e*G),Te=Math.floor(Me-Q/2),Ue=0;Ue<g;Ue++)for(var Xe=me+Ue*a.strides[2],et=Math.floor(Ue*X),it=Math.floor(et-se/2),nt=0;nt<v;nt++){for(var je=0,ut=0;ut<Q;ut++){var at=ut+Te;if(!(at<0||at>=C)){var yt=fe+at*i.strides[1],Gt=at*B;if(_e===Math.min(m-1,c?Math.round(Gt):Math.floor(Gt)))for(var Xt=0;Xt<se;Xt++){var Mt=Xt+it;if(!(Mt<0||Mt>=S)){var Tn=yt+Mt*i.strides[2],Hn=Mt*W;Ue===Math.min(g-1,c?Math.round(Hn):Math.floor(Hn))&&(je+=O[Tn+nt])}}}}M[Xe+nt]=je}return oo(M,a.shape,a.dtype)},o.prototype.batchNormalization=function(i,a,c,u,p,m){wt([i,a,c,p,m],"batchNorm");for(var g=this.readSync(i.dataId),v=this.readSync(a.dataId),y=this.readSync(c.dataId),C=p?this.readSync(p.dataId):new Float32Array([1]),S=m?this.readSync(m.dataId):new Float32Array([0]),M=new Float32Array(g.length),O=S.length,N=C.length,P=y.length,B=v.length,W=0,G=0,X=0,Q=0,se=0;se<g.length;++se)M[se]=S[W++]+(g[se]-v[G++])*C[X++]/Math.sqrt(y[Q++]+u),W>=O&&(W=0),G>=B&&(G=0),X>=N&&(X=0),Q>=P&&(Q=0);return oo(M,i.shape)},o.prototype.localResponseNormalization4D=function(i,a,c,u,p){wt(i,"localResponseNormalization4D");var m=i.shape[3],g=m-1,v=this.readSync(i.dataId),y=i.size,C=new Float32Array(y);function S(P){for(var B=P%m,W=P-B+Math.max(0,B-a),G=P-B+Math.min(B+a,g),X=0;W<=G;W++){var Q=v[W];X+=Q*Q}return X}for(var M=0;M<y;M++){var O=S(M),N=v[M]*Math.pow(c+u*O,-p);C[M]=N}return oo(C,i.shape)},o.prototype.LRNGrad=function(i,a,c,u,p,m,g){wt(i,"LRNGrad");for(var v=i.shape[3],y=this.readSync(i.dataId),C=this.readSync(a.dataId),S=this.readSync(c.dataId),M=new Float32Array(i.size),O=i.size,N=0;N<O;N++){for(var P=N%v,B=N-P+Math.max(0,P-u),W=N-P+Math.min(v,P+u+1),G=0,X=B;X<W;X++)G+=Math.pow(C[X],2);for(G=m*G+p,X=B;X<W;X++){var Q=-2*m*g*C[X]*S[N]/G;N===X&&(Q+=Math.pow(G,-g)),M[X]+=Q*=y[N]}}return oo(M,i.shape)},o.prototype.multinomial=function(i,a,c,u){wt(i,"multinomial");for(var p=a?i:du(i),m=p.shape[0],g=p.shape[1],v=fn([m,c],"int32"),y=this.readSync(v.dataId),C=this.readSync(p.dataId),S=0;S<m;++S){var M=S*g,O=new Float32Array(g-1);O[0]=C[M];for(var N=1;N<O.length;++N)O[N]=O[N-1]+C[M+N];for(var P=gl(u.toString()),B=S*c,W=0;W<c;++W){var G=P();y[B+W]=O.length;for(var X=0;X<O.length;X++)if(G<O[X]){y[B+W]=X;break}}}return v},o.prototype.oneHot=function(i,a,c,u){wt(i,"oneHot");var p=new Float32Array(i.size*a);p.fill(u);for(var m=this.readSync(i.dataId),g=0;g<i.size;++g)m[g]>=0&&m[g]<a&&(p[g*a+m[g]]=c);return qi(p,[i.size,a],"int32")},o.prototype.nonMaxSuppression=function(i,a,c,u,p){return wt(i,"nonMaxSuppression"),Ps(this.readSync(i.dataId),this.readSync(a.dataId),c,u,p)},o.prototype.fft=function(i){return this.fftBatch(i,!1)},o.prototype.ifft=function(i){return this.fftBatch(i,!0)},o.prototype.fftBatch=function(i,a){for(var c=i.shape[0],u=i.shape[1],p=Rt(i.shape,"float32"),m=Rt(i.shape,"float32"),g=Ft(i).as2D(c,u),v=Xn(i).as2D(c,u),y=0;y<c;y++)for(var C=g.slice([y,0],[1,u]),S=v.slice([y,0],[1,u]),M=Cn(C,S),O=this.readSync(this.fftImpl(M,a).dataId),N=0;N<u;N++){var P=Vx(O,N);p.values[y*u+N]=P.real,m.values[y*u+N]=P.imag}return Cn(p.toTensor(),m.toTensor()).as2D(c,u)},o.prototype.fftImpl=function(i,a){var c=i.as1D(),u=c.size;if(this.isExponentOf2(u)){var p=this.fftRadix2(c,u,a).as2D(i.shape[0],i.shape[1]);return a&&(p=Cn(Ft(p).div(Nt(u)),Xn(p).div(Nt(u)))),p}var m=this.readSync(i.dataId),g=function(v){for(var y=new Float32Array(v.length/2),C=new Float32Array(v.length/2),S=0;S<v.length;S+=2)y[S/2]=v[S],C[S/2]=v[S+1];return{real:y,imag:C}}(this.fourierTransformByMatmul(m,u,a));return Cn(g.real,g.imag).as2D(i.shape[0],i.shape[1])},o.prototype.isExponentOf2=function(i){return 0==(i&i-1)},o.prototype.fftRadix2=function(i,a,c){if(1===a)return i;var u=this.readSync(i.dataId),p=a/2,m=function(B){for(var W=Math.ceil(B.length/4),G=new Float32Array(W),X=new Float32Array(W),Q=0;Q<B.length;Q+=4)G[Math.floor(Q/4)]=B[Q],X[Math.floor(Q/4)]=B[Q+1];return{real:G,imag:X}}(u),g=Cn(m.real,m.imag).as1D(),v=function(B){for(var W=Math.floor(B.length/4),G=new Float32Array(W),X=new Float32Array(W),Q=2;Q<B.length;Q+=4)G[Math.floor(Q/4)]=B[Q],X[Math.floor(Q/4)]=B[Q+1];return{real:G,imag:X}}(u),y=Cn(v.real,v.imag).as1D();g=this.fftRadix2(g,p,c),y=this.fftRadix2(y,p,c);var C=function(B,W){for(var G=new Float32Array(B/2),X=new Float32Array(B/2),Q=0;Q<Math.ceil(B/2);Q++){var se=(W?2:-2)*Math.PI*(Q/B);G[Q]=Math.cos(se),X[Q]=Math.sin(se)}return{real:G,imag:X}}(a,c),S=Cn(C.real,C.imag).mul(y),M=g.add(S),O=g.sub(S),N=Ft(M).concat(Ft(O)),P=Xn(M).concat(Xn(O));return Cn(N,P).as1D()},o.prototype.fourierTransformByMatmul=function(i,a,c){for(var u=new Float32Array(2*a),p=0;p<a;p++){for(var m=0,g=0,v=0;v<a;v++){var y=hk(p*v,a,c),C=Vx(i,v);m+=C.real*y.real-C.imag*y.imag,g+=C.real*y.imag+C.imag*y.real}c&&(m/=a,g/=a),Qf(u,m,g,p)}return u},o.prototype.depthToSpace=function(i,a,c){L("NHWC"===c,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+c}),L(a>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+a});for(var u=i.shape[0],p=i.shape[1],m=i.shape[2],g=i.shape[3],v=p*a,y=m*a,C=g/(a*a),S=this.readSync(i.dataId),M=new Float32Array(u*v*y*C),O=0,N=0;N<u;++N)for(var P=0;P<v;++P)for(var B=Math.floor(P/a),W=P%a,G=0;G<y;++G)for(var X=Math.floor(G/a),Q=(W*a+G%a)*C,se=0;se<C;++se)M[O++]=S[se+Q+g*(X+m*(B+p*N))];return oo(M,[u,v,y,C])},o.prototype.broadcastedBinaryOp=function(i,a,c,u){var p=_i(i.shape,a.shape),m=Rt(p,c),g=this.readSync(i.dataId),v=this.readSync(a.dataId),y=Ki(i.shape,p),C=Ki(a.shape,p),S=m.values;if(y.length+C.length===0)for(var M=0;M<S.length;++M)S[M]=u(g[M%g.length],v[M%v.length]);else{var O=this.bufferSync(i),N=this.bufferSync(a),P=function(B){var W=m.indexToLoc(B),G=W.slice(-i.rank);y.forEach(function(ue){return G[ue]=0});var X=O.locToIndex(G),Q=W.slice(-a.rank);C.forEach(function(ue){return Q[ue]=0});var se=N.locToIndex(Q);S[B]=u(g[X],v[se])};for(M=0;M<S.length;++M)P(M)}return m.toTensor()},o.prototype.broadcastedBinaryComplexOp=function(i,a,c){var u=_i(i.shape,a.shape),p=Rt(u,"float32"),m=Rt(u,"float32"),g=this.readSync(i.dataId),v=this.readSync(a.dataId),y=Ki(i.shape,u),C=Ki(a.shape,u),S=p.values,M=m.values;if(y.length+C.length===0)for(var O=0;O<S.length;O++){var N=O%g.length,P=O%v.length,B=c(g[2*N],g[2*N+1],v[2*P],v[2*P+1]);S[O]=B.real,M[O]=B.imag}else{var W=this.bufferSync(this.data.get(i.dataId).complexTensors.real),G=this.bufferSync(this.data.get(a.dataId).complexTensors.real),X=function(Q){var se=p.indexToLoc(Q),ue=se.slice(-i.rank);y.forEach(function(Te){return ue[Te]=0});var fe=W.locToIndex(ue),_e=se.slice(-a.rank);C.forEach(function(Te){return _e[Te]=0});var me=G.locToIndex(_e),Me=c(g[2*fe],g[2*fe+1],v[2*me],v[2*me+1]);S[Q]=Me.real,M[Q]=Me.imag};for(O=0;O<S.length;O++)X(O)}return this.complex(p.toTensor(),m.toTensor())},o.prototype.split=function(i,a,c){return Jf(i,a,c)},o.prototype.dispose=function(){},o.prototype.floatPrecision=function(){return 32},o.prototype.epsilon=function(){return 1e-7},o.prototype.cropAndResize=function(i,a,c,u,p,m){for(var g=i.shape,v=g[0],y=g[1],C=g[2],S=g[3],M=a.shape[0],O=u[0],N=u[1],P=Rt([M,O,N,S],i.dtype),B=this.readSync(a.dataId),W=this.readSync(c.dataId),G=this.readSync(i.dataId),X=i.strides,Q=P.strides,se=0;se<M;se++){var ue=4*se,fe=B[ue],_e=B[ue+1],me=B[ue+2],Me=B[ue+3],Te=W[se];if(!(Te>=v))for(var Ue=O>1?(me-fe)*(y-1)/(O-1):0,Xe=N>1?(Me-_e)*(C-1)/(N-1):0,et=0;et<O;et++){var it=O>1?fe*(y-1)+et*Ue:.5*(fe+me)*(y-1);if(it<0||it>y-1)for(var nt=0;nt<N;nt++)for(var je=0;je<S;je++){var ut=je+nt*Q[2]+et*Q[1]+se*Q[0];P.values[ut]=m}else if("bilinear"===p){var at=Math.floor(it),yt=Math.ceil(it),Gt=it-at;for(nt=0;nt<N;nt++)if((di=N>1?_e*(C-1)+nt*Xe:.5*(_e+Me)*(C-1))<0||di>C-1)for(je=0;je<S;je++)P.values[ut=je+nt*Q[2]+et*Q[1]+se*Q[0]]=m;else{var Xt=Math.floor(di),Mt=Math.ceil(di),Tn=di-Xt;for(je=0;je<S;je++){var Hn=G[ut=je+Xt*X[2]+at*X[1]+Te*X[0]],si=G[ut=je+Mt*X[2]+at*X[1]+Te*X[0]],li=G[ut=je+Xt*X[2]+yt*X[1]+Te*X[0]],ci=Hn+(si-Hn)*Tn,hr=li+(G[ut=je+Mt*X[2]+yt*X[1]+Te*X[0]]-li)*Tn;P.values[ut=je+nt*Q[2]+et*Q[1]+se*Q[0]]=ci+(hr-ci)*Gt}}}else for(nt=0;nt<N;++nt){var di;if((di=N>1?_e*(C-1)+nt*Xe:.5*(_e+Me)*(C-1))<0||di>C-1)for(je=0;je<S;je++)P.values[ut=je+nt*Q[2]+et*Q[1]+se*Q[0]]=m;else{var Ui=Math.round(di),Jn=Math.round(it);for(je=0;je<S;je++)P.values[je+nt*Q[2]+et*Q[1]+se*Q[0]]=G[je+Ui*X[2]+Jn*X[1]+Te*X[0]]}}}}return P.toTensor()},o.prototype.sparseToDense=function(i,a,c,u){var p=Yf(0,i,c);return this.scatter(i,a,c,p.outputSize,p.sliceSize,p.numUpdates,p.sliceRank,p.strides,u,!1)},o.prototype.gatherND=function(i,a){var c=a.shape,u=c[c.length-1],p=zh(i,a),m=p[0],g=p[1],v=p[2],y=p[3];if(0===g)return ei([],m,i.dtype);for(var C=new Bi([g,v],i.dtype),S=this.readSync(a.dataId),M=this.readSync(i.dataId),O=0;O<g;O++){for(var N=[],P=0,B=0;B<u;B++){var W=S[O*u+B];P+=W*y[B],N.push(W)}if(P<0||P>=i.size/v)throw new Error("Invalid indices: "+N+" does not index into "+i.shape);for(var G=0;G<v;G++)C.values[O*v+G]=M[P*v+G]}return C.toTensor().reshape(m)},o.prototype.scatterND=function(i,a,c){var u=Yf(0,i,c),p=u.sliceRank,m=u.numUpdates,g=u.sliceSize,v=u.strides,y=u.outputSize,C=Nt(0);return this.scatter(i,a,c,y,g,m,p,v,C,!0)},o.prototype.fill=function(i,a,c){var u=ze(c=c||Pt(a),de(i));return u.fill(a),Ie.makeTensor(u,i,c,this)},o.prototype.onesLike=function(i){if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(i.shape,1,i.dtype)},o.prototype.zerosLike=function(i){var a=ze(i.dtype,de(i.shape));return this.makeOutput(a,i.shape,i.dtype)},o.prototype.linspace=function(i,a,c){return Zf(i,a,c)},o.prototype.scatter=function(i,a,c,u,p,m,g,v,y,C){var S=[u/p,p],M=this.readSync(i.dataId),O=this.readSync(a.dataId);if(0===u)return ei([],c,a.dtype);var N=new Bi(S,a.dtype);N.values.fill(this.readSync(y.dataId)[0]);for(var P=0;P<m;P++){for(var B=[],W=0,G=0;G<g;G++){var X=M[P*g+G];B.push(X),W+=X*v[G]}if(W<0||W>=u/p)throw new Error("Invalid indices: "+B+" does not index into "+c);for(var Q=0;Q<p;Q++)C?N.values[W*p+Q]+=O[P*p+Q]:N.values[W*p+Q]=0===a.rank?O[0]:O[P*p+Q]}return N.toTensor().reshape(c)},o}(vl);Ie.registerBackend("cpu",function(){return new cd},1),z({kernelName:"Square",backendName:"cpu",kernelFunc:function(s){var a=s.inputs.x,c=s.backend;wt(a,"square");for(var u=c.data.get(a.dataId).values,p=new Float32Array(u.length),m=0;m<u.length;++m){var g=u[m];p[m]=g*g}return{dataId:c.write(p,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}}),z({kernelName:"Square",backendName:"webgl",kernelFunc:function(s){var a=s.inputs.x,c=s.backend,u=new ti(a.shape,"return x * x;");return c.runWebGLProgram(u,[a],a.dtype)}});var Zk=function(){function s(){}return s.prototype.fetch=function(o,i){return fetch(o,i)},s.prototype.now=function(){return performance.now()},s.prototype.encode=function(o,i){if("utf-8"!==i&&"utf8"!==i)throw new Error("Browser's encoder only supports utf-8, but got "+i);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(o)},s.prototype.decode=function(o,i){return new TextDecoder(i).decode(o)},s}();E().get("IS_BROWSER")&&E().setPlatform("browser",new Zk);var wp,Qk=function(){function s(){this.util=Re(753),this.textEncoder=new this.util.TextEncoder}return s.prototype.fetch=function(o,i){return null!=E().global.fetch?E().global.fetch(o,i):(null==wp&&(wp=Re(522)),wp(o,i))},s.prototype.now=function(){var o=process.hrtime();return 1e3*o[0]+o[1]/1e6},s.prototype.encode=function(o,i){if("utf-8"!==i&&"utf8"!==i)throw new Error("Node built-in encoder only supports utf-8, but got "+i);return this.textEncoder.encode(o)},s.prototype.decode=function(o,i){return 0===o.length?"":new this.util.TextDecoder(i).decode(o)},s}();E().get("IS_NODE")&&E().setPlatform("node",new Qk);var Cp={float32:4,int32:4,uint16:2,uint8:1,bool:1};function js(s,o){for(var i={},a=0,c=function(m){var g=m.name,v=m.dtype,y=m.shape,C=de(y),S=void 0;if("quantization"in m){var M=m.quantization;if("uint8"!==M.dtype&&"uint16"!==M.dtype)throw new Error("Weight "+m.name+" has unknown quantization dtype "+M.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var O=Cp[M.dtype],N=s.slice(a,a+C*O),P="uint8"===M.dtype?new Uint8Array(N):new Uint16Array(N);if("float32"===v)S=Float32Array.from(P,function(se){return se*M.scale+M.min});else{if("int32"!==v)throw new Error("Unsupported dtype in weight '"+g+"': "+v);S=Int32Array.from(P,function(se){return Math.round(se*M.scale+M.min)})}a+=C*O}else if("string"===v){var B=de(m.shape);S=[];for(var W=0;W<B;W++){var G=new Uint32Array(s.slice(a,a+4))[0];a+=4;var X=new Uint8Array(s.slice(a,a+G));S.push(X),a+=G}}else{var Q=Cp[v];if(N=s.slice(a,a+C*Q),"float32"===v)S=new Float32Array(N);else if("int32"===v)S=new Int32Array(N);else{if("bool"!==v)throw new Error("Unsupported dtype in weight '"+g+"': "+v);S=new Uint8Array(N)}a+=C*Q}i[g]=ei(S,y,v)},u=0,p=o;u<p.length;u++)c(p[u]);return i}function Gw(s){if(null===s)throw new Error("Invalid input value: "+JSON.stringify(s));var o=0,i=[];s.forEach(function(u){if(o+=u.byteLength,i.push(u.byteLength===u.buffer.byteLength?u:new u.constructor(u)),!(u instanceof Float32Array||u instanceof Int32Array||u instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+u.constructor.name)});var a=new Uint8Array(o),c=0;return i.forEach(function(u){a.set(new Uint8Array(u.buffer),c),c+=u.byteLength}),a.buffer}var Sp=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function $w(s){return Sp?Buffer.byteLength(s):new Blob([s]).size}function nb(s){var o=0;s.forEach(function(c){o+=c.byteLength});var i=new Uint8Array(o),a=0;return s.forEach(function(c){i.set(new Uint8Array(c),a),a+=c.byteLength}),i.buffer}function ib(s){for(s=s.trim();s.endsWith("/");)s=s.slice(0,s.length-1);var o=s.split("/");return o[o.length-1]}function Ws(s){if(s.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==s.modelTopology?0:$w(JSON.stringify(s.modelTopology)),weightSpecsBytes:null==s.weightSpecs?0:$w(JSON.stringify(s.weightSpecs)),weightDataBytes:null==s.weightData?0:s.weightData.byteLength}}var Ba=function(){function s(){this.saveRouters=[],this.loadRouters=[]}return s.getInstance=function(){return null==s.instance&&(s.instance=new s),s.instance},s.registerSaveRouter=function(o){s.getInstance().saveRouters.push(o)},s.registerLoadRouter=function(o){s.getInstance().loadRouters.push(o)},s.getSaveHandlers=function(o){return s.getHandlers(o,"save")},s.getLoadHandlers=function(o,i){return s.getHandlers(o,"load",i)},s.getHandlers=function(o,i,a){var c=[];return("load"===i?s.getInstance().loadRouters:s.getInstance().saveRouters).forEach(function(u){var p=u(o,a);null!==p&&c.push(p)}),c},s}(),Lu="://",Jl=function(){function s(){this.managers={}}return s.getInstance=function(){return null==s.instance&&(s.instance=new s),s.instance},s.registerManager=function(o,i){L(null!=o,function(){return"scheme must not be undefined or null."}),o.endsWith(Lu)&&(o=o.slice(0,o.indexOf(Lu))),L(o.length>0,function(){return"scheme must not be an empty string."});var a=s.getInstance();L(null==a.managers[o],function(){return"A model store manager is already registered for scheme '"+o+"'."}),a.managers[o]=i},s.getManager=function(o){var i=this.getInstance().managers[o];if(null==i)throw new Error("Cannot find model manager for scheme '"+o+"'");return i},s.getSchemes=function(){return Object.keys(this.getInstance().managers)},s}();function Bu(s){if(-1===s.indexOf(Lu))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Jl.getSchemes().join(","));return{scheme:s.split(Lu)[0],path:s.split(Lu)[1]}}function qw(s,o,i){return void 0===i&&(i=!1),J(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C;return K(this,function(S){switch(S.label){case 0:return L(s!==o,function(){return"Old path and new path are the same: '"+s+"'"}),L((a=Ba.getLoadHandlers(s)).length>0,function(){return"Copying failed because no load handler is found for source URL "+s+"."}),L(a.length<2,function(){return"Copying failed because more than one ("+a.length+") load handlers for source URL "+s+"."}),c=a[0],L((u=Ba.getSaveHandlers(o)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+o+"."}),L(u.length<2,function(){return"Copying failed because more than one ("+a.length+") save handlers for destination URL "+o+"."}),p=u[0],m=Bu(s).scheme,g=Bu(s).path,v=m===Bu(s).scheme,[4,c.load()];case 1:return y=S.sent(),i&&v?[4,Jl.getManager(m).removeModel(g)]:[3,3];case 2:S.sent(),S.label=3;case 3:return[4,p.save(y)];case 4:return C=S.sent(),!i||v?[3,6]:[4,Jl.getManager(m).removeModel(g)];case 5:S.sent(),S.label=6;case 6:return[2,C.modelArtifactsInfo]}})})}var ec="models_store",tc="model_info_store";function rb(){if(!E().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var s=window,o=s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB||s.shimIndexedDB;if(null==o)throw new Error("The current browser does not appear to support IndexedDB.");return o}function Yw(s){var o=s.result;o.createObjectStore(ec,{keyPath:"modelPath"}),o.createObjectStore(tc,{keyPath:"modelPath"})}var zu=function(){function s(o){if(this.indexedDB=rb(),null==o||!o)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=o}return s.prototype.save=function(o){return J(this,void 0,void 0,function(){return K(this,function(i){if(o.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,o)]})})},s.prototype.load=function(){return J(this,void 0,void 0,function(){return K(this,function(o){return[2,this.databaseAction(this.modelPath)]})})},s.prototype.databaseAction=function(o,i){var a=this;return new Promise(function(c,u){var p=a.indexedDB.open("tensorflowjs",1);p.onupgradeneeded=function(){return Yw(p)},p.onsuccess=function(){var m=p.result;if(null==i){var g=m.transaction(ec,"readonly"),v=g.objectStore(ec).get(a.modelPath);v.onsuccess=function(){if(null==v.result)return m.close(),u(new Error("Cannot find model with path '"+a.modelPath+"' in IndexedDB."));c(v.result.modelArtifacts)},v.onerror=function(N){return m.close(),u(v.error)},g.oncomplete=function(){return m.close()}}else{var y,C=Ws(i),S=m.transaction(tc,"readwrite"),M=S.objectStore(tc),O=M.put({modelPath:a.modelPath,modelArtifactsInfo:C});O.onsuccess=function(){var N=(y=m.transaction(ec,"readwrite")).objectStore(ec).put({modelPath:a.modelPath,modelArtifacts:i,modelArtifactsInfo:C});N.onsuccess=function(){return c({modelArtifactsInfo:C})},N.onerror=function(P){var B=(M=S.objectStore(tc)).delete(a.modelPath);B.onsuccess=function(){return m.close(),u(N.error)},B.onerror=function(W){return m.close(),u(N.error)}}},O.onerror=function(N){return m.close(),u(O.error)},S.oncomplete=function(){null==y?m.close():y.oncomplete=function(){return m.close()}}}},p.onerror=function(m){return u(p.error)}})},s.URL_SCHEME="indexeddb://",s}(),nc=function(s){return E().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(zu.URL_SCHEME)?(o=s.slice(zu.URL_SCHEME.length),new zu(o)):null;var o};Ba.registerSaveRouter(nc),Ba.registerLoadRouter(nc);var Jk=function(){function s(){this.indexedDB=rb()}return s.prototype.listModels=function(){return J(this,void 0,void 0,function(){var o=this;return K(this,function(i){return[2,new Promise(function(a,c){var u=o.indexedDB.open("tensorflowjs",1);u.onupgradeneeded=function(){return Yw(u)},u.onsuccess=function(){var p=u.result,m=p.transaction(tc,"readonly"),g=m.objectStore(tc).getAll();g.onsuccess=function(){for(var v={},y=0,C=g.result;y<C.length;y++){var S=C[y];v[S.modelPath]=S.modelArtifactsInfo}a(v)},g.onerror=function(v){return p.close(),c(g.error)},m.oncomplete=function(){return p.close()}},u.onerror=function(p){return c(u.error)}})]})})},s.prototype.removeModel=function(o){return J(this,void 0,void 0,function(){var i=this;return K(this,function(a){var c;return o=(c=o).startsWith(zu.URL_SCHEME)?c.slice(zu.URL_SCHEME.length):c,[2,new Promise(function(u,p){var m=i.indexedDB.open("tensorflowjs",1);m.onupgradeneeded=function(){return Yw(m)},m.onsuccess=function(){var g,v=m.result,y=v.transaction(tc,"readwrite"),C=y.objectStore(tc),S=C.get(o);S.onsuccess=function(){if(null==S.result)return v.close(),p(new Error("Cannot find model with path '"+o+"' in IndexedDB."));var M=C.delete(o),O=function(){var N=(g=v.transaction(ec,"readwrite")).objectStore(ec).delete(o);N.onsuccess=function(){return u(S.result.modelArtifactsInfo)},N.onerror=function(P){return p(S.error)}};M.onsuccess=O,M.onerror=function(N){return O(),v.close(),p(S.error)}},S.onerror=function(M){return v.close(),p(S.error)},y.oncomplete=function(){null==g?v.close():g.oncomplete=function(){return v.close()}}},m.onerror=function(g){return p(m.error)}})]})})},s}();if(E().getBool("IS_BROWSER"))try{Jl.registerManager(zu.URL_SCHEME,new Jk)}catch{}var Ca="/",Ut="tensorflowjs_models",Kw="info",Dp="model_topology",wl="weight_specs",eM="weight_data",tM="model_metadata";function ic(s){return{info:[Ut,s,Kw].join(Ca),topology:[Ut,s,Dp].join(Ca),weightSpecs:[Ut,s,wl].join(Ca),weightData:[Ut,s,eM].join(Ca),modelMetadata:[Ut,s,tM].join(Ca)}}function nM(s){var o=s.split(Ca);if(o.length<3)throw new Error("Invalid key format: "+s);return o.slice(1,o.length-1).join(Ca)}var rc=function(){function s(o){if(!E().getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==o||!o)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=o,this.keys=ic(this.modelPath)}return s.prototype.save=function(o){return J(this,void 0,void 0,function(){var i,a,c;return K(this,function(u){if(o.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");i=JSON.stringify(o.modelTopology),a=JSON.stringify(o.weightSpecs),c=Ws(o);try{return this.LS.setItem(this.keys.info,JSON.stringify(c)),this.LS.setItem(this.keys.topology,i),this.LS.setItem(this.keys.weightSpecs,a),this.LS.setItem(this.keys.weightData,(p=o.weightData,Sp?Buffer.from(p).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(p))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy})),[2,{modelArtifactsInfo:c}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+c.modelTopologyBytes+", weightSpecsBytes="+c.weightSpecsBytes+", weightDataBytes="+c.weightDataBytes+".")}var p;return[2]})})},s.prototype.load=function(){return J(this,void 0,void 0,function(){var o,i,a,c,u,p,m;return K(this,function(g){if(null==(o=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==o.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(i={},null==(a=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(i.modelTopology=a,null==(c=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(i.weightSpecs=c,null!=(u=this.LS.getItem(this.keys.modelMetadata))&&(p=JSON.parse(u),i.format=p.format,i.generatedBy=p.generatedBy,i.convertedBy=p.convertedBy),null==(m=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return i.weightData=function(v){if(Sp){var y=Buffer.from(v,"base64");return y.buffer.slice(y.byteOffset,y.byteOffset+y.byteLength)}for(var C=atob(v),S=new Uint8Array(C.length),M=0;M<C.length;++M)S.set([C.charCodeAt(M)],M);return S.buffer}(m),[2,i]})})},s.URL_SCHEME="localstorage://",s}(),og=function(s){return E().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(rc.URL_SCHEME)?(o=s.slice(rc.URL_SCHEME.length),new rc(o)):null;var o};Ba.registerSaveRouter(og),Ba.registerLoadRouter(og);var iM=function(){function s(){L(E().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),L(void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return s.prototype.listModels=function(){return J(this,void 0,void 0,function(){var o,i,a,c,u,p;return K(this,function(m){for(o={},i=Ut+Ca,a=Ca+Kw,c=0;c<this.LS.length;++c)(u=this.LS.key(c)).startsWith(i)&&u.endsWith(a)&&(p=nM(u),o[p]=JSON.parse(this.LS.getItem(u)));return[2,o]})})},s.prototype.removeModel=function(o){return J(this,void 0,void 0,function(){var i,a;return K(this,function(c){var u;if(o=(u=o).startsWith(rc.URL_SCHEME)?u.slice(rc.URL_SCHEME.length):u,i=ic(o),null==this.LS.getItem(i.info))throw new Error("Cannot find model at path '"+o+"'");return a=JSON.parse(this.LS.getItem(i.info)),this.LS.removeItem(i.info),this.LS.removeItem(i.topology),this.LS.removeItem(i.weightSpecs),this.LS.removeItem(i.weightData),[2,a]})})},s}();if(E().getBool("IS_BROWSER"))try{Jl.registerManager(rc.URL_SCHEME,new iM)}catch{}function Xw(s){return new Promise(function(o){return setTimeout(o)}).then(s)}var ab=function(){function s(o){if(!E().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");o.startsWith(s.URL_SCHEME)&&(o=o.slice(s.URL_SCHEME.length)),null!=o&&0!==o.length||(o="model"),this.modelTopologyFileName=o+".json",this.weightDataFileName=o+".weights.bin"}return s.prototype.save=function(o){return J(this,void 0,void 0,function(){var i,u,p,m;return K(this,function(g){switch(g.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(i=window.URL.createObjectURL(new Blob([o.weightData],{type:"application/octet-stream"})),!(o.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return u=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:o.modelTopology,format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:o.weightSpecs}]})],{type:"application/json"})),(p=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,p.href=u,[4,Xw(function(){return p.dispatchEvent(new MouseEvent("click"))})];case 2:return g.sent(),null==o.weightData?[3,4]:((m=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,m.href=i,[4,Xw(function(){return m.dispatchEvent(new MouseEvent("click"))})]);case 3:g.sent(),g.label=4;case 4:return[2,{modelArtifactsInfo:Ws(o)}]}})})},s.URL_SCHEME="downloads://",s}(),oM=function(){function s(o){if(null==o||o.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+o);this.files=o}return s.prototype.load=function(){return J(this,void 0,void 0,function(){var o,i,a=this;return K(this,function(c){return o=this.files[0],i=this.files.slice(1),[2,new Promise(function(u,p){var m=new FileReader;m.onload=function(g){var v=JSON.parse(g.target.result),y=v.modelTopology;if(null!=y){0===i.length&&u({modelTopology:y});var C=v.weightsManifest;if(null!=C){var S;try{S=a.checkManifestAndWeightFiles(C,i)}catch(P){return void p(P)}var M=[],O=[],N=[];C.forEach(function(P){P.paths.forEach(function(B){O.push(B),N.push(null)}),M.push.apply(M,P.weights)}),C.forEach(function(P){P.paths.forEach(function(B){var W=new FileReader;W.onload=function(G){var X=G.target.result,Q=O.indexOf(B);N[Q]=X,-1===N.indexOf(null)&&u({modelTopology:y,weightSpecs:M,weightData:nb(N)})},W.onerror=function(G){return p("Failed to weights data from file of path '"+B+"'.")},W.readAsArrayBuffer(S[B])})})}else p(new Error("weightManifest field is missing from file "+o.name))}else p(new Error("modelTopology field is missing from file "+o.name))},m.onerror=function(g){return p("Failed to read model topology and weights manifest JSON from file '"+o.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},m.readAsText(o)})]})})},s.prototype.checkManifestAndWeightFiles=function(o,i){for(var a=[],c=i.map(function(g){return ib(g.name)}),u={},p=0,m=o;p<m.length;p++)m[p].paths.forEach(function(g){var v=ib(g);if(-1!==a.indexOf(v))throw new Error("Duplicate file basename found in weights manifest: '"+v+"'");if(a.push(v),-1===c.indexOf(v))throw new Error("Weight file with basename '"+v+"' is not provided.");u[g]=i[c.indexOf(v)]});if(a.length!==i.length)throw new Error("Mismatch in the number of files in weights manifest ("+a.length+") and the number of weight files provided ("+i.length+").");return u},s}();function Zw(s,o,i,a){var u;L(null!=(u=s)&&Array.isArray(u)&&u.length>0,function(){return"promises must be a none empty array"}),function(u,p){L(u>=0&&u<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+u}),L(p>=0&&p<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+p}),L(p>=u,function(){return"startFraction must be no more than endFraction, but got startFraction "+u+" and endFraction "+p})}(i=i??0,a=a??1);var c=0;return Promise.all(s.map(function(u){return u.then(function(p){var m=i+ ++c/s.length*(a-i);return o(m),p}),u}))}function Qw(s,o){return J(this,void 0,void 0,function(){var i,a,c,u,p,m,g,v,y;return K(this,function(C){switch(C.label){case 0:return null==o&&(o={}),i=null==o.fetchFunc?E().platform.fetch:o.fetchFunc,a=s.map(function(S){return i(S,o.requestInit,{isBinary:!0})}),c=0,u=.5,null!=o.onProgress?[3,2]:[4,Promise.all(a)];case 1:return p=C.sent(),[3,4];case 2:return[4,Zw(a,o.onProgress,c,u)];case 3:p=C.sent(),C.label=4;case 4:return m=p.map(function(S){return S.arrayBuffer()}),g=.5,v=1,null!=o.onProgress?[3,6]:[4,Promise.all(m)];case 5:return y=C.sent(),[3,8];case 6:return[4,Zw(m,o.onProgress,g,v)];case 7:y=C.sent(),C.label=8;case 8:return[2,y]}})})}function Jw(s){var o=this;return function(i,a,c){return void 0===a&&(a=""),J(o,void 0,void 0,function(){var u,p,m,g,v,y,C,S,M,O;return K(this,function(N){switch(N.label){case 0:if(u=i.map(function(){return!1}),p={},m=null!=c?c.map(function(){return!1}):[],g=[],i.forEach(function(P,B){var W=0;P.weights.forEach(function(G){var Q=Cp["quantization"in G?G.quantization.dtype:G.dtype]*de(G.shape),se=function(){u[B]=!0,null==p[B]&&(p[B]=[]),p[B].push({manifestEntry:G,groupOffset:W,sizeBytes:Q})};null!=c?c.forEach(function(ue,fe){ue===G.name&&(se(),m[fe]=!0)}):se(),g.push(G.name),W+=Q})}),!m.every(function(P){return P}))throw v=c.filter(function(P,B){return!m[B]}),new Error("Could not find weights in manifest with names: "+v.join(", ")+". \nManifest JSON has weights with names: "+g.join(", ")+".");return y=u.reduce(function(P,B,W){return B&&P.push(W),P},[]),C=[],y.forEach(function(P){i[P].paths.forEach(function(B){var W=a+(a.endsWith("/")?"":"/")+B;C.push(W)})}),[4,s(C)];case 1:return S=N.sent(),M={},O=0,y.forEach(function(P){for(var B=i[P].paths.length,W=0,G=0;G<B;G++)W+=S[O+G].byteLength;for(var X=new ArrayBuffer(W),Q=new Uint8Array(X),se=0,ue=0;ue<B;ue++){var fe=new Uint8Array(S[O+ue]);Q.set(fe,se),se+=fe.byteLength}p[P].forEach(function(_e){var me=js(X.slice(_e.groupOffset,_e.groupOffset+_e.sizeBytes),[_e.manifestEntry]);for(var Me in me)M[Me]=me[Me]}),O+=B}),[2,M]}})})}}Ba.registerSaveRouter(function(s){return E().getBool("IS_BROWSER")&&!Array.isArray(s)&&s.startsWith(ab.URL_SCHEME)?(void 0===(o=s.slice(ab.URL_SCHEME.length))&&(o="model"),new ab(o)):null;var o});var ud=function(){function s(o,i){if(this.DEFAULT_METHOD="POST",null==i&&(i={}),this.weightPathPrefix=i.weightPathPrefix,this.onProgress=i.onProgress,null!=i.fetchFunc?(L("function"==typeof i.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=i.fetchFunc):this.fetch=E().platform.fetch,L(null!=o&&o.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(o)&&L(2===o.length,function(){return"URL paths for http must have a length of 2, (actual length is "+o.length+")."}),this.path=o,null!=i.requestInit&&null!=i.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=i.requestInit||{}}return s.prototype.save=function(o){return J(this,void 0,void 0,function(){var i,u;return K(this,function(p){switch(p.label){case 0:if(o.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(i=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,i.body.append("model.json",new Blob([JSON.stringify({modelTopology:o.modelTopology,format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:o.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=o.weightData&&i.body.append("model.weights.bin",new Blob([o.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,i)];case 1:if((u=p.sent()).ok)return[2,{modelArtifactsInfo:Ws(o),responses:[u]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+u.status+".")}})})},s.prototype.load=function(){return J(this,void 0,void 0,function(){var o,i,a,c,u,p,m,g;return K(this,function(v){switch(v.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(o=v.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+o.status+". Please verify this URL points to the model JSON of the model to load.");v.label=2;case 2:return v.trys.push([2,4,,5]),[4,o.json()];case 3:return i=v.sent(),[3,5];case 4:throw v.sent(),a="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a);case 5:if(u=i.weightsManifest,null==(c=i.modelTopology)&&null==u)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==u?[3,7]:[4,this.loadWeights(u)];case 6:g=v.sent(),p=g[0],m=g[1],v.label=7;case 7:return[2,{modelTopology:c,weightSpecs:p,weightData:m}]}})})},s.prototype.loadWeights=function(o){return J(this,void 0,void 0,function(){var a,c,u,p,m,g,v,C,S;return K(this,function(M){switch(M.label){case 0:for(void 0,void 0,N=(O=Array.isArray(this.path)?this.path[1]:this.path).lastIndexOf("/"),P=O.lastIndexOf("?"),a=[O.substring(0,N)+"/",P>N?O.substring(P):""],c=a[0],u=a[1],p=this.weightPathPrefix||c,m=[],g=0,v=o;g<v.length;g++)m.push.apply(m,v[g].weights);return C=[],o.forEach(function(O){O.paths.forEach(function(N){C.push(p+N+u)})}),[4,Qw(C,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return S=M.sent(),[2,[m,nb(S)]]}var O,N,P})})},s.URL_SCHEME_REGEX=/^https?:\/\//,s}();function gs(s){return null!=s.match(ud.URL_SCHEME_REGEX)}var e1=function(s,o){return typeof fetch>"u"?null:(Array.isArray(s)?s.every(function(i){return gs(i)}):gs(s))?sb(s,{onProgress:o}):null};function sb(s,o){return new ud(s,o)}Ba.registerSaveRouter(e1),Ba.registerLoadRouter(e1);var t1=function(){function s(o){this.modelArtifacts=o}return s.prototype.load=function(){return J(this,void 0,void 0,function(){return K(this,function(o){return[2,this.modelArtifacts]})})},s}(),bF=function(){function s(o){this.saveHandler=o}return s.prototype.save=function(o){return J(this,void 0,void 0,function(){return K(this,function(i){return[2,this.saveHandler(o)]})})},s}(),Sa=Object.freeze({browserFiles:function(s){return new oM(s)},browserHTTPRequest:function(s,o){return sb(s,o)},concatenateArrayBuffers:nb,decodeWeights:js,encodeWeights:function(s,o){return J(this,void 0,void 0,function(){var i,a,c,u,p,m=this;return K(this,function(g){switch(g.label){case 0:for(i=[],a=[],c=Array.isArray(s)?s.map(function(v){return v.name}):Object.keys(s),u=function(v){var y=c[v],C=Array.isArray(s)?s[v].tensor:s[y];if("float32"!==C.dtype&&"int32"!==C.dtype&&"bool"!==C.dtype&&"string"!==C.dtype)throw new Error("Unsupported dtype in weight '"+y+"': "+C.dtype);var S={name:y,shape:C.shape,dtype:C.dtype};if("string"===C.dtype){var M=new Promise(function(O){return J(m,void 0,void 0,function(){var N,P,B,W,G,X,Q;return K(this,function(se){switch(se.label){case 0:return[4,C.bytes()];case 1:for(N=se.sent(),P=N.reduce(function(ue,fe){return ue+fe.length},0)+4*N.length,B=new Uint8Array(P),W=0,G=0;G<N.length;G++)X=N[G],Q=new Uint8Array(new Uint32Array([X.length]).buffer),B.set(Q,W),B.set(X,W+=4),W+=X.length;return O(B),[2]}})})});a.push(M)}else a.push(C.data());null!=o&&(S.group=o),i.push(S)},p=0;p<c.length;++p)u(p);return[4,Promise.all(a)];case 1:return[2,{data:Gw(g.sent()),specs:i}]}})})},fromMemory:function(s,o,i,a){return 1===arguments.length?null!=s.modelTopology||null!=s.weightSpecs?new t1(s):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new t1({modelTopology:s})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new t1({modelTopology:s,weightSpecs:o,weightData:i,trainingConfig:a}))},getLoadHandlers:function(s,o){return Ba.getLoadHandlers(s,o)},getModelArtifactsInfoForJSON:Ws,getSaveHandlers:function(s){return Ba.getSaveHandlers(s)},http:sb,isHTTPScheme:gs,loadWeights:function(s,o,i,a){return void 0===o&&(o=""),J(this,void 0,void 0,function(){return K(this,function(c){return[2,Jw(function(u){return Qw(u,{requestInit:a})})(s,o,i)]})})},registerLoadRouter:function(s){return Ba.registerLoadRouter(s)},registerSaveRouter:function(s){return Ba.registerSaveRouter(s)},weightsLoaderFactory:Jw,withSaveHandler:function(s){return new bF(s)},copyModel:function(s,o){return J(this,void 0,void 0,function(){return K(this,function(i){return[2,qw(s,o,!1)]})})},listModels:function(){return J(this,void 0,void 0,function(){var s,o,i,a,c,u,p;return K(this,function(m){switch(m.label){case 0:s=Jl.getSchemes(),o={},i=0,a=s,m.label=1;case 1:return i<a.length?[4,Jl.getManager(c=a[i]).listModels()]:[3,4];case 2:for(p in u=m.sent())o[c+Lu+p]=u[p];m.label=3;case 3:return i++,[3,1];case 4:return[2,o]}})})},moveModel:function(s,o){return J(this,void 0,void 0,function(){return K(this,function(i){return[2,qw(s,o,!0)]})})},removeModel:function(s){return J(this,void 0,void 0,function(){var o;return K(this,function(i){return o=Bu(s),[2,Jl.getManager(o.scheme).removeModel(o.path)]})})}}),yF=ee({confusionMatrix_:function(s,o,i){var a=F(s,"labels","confusionMatrix"),c=F(o,"predictions","confusionMatrix");L(null==i||i>0&&Number.isInteger(i),function(){return"If provided, numClasses must be a positive integer, but got "+i}),L(1===a.rank,function(){return"Expected the rank of labels to be 1, but got "+a.rank}),L(1===c.rank,function(){return"Expected the rank of predictions to be 1, but got "+c.rank}),L(a.shape[0]===c.shape[0],function(){return"Mismatch in the number of examples: "+a.shape[0]+" vs. "+c.shape[0]+". Labels and predictions should have the same number of elements."}),L(i>0&&Number.isInteger(i),function(){return"numClasses is required to be a positive integer, but got "+i});var u=Ul(a.asType("int32"),i),p=Ul(c.asType("int32"),i);return u.transpose().matMul(p).asType("int32")}}),n1=Object.freeze({confusionMatrix:yF}),r1=ee({fromPixels_:function(s,o){if(void 0===o&&(o=3),o>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement;if(i&&i&&s.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return Ie.fromPixels(s,o)}}),o1=Object.freeze({toPixels:function(s,o){return J(this,void 0,void 0,function(){var i,a,c,u,p,m,g,v,y,M,O,N,P,B,W,G,X,Q,se,ue,fe;return K(this,function(_e){switch(_e.label){case 0:if(i=F(s,"img","toPixels"),s instanceof ki||(i=i.toInt()),2!==i.rank&&3!==i.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+i.rank+".");if(a=i.shape.slice(0,2),c=a[0],u=a[1],(p=2===i.rank?1:i.shape[2])>4||2===p)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+p);return[4,i.data()];case 1:return m=_e.sent(),g=i.min(),v=i.max(),[4,Promise.all([g.data(),v.data()])];case 2:if(y=_e.sent(),M=y[0][0],O=y[1][0],g.dispose(),v.dispose(),"float32"===i.dtype){if(M<0||O>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+M+" - "+O+"].")}else{if("int32"!==i.dtype)throw new Error("Unsupported type for toPixels: "+i.dtype+". Please use float32 or int32 tensors.");if(M<0||O>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+M+" - "+O+"].")}for(N="float32"===i.dtype?255:1,P=new Uint8ClampedArray(u*c*4),B=0;B<c*u;++B)W=void 0,G=void 0,X=void 0,Q=void 0,1===p?(W=m[B]*N,G=m[B]*N,X=m[B]*N,Q=255):3===p?(W=m[3*B]*N,G=m[3*B+1]*N,X=m[3*B+2]*N,Q=255):4===p&&(W=m[4*B]*N,G=m[4*B+1]*N,X=m[4*B+2]*N,Q=m[4*B+3]*N),P[0+(se=4*B)]=Math.round(W),P[se+1]=Math.round(G),P[se+2]=Math.round(X),P[se+3]=Math.round(Q);return null!=o&&(o.width=u,o.height=c,ue=o.getContext("2d"),fe=new ImageData(P,u,c),ue.putImageData(fe,0,0)),i!==s&&i.dispose(),[2,P]}})})},fromPixels:r1}),lb=function(){function s(){}return s.prototype.getClassName=function(){return this.constructor.className},s.fromConfig=function(o,i){return new o(i)},s}(),a1=function(){function s(){this.classNameMap={}}return s.getMap=function(){return null==s.instance&&(s.instance=new s),s.instance},s.register=function(o){s.getMap().classNameMap[o.className]=[o,o.fromConfig]},s}();function oc(s){L(null!=s.className,function(){return"Class being registered does not have the static className property defined."}),L("string"==typeof s.className,function(){return"className is required to be a string, but got type "+typeof s.className}),L(s.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),a1.register(s)}var bt=Object.freeze({Serializable:lb,SerializationMap:a1,registerClass:oc});function db(){return 32===Ie.backend.floatPrecision()?.001:.1}function ub(s,o,i){var a=!0;if((Le(s)||Le(o))&&(a=!1),Le(s)&&Le(o)&&(a=!0),a){var c=s.constructor.name,u=o.constructor.name;if(c!==u)throw new Error("Arrays are of different type. Actual: "+c+". Expected: "+u)}if(Array.isArray(s)&&Array.isArray(o)){var p=k(s),m=k(o);if(!ke(p,m))throw new Error("Arrays have different shapes. Actual: ["+p+"]. Expected: ["+m+"]")}var g=Le(s)?s:we(s),v=Le(o)?o:we(o);if(g.length!==v.length)throw new Error("Arrays have different lengths actual: "+g.length+" vs expected: "+v.length+".\nActual:   "+g+".\nExpected: "+v+".");for(var y=0;y<v.length;++y){var C=g[y],S=v[y];if(!i(C,S))throw new Error("Arrays differ: actual["+y+"] = "+C+", expected["+y+"] = "+S+".\nActual:   "+g+".\nExpected: "+v+".")}}function hb(s,o,i){return!isFinite(s)&&!isFinite(o)||!(isNaN(s)||isNaN(o)||Math.abs(s-o)>i)}var sM=Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(s,o,i){return null==i&&(i=db()),ub(s,o,function(a,c){return hb(a,c,i)})},testEpsilon:db,expectPromiseToFail:function(s,o){s().then(function(){return o.fail()},function(){return o()})},expectArraysEqual:function(s,o){var i="string"==typeof o||"number"==typeof o||"boolean"==typeof o?[o]:o;return en(s)||en(s[0])||en(o)||en(o[0])?ub(s,i,function(a,c){return a==c}):ub(s,o,function(a,c){return hb(a,c,0)})},expectNumbersClose:function(s,o,i){if(null==i&&(i=db()),!hb(s,o,i))throw new Error("Numbers differ: actual === "+s+", expected === "+o)},expectValuesInRange:function(s,o,i){for(var a=0;a<s.length;a++)if(s[a]<o||s[a]>i)throw new Error("Value out of range:"+s[a]+" low: "+o+", high: "+i)},expectArrayBuffersEqual:function(s,o){expect(new Float32Array(s)).toEqual(new Float32Array(o))}}),pb="1.3.1",lM=Object.freeze({gpgpu_util:sv,webgl_util:Wo,forceHalfFloat:function(){E().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:fv,setWebGLContext:R_,GPGPUContext:nw}),Sl=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return j(o,s),o.prototype.minimize=function(i,a,c){void 0===a&&(a=!1);var u=this.computeGradients(i,c),p=u.value,m=u.grads;if(null!=c){var g=c.map(function(v){return{name:v.name,tensor:m[v.name]}});this.applyGradients(g)}else this.applyGradients(m);return Kn(m),a?p:(p.dispose(),null)},Object.defineProperty(o.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),o.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},o.prototype.computeGradients=function(i,a){return uk(i,a)},o.prototype.dispose=function(){null!=this.iterations_&&Kn(this.iterations_)},o.prototype.saveIterations=function(){return J(this,void 0,void 0,function(){return K(this,function(i){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:Nt(this.iterations_,"int32")}]})})},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){return K(this,function(i){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){return K(this,function(a){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},o.prototype.extractIterations=function(i){return J(this,void 0,void 0,function(){var a;return K(this,function(c){switch(c.label){case 0:return a=this,[4,i[0].tensor.data()];case 1:return a.iterations_=c.sent()[0],[2,i.slice(1)]}})})},o}(lb);Object.defineProperty(Sl,Symbol.hasInstance,{value:function(s){return null!=s.minimize&&null!=s.computeGradients&&null!=s.applyGradients}});var fb=function(s){function o(i,a,c){void 0===c&&(c=null);var u=s.call(this)||this;return u.learningRate=i,u.rho=a,u.epsilon=c,u.accumulatedGrads=[],u.accumulatedUpdates=[],null==c&&(u.epsilon=Ie.backend.epsilon()),u}return j(o,s),o.prototype.applyGradients=function(i){var a=this;(Array.isArray(i)?i.map(function(c){return c.name}):Object.keys(i)).forEach(function(c,u){var p=Ie.registeredVariables[c];null==a.accumulatedGrads[u]&&(a.accumulatedGrads[u]={originalName:c+"/accum_grad",variable:$e(function(){return $n(p).variable(!1)})}),null==a.accumulatedUpdates[u]&&(a.accumulatedUpdates[u]={originalName:c+"/accum_var",variable:$e(function(){return $n(p).variable(!1)})});var m=Array.isArray(i)?i[u].tensor:i[c];if(null!=m){var g=a.accumulatedGrads[u].variable,v=a.accumulatedUpdates[u].variable;$e(function(){var y=g.mul(a.rho).add(m.square().mul(1-a.rho)),C=v.add(a.epsilon).sqrt().div(g.add(a.epsilon).sqrt()).mul(m),S=v.mul(a.rho).add(C.square().mul(1-a.rho));g.assign(y),v.assign(S);var M=C.mul(-a.learningRate).add(p);p.assign(M)})}}),this.incrementIterations()},o.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Kn(this.accumulatedGrads.map(function(i){return i.variable})),Kn(this.accumulatedUpdates.map(function(i){return i.variable})))},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){var i;return K(this,function(a){switch(a.label){case 0:return i=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(i.map(function(c){return{name:c.originalName,tensor:c.variable}}))]}})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){var a;return K(this,function(c){switch(c.label){case 0:return[4,this.extractIterations(i)];case 1:return i=c.sent(),this.accumulatedGrads=i.slice(0,a=i.length/2).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),this.accumulatedUpdates=i.slice(a,2*a).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),[2]}})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},o.fromConfig=function(i,a){return new i(a.learningRate,a.rho,a.epsilon)},o.className="Adadelta",o}(Sl);oc(fb);var Un=function(s){function o(i,a){void 0===a&&(a=.1);var c=s.call(this)||this;return c.learningRate=i,c.initialAccumulatorValue=a,c.accumulatedGrads=[],c}return j(o,s),o.prototype.applyGradients=function(i){var a=this;(Array.isArray(i)?i.map(function(c){return c.name}):Object.keys(i)).forEach(function(c,u){var p=Ie.registeredVariables[c];null==a.accumulatedGrads[u]&&(a.accumulatedGrads[u]={originalName:c+"/accumulator",variable:$e(function(){return ml(p.shape,a.initialAccumulatorValue).variable(!1)})});var m=Array.isArray(i)?i[u].tensor:i[c];if(null!=m){var g=a.accumulatedGrads[u].variable;$e(function(){var v=g.add(m.square());g.assign(v);var y=m.div(v.add(Ie.backend.epsilon()).sqrt()).mul(-a.learningRate).add(p);p.assign(y)})}}),this.incrementIterations()},o.prototype.dispose=function(){null!=this.accumulatedGrads&&Kn(this.accumulatedGrads.map(function(i){return i.variable}))},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){return K(this,function(i){switch(i.label){case 0:return[4,this.saveIterations()];case 1:return[2,[i.sent()].concat(this.accumulatedGrads.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){return K(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(i)];case 1:return i=a.sent(),this.accumulatedGrads=i.map(function(c){return{originalName:c.name,variable:c.tensor.variable(!1)}}),[2]}})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},o.fromConfig=function(i,a){return new i(a.learningRate,a.initialAccumulatorValue)},o.className="Adagrad",o}(Sl);oc(Un);var Ct=function(s){function o(i,a,c,u){void 0===u&&(u=null);var p=s.call(this)||this;return p.learningRate=i,p.beta1=a,p.beta2=c,p.epsilon=u,p.accumulatedFirstMoment=[],p.accumulatedSecondMoment=[],$e(function(){p.accBeta1=Nt(a).variable(),p.accBeta2=Nt(c).variable()}),null==u&&(p.epsilon=Ie.backend.epsilon()),p}return j(o,s),o.prototype.applyGradients=function(i){var a=this,c=Array.isArray(i)?i.map(function(u){return u.name}):Object.keys(i);$e(function(){var u=jr(1,a.accBeta1),p=jr(1,a.accBeta2);c.forEach(function(m,g){var v=Ie.registeredVariables[m];null==a.accumulatedFirstMoment[g]&&(a.accumulatedFirstMoment[g]={originalName:m+"/m",variable:$e(function(){return $n(v).variable(!1)})}),null==a.accumulatedSecondMoment[g]&&(a.accumulatedSecondMoment[g]={originalName:m+"/v",variable:$e(function(){return $n(v).variable(!1)})});var y=Array.isArray(i)?i[g].tensor:i[m];if(null!=y){var C=a.accumulatedFirstMoment[g].variable,S=a.accumulatedSecondMoment[g].variable,M=C.mul(a.beta1).add(y.mul(1-a.beta1)),O=S.mul(a.beta2).add(y.square().mul(1-a.beta2)),N=M.div(u),P=O.div(p);C.assign(M),S.assign(O);var B=N.div(P.sqrt().add(a.epsilon)).mul(-a.learningRate).add(v);v.assign(B)}}),a.accBeta1.assign(a.accBeta1.mul(a.beta1)),a.accBeta2.assign(a.accBeta2.mul(a.beta2))}),this.incrementIterations()},o.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Kn(this.accumulatedFirstMoment.map(function(i){return i.variable})),null!=this.accumulatedSecondMoment&&Kn(this.accumulatedSecondMoment.map(function(i){return i.variable}))},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){var i;return K(this,function(a){switch(a.label){case 0:return i=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(i.map(function(c){return{name:c.originalName,tensor:c.variable}}))]}})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){var a,c=this;return K(this,function(u){switch(u.label){case 0:return[4,this.extractIterations(i)];case 1:return i=u.sent(),$e(function(){c.accBeta1.assign(Kl(c.beta1,c.iterations_+1)),c.accBeta2.assign(Kl(c.beta2,c.iterations_+1))}),this.accumulatedFirstMoment=i.slice(0,a=i.length/2).map(function(p){return{originalName:p.name,variable:p.tensor.variable(!1)}}),this.accumulatedSecondMoment=i.slice(a,2*a).map(function(p){return{originalName:p.name,variable:p.tensor.variable(!1)}}),[2]}})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},o.fromConfig=function(i,a){return new i(a.learningRate,a.beta1,a.beta2,a.epsilon)},o.className="Adam",o}(Sl);oc(Ct);var ag=function(s){function o(i,a,c,u,p){void 0===u&&(u=null),void 0===p&&(p=0);var m=s.call(this)||this;return m.learningRate=i,m.beta1=a,m.beta2=c,m.epsilon=u,m.decay=p,m.accumulatedFirstMoment=[],m.accumulatedWeightedInfNorm=[],$e(function(){m.iteration=Nt(0).variable(),m.accBeta1=Nt(a).variable()}),null==u&&(m.epsilon=Ie.backend.epsilon()),m}return j(o,s),o.prototype.applyGradients=function(i){var a=this,c=Array.isArray(i)?i.map(function(u){return u.name}):Object.keys(i);$e(function(){var u=jr(1,a.accBeta1),p=bo(-a.learningRate,a.iteration.mul(a.decay).add(1));c.forEach(function(m,g){var v=Ie.registeredVariables[m];null==a.accumulatedFirstMoment[g]&&(a.accumulatedFirstMoment[g]={originalName:m+"/m",variable:$n(v).variable(!1)}),null==a.accumulatedWeightedInfNorm[g]&&(a.accumulatedWeightedInfNorm[g]={originalName:m+"/v",variable:$n(v).variable(!1)});var y=Array.isArray(i)?i[g].tensor:i[m];if(null!=y){var C=a.accumulatedFirstMoment[g].variable,S=a.accumulatedWeightedInfNorm[g].variable,M=C.mul(a.beta1).add(y.mul(1-a.beta1)),O=S.mul(a.beta2),N=y.abs(),P=O.maximum(N);C.assign(M),S.assign(P);var B=p.div(u).mul(M.div(P.add(a.epsilon))).add(v);v.assign(B)}}),a.iteration.assign(a.iteration.add(1)),a.accBeta1.assign(a.accBeta1.mul(a.beta1))}),this.incrementIterations()},o.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Kn(this.accumulatedFirstMoment.map(function(i){return i.variable})),null!=this.accumulatedWeightedInfNorm&&Kn(this.accumulatedWeightedInfNorm.map(function(i){return i.variable}))},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){return K(this,function(i){throw new Error("getWeights() is not implemented for Adamax yet.")})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){return K(this,function(a){throw new Error("setWeights() is not implemented for Adamax yet.")})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},o.fromConfig=function(i,a){return new i(a.learningRate,a.beta1,a.beta2,a.epsilon,a.decay)},o.className="Adamax",o}(Sl);oc(ag);var Ep=function(s){function o(i){var a=s.call(this)||this;return a.learningRate=i,a.setLearningRate(i),a}return j(o,s),o.prototype.applyGradients=function(i){var a=this;(Array.isArray(i)?i.map(function(c){return c.name}):Object.keys(i)).forEach(function(c,u){var p=Array.isArray(i)?i[u].tensor:i[c];if(null!=p){var m=Ie.registeredVariables[c];$e(function(){var g=a.c.mul(p).add(m);m.assign(g)})}}),this.incrementIterations()},o.prototype.setLearningRate=function(i){this.learningRate=i,null!=this.c&&this.c.dispose(),this.c=Ka(Nt(-i))},o.prototype.dispose=function(){this.c.dispose()},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){return K(this,function(i){switch(i.label){case 0:return[4,this.saveIterations()];case 1:return[2,[i.sent()]]}})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){return K(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(i)];case 1:if(0!==(i=a.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate}},o.fromConfig=function(i,a){return new i(a.learningRate)},o.className="SGD",o}(Sl);oc(Ep);var mb=function(s){function o(i,a,c){void 0===c&&(c=!1);var u=s.call(this,i)||this;return u.learningRate=i,u.momentum=a,u.useNesterov=c,u.accumulations=[],u.m=Nt(u.momentum),u}return j(o,s),o.prototype.applyGradients=function(i){var a=this;(Array.isArray(i)?i.map(function(c){return c.name}):Object.keys(i)).forEach(function(c,u){var p=Ie.registeredVariables[c];null==a.accumulations[u]&&(a.accumulations[u]={originalName:c+"/momentum",variable:$e(function(){return $n(p).variable(!1)})});var m=a.accumulations[u].variable,g=Array.isArray(i)?i[u].tensor:i[c];null!=g&&$e(function(){var v,y=a.m.mul(m).add(g);v=a.useNesterov?a.c.mul(g.add(y.mul(a.m))).add(p):a.c.mul(y).add(p),m.assign(y),p.assign(v)})}),this.incrementIterations()},o.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Kn(this.accumulations.map(function(i){return i.variable}))},o.prototype.setMomentum=function(i){this.momentum=i},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){return K(this,function(i){switch(i.label){case 0:return[4,this.saveIterations()];case 1:return[2,[i.sent()].concat(this.accumulations.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){return K(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(i)];case 1:return i=a.sent(),this.accumulations=i.map(function(c){return{originalName:c.name,variable:c.tensor.variable(!1)}}),[2]}})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},o.fromConfig=function(i,a){return new i(a.learningRate,a.momentum,a.useNesterov)},o.className="Momentum",o}(Ep);oc(mb);var gb=function(s){function o(i,a,c,u,p){void 0===a&&(a=.9),void 0===c&&(c=0),void 0===u&&(u=null),void 0===p&&(p=!1);var m=s.call(this)||this;return m.learningRate=i,m.decay=a,m.momentum=c,m.epsilon=u,m.accumulatedMeanSquares=[],m.accumulatedMoments=[],m.accumulatedMeanGrads=[],m.centered=p,null==u&&(m.epsilon=Ie.backend.epsilon()),m}return j(o,s),o.prototype.applyGradients=function(i){var a=this;(Array.isArray(i)?i.map(function(c){return c.name}):Object.keys(i)).forEach(function(c,u){var p=Ie.registeredVariables[c];null==a.accumulatedMeanSquares[u]&&(a.accumulatedMeanSquares[u]={originalName:c+"/rms",variable:$e(function(){return $n(p).variable(!1)})}),null==a.accumulatedMoments[u]&&(a.accumulatedMoments[u]={originalName:c+"/momentum",variable:$e(function(){return $n(p).variable(!1)})}),null==a.accumulatedMeanGrads[u]&&a.centered&&(a.accumulatedMeanGrads[u]={originalName:c+"/mg",variable:$e(function(){return $n(p).variable(!1)})});var m=Array.isArray(i)?i[u].tensor:i[c];if(null!=m){var g=a.accumulatedMeanSquares[u].variable,v=a.accumulatedMoments[u].variable;$e(function(){var y=g.mul(a.decay).add(m.square().mul(1-a.decay));if(a.centered){var C=a.accumulatedMeanGrads[u].variable,S=C.mul(a.decay).add(m.mul(1-a.decay)),M=v.mul(a.momentum).add(m.mul(a.learningRate).div(y.sub(S.square().add(a.epsilon)).sqrt()));g.assign(y),C.assign(S),v.assign(M);var O=p.sub(M);p.assign(O)}else{var N=g.mul(a.decay).add(m.square().mul(1-a.decay));M=v.mul(a.momentum).add(m.mul(a.learningRate).div(N.add(a.epsilon).sqrt())),g.assign(N),v.assign(M),O=p.sub(M),p.assign(O)}})}}),this.incrementIterations()},o.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Kn(this.accumulatedMeanSquares.map(function(i){return i.variable})),null!=this.accumulatedMeanGrads&&this.centered&&Kn(this.accumulatedMeanGrads.map(function(i){return i.variable})),null!=this.accumulatedMoments&&Kn(this.accumulatedMoments.map(function(i){return i.variable}))},o.prototype.getWeights=function(){return J(this,void 0,void 0,function(){var i;return K(this,function(a){switch(a.label){case 0:return i=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&i.push.apply(i,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[a.sent()].concat(i.map(function(c){return{name:c.originalName,tensor:c.variable}}))]}})})},o.prototype.setWeights=function(i){return J(this,void 0,void 0,function(){var a;return K(this,function(c){switch(c.label){case 0:return[4,this.extractIterations(i)];case 1:return i=c.sent(),this.accumulatedMeanSquares=i.slice(0,a=this.centered?i.length/3:i.length/2).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),this.accumulatedMoments=i.slice(a,2*a).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=i.slice(2*a,3*a).map(function(u){return{originalName:u.name,variable:u.tensor.variable(!1)}})),[2]}})})},o.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},o.fromConfig=function(i,a){return new i(a.learningRate,a.decay,a.momentum,a.epsilon,a.centered)},o.className="RMSProp",o}(Sl);oc(gb);var ac=function(){function s(){}return s.sgd=function(o){return new Ep(o)},s.momentum=function(o,i,a){return void 0===a&&(a=!1),new mb(o,i,a)},s.rmsprop=function(o,i,a,c,u){return void 0===i&&(i=.9),void 0===a&&(a=0),void 0===c&&(c=null),void 0===u&&(u=!1),new gb(o,i,a,c,u)},s.adam=function(o,i,a,c){return void 0===o&&(o=.001),void 0===i&&(i=.9),void 0===a&&(a=.999),void 0===c&&(c=null),new Ct(o,i,a,c)},s.adadelta=function(o,i,a){return void 0===o&&(o=.001),void 0===i&&(i=.95),void 0===a&&(a=null),new fb(o,i,a)},s.adamax=function(o,i,a,c,u){return void 0===o&&(o=.002),void 0===i&&(i=.9),void 0===a&&(a=.999),void 0===c&&(c=null),void 0===u&&(u=0),new ag(o,i,a,c,u)},s.adagrad=function(o,i){return void 0===i&&(i=.1),new Un(o,i)},s}(),hd={sgd:ac.sgd,momentum:ac.momentum,adadelta:ac.adadelta,adagrad:ac.adagrad,rmsprop:ac.rmsprop,adamax:ac.adamax,adam:ac.adam},s1=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(s){return s()};function sg(){return new Promise(function(s){return s1(function(){return s()})})}Je=tb;var l1=function(s,o){return(l1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var c in a)a.hasOwnProperty(c)&&(i[c]=a[c])})(s,o)};function ft(s,o){function i(){this.constructor=s}l1(s,o),s.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}var lg,Vu=function(){return(Vu=Object.assign||function(s){for(var o,i=1,a=arguments.length;i<a;i++)for(var c in o=arguments[i])Object.prototype.hasOwnProperty.call(o,c)&&(s[c]=o[c]);return s}).apply(this,arguments)};function nn(s,o,i,a){return new(i||(i=Promise))(function(c,u){function p(v){try{g(a.next(v))}catch(y){u(y)}}function m(v){try{g(a.throw(v))}catch(y){u(y)}}function g(v){v.done?c(v.value):new i(function(y){y(v.value)}).then(p,m)}g((a=a.apply(s,o||[])).next())})}function Rn(s,o){var i,a,c,u,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:m(0),throw:m(1),return:m(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function m(g){return function(v){return function(y){if(i)throw new TypeError("Generator is already executing.");for(;p;)try{if(i=1,a&&(c=2&y[0]?a.return:y[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,y[1])).done)return c;switch(a=0,c&&(y=[2&y[0],c.value]),y[0]){case 0:case 1:c=y;break;case 4:return p.label++,{value:y[1],done:!1};case 5:p.label++,a=y[1],y=[0];continue;case 7:y=p.ops.pop(),p.trys.pop();continue;default:if(!(c=(c=p.trys).length>0&&c[c.length-1])&&(6===y[0]||2===y[0])){p=0;continue}if(3===y[0]&&(!c||y[1]>c[0]&&y[1]<c[3])){p.label=y[1];break}if(6===y[0]&&p.label<c[1]){p.label=c[1],c=y;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(y);break}c[2]&&p.ops.pop(),p.trys.pop();continue}y=o.call(s,p)}catch(C){y=[6,C],a=0}finally{i=c=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([g,v])}}}function Sr(){return null==lg&&(lg=Go().epsilon()),lg}var pd=function(s){function o(i){var a=s.call(this,i)||this;return Object.setPrototypeOf(a,o.prototype),a}return ft(o,s),o}(Error),Dl=function(s){function o(i){var a=s.call(this,i)||this;return Object.setPrototypeOf(a,o.prototype),a}return ft(o,s),o}(Error),Ne=function(s){function o(i){var a=s.call(this,i)||this;return Object.setPrototypeOf(a,o.prototype),a}return ft(o,s),o}(Error),ni=function(s){function o(i){var a=s.call(this,i)||this;return Object.setPrototypeOf(a,o.prototype),a}return ft(o,s),o}(Error),cM=function(s){function o(i){var a=s.call(this,i)||this;return Object.setPrototypeOf(a,o.prototype),a}return ft(o,s),o}(Error);function Uu(s,o){if(Array.isArray(s)){for(var i=[],a=0;a<o;a++)i=i.concat(s);return i}return(i=new Array(o)).fill(s),i}function Gs(s,o){if(!s)throw new cM(o)}function fd(s,o){for(var i=0,a=0,c=s;a<c.length;a++)c[a]===o&&i++;return i}function Jo(s){return 1===s.length?s[0]:s}function Zi(s){return Array.isArray(s)?s:[s]}function ns(s){var o=s.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==o[0]?o:"private"+o}function md(s){return s.length<=1||-1===s.indexOf("_")?s:s.replace(/[_]+(\w|$)/g,function(o,i){return i.toUpperCase()})}!function(s){ft(function o(i){var a=s.call(this,i)||this;return Object.setPrototypeOf(a,o.prototype),a},s)}(Error);var Va={};function _b(s){if(null==s)return null;var o={};return o.className=s.getClassName(),o.config=s.getConfig(),o}function vb(s){if(null!=s&&"object"==typeof s)if(Array.isArray(s))s.forEach(function(u){return vb(u)});else for(var o=0,i=Object.keys(s);o<i.length;o++){var a=i[o],c=s[a];null!=c&&"object"==typeof c&&(Array.isArray(c)||"ndarray"!==c.type||"number"!=typeof c.value?vb(c):s[a]=c.value)}}function kp(s,o,i,a,c){var u,p,m;if(void 0===o&&(o={}),void 0===i&&(i={}),void 0===a&&(a="object"),void 0===c&&(c=!1),"string"==typeof s){var v=void 0;if(s in i)v=i[s];else if(s in Va)v=Va[s];else if(null==(v=o[s]))throw new Ne("Unknown "+a+": "+s+". This may be due to one of the following reasons:\n1. The "+a+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+a+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return v}var y=s;if(null==y.className||null==y.config)throw new Ne(a+": Improper config format: "+JSON.stringify(y)+".\n'className' and 'config' must set.");var C=y.className,S=void 0,M=void 0;if(C in i?(S=(u=i[C])[0],M=u[1]):C in Va?(S=(p=Va.className)[0],M=p[1]):C in o&&(S=(m=o[C])[0],M=m[1]),null==S)throw new Ne("Unknown "+a+": "+C+". This may be due to one of the following reasons:\n1. The "+a+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+a+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(null!=M){for(var O={},N=0,P=Object.keys(Va);N<P.length;N++)O[se=P[N]]=Va[se];for(var B=0,W=Object.keys(i);B<W.length;B++)O[se=W[B]]=i[se];y.config.customObjects=O;for(var G=Vu({},Va),X=0,Q=Object.keys(i);X<Q.length;X++){var se=Q[X];Va[se]=i[se]}vb(y.config);var ue=M(S,y.config,i,c);return Va=Vu({},G),ue}G=Vu({},Va);for(var fe=0,_e=Object.keys(i);fe<_e.length;fe++)Va[se=_e[fe]]=i[se];return ue=new S(y.config),Va=Vu({},G),ue}function cg(s,o){return-1*function uM(s,o){return s<o?-1:s>o?1:0}(s,o)}function El(s){if(null==s)return s;for(var o=[],i=0,a=s;i<a.length;i++){var c=a[i];-1===o.indexOf(c)&&o.push(c)}return o}function hM(s){if(null==s)throw new Ne("Invalid value in obj: "+JSON.stringify(s));for(var o in s)if(s.hasOwnProperty(o))return!1;return!0}function gd(s,o,i){if(null!=i&&s.indexOf(i)<0)throw new Ne(i+" is not a valid "+o+".  Valid values are "+s+" or null/undefined.")}function dg(s,o,i,a){return void 0===i&&(i=0),void 0===a&&(a=1/0),Gs(i>=0),Gs(a>=i),Array.isArray(s)&&s.length>=i&&s.length<=a&&s.every(function(c){return typeof c===o})}function xo(s,o){Array.isArray(s)?(qe.assert(s.length>0,function(){return o+" is unexpectedly an empty array."}),s.forEach(function(i,a){return xo(i,"element "+(a+1)+" of "+o)})):qe.assert(Number.isInteger(s)&&s>0,function(){return"Expected "+o+" to be a positive integer, but got "+pM(s)+"."})}function pM(s){return null===s?"null":Array.isArray(s)?"["+s.map(function(o){return pM(o)}).join(",")+"]":"string"==typeof s?'"'+s+'"':""+s}function c1(s){return"relu"===s?"relu":"linear"===s?"linear":"elu"===s?"elu":null}function d1(s,o){return $e(function(){return Eu(wa(Dm(s,s),o,!0))})}var re=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.getConfig=function(){return{}},o}(bt.Serializable),$s=function(s){function o(i){var a=s.call(this)||this;return a.defaultMaxValue=2,a.defaultAxis=0,a.maxValue=null!=i.maxValue?i.maxValue:a.defaultMaxValue,a.axis=null!=i.axis?i.axis:a.defaultAxis,a}return ft(o,s),o.prototype.apply=function(i){var a=this;return $e(function(){var c=d1(i,a.axis),u=Zo(c,0,a.maxValue);return Vn(i,bo(u,ai(Sr(),c)))})},o.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},o.className="MaxNorm",o}(re);bt.registerClass($s);var u1=function(s){function o(i){var a=s.call(this)||this;return a.defaultAxis=0,a.axis=null!=i.axis?i.axis:a.defaultAxis,a}return ft(o,s),o.prototype.apply=function(i){var a=this;return $e(function(){return bo(i,ai(Sr(),d1(i,a.axis)))})},o.prototype.getConfig=function(){return{axis:this.axis}},o.className="UnitNorm",o}(re);bt.registerClass(u1);var yb=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return Zl(i)},o.className="NonNeg",o}(re);bt.registerClass(yb);var h1=function(s){function o(i){var a=s.call(this)||this;return a.defaultMinValue=0,a.defaultMaxValue=1,a.defaultRate=1,a.defaultAxis=0,a.minValue=null!=i.minValue?i.minValue:a.defaultMinValue,a.maxValue=null!=i.maxValue?i.maxValue:a.defaultMaxValue,a.rate=null!=i.rate?i.rate:a.defaultRate,a.axis=null!=i.axis?i.axis:a.defaultAxis,a}return ft(o,s),o.prototype.apply=function(i){var a=this;return $e(function(){var c=d1(i,a.axis),u=ai(Vn(a.rate,Zo(c,a.minValue,a.maxValue)),Vn(1-a.rate,c));return Vn(i,bo(u,ai(Sr(),c)))})},o.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},o.className="MinMaxNorm",o}(re);bt.registerClass(h1);var p1={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Oi(s){return _b(s)}function _d(s,o){return void 0===o&&(o={}),kp(s,bt.SerializationMap.getMap().classNameMap,o,"constraint")}function Dr(s){return null==s?null:"string"==typeof s?_d({className:s in p1?p1[s]:s,config:{}}):s instanceof re?s:_d(s)}var wb=Object.freeze({maxNorm:function Mp(s){return new $s(s)},unitNorm:function xb(s){return new u1(s)},nonNeg:function ug(){return new yb},minMaxNorm:function f1(s){return new h1(s)}}),Cb=["channelsFirst","channelsLast"],Sb=["valid","same","causal"],m1=["max","avg"],Db=["sum","mul","concat","ave"],Hu=new Map;function Wr(s){gd(Cb,"DataFormat",s)}function Ua(s){gd(Sb,"PaddingMode",s)}function g1(s){gd(m1,"PoolMode",s)}var ju=[];function vd(s,o){ju.push(s);try{var i=o();return ju.pop(),i}catch(a){throw ju.pop(),a}}function Da(s){if(!gM(s))throw new Error("Not a valid tensor name: '"+s+"'");return function fM(){return 0===ju.length?"":ju.join("/")+"/"}()+s}function kb(s){if(!gM(s))throw new Error("Not a valid tensor name: '"+s+"'");Hu.has(s)||Hu.set(s,0);var o=Hu.get(s);if(Hu.set(s,Hu.get(s)+1),o>0){var i=s+"_"+o;return Hu.set(i,1),i}return s}var mM=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function gM(s){return!!s.match(mM)}function Mb(s){return s===parseInt(s.toString(),10)}function kl(s,o,i){null==o&&(o=0),null==i&&(i=s.length);for(var a=1,c=o;c<i;++c)a*=s[c];return a}function _1(s){return Pn(s=Array.isArray(s)?new Float32Array(s):s)}function Wu(s){return jm(_1(s)).dataSync()[0]}function sc(s){return xa(_1(s)).dataSync()[0]}function is(s,o){if(o<s)throw new Ne("end ("+o+") < begin ("+s+") is forbidden.");for(var i=[],a=s;a<o;++a)i.push(a);return i}function Tp(s,o){return s.asType(o)}function Ip(s,o){void 0===o&&(o=-1);var i=s.shape.slice();return o<0&&(o=i.length+o+1),i.splice(o,0,1),s.reshape(i)}function bd(s,o,i){return $e(function(){switch(s.rank){case 1:return Vm(s,o,i);case 2:return Um(s,[o,0],[i,s.shape[1]]);case 3:return od(s,[o,0,0],[i,s.shape[1],s.shape[2]]);case 4:return Ru(s,[o,0,0,0],[i,s.shape[1],s.shape[2],s.shape[3]]);case 5:return Pa(s,[o,0,0,0,0],[i,s.shape[1],s.shape[2],s.shape[3],s.shape[4]]);case 6:return Pa(s,[o,0,0,0,0,0],[i,s.shape[1],s.shape[2],s.shape[3],s.shape[4],s.shape[5]]);default:throw new Ne("sliceAlongFirstAxis() received an unsupported tensor rank: "+s.rank)}})}function Ib(s,o,i){return $e(function(){switch(s.rank){case 1:return Vm(s,o,i);case 2:return Um(s,[0,o],[s.shape[0],i]);case 3:return od(s,[0,0,o],[s.shape[0],s.shape[1],i]);case 4:return Ru(s,[0,0,0,o],[s.shape[0],s.shape[1],s.shape[2],i]);default:throw new Ne("sliceAlongLastAxis() received an unsupported tensor rank: "+s.rank)}})}function hg(s,o,i,a){return $e(function(){switch(s.rank){case 1:return Vm(s,o,i);case 2:switch(a){case 1:return bd(s,o,i);case 2:return Ib(s,o,i);default:throw new Ne("The axis is not within the rank of the tensor "+a)}case 3:switch(a){case 1:return bd(s,o,i);case 2:return od(s,[0,o,0],[s.shape[0],i,s.shape[2]]);case 3:return Ib(s,o,i);default:throw new Ne("The axis is not within the rank of the tensor "+a)}case 4:switch(a){case 1:return bd(s,o,i);case 2:return Ru(s,[0,o,0,0],[s.shape[0],i,s.shape[2],s.shape[3]]);case 3:return Ru(s,[0,0,o,0],[s.shape[0],s.shape[1],i,s.shape[3]]);case 4:return Ib(s,o,i);default:throw new Ne("The axis is not within the rank of the tensor "+a)}default:throw new Ne("sliceAlongLastAxis() received an unsupported tensor rank: "+s.rank)}})}function _s(s,o){var i;return void 0===o&&(o=-1),o<0&&(o=0!==(i=s[0].rank)?i:0),o===s[0].rank&&(o=-1),Ur(s,o)}function pg(s,o){switch(s.rank){case 1:return V_([s,o]);case 2:return Mn([s,o],0);case 3:return U_([s,o],0);case 4:return $f([s,o],0);default:throw new Ne("concatAlongFirstAxis() received an unsupported tensor rank: "+s.rank)}}function Ab(s,o){if(Array.isArray(o)||(o=[o]),s.rank!==o.length)throw new Ne("The length of input n ("+o.length+") does not match the number of dimensions in input x ("+s.rank+")");return us(s,o)}function fg(s,o,i,a,c){return void 0===o&&(o=0),void 0===i&&(i=1),Za(s,o,i,a,c)}function qs(s,o,i,a){if(s.rank<2||o.rank<2)throw new ni("dot requires both inputs to be rank >= 2 but got x shape = "+s.shape+" and y shape = "+o.shape);if(o.rank>=3&&s.shape.slice(-1)[0]!==(y=o.shape.slice(-2)[0]))throw new ni("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+s.shape+" and  y shape = "+o.shape);if(2===s.rank&&2===o.rank){var c=!1,u=!1;return Pu.matMul({a:s,b:o,transposeA:c,transposeB:u,bias:a?Rb(s.rank,a,"channelsLast"):null,activation:i})}var p=s.shape.slice(),m=p.pop();s=s.reshape([-1,m]);var g=o.shape.slice(),v=g.pop(),y=g.pop(),C=g.concat([v]),S=Array.from({length:o.rank},function(O,N){return 0===N?o.rank-2:N<=o.rank-2?N-1:N});o=o.transpose(S).reshape([y,-1]);var M=p.concat(C);return Pu.matMul({a:s,b:o,transposeA:c=!1,transposeB:u=!1,bias:a?Rb(s.rank,a,"channelsLast"):null,activation:i}).reshape(M)}function v1(s,o,i){return $e(function(){return o=Array.isArray(o)?Pn(o,"int32"):o.toInt(),td(s,o,i)})}function Ap(s){return Dm(s,s)}function Rb(s,o,i){var a=o.shape;if(1!==o.rank&&o.rank!==s)throw new Ne("Unexpected bias dimensions: "+o.rank+"; expected it to be 1 or "+s);if(5===s){if("channelsFirst"===i)return o.reshape(1===a.length?[1,a[0],1,1,1]:[1,a[3],a[0],a[1],a[2]]);if("channelsLast"===i)return o.reshape(1===a.length?[1,1,1,1,a[0]]:[1].concat(a))}else if(4===s){if("channelsFirst"===i)return o.reshape(1===a.length?[1,a[0],1,1]:[1,a[2],a[0],a[1]]);if("channelsLast"===i)return o.reshape(1===a.length?[1,1,1,a[0]]:[1].concat(a))}else if(3===s){if("channelsFirst"===i)return o.reshape(1===a.length?[1,a[0],1]:[1,a[1],a[0]]);if("channelsLast"===i)return o.reshape(1===a.length?[1,1,a[0]]:[1].concat(a))}else if(s<3)return o;throw new Ne("Unsupported input rank by biasAdd: "+o.rank)}function vs(s,o,i){return $e(function(){return null==i&&(i="channelsLast"),Wr(i),s.add(Rb(s.rank,o,i))})}function Rp(s,o,i,a){return $e(function(){return yp(s,o,i,a)})}function Ml(s,o,i){return void 0===i&&(i=!1),i?s():o()}var xF=["fanIn","fanOut","fanAvg"],Ob=["normal","uniform","truncatedNormal"],rs=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.fromConfigUsesCustomObjects=function(){return!1},o.prototype.getConfig=function(){return{}},o}(bt.Serializable),Nb=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i,a){return fn(i,a)},o.className="Zeros",o}(rs);bt.registerClass(Nb);var mg=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i,a){return ao(i,a)},o.className="Ones",o}(rs);bt.registerClass(mg);var gg=function(s){function o(i){var a=s.call(this)||this;if("object"!=typeof i)throw new Ne("Expected argument of type ConstantConfig but got "+i);if(void 0===i.value)throw new Ne("config must have value set but got "+i);return a.value=i.value,a}return ft(o,s),o.prototype.apply=function(i,a){var c=this;return $e(function(){return Vn(Nt(c.value),ao(i,a))})},o.prototype.getConfig=function(){return{value:this.value}},o.className="Constant",o}(rs);bt.registerClass(gg);var Ys=function(s){function o(i){var a=s.call(this)||this;return a.DEFAULT_MINVAL=-.05,a.DEFAULT_MAXVAL=.05,a.minval=i.minval||a.DEFAULT_MINVAL,a.maxval=i.maxval||a.DEFAULT_MAXVAL,a.seed=i.seed,a}return ft(o,s),o.prototype.apply=function(i,a){return Hl(i,this.minval,this.maxval,a)},o.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},o.className="RandomUniform",o}(rs);bt.registerClass(Ys);var Fp=function(s){function o(i){var a=s.call(this)||this;return a.DEFAULT_MEAN=0,a.DEFAULT_STDDEV=.05,a.mean=i.mean||a.DEFAULT_MEAN,a.stddev=i.stddev||a.DEFAULT_STDDEV,a.seed=i.seed,a}return ft(o,s),o.prototype.apply=function(i,a){if("float32"!==(a=a||"float32")&&"int32"!==a)throw new ni("randomNormal does not support dType "+a+".");return fg(i,this.mean,this.stddev,a,this.seed)},o.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},o.className="RandomNormal",o}(rs);bt.registerClass(Fp);var Op=function(s){function o(i){var a=s.call(this)||this;return a.DEFAULT_MEAN=0,a.DEFAULT_STDDEV=.05,a.mean=i.mean||a.DEFAULT_MEAN,a.stddev=i.stddev||a.DEFAULT_STDDEV,a.seed=i.seed,a}return ft(o,s),o.prototype.apply=function(i,a){if("float32"!==(a=a||"float32")&&"int32"!==a)throw new ni("truncatedNormal does not support dType "+a+".");return jl(i,this.mean,this.stddev,a,this.seed)},o.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},o.className="TruncatedNormal",o}(rs);bt.registerClass(Op);var Gu=function(s){function o(i){var a=s.call(this)||this;return a.gain=null!=i.gain?i.gain:1,a}return ft(o,s),o.prototype.apply=function(i,a){var c=this;return $e(function(){if(2!==i.length||i[0]!==i[1])throw new Ne("Identity matrix initializer can only be used for 2D square matrices.");return Vn(c.gain,Lc(i[0]))})},o.prototype.getConfig=function(){return{gain:this.gain}},o.className="Identity",o}(rs);bt.registerClass(Gu);var ea=function(s){function o(i){var a=s.call(this)||this;if(i.scale<0)throw new Ne("scale must be a positive float. Got: "+i.scale);return a.scale=null==i.scale?1:i.scale,a.mode=null==i.mode?"fanIn":i.mode,function wF(s){gd(xF,"FanMode",s)}(a.mode),a.distribution=null==i.distribution?"normal":i.distribution,function b1(s){gd(Ob,"Distribution",s)}(a.distribution),a.seed=i.seed,a}return ft(o,s),o.prototype.apply=function(i,a){var c=function xM(s,o){var i,a;if(void 0===o&&(o="channelsLast"),Wr(o),2===s.length)i=s[0],a=s[1];else if(-1!==[3,4,5].indexOf(s.length))if("channelsFirst"===o){var c=kl(s,2);i=s[1]*c,a=s[0]*c}else"channelsLast"===o&&(c=kl(s,0,s.length-2),i=s[s.length-2]*c,a=s[s.length-1]*c);else{var u=kl(s);i=Math.sqrt(u),a=Math.sqrt(u)}return[i,a]}(i),u=c[0],p=c[1],m=this.scale;if(m/="fanIn"===this.mode?Math.max(1,u):"fanOut"===this.mode?Math.max(1,p):Math.max(1,(u+p)/2),"normal"===this.distribution){var g=Math.sqrt(m);if("float32"!==(a=a||"float32")&&"int32"!==a)throw new ni(this.getClassName()+" does not support dType "+a+".");return jl(i,0,g,a,this.seed)}var v=Math.sqrt(3*m);return Hl(i,-v,v,a)},o.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},o.className="VarianceScaling",o}(rs);bt.registerClass(ea);var _g=function(s){function o(i){return s.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==i?null:i.seed})||this}return ft(o,s),o.prototype.getClassName=function(){return ea.className},o.className="GlorotUniform",o}(ea);bt.registerClass(_g);var Pb=function(s){function o(i){return s.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==i?null:i.seed})||this}return ft(o,s),o.prototype.getClassName=function(){return ea.className},o.className="GlorotNormal",o}(ea);bt.registerClass(Pb);var Lb=function(s){function o(i){return s.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==i?null:i.seed})||this}return ft(o,s),o.prototype.getClassName=function(){return ea.className},o.className="HeNormal",o}(ea);bt.registerClass(Lb);var yd=function(s){function o(i){return s.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==i?null:i.seed})||this}return ft(o,s),o.prototype.getClassName=function(){return ea.className},o.className="HeUniform",o}(ea);bt.registerClass(yd);var Bb=function(s){function o(i){return s.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==i?null:i.seed})||this}return ft(o,s),o.prototype.getClassName=function(){return ea.className},o.className="LeCunNormal",o}(ea);bt.registerClass(Bb);var y1=function(s){function o(i){return s.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==i?null:i.seed})||this}return ft(o,s),o.prototype.getClassName=function(){return ea.className},o.className="LeCunNormal",o}(ea);bt.registerClass(y1);var x1=function(s){function o(i){var a=s.call(this)||this;if(a.DEFAULT_GAIN=1,a.gain=null==i.gain?a.DEFAULT_GAIN:i.gain,a.seed=i.seed,null!=a.seed)throw new ni("Random seed is not implemented for Orthogonal Initializer yet.");return a}return ft(o,s),o.prototype.apply=function(i,a){var c=this;return $e(function(){if(2!==i.length)throw new ni("The Orthogonal Initializer does not support non-2D shapes yet.");i[0]*i[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+i[0]*i[1]+") elements: Slowness may result.");var u=fg(i[0]>i[1]?[i[1],i[0]]:i,0,1,"float32"),p=Jm.gramSchmidt(u);return i[0]>i[1]&&(p=p.transpose()),Vn(c.gain,p)})},o.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},o.className="Orthogonal",o}(rs);bt.registerClass(x1);var w1={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function C1(s,o){return void 0===o&&(o={}),kp(s,bt.SerializationMap.getMap().classNameMap,o,"initializer")}function Ii(s){return _b(s)}function lr(s){if("string"==typeof s){var o=s in w1?w1[s]:s;if("GlorotNormal"===o)return new Pb;if("GlorotUniform"===o)return new _g;if("HeNormal"===o)return new Lb;if("HeUniform"===o)return new yd;if("LeCunNormal"===o)return new Bb;if("LeCunUniform"===o)return new y1;var i={};return i.className=o,i.config={},C1(i)}return s instanceof rs?s:C1(s)}var RM=Object.freeze({zeros:function wM(){return new Nb},ones:function CM(){return new mg},constant:function S1(s){return new gg(s)},randomUniform:function Et(s){return new Ys(s)},randomNormal:function SM(s){return new Fp(s)},truncatedNormal:function zb(s){return new Op(s)},identity:function DM(s){return new Gu(s)},varianceScaling:function EM(s){return new ea(s)},glorotUniform:function kM(s){return new _g(s)},glorotNormal:function MM(s){return new Pb(s)},heNormal:function TM(s){return new Lb(s)},heUniform:function IM(s){return new yd(s)},leCunNormal:function AM(s){return new Bb(s)},leCunUniform:function D1(s){return new y1(s)},orthogonal:function E1(s){return new x1(s)}}),CF=0;function Vb(){return CF++}var xd={};function Ks(s){return void 0===s&&(s=""),s in xd||(xd[s]=0),xd[s]+=1,s+xd[s].toString()}function k1(s){return Array.isArray(s)&&Array.isArray(s[0])}function lc(s){return 0===s.length?[]:Array.isArray(s[0])?s:[s]}function Qn(s){var o;if(Array.isArray(s)){if(1!==s.length)throw new Ne("Expected Tensor length to be 1; got "+s.length);o=s[0]}else o=s;return o}function Qi(s){if(Array.isArray(s)&&Array.isArray(s[0])){if(1===s.length)return s[0];throw new Ne("Expected exactly 1 Shape; got "+s.length)}return s}function $u(s){for(var o=0,i=0,a=s;i<a.length;i++){var c=a[i];o+=0===c.shape.length?1:c.shape.reduce(function(u,p){return u*p})}return o}var M1="Variable",bs=function(){function s(o,i,a,c,u){void 0===i&&(i="float32"),void 0===a&&(a=M1),void 0===c&&(c=!0),void 0===u&&(u=null),this.dtype=i??"float32",this.shape=o.shape,this.id=Vb(),this.originalName=Da(a=a??M1),this.name=kb(this.originalName),this.trainable_=c,this.constraint=u,this.val=Oa(o,this.trainable_,this.name,this.dtype)}return s.prototype.read=function(){return this.assertNotDisposed(),this.val},s.prototype.write=function(o){return this.assertNotDisposed(),function Np(s,o){if(s.shape.toString()!==o.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(s.shape)+" vs. "+JSON.stringify(o.shape))}(this.val,o),this.val.id!==o.id&&(this.val.assign(o),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},s.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},s.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(s.prototype,"trainable",{get:function(){return this.trainable_},set:function(o){this.trainable_=o,this.val.trainable=o},enumerable:!0,configurable:!0}),s}();function lo(s){return s.map(function(o){return o.read()})}function Tl(s){s.forEach(function(o){o[0].write(o[1])})}var Nr=function(s){this.dtype=s.dtype,this.shape=s.shape,this.ndim=null!=s.shape?s.shape.length:s.ndim,this.maxNDim=s.maxNDim,this.minNDim=s.minNDim,this.axes=s.axes||{}},Er=function(s,o,i,a,c,u,p){this.dtype=s,this.shape=o,this.sourceLayer=i,this.inputs=a,this.callArgs=c,this.outputTensorIndex=p,this.id=Vb(),null!=u&&(this.originalName=Da(u),this.name=kb(this.originalName)),this.rank=o.length},On=0,Il=function(){function s(o,i){this.callArgs=i,this.id=On++,this.outboundLayer=o.outboundLayer,this.inboundLayers=o.inboundLayers,this.nodeIndices=o.nodeIndices,this.tensorIndices=o.tensorIndices,this.inputTensors=o.inputTensors,this.outputTensors=o.outputTensors,this.inputMasks=o.inputMasks,this.outputMasks=o.outputMasks,this.inputShapes=o.inputShapes,this.outputShapes=o.outputShapes;for(var a=0,c=o.inboundLayers;a<c.length;a++)c[a]?.outboundNodes.push(this);o.outboundLayer.inboundNodes.push(this)}return s.prototype.getConfig=function(){for(var o=[],i=0,a=this.inboundLayers;i<a.length;i++){var c=a[i];o.push(null!=c?c.name:null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:o,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},s}(),qu=0,ii=function(s){function o(i){var a=s.call(this)||this;a._callHook=null,a._addedWeightNames=[],a._stateful=!1,a.id=qu++,a.activityRegularizer=null,a.inputSpec=null,a.supportsMasking=!1,a._trainableWeights=[],a._nonTrainableWeights=[],a._losses=[],a._updates=[],a._built=!1,a.inboundNodes=[],a.outboundNodes=[];var c=i.name;if(!c){var u=a.getClassName();c=ns(u)+"_"+Ks(u)}if(a.name=c,a.trainable_=null==i.trainable||i.trainable,null!=i.inputShape||null!=i.batchInputShape){var p=void 0;if(null!=i.batchInputShape)p=i.batchInputShape;else if(null!=i.inputShape){var m=null;null!=i.batchSize&&(m=i.batchSize),p=[m].concat(i.inputShape)}a.batchInputShape=p;var g=i.dtype;null==g&&(g=i.inputDType),null==g&&(g="float32"),a.dtype=g}return a.initialWeights=null!=i.weights?i.weights:null,a._refCount=null,a.fastWeightInitDuringBuild=!1,a}return ft(o,s),o.nodeKey=function(i,a){return i.name+"_ib-"+a.toString()},o.prototype.getNodeAtIndex=function(i,a){if(0===this.inboundNodes.length)throw new Dl("The layer has never been called and thus has no defined "+a+".");if(this.inboundNodes.length<=i)throw new Ne("Asked to get "+a+" at node "+i+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[i]},o.prototype.getInputAt=function(i){return Jo(this.getNodeAtIndex(i,"input").inputTensors)},o.prototype.getOutputAt=function(i){return Jo(this.getNodeAtIndex(i,"output").outputTensors)},Object.defineProperty(o.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new pd("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new pd("Layer "+this.name+" is not connected, no input to return.");return Jo(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new pd("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new pd("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Jo(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),o.prototype.calculateLosses=function(){return this.losses.map(function(i){return i()})},Object.defineProperty(o.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"built",{get:function(){return this._built},set:function(i){this._built=i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"trainable",{get:function(){return this.trainable_},set:function(i){this._trainableWeights.forEach(function(a){return a.trainable=i}),this.trainable_=i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(i){return i.trainable}):[]},set:function(i){this._trainableWeights=i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(i){return!i.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(i){this._nonTrainableWeights=i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),o.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},o.prototype.assertInputCompatibility=function(i){if(i=Zi(i),null!=this.inputSpec&&0!==this.inputSpec.length){var a=Zi(this.inputSpec);if(i.length!==a.length)throw new Ne("Layer "+this.name+" expects "+a.length+" inputs, but it received "+i.length+" input tensors. Input received: "+i);for(var c=0;c<i.length;c++){var u=i[c],p=a[c];if(null!=p){var m=u.rank;if(null!=p.ndim&&m!==p.ndim)throw new Ne("Input "+c+" is incompatible with layer "+this.name+": expected ndim="+p.ndim+", found ndim="+m);if(null!=p.maxNDim&&m>p.maxNDim)throw new Ne("Input "+c+" is incompatible with layer "+this.name+": expected max_ndim="+p.maxNDim+", found ndim="+m);if(null!=p.minNDim&&m<p.minNDim)throw new Ne("Input "+c+" is incompatible with layer "+this.name+": expected min_ndim="+p.minNDim+", found ndim="+m+".");if(null!=p.dtype&&u.dtype!==p.dtype)throw new Ne("Input "+c+" is incompatible with layer "+this.name+" : expected dtype="+p.dtype+", found dtype="+u.dtype+".");if(p.axes){var g=u.shape;for(var v in p.axes){var y=Number(v),C=p.axes[v];if(null!=C&&-1===[C,null].indexOf(y>=0?g[y]:g[g.length+y]))throw new Ne("Input "+c+" is incompatible with layer "+this.name+": expected axis "+y+" of input shape to have value "+C+" but got shape "+g+".")}}if(null!=p.shape)for(var M=0;M<p.shape.length;++M){var O=p.shape[M],N=u.shape[M];if(null!=O&&null!=N&&O!==N)throw new Ne("Input "+c+" is incompatible with layer "+this.name+": expected shape="+p.shape+", found shape="+u.shape+".")}}}}},o.prototype.call=function(i,a){return i},o.prototype.invokeCallHook=function(i,a){null!=this._callHook&&this._callHook(i,a)},o.prototype.setCallHook=function(i){this._callHook=i},o.prototype.clearCallHook=function(){this._callHook=null},o.prototype.apply=function(i,a){var c=this;a=a||{},this.assertNotDisposed();for(var u=Zi(i),p=!0,m=0,g=u;m<g.length;m++)if(!(g[m]instanceof Er)){p=!1;break}for(var v=!0,y=0,C=u;y<C.length;y++)if(C[y]instanceof Er){v=!1;break}if(p===v)throw new Ne("Arguments to apply() must be all SymbolicTensors or all Tensors");return vd(this.name,function(){if(!c.built){c.assertInputCompatibility(i);for(var S=[],M=0,O=Zi(i);M<O.length;M++)S.push(O[M].shape);c.build(Jo(S)),c.built=!0,c.initialWeights&&c.setWeights(c.initialWeights),null===c._refCount&&v&&(c._refCount=1)}if(c.assertInputCompatibility(i),v){for(var P=[],B=0,W=Zi(se=c.call(i,a));B<W.length;B++){var G=W[B];-1!==u.indexOf(G)&&(G=G.clone()),P.push(G)}if(se=Jo(P),null!=c.activityRegularizer)throw new ni("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return se}var X=function Yu(s){for(var o=[],i=0,a=s=Zi(s);i<a.length;i++)o.push(a[i].shape);return Jo(o)}(i),Q=c.computeOutputShape(X),se=void 0,ue="float32";if(c.warnOnIncompatibleInputShape(Array.isArray(i)?X[0]:X),se=null!=Q&&Q.length>0&&Array.isArray(Q[0])?Q.map(function(fe,_e){return new Er(ue,fe,c,Zi(i),a,c.name,_e)}):new Er(ue,Q,c,Zi(i),a,c.name),c.addInboundNode(i,se,null,null,X,Q,a),c._refCount++,null!=c.activityRegularizer)throw new ni("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return se})},o.prototype.warnOnIncompatibleInputShape=function(i){if(null!=this.batchInputShape)if(i.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(i)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var a=!1;this.batchInputShape.forEach(function(c,u){null!=c&&null!=i[u]&&i[u]!==c&&(a=!0)}),a&&console.warn("The shape of the input tensor ("+JSON.stringify(i)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(o.prototype,"outputShape",{get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new pd("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var i=[],a=0,c=this.inboundNodes;a<c.length;a++){var p=JSON.stringify(c[a].outputShapes);-1===i.indexOf(p)&&i.push(p)}if(1===i.length){var m=this.inboundNodes[0].outputShapes;return Array.isArray(m)&&Array.isArray(m[0])&&1===m.length?m[0]:m}throw new pd("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),o.prototype.countParams=function(){if(!this.built)throw new Dl("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return $u(this.weights)},o.prototype.build=function(i){this.built=!0},o.prototype.getWeights=function(i){return void 0===i&&(i=!1),lo(i?this.trainableWeights:this.weights)},o.prototype.setWeights=function(i){var a=this;$e(function(){var c=a.weights;if(c.length!==i.length)throw new Ne('You called setWeights(weights) on layer "'+a.name+'" with a weight list of length '+i.length+", but the layer was expecting "+c.length+" weights. Provided weights: "+i+"...");if(0!==c.length){for(var u=[],p=lo(c),m=0;m<p.length;++m){var g=p[m],v=c[m],y=i[m];if(!qe.arraysEqual(g.shape,y.shape))throw new Ne("Layer weight shape "+g.shape+" not compatible with provided weight shape "+y.shape);u.push([v,y])}Tl(u)}})},o.prototype.addWeight=function(i,a,c,u,p,m,g){if(-1!==this._addedWeightNames.indexOf(i))throw new Ne("Duplicate weight name "+i+" for layer "+this.name);this._addedWeightNames.push(i),null==c&&(c="float32"),this.fastWeightInitDuringBuild&&(u=lr("zeros"));var v=u.apply(a,c),y=new bs(v,c,i,m,g);return v.dispose(),null!=p&&this.addLoss(function(){return p.apply(y.read())}),null==m&&(m=!0),m?this._trainableWeights.push(y):this._nonTrainableWeights.push(y),y},o.prototype.setFastWeightInitDuringBuild=function(i){this.fastWeightInitDuringBuild=i},o.prototype.addLoss=function(i){var a;null==i||Array.isArray(i)&&0===i.length||(i=Zi(i),null!=this._losses&&(a=this.losses).push.apply(a,i))},o.prototype.computeOutputShape=function(i){return i},o.prototype.computeMask=function(i,a){var c=this;if(!this.supportsMasking){if(null!=a){if(!Array.isArray(a))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");a.forEach(function(u){if(null!=u)throw new TypeError("Layer "+c.name+" does not support masking, but was passed an inputMask.")})}return null}return a},o.prototype.addInboundNode=function(i,a,c,u,p,m,g){void 0===g&&(g=null);var v=Zi(i);a=Zi(a),c=Zi(c),u=Zi(u),p=lc(p),m=lc(m);for(var y=[],C=[],S=[],M=0,O=v;M<O.length;M++){var N=O[M];y.push(N.sourceLayer),C.push(N.nodeIndex),S.push(N.tensorIndex)}new Il({outboundLayer:this,inboundLayers:y,nodeIndices:C,tensorIndices:S,inputTensors:v,outputTensors:a,inputMasks:c,outputMasks:u,inputShapes:p,outputShapes:m},g);for(var P=0;P<a.length;P++)a[P].sourceLayer=this,a[P].nodeIndex=this.inboundNodes.length-1,a[P].tensorIndex=P},o.prototype.getConfig=function(){var i={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(i.batchInputShape=this.batchInputShape),null!=this.dtype&&(i.dtype=this.dtype),i},o.prototype.disposeWeights=function(){return this.weights.forEach(function(i){return i.dispose()}),this.weights.length},o.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '"+this.name+"' is already disposed.")},o.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var i=0;return 0==--this._refCount&&(i=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:i}},o}(bt.Serializable);function wd(s,o,i){if((null==o||null!=i&&i>0)&&(o=s.sourceLayer,i=s.nodeIndex),0===o.inboundNodes.length)return[s];var a=o.inboundNodes[i];if(0===a.inboundLayers.length)return a.inputTensors;for(var c=[],u=0;u<a.inboundLayers.length;u++)for(var p=0,m=wd(a.inputTensors[u],a.inboundLayers[u],a.nodeIndices[u]);p<m.length;p++){var g=m[p];-1===c.indexOf(g)&&c.push(g)}return c}var Cd,Xs=function(s){function o(i){var a=s.call(this,{dtype:i.dtype,name:null!=i.name?i.name:Ks("input").toString()})||this;if(null==i.batchSize&&(i.batchSize=null),null==i.sparse&&(i.sparse=!1),a.trainable=!1,a.built=!0,a.sparse=i.sparse,null!=i.inputShape&&null!=i.batchInputShape)throw new Ne("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var c=i.batchInputShape;if(null==c){if(null==i.inputShape)throw new Ne("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");c=[i.batchSize].concat(i.inputShape)}else if(null!=i.batchSize)throw new Ne("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var u=i.dtype||"float32";a.batchInputShape=c,a.dtype=u,a.inputSpec=[{shape:c}];var p=new Er(a.dtype,a.batchInputShape,a,[],{},a.name);return p.nodeIndex=0,p.tensorIndex=0,new Il({outboundLayer:a,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[p],outputTensors:[p],inputMasks:[null],outputMasks:[null],inputShapes:[c],outputShapes:[c]}),a}return ft(o,s),o.prototype.apply=function(i,a){throw new Ne("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},o.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},o.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},o.className="InputLayer",o}(ii);function Sd(s){if(null==s.batchShape&&null==s.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=s.batchShape&&null!=s.shape)throw new Ne("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var o=s.batchShape;null!=s.shape&&null==o&&(o=[null].concat(s.shape));var i=s.dtype;return null==i&&(i="float32"),new Xs({batchInputShape:o,name:s.name,dtype:i,sparse:s.sparse}).inboundNodes[0].outputTensors[0]}function Al(s){return nn(this,void 0,void 0,function(){var o,i,a,c,u,p,m,g;return Rn(this,function(v){switch(v.label){case 0:if(null==s)return[2];for(c in o=[],i=[],a=[],s)"number"!=typeof(u=s[c])&&(o.push((p=u).data()),i.push(c),a.push(p));return o.length>0?[4,Promise.all(o)]:[3,2];case 1:for(m=v.sent(),g=0;g<m.length;++g)s[i[g]]=m[g][0];Kn(a),v.label=2;case 2:return[2]}})})}function Ub(s){if(null!=s)for(var o in s){var i=s[o];"number"!=typeof i&&i.dispose()}}bt.registerClass(Xs),function(s){s[s.SILENT=0]="SILENT",s[s.VERBOSE=1]="VERBOSE"}(Cd||(Cd={}));var Dd=function(){function s(){this.validationData=null}return s.prototype.setParams=function(o){this.params=o},s.prototype.onEpochBegin=function(o,i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return[2]})})},s.prototype.onEpochEnd=function(o,i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return[2]})})},s.prototype.onBatchBegin=function(o,i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return[2]})})},s.prototype.onBatchEnd=function(o,i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return[2]})})},s.prototype.onTrainBegin=function(o){return nn(this,void 0,void 0,function(){return Rn(this,function(i){return[2]})})},s.prototype.onTrainEnd=function(o){return nn(this,void 0,void 0,function(){return Rn(this,function(i){return[2]})})},s.prototype.setModel=function(o){},s}(),Hb=function(){function s(o,i){void 0===i&&(i=10),null==o&&(o=[]),this.callbacks=o,this.queueLength=i}return s.prototype.append=function(o){this.callbacks.push(o)},s.prototype.setParams=function(o){for(var i=0,a=this.callbacks;i<a.length;i++)a[i].setParams(o)},s.prototype.setModel=function(o){for(var i=0,a=this.callbacks;i<a.length;i++)a[i].setModel(o)},s.prototype.onEpochBegin=function(o,i){return nn(this,void 0,void 0,function(){var a,c;return Rn(this,function(u){switch(u.label){case 0:null==i&&(i={}),a=0,c=this.callbacks,u.label=1;case 1:return a<c.length?[4,c[a].onEpochBegin(o,i)]:[3,4];case 2:u.sent(),u.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},s.prototype.onEpochEnd=function(o,i){return nn(this,void 0,void 0,function(){var a,c;return Rn(this,function(u){switch(u.label){case 0:null==i&&(i={}),a=0,c=this.callbacks,u.label=1;case 1:return a<c.length?[4,c[a].onEpochEnd(o,i)]:[3,4];case 2:u.sent(),u.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},s.prototype.onBatchBegin=function(o,i){return nn(this,void 0,void 0,function(){var a,c;return Rn(this,function(u){switch(u.label){case 0:null==i&&(i={}),a=0,c=this.callbacks,u.label=1;case 1:return a<c.length?[4,c[a].onBatchBegin(o,i)]:[3,4];case 2:u.sent(),u.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},s.prototype.onBatchEnd=function(o,i){return nn(this,void 0,void 0,function(){var a,c;return Rn(this,function(u){switch(u.label){case 0:null==i&&(i={}),a=0,c=this.callbacks,u.label=1;case 1:return a<c.length?[4,c[a].onBatchEnd(o,i)]:[3,4];case 2:u.sent(),u.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},s.prototype.onTrainBegin=function(o){return nn(this,void 0,void 0,function(){var i,a;return Rn(this,function(c){switch(c.label){case 0:null==o&&(o={}),i=0,a=this.callbacks,c.label=1;case 1:return i<a.length?[4,a[i].onTrainBegin(o)]:[3,4];case 2:c.sent(),c.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},s.prototype.onTrainEnd=function(o){return nn(this,void 0,void 0,function(){var i,a;return Rn(this,function(c){switch(c.label){case 0:null==o&&(o={}),i=0,a=this.callbacks,c.label=1;case 1:return i<a.length?[4,a[i].onTrainEnd(o)]:[3,4];case 2:c.sent(),c.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},s}(),I1=function(s){function o(){return s.call(this)||this}return ft(o,s),o.prototype.onEpochBegin=function(i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return this.seen=0,this.totals={},[2]})})},o.prototype.onBatchEnd=function(i,a){return nn(this,void 0,void 0,function(){var c,u,p,m,g=this;return Rn(this,function(v){for(m in null==a&&(a={}),this.seen+=c=null==a.size?0:a.size,u=function(y){var C=a[y];if("number"==typeof C)p.totals.hasOwnProperty(y)||(p.totals[y]=0),p.totals[y]=p.totals[y]+C*c;else{var S=void 0;y in p.totals?S=p.totals[y]:p.totals[y]=0;var M=$e(function(){return ai(g.totals[y],Vn(C,c))});p.totals[y]=M,S?.dispose()}},p=this,a)u(m);return[2]})})},o.prototype.onEpochEnd=function(i,a){return nn(this,void 0,void 0,function(){var c,u,p,m,v=this;return Rn(this,function(y){if(null!=a)for(c=function(C){if(null==u.totals[C])return"continue";"number"==typeof u.totals[C]?a[C]=u.totals[C]/u.seen:$e(function(){var S=Vn(bo(1,v.seen),v.totals[C]);a[C]=S,v.totals[C].dispose(),Ka(a[C])})},u=this,p=0,m=this.params.metrics;p<m.length;p++)c(m[p]);return[2]})})},o}(Dd),jb=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.onTrainBegin=function(i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return this.epoch=[],this.history={},[2]})})},o.prototype.onEpochEnd=function(i,a){return nn(this,void 0,void 0,function(){var c;return Rn(this,function(u){for(c in null==a&&(a={}),this.epoch.push(i),a)null==this.history[c]&&(this.history[c]=[]),this.history[c].push(a[c]);return[2]})})},o.prototype.syncData=function(){return nn(this,void 0,void 0,function(){var i,a,c,u,p,m,v,y;return Rn(this,function(C){switch(C.label){case 0:for(u in i=[],a=[],c=[],this.history)for(p=this.history[u],m=0;m<p.length;++m)"number"!=typeof p[m]&&(i.push(p[m].data()),a.push(u),c.push(m));return[4,Promise.all(i)];case 1:for(v=C.sent(),y=0;y<v.length;++y)this.history[a[y]][c[y]].dispose(),this.history[a[y]][c[y]]=v[y][0];return[2]}})})},o}(Dd),Wb=function(s){function o(i,a){var c=s.call(this)||this;if(c.currentEpoch=0,c.yieldEvery=a||"auto","auto"===c.yieldEvery&&(c.yieldEvery=125),"never"===c.yieldEvery&&null!=i.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return qe.isNumber(c.yieldEvery)&&(c.maybeWait=function bb(s,o){var i,a=qe.now();return function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var p=qe.now();return p-a<o?i:(a=p,i=s.apply(void 0,c))}}(c.maybeWait.bind(c),c.yieldEvery)),c.trainBegin=i.onTrainBegin,c.trainEnd=i.onTrainEnd,c.epochBegin=i.onEpochBegin,c.epochEnd=i.onEpochEnd,c.batchBegin=i.onBatchBegin,c.batchEnd=i.onBatchEnd,c.yield=i.onYield,c}return ft(o,s),o.prototype.maybeWait=function(i,a,c){return nn(this,void 0,void 0,function(){var u;return Rn(this,function(p){switch(p.label){case 0:return u=[],null==this.yield?[3,2]:[4,Al(c)];case 1:p.sent(),u.push(this.yield(i,a,c)),p.label=2;case 2:return u.push(sg()),[4,Promise.all(u)];case 3:return p.sent(),[2]}})})},o.prototype.onEpochBegin=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){switch(c.label){case 0:return this.currentEpoch=i,null==this.epochBegin?[3,3]:[4,Al(a)];case 1:return c.sent(),[4,this.epochBegin(i,a)];case 2:c.sent(),c.label=3;case 3:return[2]}})})},o.prototype.onEpochEnd=function(i,a){return nn(this,void 0,void 0,function(){var c;return Rn(this,function(u){switch(u.label){case 0:return c=[],null==this.epochEnd?[3,2]:[4,Al(a)];case 1:u.sent(),c.push(this.epochEnd(i,a)),u.label=2;case 2:return"epoch"===this.yieldEvery&&c.push(sg()),[4,Promise.all(c)];case 3:return u.sent(),[2]}})})},o.prototype.onBatchBegin=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){switch(c.label){case 0:return null==this.batchBegin?[3,3]:[4,Al(a)];case 1:return c.sent(),[4,this.batchBegin(i,a)];case 2:c.sent(),c.label=3;case 3:return[2]}})})},o.prototype.onBatchEnd=function(i,a){return nn(this,void 0,void 0,function(){var c;return Rn(this,function(u){switch(u.label){case 0:return c=[],null==this.batchEnd?[3,2]:[4,Al(a)];case 1:u.sent(),c.push(this.batchEnd(i,a)),u.label=2;case 2:return"batch"===this.yieldEvery?c.push(sg()):qe.isNumber(this.yieldEvery)&&c.push(this.maybeWait(this.currentEpoch,i,a)),[4,Promise.all(c)];case 3:return u.sent(),[2]}})})},o.prototype.onTrainBegin=function(i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){switch(a.label){case 0:return null==this.trainBegin?[3,3]:[4,Al(i)];case 1:return a.sent(),[4,this.trainBegin(i)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},o.prototype.onTrainEnd=function(i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){switch(a.label){case 0:return null==this.trainEnd?[3,3]:[4,Al(i)];case 1:return a.sent(),[4,this.trainEnd(i)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},o}(Dd);function Gb(s,o){return null==s&&(s={}),s instanceof Dd?[s]:Array.isArray(s)&&s[0]instanceof Dd?s:Zi(s).map(function(i){return new Wb(i,o)})}var A1=function(){function s(){}return s.registerCallbackConstructor=function(o,i){qe.assert(o>=0&&Number.isInteger(o),function(){return"Verbosity level is expected to be an integer >= 0, but got "+o}),s.checkForDuplicate(i),null==s.constructors[o]&&(s.constructors[o]=[]),s.constructors[o].push(i)},s.checkForDuplicate=function(o){for(var i in s.constructors)s.constructors[+i].forEach(function(a){if(a===o)throw new Ne("Duplicate callback constructor.")})},s.clear=function(){s.constructors={}},s.createCallbacks=function(o){var i=[];for(var a in s.constructors){var c=+a;o>=c&&i.push.apply(i,s.constructors[c])}return i.map(function(u){return new u})},s.constructors={},s}();function R1(s,o,i,a,c,u,p,m,g){var v=new jb,y=[new I1].concat(A1.createCallbacks(o));null!=s&&y.push.apply(y,s),y.push(v);var C=new Hb(y);return C.setParams({epochs:i,initialEpoch:a,samples:c,steps:u,batchSize:p,verbose:o,doValidation:m,metrics:g}),{callbackList:C,history:v}}function Bt(s,o,i){return void 0===o&&(o={}),void 0===i&&(i=!1),kp(s,bt.SerializationMap.getMap().classNameMap,o,"layer",i)}function vg(s,o){return $e(function(){"float32"!==s.dtype&&(s=s.asType("float32"));var i=wa(Ap(s),o,!0),a=ml(i.shape,Sr()),c=Eu(zs(i,a));return bo(s,c)})}function Gr(s,o){return $e(function(){return Or(Ap(jr(o,s)),-1)})}function Dt(s,o){return $e(function(){return Or(Gl(jr(o,s)),-1)})}function cc(s,o){return $e(function(){var i=jr(s,o),a=Zo(Gl(s),Sr(),Number.MAX_VALUE),c=Gl(bo(i,a));return Vn(100,Or(c,-1))})}function $r(s,o,i){return void 0===i&&(i=!1),$e(function(){if(i)o=du(o);else{var a=wa(o,o.shape.length-1,!0);o=bo(o,a)}return o=Zo(o,Sr(),1-Sr()),Zc(wa(Vn(s.toFloat(),ql(o)),o.shape.length-1))})}function to(s,o){return $e(function(){var i=sp(function _M(s){var o=[kl(s.shape)];return s.reshape(o)}(s)).toInt(),a=(o=Zo(o,Sr(),1-Sr())).shape;return $r(Ul(i,a[a.length-1]).reshape(a),o,!1)})}function Zs(s,o){return $e(function(){var i;return i=Zo(o,Sr(),1-Sr()),i=ql(bo(i,jr(1,i))),Or(function os(s,o){if(!qe.arraysEqual(s.shape,o.shape))throw new Ne("logits and labels must have the same shape, but got shapes "+JSON.stringify(s.shape)+" and "+JSON.stringify(o.shape));return $e(function(){var i=o.relu(),a=o.abs().neg();return i.sub(o.mul(s)).add(a.exp().log1p())})}(s,i),-1)})}function Lp(s,o){return $e(function(){var i=vg(s,-1),a=vg(o,-1),c=Vn(i,a);return Zc(wa(c,-1))})}var bn={meanSquaredError:Gr,meanAbsoluteError:Dt,meanAbsolutePercentageError:cc,meanSquaredLogarithmicError:function FM(s,o){return $e(function(){var i=Zo(o,Sr(),Number.MAX_VALUE),a=ql(ai(1,i)),c=Zo(s,Sr(),Number.MAX_VALUE),u=ql(ai(1,c));return Or(Ap(jr(a,u)),-1)})},squaredHinge:function ct(s,o){return $e(function(){var i=zs(0,jr(1,Vn(s,o)));return Or(Ap(i),-1)})},hinge:function dt(s,o){return $e(function(){var i=zs(0,jr(1,Vn(s,o)));return Or(i,-1)})},categoricalHinge:function yn(s,o){return $e(function(){var i=wa(Vn(s,o),-1),a=xa(Vn(jr(1,s),o),-1);return zs(0,ai(1,jr(a,i)))})},logcosh:function OM(s,o){return $e(function(){var i=Math.log(2),a=jr(o,s),c=jr(ai(a,dp(Vn(-2,a))),i);return Or(c,-1)})},categoricalCrossentropy:$r,sparseCategoricalCrossentropy:to,binaryCrossentropy:Zs,kullbackLeiblerDivergence:function Pp(s,o){return $e(function(){var i=Zo(s,Sr(),1),a=Zo(o,Sr(),1);return wa(Vn(s,ql(bo(i,a))),-1)})},poisson:function F1(s,o){return $e(function(){var i=ql(ai(Sr(),o));return Or(jr(o,Vn(s,i)),-1)})},cosineProximity:Lp};function Bp(s){if("string"==typeof s){if(s in bn)return bn[s];var o="Unknown loss "+s;throw s.toLowerCase().includes("softmaxcrossentropy")&&(o="Unknown loss "+s+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Ne(o)}return s}function $b(s,o){return $e(function(){var i=Vn(.5,ua(o)),a=Tp(Tu(o,i),s.dtype);return Or(Jc(s,a),-1)})}function bg(s,o){return $e(function(){return Tp(Jc(Fu(s,-1),Fu(o,-1)),"float32")})}function qb(s,o){return $e(function(){return fs(s.equal(1),o.equal(1)).sum().cast("float32")})}function N1(s,o){return $e(function(){var i=qb(s,o),a=function qn(s,o){return $e(function(){return fs(s.equal(0),o.equal(1)).sum().cast("float32")})}(s,o),c=i.add(a);return Na(Tu(c,0),i.div(c),0).cast("float32")})}function Sn(s,o){return Zs(s,o)}function yg(s,o){return s.rank===o.rank&&(s=s.squeeze([s.rank-1])),(o=o.argMax(-1)).dtype!==s.dtype&&(o=o.asType(s.dtype)),Jc(s,o).asType("float32")}var xg=$r,Kb=to,Ed={binaryAccuracy:$b,categoricalAccuracy:bg,precision:N1,categoricalCrossentropy:xg,sparseCategoricalCrossentropy:Kb,mse:Gr,MSE:Gr,mae:Dt,MAE:Dt,mape:cc,MAPE:cc,cosine:Lp};function wg(s){if(Gs(null!==s,"Unknown LossOrMetricFn "+s),"string"==typeof s)return s;for(var o=void 0,i=0,a=Object.keys(bn);i<a.length;i++){var c=a[i];if(bn[c]===s){o=c;break}}if(void 0!==o)return o;for(var u=0,p=Object.keys(Ed);u<p.length;u++)if(Ed[c=p[u]]===s){o=c;break}return void 0!==o?o:s.name}function uc(s,o,i){if(void 0===i&&(i=!1),null==s||"object"!=typeof s||Object.getPrototypeOf(s)!==Object.prototype||!zp(s))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(i){var a=JSON.stringify(s);a.length>1048576&&console.warn('User-defined metadata of model "'+o+'" is too large in size (length='+a.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function zp(s){if(null===s)return!0;if("object"==typeof s){if(Object.getPrototypeOf(s)===Object.prototype){for(var o=0,i=Object.keys(s);o<i.length;o++){var a=i[o];if("string"!=typeof a||!zp(s[a]))return!1}return!0}if(Array.isArray(s)){for(var c=0,u=s;c<u.length;c++)if(!zp(u[c]))return!1;return!0}return!1}var p=typeof s;return"string"===p||"number"===p||"boolean"===p}function Zb(s,o,i){void 0===i&&(i=console.log);for(var a="",c=0;c<s.length;++c)c>0&&(a=a.slice(0,a.length-1)+" "),a=(a+=s[c]).slice(0,o[c]),a+=" ".repeat(o[c]-a.length);i(a)}function LM(s,o,i){var a;try{a=JSON.stringify(s.outputShape)}catch{a="multiple"}Zb([s.name+" ("+s.getClassName()+")",a,s.countParams().toString()],o,i)}function BM(s,o,i,a){var c;try{c=JSON.stringify(s.outputShape)}catch{c="multiple"}for(var u=[],p=0,m=s.inboundNodes;p<m.length;p++){var g=m[p];if(!(null!=i&&i.length>0&&-1===i.indexOf(g)))for(var v=0;v<g.inboundLayers.length;++v)u.push(g.inboundLayers[v].name+"["+g.nodeIndices[v]+"]["+g.tensorIndices[v]+"]")}var M=s.name,O=s.getClassName(),N=0===u.length?"":u[0];for(Zb([M+" ("+O+")",c,s.countParams().toString(),N],o,a),v=1;v<u.length;++v)Zb(["","","",u[v]],o,a)}function Qb(s,o,i){return("inboundNodes"===s||"outputLayers"===s||"inputLayers"===s)&&0===o&&"string"==typeof i}function Vp(s,o){if(null===s)return null;if("string"==typeof s)return md(s);if("number"==typeof s||"boolean"==typeof s)return s;if(s instanceof Array){for(var i=[],a=s.length,c=0;c<a;++c){var u=s[c];Qb(o,c,u)?i.push(u):i.push(Vp(u,o))}return i}for(var p={},m=0,g=Object.keys(s);m<g.length;m++){var v=g[m],y=s[v];if("name"===v&&"string"==typeof y)p[v]=y;else{var C=md(v);p[C]=Vp(y,C)}}return p}function Pr(s,o){if(null==s)return null;if("string"==typeof s)return ns(s);if("number"==typeof s||"boolean"==typeof s)return s;if(s instanceof Array){for(var i=[],a=s.length,c=0;c<a;++c){var u=s[c];Qb(o,c,u)?i.push(u):i.push(Pr(u,o))}return i}for(var p={},m=0,g=Object.keys(s);m<g.length;m++){var v=g[m],y=s[v];p[ns(v)]="name"!==v&&"className"!==v||"string"!=typeof y?Pr(y,v):y}return p}var Up="1.3.1",Xu=function(){function s(o){if(this.id2Value={},this.id2Mask={},this.name2Id={},o instanceof s)for(var i in o.id2Value)this.id2Value[i]=o.id2Value[i],i in o.id2Mask&&(this.id2Mask[i]=o.id2Mask[i]);else{if(null==o)return;for(var a=0,c=o;a<c.length;a++){var u=c[a];this.add(u.key,u.value)}}}return s.prototype.add=function(o,i,a){if(null!=this.id2Value[o.id])throw new Ne("Duplicate key: name="+o.name+", id="+o.id);return this.id2Value[o.id]=function zM(s,o){if(null==s.dtype||s.dtype===o.dtype)return o;try{return Ns(o,s.dtype)}catch{throw new Ne("The dtype of the feed ("+o.dtype+") can not be cast to the dtype of the key '"+s.name+"' ("+s.dtype+").")}}(o,i),this.name2Id[o.name]=o.id,null!=a&&(this.id2Mask[o.id]=a),this},s.prototype.addFeed=function(o){this.add(o.key,o.value)},s.prototype.hasKey=function(o){return null!=this.id2Value[o.id]},s.prototype.names=function(){return Object.keys(this.name2Id)},s.prototype.getValue=function(o){if(o instanceof Er){if(null==this.id2Value[o.id])throw new Ne("Nonexistent key: "+o.name);return this.id2Value[o.id]}var i=this.name2Id[o];if(null==i)throw new Ne("Feed dict has no SymbolicTensor name: "+o);return this.id2Value[i]},s.prototype.getMask=function(o){if(o instanceof Er){if(null==this.id2Value[o.id])throw new Ne("Nonexistent key: "+o.name);return this.id2Mask[o.id]}var i=this.name2Id[o];if(null==i)throw new Ne("Feed dict has no SymbolicTensor name: "+o);return this.id2Mask[i]},s.prototype.disposeMasks=function(){null!=this.id2Mask&&Kn(this.id2Mask)},s}(),Sg={},H1={};function Zu(s,o,i,a){for(var c=null!=i&&i.training,u=Array.isArray(s),p=u?s:[s],m=p.map(function(yt){return yt.name}),g=[],v=o.names(),y=0,C=m;y<C.length;y++){var S=C[y];-1!==v.indexOf(S)?g.push(o.getValue(S)):g.push(null)}null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);var M,O,N=m.join(",")+"|"+o.names().join(",");if(null==Sg[N]){var P=function j1(s,o){qe.assert(null!=s&&s.length>0,function(){return"Expected at least one fetch, got none"});var i=[],a={};if(1===s.length){var c=W1(s[0],o);i=c.sorted,a=c.recipientMap}else for(var u=new Set,p=0,m=s;p<m.length;p++){for(var g=W1(m[p],o),y=g.recipientMap,C=0,S=g.sorted;C<S.length;C++){var M=S[C];u.has(M.name)||(i.push(M),u.add(M.name))}var O=function(P){null==a[P]&&(a[P]=new Set),y[P].forEach(function(B){return a[P].add(B)})};for(var N in y)O(N)}return{sorted:i,recipientCounts:Qu(a)}}(p,o);O=P.recipientCounts,Sg[N]=M=P.sorted,H1[N]=O}M=Sg[N],O={},c||Object.assign(O,H1[N]);for(var B=new Xu(o),W=0;W<M.length;++W){if(null!=a){var G=fl().numTensors;G>a.maxNumTensors&&(a.maxNumTensors=G),G<a.minNumTensors&&(a.minNumTensors=G)}var X=M[W],Q=X.sourceLayer;if(!(Q instanceof Xs)){for(var se=[],ue=[],fe=[],_e=!1,me=0,Me=X.inputs;me<Me.length;me++){var Te=Me[me],Ue=B.getValue(Te),Xe=B.getMask(Te);se.push(Ue),ue.push(Xe),null!=Xe&&(_e=!0),c||(O[Te.name]--,0!==O[Te.name]||o.hasKey(Te)||-1!==m.indexOf(Te.name)||Ue.isDisposed||!0===Te.sourceLayer.stateful||fe.push(Ue))}_e&&((i=i||{}).mask=ue[0]);var et=Zi(Q.apply(se,i)),it=null;Q.supportsMasking&&(it=Q.computeMask(se,ue));for(var nt=VM(X),je=Array.isArray(nt)?nt:[nt],ut=0;ut<je.length;++ut){B.hasKey(je[ut])||B.add(je[ut],et[ut],Array.isArray(it)?it[0]:it);var at=m.indexOf(je[ut].name);-1!==at&&(g[at]=et[ut])}c||Kn(fe)}}return B.disposeMasks(),u?g:g[0]}function Qu(s){var o={};for(var i in s)o[i]=s[i].size;return o}function W1(s,o){for(var i=new Set,a=[],c={},u=0,p=o.names();u<p.length;u++)i.add(p[u]);var g=[],v=[];for(g.push(s);g.length>0;){var y=g[g.length-1];if(i.has(y.name))g.pop();else{var C=v[v.length-1]===g.length-1;if(0===y.inputs.length||C)g.pop(),a.push(y),i.add(y.name),C&&v.pop();else{v.push(g.length-1);for(var S=0,M=y.inputs;S<M.length;S++){var O=M[S];null==c[O.name]&&(c[O.name]=new Set),c[O.name].add(y.name),i.has(O.name)||g.push(O)}}}}return{sorted:a,recipientMap:c}}function VM(s){var o;if(1===s.sourceLayer.inboundNodes.length)o=s.sourceLayer.output;else{for(var i=null,a=0;a<s.sourceLayer.inboundNodes.length;++a)for(var c=0,u=s.sourceLayer.inboundNodes[a].outputTensors;c<u.length;c++)if(u[c].id===s.id){i=a;break}o=s.sourceLayer.getOutputAt(i)}return o}var G1=function(s){function o(i){var a=s.call(this,{})||this;if(a.containerNodes=new Set,a.name=i.name,null==a.name){var c=a.getClassName().toLowerCase();a.name=Ks(c)}if(a.supportsMasking=!1,a.trainable_=!0,a.inputs=Array.isArray(i.inputs)?i.inputs.slice():[i.inputs],a.outputs=Array.isArray(i.outputs)?i.outputs.slice():[i.outputs],El(a.inputs).length!==a.inputs.length)throw new Ne("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+a.inputs.map(function(ui){return ui.name}));El(a.outputs).length!==a.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+a.outputs.map(function(ui){return ui.name})),a.inputLayers=[],a.inputLayersNodeIndices=[],a.inputLayersTensorIndices=[],a.outputLayers=[],a.outputLayersNodeIndices=[],a.outputLayersTensorIndices=[],a.layers=[],a.internalContainerRefs=[];for(var u=0,p=a.outputs;u<p.length;u++){var m=(me=p[u]).sourceLayer,g=me.nodeIndex,v=me.tensorIndex;a.outputLayers.push(m),a.outputLayersNodeIndices.push(g),a.outputLayersTensorIndices.push(v)}for(var y=0,C=a.inputs;y<C.length;y++)m=(me=C[y]).sourceLayer,v=me.tensorIndex,Gs(0===(g=me.nodeIndex),"input layer has >1 nodes"),Gs(0===v,"input layer has >1 tensors"),a.inputLayers.push(m),a.inputLayersNodeIndices.push(g),a.inputLayersTensorIndices.push(v);a.inputNames=[],a.outputNames=[],a.feedInputShapes=[],a.feedInputNames=[],a.feedOutputNames=[];for(var S=0;S<a.inputLayers.length;S++){if(!((m=a.inputLayers[S])instanceof Xs))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+i.inputs+". Input "+S+" (0-based) originates from layer type "+m.getClassName()+".");a.inputNames.push(m.name),a.feedInputShapes.push(m.batchInputShape),a.feedInputNames.push(m.name)}for(var M=0,O=a.outputLayers;M<O.length;M++)a.outputNames.push((m=O[M]).name);a.internalInputShapes=a.inputs.map(function(ui){return ui.shape}),a.internalOutputShapes=a.outputs.map(function(ui){return ui.shape});for(var N={},P={},B={},W={},G={},X=[],Q=function(ui,rr,mi,bi,Ln,ji){null!=bi&&null!=Ln&&null!=ji||(bi=ui.sourceLayer,Ln=ui.nodeIndex,ji=ui.tensorIndex);var rn=bi.inboundNodes[Ln];if(-1!==mi.indexOf(rn))throw new Dl("The tensor "+ui.name+' at layer "'+bi.name+'" is part of a cycle.');if(-1===rr.indexOf(rn)){a.containerNodes.add(o.nodeKey(bi,Ln)),bi.id in G||(G[bi.id]=Object.keys(G).length),-1===mi.indexOf(rn)&&mi.push(rn);for(var mh=rn.inboundLayers.length,nl=0;nl<mh;nl++)Q(rn.inputTensors[nl],rr,mi,rn.inboundLayers[nl],rn.nodeIndices[nl],rn.tensorIndices[nl]);for(rr.push(rn);mi.indexOf(rn)>=0;)mi.splice(mi.indexOf(rn),1);X.push(rn)}},se=[],ue=[],fe=0,_e=a.outputs;fe<_e.length;fe++){var me=_e[fe];Q(me,se,ue)}for(var Me=0,Te=X.slice().reverse();Me<Te.length;Me++){P[(Gn=Te[Me]).id]=Gn,Gn.id in N||(N[Gn.id]=0);var Ue=N[Gn.id];for(Ue=Math.max(Ue,null==B[Gn.outboundLayer.id]?0:B[Gn.outboundLayer.id]),B[Gn.outboundLayer.id]=Ue,W[Gn.outboundLayer.id]=Gn.outboundLayer,N[Gn.id]=Ue,S=0;S<Gn.inboundLayers.length;S++){var it=Gn.inboundLayers[S].inboundNodes[g=Gn.nodeIndices[S]];N[it.id]=Math.max(Ue+1,null==N[it.id]?0:N[it.id]),P[it.id]=it}}var je={};for(var ut in N)(Ue=N[ut])in je||(je[Ue]=[]),je[Ue].push(P[ut]);var at={};for(var yt in B)(Ue=B[yt])in at||(at[Ue]=[]),at[Ue].push(W[yt]);var Gt=Object.keys(at).map(function(ui){return parseInt(ui,10)}).sort(cg);a.layers=[];for(var Xt=0,Mt=Gt;Xt<Mt.length;Xt++){var Tn=at[Ue=Mt[Xt]];Tn.sort(function(ui,rr){var mi=G[ui.id],bi=G[rr.id];return mi<bi?-1:mi>bi?1:0});for(var Hn=0,si=Tn;Hn<si.length;Hn++)(m=si[Hn])instanceof o&&a.internalContainerRefs.push(m),a.layers.push(m)}a.layersByDepth=at,Gt=Object.keys(je).map(function(ui){return parseInt(ui,10)}).sort(cg);for(var li=a.inputs.slice(),ci=[],hr=0,di=Gt;hr<di.length;hr++)for(var Ui=0,Jn=je[Ue=di[hr]];Ui<Jn.length;Ui++){var Gn;if(null!=(m=(Gn=Jn[Ui]).outboundLayer)){for(var Ji=0,Hi=Gn.inputTensors;Ji<Hi.length;Ji++)if(-1===li.indexOf(me=Hi[Ji]))throw new Dl("Graph disconnected: cannot obtain value for tensor "+me+' at layer "'+m.name+'". The following previous layers were accessed without issue: '+ci);for(var ra=0,oa=Gn.outputTensors;ra<oa.length;ra++)li.push(me=oa[ra]);ci.push(m.name)}}a.nodesByDepth=je;for(var aa=a.layers.map(function(ui){return ui.name}),Wa=function(ui){var rr=aa.filter(function(mi){return mi===ui}).length;if(1!==rr)throw new Dl('The name "'+ui+'" is used '+rr+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(aa))},Co=0,ss=aa;Co<ss.length;Co++)Wa(ss[Co]);return a.outboundNodes=[],a.inboundNodes=[],new Il({outboundLayer:a,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:a.inputs,outputTensors:a.outputs,inputMasks:a.inputs.map(function(ui){return null}),outputMasks:a.outputs.map(function(ui){return null}),inputShapes:a.inputs.map(function(ui){return ui.shape}),outputShapes:a.outputs.map(function(ui){return ui.shape})}),a.built=!0,a._refCount=1,a}return ft(o,s),o.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '"+this.name+"' is already disposed.")},o.prototype.dispose=function(){this.assertNotDisposed();var i={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(var a=0,c=this.layers;a<c.length;a++)i.numDisposedVariables+=c[a].dispose().numDisposedVariables;for(var p=0,m=this.internalContainerRefs;p<m.length;p++)i.numDisposedVariables+=m[p].dispose().numDisposedVariables}return i.refCountAfterDispose=this._refCount,i},Object.defineProperty(o.prototype,"trainable",{get:function(){return this.trainable_},set:function(i){this.layers.forEach(function(a){a._trainableWeights.forEach(function(c){return c.trainable=i})}),this.trainable_=i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new Ne("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var i=[],a=0,c=this.layers;a<c.length;a++)i=i.concat(c[a].trainableWeights);return i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nonTrainableWeights",{get:function(){for(var i=[],a=0,c=this.layers;a<c.length;a++){var u=c[a];i.push.apply(i,u.nonTrainableWeights)}if(!this.trainable){for(var p=[],m=0,g=this.layers;m<g.length;m++)p.push.apply(p,(u=g[m]).trainableWeights);return p.concat(i)}return i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),o.prototype.loadWeights=function(i,a){void 0===a&&(a=!0);for(var c={},u=0,p=0,m=this.layers;p<m.length;p++)for(var g=0,v=m[p].weights;g<v.length;g++){var y=v[g];if(null!=c[y.originalName])throw new Ne("Duplicate weight name: "+y.originalName);c[y.originalName]=y,u++}var C=[];for(var S in i){if(null!=c[S])C.push([c[S],i[S]]);else if(a)throw new Ne("Provided weight data has no target variable: "+S);delete c[S]}if(a){var M=[];for(var O in c)M.push(O);if(M.length>0)throw new Ne(M.length+" of "+u+" weights are not set: "+M)}Tl(C)},o.prototype.updatedConfig=function(){var i=this.getConfig(),a={};return a.className=this.getClassName(),a.config=i,a.kerasVersion="tfjs-layers "+Up,a.backend="TensorFlow.js",a},o.prototype.toJSON=function(i,a){void 0===a&&(a=!0);var c=Pr(this.updatedConfig());return a?JSON.stringify(c):c},o.prototype.call=function(i,a){var c=this;return $e(function(){i=Zi(i);for(var u=new Xu,p=0;p<c.inputs.length;++p)u.add(c.inputs[p],i[p]);return Zu(c.outputs,u,a)})},o.prototype.computeMask=function(i,a){var c=this;return $e(function(){var u;return i=Zi(i),u=null==a?Uu(null,i.length):Zi(a),c.runInternalGraph(i,u)[1]})},o.prototype.computeOutputShape=function(i){var a=lc(i);if(a.length!==this.inputLayers.length)throw new Ne("Invalid inputShape argument "+i+": model has "+this.inputLayers.length+" tensor inputs.");for(var c={},u=0;u<a.length;u++){var p=this.inputLayers[u];c[_e=p.name+"_0_0"]=a[u]}var g=Object.keys(this.nodesByDepth).map(function(Me){return parseInt(Me,10)}).sort(cg);if(g.length>1)for(var v=0,y=g;v<y.length;v++)for(var S=0,M=this.nodesByDepth[y[v]];S<M.length;S++){var O=M[S];if(p=O.outboundLayer,-1===this.inputLayers.map(function(Me){return Me.id}).indexOf(p.id)){for(var N=[],P=0;P<O.inboundLayers.length;P++){var G=O.tensorIndices[P],X=c[_e=O.inboundLayers[P].name+"_"+O.nodeIndices[P]+"_"+G];N.push(X)}var Q=lc(p.computeOutputShape(Jo(N))),se=p.inboundNodes.indexOf(O);for(P=0;P<Q.length;P++)c[_e=p.name+"_"+se+"_"+P]=Q[P]}}var ue=[],fe=[];for(u=0;u<this.outputLayers.length;u++){var _e=(p=this.outputLayers[u]).name+"_"+(se=this.outputLayersNodeIndices[u])+"_"+(G=this.outputLayersTensorIndices[u]);fe.push(_e)}for(u=0;u<fe.length;u++){var me=fe[u];Gs(me in c),ue.push(c[me])}return Jo(ue)},o.prototype.runInternalGraph=function(i,a){null==a&&(a=Uu(null,i.length));for(var c={},u=0;u<this.inputs.length;++u){var p=this.inputs[u],m=i[u],g=a[u];c[p.id]=[m,g]}for(var v=0,y=Object.keys(this.nodesByDepth).map(function(at){return parseInt(at,10)}).sort(cg);v<y.length;v++)for(var S=0,M=this.nodesByDepth[y[v]];S<M.length;S++){for(var O=M[S],N=O.outboundLayer,P=O.inputTensors,B=O.outputTensors,W=new Array,G=0,X=P;G<X.length;G++)(p=X[G]).id in c&&W.push(c[p.id]);if(W.length===P.length){var Q={},se=void 0,ue=void 0,fe=void 0,_e=void 0;if(null!=O.callArgs&&(Q=O.callArgs),1===W.length){var me=W[0],Me=me[0],Te=me[1];null==Q.mask&&(Q.mask=Te),fe=Zi(N.call(Me,Q)),_e=Zi(N.computeMask(Me,Te)),se=[Me],ue=[Te]}else se=W.map(function(at){return at[0]}),ue=W.map(function(at){return at[1]}),null==Q.mask&&(Q.mask=ue),fe=Zi(N.call(se,Q)),_e=Zi(N.computeMask(se,ue));if(N.activityRegularizer)throw new ni("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(u=0;u<B.length;++u)c[(p=B[u]).id]=[m=fe[u],g=_e[u]]}}for(var Ue=[],Xe=[],et=[],it=0,nt=this.outputs;it<nt.length;it++){Gs((p=nt[it]).id in c,"Could not compute output "+p.name+" : "+p.id);var je=c[p.id],ut=je[0];g=je[1],et.push(ut.shape),Ue.push(ut),Xe.push(g)}return[Ue,Xe,et]},o.prototype.buildNodeConversionMap=function(i){for(var a,c={},u=0,p=this.layers;u<p.length;u++){var m=p[u];a=m instanceof o?1:0;for(var g=0;g<m.inboundNodes.length;g++){var v=o.nodeKey(m,g);this.containerNodes.has(v)&&(c[v]=a,a+=1)}}return c},o.prototype.getLayer=function(i,a){if(null!=a){if(this.layers.length<=a)throw new Ne("Was asked to retrieve layer at index "+a+", but model only has "+this.layers.length+" layer(s).");return this.layers[a]}if(null==i)throw new Ne("Provide either a layer name or layer index");for(var c=0,u=this.layers;c<u.length;c++){var p=u[c];if(p.name===i)return p}throw new Ne("No such layer: "+i)},o.prototype.calculateLosses=function(){var i=this;return $e(function(){for(var a=[],c=0,u=i.layers;c<u.length;c++)for(var p=u[c],m=0;m<p.inboundNodes.length;++m){var g=o.nodeKey(p,m);i.containerNodes.has(g)&&a.push.apply(a,p.calculateLosses())}return a})},o.prototype.getConfig=function(){for(var i={name:this.name},a=this.buildNodeConversionMap(this.layers),c=[],u=0,p=this.layers;u<p.length;u++){for(var m=(Q=p[u]).getClassName(),g=Q.getConfig(),v=[],y=0;y<Q.inboundNodes.length;y++){var C=Q.inboundNodes[y],S=o.nodeKey(Q,y),M={};if(this.containerNodes.has(S)){if(C.callArgs)try{JSON.stringify(C.callArgs),M=C.callArgs}catch{console.warn("Layer "+Q.name+" was passed non-serializable keyword arguments: "+C.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),M={}}if(C.inboundLayers.length>0){for(var O=[],N=0;N<C.inboundLayers.length;N++){var P=C.inboundLayers[N],B=C.nodeIndices[N],W=C.tensorIndices[N];null==(ue=a[o.nodeKey(P,B)])&&(ue=0),O.push([P.name,ue,W,M])}v.push(O)}}}var G={};G.name=Q.name,G.className=m,G.config=g,G.inboundNodes=v,c.push(G)}i.layers=c;var X=[];for(N=0;N<this.inputLayers.length;N++){var Q=this.inputLayers[N];S=o.nodeKey(Q,B=this.inputLayersNodeIndices[N]),this.containerNodes.has(S)&&(null!==(ue=a[S])&&void 0!==ue||(ue=0),X.push([Q.name,ue,W=this.inputLayersTensorIndices[N]]))}i.inputLayers=X;var se=[];for(N=0;N<this.outputLayers.length;N++)if(S=o.nodeKey(Q=this.outputLayers[N],B=this.outputLayersNodeIndices[N]),this.containerNodes.has(S)){var ue;null!==(ue=a[S])&&void 0!==ue||(ue=0),se.push([Q.name,ue,W=this.outputLayersTensorIndices[N]])}return i.outputLayers=se,i},o.fromConfig=function(i,a,c,u){void 0===c&&(c={}),void 0===u&&(u=!1);var p={},m={};function g(it,nt){it.name in m?m[it.name].push(nt):m[it.name]=[nt]}function v(it,nt){for(var je,ut=[],at=0,yt=nt;at<yt.length;at++){var Gt=yt[at],Xt=Gt[0],Mt=Gt[1],Tn=Gt[2];if(je=null==Gt[3]?{}:Gt[3],!(Xt in p))return void g(it,nt);var Hn=p[Xt];if(Hn.inboundNodes.length<=Mt)return void g(it,nt);ut.push(Hn.inboundNodes[Mt].outputTensors[Tn])}ut.length>0&&it.apply(Jo(ut),je)}function y(it){var nt=it.name,je=Bt(it,null!=a.customObjects?a.customObjects:{});je.setFastWeightInitDuringBuild(u),p[nt]=je,it.inboundNodes.forEach(function(ut){if(!(ut instanceof Array))throw new Ne("Corrupted configuration, expected array for nodeData: "+ut);g(je,ut)})}for(var C=a.name,S=a.layers,M=0,O=S;M<O.length;M++)y(B=O[M]);for(;!hM(m);)for(var N=0,P=S;N<P.length;N++){var B=P[N];if((et=p[B.name]).name in m){var W=m[et.name];delete m[et.name];for(var G=0,X=W;G<X.length;G++)v(et,X[G])}}for(var Q=[],se=[],ue=0,fe=a.inputLayers;ue<fe.length;ue++){var _e=(B=fe[ue])[0],me=B[1],Me=B[2];Gs(_e in p);var Te=(et=p[_e]).inboundNodes[me].outputTensors;Q.push(Te[Me])}for(var Ue=0,Xe=a.outputLayers;Ue<Xe.length;Ue++){var et;_e=(B=Xe[Ue])[0],me=B[1],Me=B[2],Gs(_e in p),Te=(et=p[_e]).inboundNodes[me].outputTensors,se.push(Te[Me])}return new i({inputs:Q,outputs:se,name:C})},Object.defineProperty(o.prototype,"stateful",{get:function(){if(this._stateful)throw new Ne("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var i=0,a=this.layers;i<a.length;i++)if(a[i].stateful)return!0;return!1},enumerable:!0,configurable:!0}),o.prototype.resetStates=function(){var i=this;$e(function(){i.layers.forEach(function(a){a.stateful&&a.resetStates()})})},o}(ii);function Jb(s,o){return function UM(s,o,i){var a=o.length;if(null==s||Array.isArray(s)&&0===s.length)return o.map(function(u){return null});if(1===a)return Array.isArray(s)&&1===s.length?s:"object"==typeof s&&o[0]in s?[s[o[0]]]:[s];if(Array.isArray(s)){if(s.length!==a)throw new Error("Provided "+i+" is an array of "+s.length+" element(s), but the model has "+a+" outputs. Make sure a set of weights is provided for each model output.");return s}if("object"==typeof s&&Object.keys(s).length>0&&"object"==typeof s[Object.keys(s)[0]]){var c=[];return o.forEach(function(u){c.push(u in s?s[u]:null)}),c}throw new Error("The model has multiple ("+a+") outputs, so "+i+" must be either an array with "+a+" elements or an object with "+o+" keys. Provided "+i+" not understood: "+JSON.stringify(s))}(s,o,"classWeight")}function HM(s,o,i,a){return nn(this,void 0,void 0,function(){var c,u,p,m,g;return Rn(this,function(v){switch(v.label){case 0:if(null!=o||null!=a)throw new Error("Support sampleWeight is not implemented yet");return null==i?[3,2]:(c=$e(function(){if(1===s.shape.length)return s.clone();if(2===s.shape.length){if(s.shape[1]>1)return s.argMax(1);if(1===s.shape[1])return s.reshape([s.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+s.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+s.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),m=(p=Array).from,[4,c.data()]);case 1:return u=m.apply(p,[v.sent()]),Kn(c),g=[],u.forEach(function(y){if(null==i[y])throw new Error("classWeight must contain all classes in the training data. The class "+y+" exists in the data but not in classWeight");g.push(i[y])}),[2,Pn(g,"float32")];case 2:return[2,null]}})})}function Qs(s,o){return Vn(s,o)}function ys(s,o){var i,a;a=o.ys,qe.assert(null!=(i=o.xs)&&null!=a,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+o});var u=$1("input",s.inputNames,i),p=$1("output",s.outputNames,a),m=u[0].shape[0];qe.assert(u.length===s.inputs.length,function(){return"LayersModel has "+s.inputs.length+" inputs, but the dataset provides "+u.length+" inputs.  (Expected input keys: "+JSON.stringify(s.inputNames)+")"}),qe.assert(p.length===s.outputs.length,function(){return"LayersModel has "+s.outputs.length+" outputs, but the dataset provides "+p.length+" outputs.  (Expected output keys: "+JSON.stringify(s.outputNames)+")"});var g=function(S){qe.assert(u[S].shape[0]===m,function(){return"Batch size mismatch: input "+s.inputNames[S]+" has "+u[S].shape[0]+"; expected  "+m+" based on input "+s.inputNames[0]+"."})};for(var v in u)g(v);var y=function(S){qe.assert(p[S].shape[0]===m,function(){return"Batch size mismatch: output "+s.outputNames[S]+" has "+p[S].shape[0]+"; expected  "+m+" based on input "+s.inputNames[0]+"."})};for(var C in p)y(C);return{xs:u,ys:p}}function $1(s,o,i){if(i instanceof ki)return[i];if(Array.isArray(i))return qe.assert(i.length===o.length,function(){return"Received an array of "+i.length+" Tensors, but expected "+o.length+" to match the "+s+" keys "+o+"."}),i;for(var a=[],c=0,u=o;c<u.length;c++){var p=u[c];if(null==i[p])throw new Ne("The feature data generated by the dataset lacks the required "+s+" key '"+p+"'.");a.push(i[p])}return a}function Js(s,o,i){return nn(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C,M,O,N,P,B,W,G,X,Q,se,ue,fe,_e,me,Me,Te,Ue,Xe,et,nt,je,ut,at;return Rn(this,function(yt){switch(yt.label){case 0:if(a=null!=i.batchesPerEpoch,qe.assert(null!=s.optimizer,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),qe.assert(null!=i,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),qe.assert(null!=i.epochs&&i.epochs>0&&Number.isInteger(i.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+i.epochs}),qe.assert(!a||i.batchesPerEpoch>0&&Number.isInteger(i.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+i.batchesPerEpoch}),qe.assert(null==i.validationSplit,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),s.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");s.isTraining=!0,yt.label=1;case 1:return yt.trys.push([1,,26,27]),u=void 0,p=void 0,(c=null!=i.validationData)&&(as(i.validationData)?qe.assert(null==i.validationBatches||i.validationBatches>0&&Number.isInteger(i.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+i.validationBatches}):(m=function jM(s){if(3===s.length)throw new ni("Validation with sample weights is not implemented yet.");return{xs:s[0],ys:s[1]}}(i.validationData),u=m.xs,p=m.ys)),g=s.makeTrainFunction(),v=s.getDedupedMetricsNames(),y=c?v.slice().concat(v.map(function(Gt){return"val_"+Gt})):v.slice(),C=Gb(i.callbacks,i.yieldEvery),M=R1(C,null==i.verbose?1:i.verbose,i.epochs,null,null,function xs(s,o){var i=null;return null!=o.batchesPerEpoch?i=o.batchesPerEpoch:Number.isFinite(s.size)&&(i=s.size),i}(o,i),null,c,y),N=M.history,(O=M.callbackList).setModel(s),s.history=N,[4,O.onTrainBegin()];case 2:return yt.sent(),s.stopTraining_=!1,P=null==i.initialEpoch?0:i.initialEpoch,[4,o.iterator()];case 3:B=yt.sent(),yt.label=4;case 4:return P<i.epochs?(W={},[4,O.onEpochBegin(P)]):[3,23];case 5:return yt.sent(),G=0,X=0,a?[3,7]:[4,o.iterator()];case 6:B=yt.sent(),yt.label=7;case 7:return!a||G<i.batchesPerEpoch?[4,B.next()]:[3,21];case 8:return Q=yt.sent(),a&&Q.done?(console.warn("You provided `batchesPerEpoch` as "+i.batchesPerEpoch+", but your dataset iterator ran out of data after "+G+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+i.batchesPerEpoch*i.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):null==Q.value?[3,15]:(se=ys(s,Q.value),ue=se.xs,fe=se.ys,(_e={}).batch=X,_e.size=ue[0].shape[0],[4,O.onBatchBegin(X,_e)]);case 9:if(yt.sent(),me=[],null==i.classWeight)return[3,13];Me=Jb(i.classWeight,s.outputNames),at=0,yt.label=10;case 10:return at<Me.length?(Ue=(Te=me).push,[4,HM(fe[at],null,Me[at])]):[3,13];case 11:Ue.apply(Te,[yt.sent()]),yt.label=12;case 12:return++at,[3,10];case 13:for(Xe=ue.concat(fe).concat(me),et=g(Xe),Kn(Xe),at=0;at<v.length;++at)_e[v[at]]=nt=et[at],Ka(nt);return[4,O.onBatchEnd(X,_e)];case 14:yt.sent(),Ub(_e),X++,G++,yt.label=15;case 15:return(a?G>=i.batchesPerEpoch:Q.done)?c?(je=void 0,as(i.validationData)?(ut=Zi,[4,s.evaluateDataset(i.validationData,{batches:i.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return je=ut.apply(void 0,[yt.sent()]),[3,18];case 17:je=Zi(s.evaluate(u,p,{batchSize:null==i.validationBatchSize?32:i.validationBatchSize,verbose:0})),yt.label=18;case 18:for(at=0;at<s.metricsNames.length;++at)W["val_"+s.metricsNames[at]]=je[at];yt.label=19;case 19:return[3,21];case 20:return s.stopTraining_?[3,21]:[3,7];case 21:return[4,O.onEpochEnd(P,W)];case 22:return yt.sent(),P++,s.stopTraining_?[3,23]:[3,4];case 23:return[4,O.onTrainEnd()];case 24:return yt.sent(),[4,s.history.syncData()];case 25:return yt.sent(),[2,s.history];case 26:return s.isTraining=!1,[7];case 27:return[2]}})})}function as(s){return"function"==typeof s.iterator}function Y1(s,o,i){return nn(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C,S;return Rn(this,function(M){switch(M.label){case 0:if(a=null!=(i=i||{}).batches,c=s.testFunction,u=[],i.verbose>0)throw new ni("Verbose mode is not implemented yet.");return qe.assert(!a||i.batches>0&&Number.isInteger(i.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(i.batches)}),function q1(s){return"function"==typeof s.next}(o)?(m=o,[3,3]):[3,1];case 1:return[4,o.iterator()];case 2:m=M.sent(),M.label=3;case 3:p=m,g=0,v=0,y=function(){var O;return Rn(this,function(N){switch(N.label){case 0:return[4,p.next()];case 1:return O=N.sent(),u=$e(function(){if(O.value){var P=ys(s,O.value),G=P.xs.concat(P.ys),X=$e(function(){return c(G)});if(Kn(G),0===v)for(var Q=0;Q<X.length;++Q)u.push(Nt(0));var se=G[0].shape[0],ue=function(fe){var _e=X[fe],me=u[fe];u[fe]=$e(function(){return ai(u[fe],Vn(se,_e))}),v>0&&Kn(me)};for(Q=0;Q<X.length;++Q)ue(Q);Kn(X),g+=se,++v}return u}),O.done?(a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+i.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},M.label=4;case 4:return!a||v<i.batches?[5,y()]:[3,6];case 5:return"break"===M.sent()?[3,6]:[3,4];case 6:for(C=0;C<u.length;++C)S=u[C],u[C]=bo(u[C],g),Kn(S);return[2,Jo(u)]}})})}function ey(s){qe.assert(s>0&&Number.isInteger(s),function(){return"batchSize is required to be a positive integer, but got "+s})}function Hp(s,o,i){return null==s?[null]:Array.isArray(s)?s.map(function(a){return bd(a,o,i-o)}):bd(s,o,i-o)}function ty(s,o){return $e(function(){return null==s?null:Array.isArray(s)?s.map(function(i){return ty(i,o)}):v1(s,"int32"===o.dtype?o:o.toInt())})}function ny(s,o){for(var i=[],a=0,c=null;a<s;)(c=a+o)>=s&&(c=s),i.push([a,c]),a=c;return i}function iy(s,o,i,a,c,u,p,m,g,v,y,C,S,M,O){return nn(this,void 0,void 0,function(){var N,P,B,W,G,X,Q,se;return Rn(this,function(ue){switch(ue.label){case 0:if(null==c&&(c=32),null==u&&(u=1),null==y&&(y=!0),null==S&&(S=0),N=!1,null!=g&&null!=v&&(N=!0),null!=O&&(N=!0,null==M))throw new Ne("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(P=s.checkNumSamples(i,c,M,"steps_per_epoch"))&&(B=is(0,P)),null==p&&(p=1),W=R1(m,p,u,S,P,M,c,N,C),X=W.history,(G=W.callbackList).setModel(s),s.history=X,[4,G.onTrainBegin()];case 1:ue.sent(),s.stopTraining_=!1,Q=function(fe){var _e,me,Me,Te,Ue;return Rn(this,function(Xe){switch(Xe.label){case 0:return[4,G.onEpochBegin(fe)];case 1:if(Xe.sent(),_e={},null==M)return[3,2];throw new ni("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===y)throw new ni("batch shuffling is not implemneted yet");y&&qe.shuffle(B),me=Pn(B),Me=ny(P,c),Te=function(et){var it;return Rn(this,function(nt){switch(nt.label){case 0:return[4,G.onBatchBegin(et,it={})];case 1:return nt.sent(),$e(function(){var je=Me[et][0],ut=Me[et][1],at=bd(me,je,ut-je);it.batch=et,it.size=ut-je;for(var yt=ty(i,at),Gt=o(yt),Xt=0;Xt<a.length;++Xt){var Mt=a[Xt],Tn=Gt[Xt];it[Mt]=Tn,Ka(Tn)}if(et===Me.length-1&&N){var Hn=s.testLoop(g,v,c);for(Xt=0;Xt<a.length;++Xt)Mt=a[Xt],Ka(Tn=Hn[Xt]),_e["val_"+Mt]=Tn}}),[4,G.onBatchEnd(et,it)];case 2:return nt.sent(),Ub(it),s.stopTraining_?[2,"break"]:[2]}})},Ue=0,Xe.label=3;case 3:return Ue<Me.length?[5,Te(Ue)]:[3,6];case 4:if("break"===Xe.sent())return[3,6];Xe.label=5;case 5:return++Ue,[3,3];case 6:me.dispose(),Xe.label=7;case 7:return[4,G.onEpochEnd(fe,_e)];case 8:return Xe.sent(),s.stopTraining_?[2,"break"]:[2]}})},se=S,ue.label=2;case 2:return se<u?[5,Q(se)]:[3,5];case 3:if("break"===ue.sent())return[3,5];ue.label=4;case 4:return++se,[3,2];case 5:return[4,G.onTrainEnd()];case 6:return ue.sent(),[4,s.history.syncData()];case 7:return ue.sent(),[2,s.history]}})})}function jp(s,o,i,a){return void 0===a&&(a={}),nn(this,void 0,void 0,function(){var c,u,p,m,g,v,y,C,M,O,N,B,W,G,X,Q,se,ue,fe,_e;return Rn(this,function(me){switch(me.label){case 0:if(s.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");s.isTraining=!0,me.label=1;case 1:return me.trys.push([1,,7,8]),ey(C=null==a.batchSize?32:a.batchSize),[4,s.standardizeUserData(o,i,a.sampleWeight,a.classWeight,!1,C)];case 2:if(M=me.sent(),c=M[0],u=M[1],y=M[2],O=!1,N=void 0,!(null!=a.validationData&&a.validationData.length>0))return[3,4];if(O=!0,2!==a.validationData.length)throw 3===a.validationData.length?new ni("validationData including sample weights is not supported yet."):new Ne("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+a.validationData+" is invalid.");return[4,s.standardizeUserData(p=a.validationData[0],m=a.validationData[1],null,null,!0,C)];case 3:return B=me.sent(),N=(g=B[0]).concat(v=B[1]),[3,5];case 4:null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1?(O=!0,W=Math.floor(c[0].shape[0]*(1-a.validationSplit)),g=Hp(c,W,G=c[0].shape[0]),c=Hp(c,0,W),v=Hp(u,W,G),u=Hp(u,0,W),N=g.concat(v)):null!=a.validationSteps&&(O=!0),me.label=5;case 5:return X=c.concat(u).concat(y),s.checkTrainableWeightsConsistency(),Q=s.makeTrainFunction(),se=s.getDedupedMetricsNames(),ue=void 0,fe=void 0,O?(s.makeTestFunction(),ue=s.testFunction,fe=se.slice().concat(se.map(function(Me){return"val_"+Me}))):(ue=null,N=[],fe=se.slice()),_e=Gb(a.callbacks,a.yieldEvery),[4,iy(s,Q,X,se,C,a.epochs,a.verbose,_e,ue,N,a.shuffle,fe,a.initialEpoch,null,null)];case 6:return[2,me.sent()];case 7:return s.isTraining=!1,hc(c,o),hc(u,i),hc(g,p),hc(v,m),null!=y&&Kn(y),[7];case 8:return[2]}})})}function K1(s){var o=[];s instanceof ki&&(s=[s]);for(var i=0;i<s.length;++i){var a=s[i];if(1===a.rank)o.push(Ip(a,1));else{if(0===a.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");o.push(a)}}return o}function hc(s,o){if(null!=s){var i=[];if(o instanceof ki)i.push(o.id);else if(Array.isArray(o))o.forEach(function(g){return i.push(g.id)});else if(null!=o)for(var a in o)i.push(o[a].id);var u=[];if(s instanceof ki)-1===i.indexOf(s.id)&&u.push(s);else if(Array.isArray(s))s.forEach(function(g){-1===i.indexOf(g.id)&&u.push(g)});else if(null!=s)for(var p in s){var m=s[p];-1===i.indexOf(m.id)&&u.push(m)}u.forEach(function(g){g.isDisposed||g.dispose()})}}function Dg(s){return Array.isArray(s)}function ry(s){return!function WM(s){return s instanceof ki}(s)&&!Dg(s)}function Wp(s,o,i,a,c){if(void 0===a&&(a=!0),void 0===c&&(c=""),null==o||0===o.length){if(null!=s){var u=!1;if(Dg(s)&&s.length>0)u=!0;else if(ry(s)){for(var p in s)if(s.hasOwnProperty(p)){u=!0;break}}else u=!0;if(u)throw new Ne("Error when checking model "+c+" expected no data, but got "+s)}return[]}if(null==s)return o.map(function(P){return null});var m;if(ry(s)){m=[];for(var g=0,v=o;g<v.length;g++){var y=v[g];if(null==s[y])throw new Ne('No data provided for "'+y+'". Need data for each key in: '+o);m.push(s[y])}}else if(Dg(s)){if(s.length!==o.length)throw new Ne("Error when checking model "+c+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+o.length+" Tensor(s), but instead got the following list of Tensor(s): "+s);m=s}else{if(o.length>1)throw new Ne("The model "+c+" expects "+o.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+s.shape);m=[s]}if(m=K1(m),null!=i)for(var C=0;C<o.length;++C)if(null!=i[C]){var S=m[C];if(S.shape.length!==i[C].length)throw new Ne("Error when checking "+c+": expected "+o[C]+" to have "+i[C].length+" dimension(s). but got array with shape "+S.shape);for(var M=0;M<i[C].length;++M)if(0!==M||a){var N=i[C][M];if(null!=N&&N>=0&&S.shape[M]!==N)throw new Ne("Error when checking "+c+": expected "+o[C]+" to have shape ["+i[C]+"], but got array with shape ["+S.shape+"].")}}return m}function gn(s,o,i,a,c){var u;if(void 0===a&&(a=!0),void 0===c&&(c=""),Array.isArray(s)){if(s.length!==o.length)throw new Ne("Error when checking model "+c+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+o.length+" Tensor(s), but instead got "+s.length+" Tensors(s).");u=s}else{if(o.length>1)throw new Ne("The model expects "+o.length+" "+c+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(s.shape)+".");u=[s]}if(null!=i)for(var p=0;p<o.length;++p)if(null!=i[p]){var m=u[p];if(m.shape.length!==i[p].length)throw new Ne("Error when checking "+c+": expected "+o[p]+" to have "+i[p].length+" dimension(s), but got array with shape "+JSON.stringify(m.shape));for(var g=0;g<i[p].length;++g)if(0!==g||a){var y=i[p][g];if(null!=y&&y!==m.shape[g])throw new Ne("Error when checking "+c+": expected "+o[p]+" to have shape "+JSON.stringify(i[p])+" but got array with shape "+JSON.stringify(m.shape)+".")}}}var Rl=function(s){function o(i){var a=s.call(this,i)||this;return a.isTraining=!1,a}return ft(o,s),o.prototype.summary=function(i,a,c){if(void 0===c&&(c=console.log),!this.built)throw new Ne("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function PM(s,o,i,a){void 0===a&&(a=console.log);var c,u=function SF(s){var o=!0,i=[],a=[];for(var c in s.nodesByDepth)i.push(s.nodesByDepth[c]);for(var u=0,p=i;u<p.length;u++){var m=p[u];if(m.length>1||1===m.length&&m[0].inboundLayers.length>1){o=!1;break}a.push.apply(a,m)}if(o)for(var g=0,v=s.layers;g<v.length;g++){for(var y=!1,C=0,S=v[g].inboundNodes;C<S.length;C++)if(-1!==a.indexOf(S[C])){if(y){o=!1;break}y=!0}if(!o)break}return o}(s),p=["Layer (type)","Output shape","Param #"];if(u?(o=o||65,i=i||[.45,.85,1]):(o=o||98,i=i||[.33,.55,.67,1]),i[i.length-1]<=1&&(i=i.map(function(S){return Math.floor(o*S)})),!u)for(var m in p.push("Receives inputs"),c=[],s.nodesByDepth)c.push.apply(c,s.nodesByDepth[m]);a("_".repeat(o)),Zb(p,i,a),a("=".repeat(o));for(var g=s.layers,v=0;v<g.length;++v)u?LM(g[v],i,a):BM(g[v],i,c,a),a((v===g.length-1?"=":"_").repeat(o));s.checkTrainableWeightsConsistency();var y=function Xb(s){return $u(null!=s.collectedTrainableWeights?s.collectedTrainableWeights:s.trainableWeights)}(s),C=$u(s.nonTrainableWeights);a("Total params: "+(y+C)),a("Trainable params: "+y),a("Non-trainable params: "+C),a("_".repeat(o))}(this,i,a,c)},o.prototype.compile=function(i){var a=this;if(null==i.loss&&(i.loss=[]),this.loss=i.loss,"string"==typeof i.optimizer)this.optimizer_=function NM(s){var o={Adagrad:function(){return hd.adagrad(.01)},Adadelta:function(){return hd.adadelta(1,.95,Sr())},Adam:function(){return hd.adam(.001,.9,.999,Sr())},Adamax:function(){return hd.adamax(.002,.9,.999,Sr(),0)},RMSProp:function(){return hd.rmsprop(.001,.9,0,Sr())},SGD:function(){return hd.sgd(.01)}};if(o.adagrad=o.Adagrad,o.adadelta=o.Adadelta,o.adam=o.Adam,o.adamax=o.Adamax,o.rmsprop=o.RMSProp,o.sgd=o.SGD,s in o)return o[s]();throw new Ne("Unknown Optimizer "+s)}(i.optimizer),this.isOptimizerOwned=!0;else{if(!(i.optimizer instanceof Sl))throw new Ne("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=i.optimizer,this.isOptimizerOwned=!1}var c=[];if(Array.isArray(i.loss)||"string"==typeof i.loss||"function"==typeof i.loss)if(Array.isArray(i.loss)){if(i.loss.length!==this.outputs.length)throw new Ne("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+i.loss+".");c=i.loss.map(function(P){return Bp(P)})}else{var p=Bp(i.loss);this.outputs.forEach(function(P){c.push(p)})}else{for(var m in i.loss=i.loss,i.loss)if(-1===this.outputNames.indexOf(m))throw new Ne('Unknown entry in loss dictionary: "'+m+'". Only expected the following keys: '+this.outputNames);for(var g=0,v=this.outputNames;g<v.length;g++){var y=v[g];null==i.loss[y]&&console.warn('Output "'+y+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+y+" during training"),c.push(Bp(i.loss[y]))}}this.lossFunctions=c,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var C=0;C<this.outputs.length;++C){var S=this.internalOutputShapes[C];this.feedOutputNames.push(this.outputNames[C]),this.feedOutputShapes.push(S),this.feedLossFns.push(this.lossFunctions[C])}var O=[];this.metrics=i.metrics,this.metricsNames=["loss"],this.metricsTensors=[],vd("loss",function(){for(var P=0;P<a.outputs.length;++P)-1===O.indexOf(P)&&a.outputs.length>1&&(a.metricsTensors.push([a.lossFunctions[P],P]),a.metricsNames.push(a.outputNames[P]+"_loss"))});var N=function Gp(s,o){if(null==s||Array.isArray(s)&&0===s.length)return o.map(function(g){return[]});var i;if("string"==typeof s||"function"==typeof s)i=[s];else{if(!Array.isArray(s)&&"object"!=typeof s)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+s);i=s}if(Array.isArray(i))return o.map(function(g){return i});for(var a=[],c=0,u=o;c<u.length;c++){var p=u[c],m=i.hasOwnProperty(p)?i[p]:[];Array.isArray(m)||(m=[m]),a.push(m)}return a}(i.metrics,this.outputNames);vd("metric",function(){for(var P=function(W){if(-1!==O.indexOf(W))return"continue";!function(G){for(var X,Q,se,ue=function(me){if("string"==typeof me&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(me)){var Me=a.internalOutputShapes[W];1===Me[Me.length-1]||a.lossFunctions[W]===Zs?-1!==["accuracy","acc"].indexOf(me)?Q=$b:-1!==["crossentropy","ce"].indexOf(me)&&(Q=Sn):a.lossFunctions[W]===to?-1!==["accuracy","acc"].indexOf(me)?Q=yg:-1!==["crossentropy","ce"].indexOf(me)&&(Q=Kb):-1!==["accuracy","acc"].indexOf(me)?Q=bg:-1!==["crossentropy","ce"].indexOf(me)&&(Q=xg);var Te=void 0;-1!==["accuracy","acc"].indexOf(me)?Te="acc":-1!==["crossentropy","ce"].indexOf(me)&&(Te="ce"),se=Q,X=""+Te}else{var Ue=function dc(s){if("string"==typeof s&&s in Ed)return Ed[s];if("string"!=typeof s&&null!=s)return s;throw new Ne("Unknown metric "+s)}(me);se=Ue,X=""+wg(me)}var Xe,et,it,nt;vd(X,function(){Xe=se}),et=W,it=X,nt=Xe,a.outputNames.length>1&&(it=a.outputNames[et]+"_"+it),a.metricsNames.push(it),a.metricsTensors.push([nt,et])},fe=0,_e=G;fe<_e.length;fe++)ue(_e[fe])}(N[W])},B=0;B<a.outputs.length;++B)P(B)}),this.collectedTrainableWeights=this.trainableWeights},o.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},o.prototype.evaluate=function(i,a,c){void 0===c&&(c={});var u=null==c.batchSize?32:c.batchSize;ey(u);var p=this.standardizeUserDataXY(i,a,!0,u);try{var m=p[0].concat(p[1]);return this.makeTestFunction(),Jo(this.testLoop(this.testFunction,m,u,c.verbose,c.steps))}finally{hc(p[0],i),hc(p[1],a)}},o.prototype.evaluateDataset=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){return this.makeTestFunction(),[2,Y1(this,i,a)]})})},o.prototype.checkNumSamples=function(i,a,c,u){var p;if(void 0===u&&(u="steps"),null!=c){if(p=null,null!=a)throw new Ne("If "+u+" is set, batchSize must be null or undefined.Got batchSize = "+a)}else{if(null==i)throw new Ne("Either the input data should have a defined shape, or "+u+" shoud be specified.");p=Array.isArray(i)?i[0].shape[0]:i.shape[0]}return p},o.prototype.execute=function(i,a){if(Array.isArray(a)&&0===a.length)throw new Ne("`outputs` is an empty Array, which is not allowed.");var c=Array.isArray(a),p=this.retrieveSymbolicTensors(c?a:[a]),m=new Xu;if(i instanceof ki&&(i=[i]),Array.isArray(i)){if(i.length!==this.inputs.length)throw new Ne("The number of inputs provided ("+i.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var g=0;g<this.inputs.length;++g)m.add(this.inputs[g],i[g])}else for(var v=0,y=this.inputs;v<y.length;v++){var C=y[v],S=i[C.name];if(null==S)throw new Ne("No value is provided for the model's input "+C.name);m.add(C,S)}var M=Zu(p,m);return c?M:M[0]},o.prototype.retrieveSymbolicTensors=function(i){for(var a=Uu(null,i.length),c=i.length,u=0,p=this.layers;u<p.length;u++){for(var m=p[u],g=Array.isArray(m.output)?m.output:[m.output],v=g.map(function(M){return M.name}),y=0;y<i.length;++y){var C=v.indexOf(i[y]);if(-1!==C&&(a[y]=g[C],c--),0===c)break}if(0===c)break}if(c>0){var S=[];throw a.forEach(function(M,O){null==M&&S.push(i[O])}),new Ne("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(S))}return a},o.prototype.predictLoop=function(i,a,c){var u=this;return void 0===a&&(a=32),void 0===c&&(c=!1),$e(function(){var p=u.checkNumSamples(i);if(c)throw new ni("Verbose predictLoop() is not implemented yet.");for(var m=ny(p,a),g=u.outputs.map(function(C){return[]}),v=function(C){$e(function(){var O=Hp(i,m[C][0],m[C][1]),N=[];if(Array.isArray(O))for(var P=0;P<O.length;++P)N.push({key:u.inputs[P],value:O[P]});else N.push({key:u.inputs[0],value:O});var B=new Xu(N);return Zu(u.outputs,B)}).forEach(function(S,M){return g[M].push(S)})},y=0;y<m.length;++y)v(y);return Jo(g.map(function(C){return Ur(C,0)}))})},o.prototype.predict=function(i,a){void 0===a&&(a={});var c=K1(i);gn(c,this.inputNames,this.feedInputShapes,!1);try{var u=null==a.batchSize?32:a.batchSize;return ey(u),this.predictLoop(c,u)}finally{hc(c,i)}},o.prototype.predictOnBatch=function(i){gn(i,this.inputNames,this.feedInputShapes,!0);var a=(Array.isArray(i)?i[0]:i).shape[0];return this.predictLoop(i,a)},o.prototype.standardizeUserDataXY=function(i,a,c,u){if(void 0===c&&(c=!0),null==this.optimizer_)throw new Dl("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var p=[],m=0;m<this.feedOutputShapes.length;++m){var g=this.feedOutputShapes[m];p.push(this.feedLossFns[m]===to?g.slice(0,g.length-1).concat([1]):g)}if(function GM(s,o,i){var a=El(s.map(function(u){return u.shape[0]}));a.sort();var c=El(o.map(function(u){return u.shape[0]}));if(c.sort(),a.length>1)throw new Ne("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(s.map(function(u){return u.shape})));if(c.length>1)throw new Ne("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(o.map(function(u){return u.shape})));if(a.length>0&&c.length>0&&!qe.arraysEqual(a,c))throw new Ne("Input Tensors should have the same number of samples as target Tensors. Found "+a[0]+" input sample(s) and "+c[0]+" target sample(s).")}(i=Wp(i,this.feedInputNames,this.feedInputShapes,!1,"input"),a=Wp(a,this.feedOutputNames,p,!1,"target")),function X1(s,o,i){for(var a=[Gr,Zs,$r],c=0;c<s.length;++c){var u=s[c],p=o[c],m=i[c];if(null!=p){if(p===$r&&1===u.shape[u.shape.length-1])throw new Ne("You are passing a target array of shape "+u.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==a.indexOf(p))for(var g=u.shape.slice(1),v=m.slice(1),y=0;y<g.length;++y){var S=v[y];if(null!=S&&g[y]!==S)throw new Ne("A target Tensor with shape "+u.shape+" was passed for an output of shape "+m+", while using a loss function that expects targets to have the same shape as the output.")}}}}(a,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=u&&u>0&&i[0].shape[0]%u!=0)throw new Ne("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+u+". Found: "+i[0].shape[0]+" sample(s).");return[i,a]},o.prototype.standardizeUserData=function(i,a,c,u,p,m){return void 0===p&&(p=!0),nn(this,void 0,void 0,function(){var g,v,y,C,S,M,O,N;return Rn(this,function(P){switch(P.label){case 0:if(g=this.standardizeUserDataXY(i,a,p,m),v=g[0],y=g[1],null!=c)throw new Error("sample weight is not supported yet.");if(C=null,null==u)return[3,4];S=Jb(u,this.outputNames),C=[],M=0,P.label=1;case 1:return M<S.length?(N=(O=C).push,[4,HM(y[M],null,S[M])]):[3,4];case 2:N.apply(O,[P.sent()]),P.label=3;case 3:return++M,[3,1];case 4:return[2,[v,y,C]]}})})},o.prototype.testLoop=function(i,a,c,u,p){var m=this;return void 0===u&&(u=0),$e(function(){var g=m.checkNumSamples(a,c,p,"steps"),v=[];if(u>0)throw new ni("Verbose mode is not implemented yet.");if(null!=p)throw new ni("steps mode in testLoop() is not implemented yet");for(var y=ny(g,c),C=Pn(is(0,g)),S=0;S<y.length;++S){var M=y[S][0],O=y[S][1],N=bd(C,M,O-M),P=ty(a,N),B=i(P);if(0===S)for(var W=0;W<B.length;++W)v.push(Nt(0));for(W=0;W<B.length;++W)v[W]=ai(v[W],Vn(O-M,B[W]))}for(W=0;W<v.length;++W)v[W]=bo(v[W],g);return v})},o.prototype.getDedupedMetricsNames=function(){for(var i=this.metricsNames,a=[],c=0;c<i.length;++c){var u=i[c],p=u;fd(i,u)>1&&(p+="_"+fd(i.slice(0,c),u)),a.push(p)}return a},o.prototype.makeTrainFunction=function(){var i=this;return function(a){var c=[],u=a.slice(0,i.inputs.length),p=a.slice(i.inputs.length,i.inputs.length+i.outputs.length),m=a.slice(i.inputs.length+i.outputs.length,i.inputs.length+2*i.outputs.length),g=[],v=i.collectedTrainableWeights.map(function(y){return y.read()});return[i.optimizer_.minimize(function(){for(var y=[],C=0;C<i.inputs.length;++C)y.push({key:i.inputs[C],value:u[C]});var S,M=new Xu(y),O=Zu(i.outputs,M,{training:!0});for(C=0;C<i.lossFunctions.length;++C){var N=(0,i.lossFunctions[C])(p[C],O[C]);null!=m[C]&&(N=Qs(N,m[C]));var P=Or(N);c.push(P),S=0===C?N:ai(S,N)}for(C=0;C<i.metricsTensors.length;++C){var B=void 0;if(i.outputs.length>1&&C<i.outputs.length)B=c[C];else{var G=i.metricsTensors[C][1];B=Or((0,i.metricsTensors[C][0])(p[G],O[G]))}Ka(B),g.push(B)}return S=Or(S),i.calculateLosses().forEach(function(X){S=ai(S,X)}),S},!0,v)].concat(g)}},o.prototype.makeTestFunction=function(){var i=this;this.testFunction=function(a){return $e(function(){for(var c,u=[],p=a.slice(0,i.inputs.length),m=a.slice(i.inputs.length,i.inputs.length+i.outputs.length),g=[],v=0;v<i.inputs.length;++v)g.push({key:i.inputs[v],value:p[v]});var y=new Xu(g),C=Zu(i.outputs,y);for(v=0;v<i.lossFunctions.length;++v){var M=Or((0,i.lossFunctions[v])(m[v],C[v]));c=0===v?M:ai(c,M),u.push(c)}for(v=0;v<i.metricsTensors.length;++v){var N=i.metricsTensors[v][1],P=Or((0,i.metricsTensors[v][0])(m[N],C[N]));u.push(P)}return u})}},o.prototype.fit=function(i,a,c){return void 0===c&&(c={}),nn(this,void 0,void 0,function(){return Rn(this,function(u){return[2,jp(this,i,a,c)]})})},o.prototype.fitDataset=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){return[2,Js(this,i,a)]})})},o.prototype.trainOnBatch=function(i,a){return nn(this,void 0,void 0,function(){var c,u,p,m,g,v,y,C,S;return Rn(this,function(M){switch(M.label){case 0:return[4,this.standardizeUserData(i,a)];case 1:c=M.sent(),u=c[0],p=c[1],m=this.makeTrainFunction(),g=m(u.concat(p)),v=[],y=0,C=g,M.label=2;case 2:return y<C.length?[4,C[y].data()]:[3,5];case 3:S=M.sent(),v.push(S[0]),M.label=4;case 4:return y++,[3,2];case 5:return Kn(g),[2,Jo(v)]}})})},o.prototype.getNamedWeights=function(i){for(var a=[],c=null!=i&&i.trainableOnly,u=c?this.trainableWeights:this.weights,p=this.getWeights(c),m=0;m<u.length;++m)c&&!u[m].trainable||a.push({name:u[m].originalName,tensor:p[m]});return a},Object.defineProperty(o.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(i){this.stopTraining_=i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(i){this.optimizer_!==i&&(this.optimizer_=i,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),o.prototype.dispose=function(){var i=s.prototype.dispose.call(this);if(0===i.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var a=fl().numTensors;this.optimizer_.dispose(),i.numDisposedVariables+=a-fl().numTensors}return i},o.prototype.getLossIdentifiers=function(){var i;if("string"==typeof this.loss)i=ns(this.loss);else if(Array.isArray(this.loss)){for(var a=0,c=this.loss;a<c.length;a++)if("string"!=typeof c[a])throw new Error("Serialization of non-string loss is not supported.");i=this.loss.map(function(y){return ns(y)})}else{var u=Object.keys(this.loss);i={};for(var p=this.loss,m=0,g=u;m<g.length;m++){var v=g[m];if("string"!=typeof p[v])throw new Error("Serialization of non-string loss is not supported.");i[v]=ns(p[v])}}return i},o.prototype.getMetricIdentifiers=function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[ns(wg(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(c){return ns(wg(c))});var i={};for(var a in this.metrics)i[a]=ns(wg(this.metrics[a]));return i},o.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},o.prototype.loadTrainingConfig=function(i){if(null!=i.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=i.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=i.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var a,c,u=Bt(Vp(i.optimizer_config));if("string"==typeof i.loss)a=md(i.loss);else if(Array.isArray(i.loss))a=i.loss.map(function(m){return md(m)});else if(null!=i.loss)for(var p in a={},i.loss)a[p]=md(i.loss[p]);if(Array.isArray(i.metrics))c=i.metrics.map(function(m){return md(m)});else if(null!=i.metrics)for(var p in c={},i.metrics)c[p]=md(i.metrics[p]);this.compile({loss:a,metrics:c,optimizer:u})},o.prototype.save=function(i,a){return nn(this,void 0,void 0,function(){var c,u,g,v,y,C,S,O,N,B;return Rn(this,function(W){switch(W.label){case 0:if("string"==typeof i){if(0===(c=Sa.getSaveHandlers(i)).length)throw new Ne("Cannot find any save handlers for URL '"+i+"'");if(c.length>1)throw new Ne("Found more than one ("+c.length+") save handlers for URL '"+i+"'");i=c[0]}if(null==i.save)throw new Ne("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Sa.encodeWeights(this.getNamedWeights(a))];case 1:return u=W.sent(),g=this.toJSON(null,!1),v={modelTopology:g,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v"+Up,convertedBy:null},null!=a&&a.includeOptimizer&&null!=this.optimizer?(v.trainingConfig=this.getTrainingConfig(),y="optimizer",N=(O=Sa).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,N.apply(O,[W.sent(),y])];case 3:C=W.sent(),S=C.data,(B=u.specs).push.apply(B,C.specs),u.data=Sa.concatenateArrayBuffers([u.data,S]),W.label=4;case 4:return null!=this.userDefinedMetadata&&(uc(this.userDefinedMetadata,this.name,!0),v.userDefinedMetadata=this.userDefinedMetadata),v.weightData=u.data,v.weightSpecs=u.specs,[2,i.save(v)]}})})},o.prototype.setUserDefinedMetadata=function(i){uc(i,this.name),this.userDefinedMetadata=i},o.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},o.className="Model",o}(G1);function J1(s,o,i){return nn(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C;return Rn(this,function(S){switch(S.label){case 0:if(null==i&&(i={}),null==s.load)throw new Ne("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,s.load()];case 1:if(a=S.sent(),null!=(c=a.modelTopology).model_config&&(c=c.model_config),u=null==i.strict||i.strict,p=null!=a.weightData&&null!=a.weightSpecs&&u,m=Bt(Vp(c),o,p),null!=(g=a.trainingConfig)&&m.loadTrainingConfig(g),null!=a.userDefinedMetadata&&m.setUserDefinedMetadata(a.userDefinedMetadata),null==a.weightData)return[3,4];if(null==a.weightSpecs)throw new Ne("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return v=function eC(s,o){var i=Sa.decodeWeights(s,o),a={},c=[];return o.forEach(function(u){"optimizer"===u.group?c.push({name:u.name,tensor:i[u.name]}):a[u.name]=i[u.name]}),{modelWeights:a,optimizerWeights:c}}(a.weightData,a.weightSpecs),C=v.optimizerWeights,m.loadWeights(y=v.modelWeights,u),null!=m.optimizer&&C.length>0?[4,m.optimizer.setWeights(C)]:[3,3];case 2:S.sent(),S.label=3;case 3:Kn(y),Kn(C.map(function(M){return M.tensor})),S.label=4;case 4:return[2,m]}})})}bt.registerClass(Rl);var Eg=function(s){function o(i){var a=s.call(this,{inputs:[],outputs:[]})||this;if(i=i||{},a.trainable=!0,a.built=!1,a.name=null!=i.name?i.name:Ks("sequential_"),null!=i.layers)for(var c=0,u=i.layers;c<u.length;c++)a.add(u[c]);return a}return ft(o,s),o.prototype.checkShape=function(i){if(i.inboundNodes[0].outputTensors[0].shape.some(function(a){return a<0}))throw new Ne("Negative dimension size caused by adding layer "+i.name+" with input shape ["+i.inboundNodes[0].inputTensors[0].shape+"]")},o.prototype.add=function(i){var a,c=i instanceof o||i instanceof Rl;if(c){if(1!==(a=i).outputs.length)throw new Ne("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==a.inputs.length)throw new Ne("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===i.inboundNodes.length){if(null==i.batchInputShape)throw new Ne("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var u=Sd({batchShape:i.batchInputShape,dtype:i.dtype,name:i.name+"_input"});i.apply(u)}if(c)this.outputs=a.outputs,this.inputs=a.inputs;else{if(1!==i.inboundNodes.length)throw new Ne("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+i.name+" which has "+i.inboundNodes.length+" pre-existing inbound connections.");if(1!==i.inboundNodes[0].outputTensors.length)throw new Ne("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(i),this.outputs=[i.inboundNodes[0].outputTensors[0]],this.inputs=wd(this.outputs[0])}this.inboundNodes=[],new Il({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Uu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(m){return m.shape}),outputShapes:this.outputs[0].shape})}else{var p=i.apply(this.outputs[0]);if(Array.isArray(p))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(i),this.outputs=[p],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(i),this.built=!1},o.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var i=this.layers.length-1;this.layers[i].outboundNodes=[],this.outputs=[this.layers[i].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},o.prototype.call=function(i,a){return null==this.model&&this.build(),this.model.call(i,a)},o.prototype.build=function(i){if(Qi(i),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Rl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},o.prototype.countParams=function(){return this.built||this.build(),s.prototype.countParams.call(this)},o.prototype.summary=function(i,a,c){void 0===c&&(c=console.log),this.built||this.build(),s.prototype.summary.call(this,i,a,c)},o.prototype.setWeights=function(i){null==this.model&&this.build(),this.model.setWeights(i)},o.prototype.evaluate=function(i,a,c){if(void 0===c&&(c={}),!this.built)throw new Dl("The model needs to be compiled before being used.");return this.model.evaluate(i,a,c)},o.prototype.evaluateDataset=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){if(!this.built)throw new Dl("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(i,a)]})})},o.prototype.predict=function(i,a){return void 0===a&&(a={}),null==this.model&&this.build(),this.model.predict(i,a)},o.prototype.predictOnBatch=function(i){return null==this.model&&this.build(),this.model.predictOnBatch(i)},o.prototype.compile=function(i){this.build(),this.model.compile(i),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(o.prototype,"optimizer",{get:function(){return null==this.model?void 0:this.model.optimizer},set:function(i){this.model.optimizer=i},enumerable:!0,configurable:!0}),o.prototype.fit=function(i,a,c){return void 0===c&&(c={}),nn(this,void 0,void 0,function(){return Rn(this,function(u){if(!this.built)throw new Dl("The model needs to be compiled before being used.");return[2,this.model.fit(i,a,c)]})})},o.prototype.fitDataset=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){if(!this.built)throw new Dl("The model needs to be compiled before being used.");return[2,this.model.fitDataset(i,a)]})})},o.prototype.trainOnBatch=function(i,a){return nn(this,void 0,void 0,function(){return Rn(this,function(c){return[2,this.model.trainOnBatch(i,a)]})})},o.fromConfig=function(i,a,c,u){var p;void 0===c&&(c={}),void 0===u&&(u=!1);var m={};if(a instanceof Array){if(null==a[0].className||"Merge"===a[0].className)throw new Ne("Legacy serialization format not supported yet.");p=a}else qe.assert(null!=a.layers,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),p=a.layers,delete a.layers,m=a;var g=new i(m);if(!(g instanceof o))throw new ni("Sequential.fromConfig called on non-Sequential input: "+g);for(var v=0,y=p;v<y.length;v++){var C=Bt(y[v],void 0,u);u&&C.setFastWeightInitDuringBuild(!0),g.add(C)}return g},Object.defineProperty(o.prototype,"stopTraining",{get:function(){if(null==this.model)throw new Ne("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(i){if(null==this.model)throw new Ne("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=i},enumerable:!0,configurable:!0}),o.prototype.getConfig=function(){for(var i=[],a=0,c=this.layers;a<c.length;a++){var u=c[a],p={};p.className=u.getClassName(),p.config=u.getConfig(),i.push(p)}return{name:this.name,layers:i}},o.className="Sequential",o}(Rl);function tC(s){return new Rl(s)}function nC(s){return new Eg(s)}function $M(s,o){return null==o&&(o={}),function Q1(s,o){return nn(this,void 0,void 0,function(){var i;return Rn(this,function(a){if(null==o&&(o={}),"string"==typeof s){if(0===(i=Sa.getLoadHandlers(s,o.onProgress)).length)i.push(Sa.browserHTTPRequest(s,o));else if(i.length>1)throw new Ne("Found more than one ("+i.length+") load handlers for URL '"+s+"'");s=i[0]}return[2,J1(s,void 0,o)]})})}(s,o)}function iC(s){return Sd(s)}function qM(s,o){A1.registerCallbackConstructor(s,o)}bt.registerClass(Eg);var Ha=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.getConfig=function(){return{}},o}(bt.Serializable),YM=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i,a){return void 0===a&&(a=1),function bM(s,o){if(void 0===o&&(o=1),1!==o)throw new ni("Support for alpha values other than 1 ("+o+") is not implemented yet.");return so(s)}(i,a)},o.className="elu",o}(Ha);bt.registerClass(YM);var KM=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return $m(i)},o.className="selu",o}(Ha);bt.registerClass(KM);var XM=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return Zl(i)},o.className="relu",o}(Ha);bt.registerClass(XM);var ZM=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return $e(function(){return Yl(6,Zl(i))})},o.className="relu6",o}(Ha);bt.registerClass(ZM);var QM=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return i},o.className="linear",o}(Ha);bt.registerClass(QM);var JM=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return Cv(i)},o.className="sigmoid",o}(Ha);bt.registerClass(JM);var e2=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return function Fb(s){return $e(function(){var o=ai(.5,Vn(.2,s));return Zo(o,0,1)})}(i)},o.className="hardSigmoid",o}(Ha);bt.registerClass(e2);var t2=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return dp(i)},o.className="softplus",o}(Ha);bt.registerClass(t2);var n2=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return function yM(s){return $e(function(){return bo(s,Gl(s).add(1))})}(i)},o.className="softsign",o}(Ha);bt.registerClass(n2);var r2=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i){return up(i)},o.className="tanh",o}(Ha);bt.registerClass(r2);var rC=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i,a){return void 0===a&&(a=-1),du(i,a)},o.className="softmax",o}(Ha);bt.registerClass(rC);var o2=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.apply=function(i,a){return void 0===a&&(a=-1),q_(i,a)},o.className="logSoftmax",o}(Ha);function ja(s){return s.getClassName()}function oy(s,o){return void 0===o&&(o={}),kp(s,bt.SerializationMap.getMap().classNameMap,o,"activation")}function Fl(s){var o;return null==s?oy(o={className:"linear",config:{}}):"string"==typeof s?((o={}).className=s,o.config={},oy(o)):s instanceof Ha?s:oy(s)}function kg(s){if(null!=s&&"object"!=typeof s)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+s)}bt.registerClass(o2);var ay=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o}(bt.Serializable),$p=function(s){function o(i){var a=s.call(this)||this;return kg(i),a.l1=null==i||null==i.l1?.01:i.l1,a.l2=null==i||null==i.l2?.01:i.l2,a.hasL1=0!==a.l1,a.hasL2=0!==a.l2,a}return ft(o,s),o.prototype.apply=function(i){var a=this;return $e(function(){var c=fn([1]);return a.hasL1&&(c=ai(c,wa(Vn(a.l1,Gl(i))))),a.hasL2&&(c=ai(c,wa(Vn(a.l2,Ap(i))))),c.asScalar()})},o.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},o.fromConfig=function(i,a){return new i({l1:a.l1,l2:a.l2})},o.className="L1L2",o}(ay);bt.registerClass($p);var sy={l1l2:"L1L2"};function ri(s){return _b(s)}function ly(s,o){return void 0===o&&(o={}),kp(s,bt.SerializationMap.getMap().classNameMap,o,"regularizer")}function fi(s){return null==s?null:"string"==typeof s?ly({className:s in sy?sy[s]:s,config:{}}):s instanceof ay?s:ly(s)}var Mg=function(s){function o(i){var a=s.call(this,i??{})||this;return a.supportsMasking=!0,null!=i&&(a.maxValue=i.maxValue),a}return ft(o,s),o.prototype.call=function(i,a){i=Qn(i);var c=Zl(i);return null!=this.maxValue&&(c=Zo(c,0,this.maxValue)),c},o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i={maxValue:this.maxValue},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="ReLU",o}(ii);bt.registerClass(Mg);var pc=function(s){function o(i){var a=s.call(this,i??{})||this;return a.DEFAULT_ALPHA=.3,null==i&&(i={}),a.alpha=null==i.alpha?a.DEFAULT_ALPHA:i.alpha,a}return ft(o,s),o.prototype.call=function(i,a){var c=Qn(i);return La(c,this.alpha)},o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i={alpha:this.alpha},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="LeakyReLU",o}(ii);bt.registerClass(pc);var sC=function(s){function o(i){var a=s.call(this,i??{})||this;if(a.DEFAULT_ALPHA_INITIALIZER="zeros",null==i&&(i={}),a.supportsMasking=!0,a.alphaInitializer=lr(i.alphaInitializer||a.DEFAULT_ALPHA_INITIALIZER),a.alphaRegularizer=fi(i.alphaRegularizer),a.alphaConstraint=Dr(i.alphaConstraint),null==i.sharedAxes)a.sharedAxes=null;else if(Array.isArray(i.sharedAxes))a.sharedAxes=i.sharedAxes;else{if("number"!=typeof i.sharedAxes)throw new Ne("Expected sharedAxes to be a number or an array of numbers, but got "+i.sharedAxes);a.sharedAxes=[i.sharedAxes]}return a}return ft(o,s),o.prototype.build=function(i){var a=(i=Qi(i)).slice(1);if(null!=this.sharedAxes)for(var c=0,u=this.sharedAxes;c<u.length;c++)a[(m=u[c])-1]=1;this.alpha=this.addWeight("alpha",a,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var p={};if(null!=this.sharedAxes)for(var m=1;m<i.length;++m)p[m]=i[m];this.inputSpec=[new Nr({ndim:i.length,axes:p})],this.built=!0},o.prototype.call=function(i,a){return i=Qn(i),Gm(i,this.alpha.read())},o.prototype.getConfig=function(){var i={alphaInitializer:Ii(this.alphaInitializer),alphaRegularizer:ri(this.alphaRegularizer),alphaConstraint:Oi(this.alphaConstraint),sharedAxes:this.sharedAxes},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="PReLU",o}(ii);bt.registerClass(sC);var lC=function(s){function o(i){var a=s.call(this,i??{})||this;if(a.DEFAULT_ALPHA=1,null==i&&(i={}),null!=i.alpha&&i.alpha!==a.DEFAULT_ALPHA)throw new ni("Non-default alpha value ("+i.alpha+") is not supported by the ELU layer yet.");return a.alpha=null==i.alpha?a.DEFAULT_ALPHA:i.alpha,a}return ft(o,s),o.prototype.call=function(i,a){var c=Qn(i);return so(c)},o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i={alpha:this.alpha},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="ELU",o}(ii);bt.registerClass(lC);var kd=function(s){function o(i){var a=s.call(this,i??{})||this;return a.DEFAULT_THETA=1,null==i&&(i={}),a.theta=null==i.theta?a.DEFAULT_THETA:i.theta,a}return ft(o,s),o.prototype.call=function(i,a){var c=Qn(i);return c.mul(Tp(c.greater(this.theta),"float32"))},o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i={theta:this.theta},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="ThresholdedReLU",o}(ii);bt.registerClass(kd);var a2=function(s){function o(i){var a=s.call(this,i??{})||this;return a.DEFAULT_AXIS=1,null==i&&(i={}),a.softmax=(new rC).apply,a.axis=null==i.axis?a.DEFAULT_AXIS:i.axis,a}return ft(o,s),o.prototype.call=function(i,a){var c=Qn(i);return this.softmax(c,this.axis)},o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i={axis:this.axis},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Softmax",o}(ii);function wo(s,o,i){if("number"==typeof s)return Uu(s,o);if(s.length!==o)throw new Ne("The "+i+" argument must be an integer or tuple of "+o+" integers. Received: "+s.length+" elements.");for(var a=0;a<o;++a){var c=s[a];if(!Mb(c))throw new Ne("The "+i+" argument must be an integer or tuple of "+o+" integers. Received: "+JSON.stringify(s)+" including a non-integer number "+c)}return s}function fc(s,o,i,a,c){return void 0===c&&(c=1),null==s?s:Math.floor((("same"===i?s:s-(o+(o-1)*(c-1))+1)+a-1)/a)}function qp(s,o,i,a){if(null==s)return null;if("valid"===a)s=s*o+sc([i-o,0]);else{if("same"!==a)throw new Ne("Unsupport padding mode: "+a+".");s*=o}return s}function Tg(s,o){return $e(function(){return Wr(o),"channelsFirst"===o?ur(s,[0,2,3,1]):s})}function s2(s,o){return $e(function(){return Wr(o),"channelsFirst"===o?ur(s,[0,2,3,4,1]):s})}function cC(s,o,i,a,c,u,p,m){return void 0===a&&(a=[1,1]),void 0===c&&(c="valid"),void 0===m&&(m=null),$e(function(){if(null==u&&(u="channelsLast"),Wr(u),3!==s.rank&&4!==s.rank)throw new Ne("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+s.rank+".");if(3!==o.rank&&4!==o.rank)throw new Ne("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+s.rank+".");var g=Tg(s,u);if("causal"===c)throw new ni("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return g=Pu.conv2d({x:g,filter:o,strides:a,pad:"same"===c?"same":"valid",dilations:p,dataFormat:"NHWC",bias:i,activation:m}),"channelsFirst"===u&&(g=ur(g,[0,3,1,2])),g})}bt.registerClass(a2);var dC=function(s){function o(i,a){var c=s.call(this,a)||this;if(c.bias=null,c.DEFAULT_KERNEL_INITIALIZER="glorotNormal",c.DEFAULT_BIAS_INITIALIZER="zeros",o.verifyArgs(a),c.rank=i,xo(c.rank,"rank"),1!==c.rank&&2!==c.rank&&3!==c.rank)throw new ni("Convolution layer for rank other than 1, 2, or 3 ("+c.rank+") is not implemented yet.");if(c.kernelSize=wo(a.kernelSize,i,"kernelSize"),c.strides=wo(null==a.strides?1:a.strides,i,"strides"),c.padding=null==a.padding?"valid":a.padding,Ua(c.padding),c.dataFormat=null==a.dataFormat?"channelsLast":a.dataFormat,Wr(c.dataFormat),c.activation=Fl(a.activation),c.useBias=null==a.useBias||a.useBias,c.biasInitializer=lr(a.biasInitializer||c.DEFAULT_BIAS_INITIALIZER),c.biasConstraint=Dr(a.biasConstraint),c.biasRegularizer=fi(a.biasRegularizer),c.activityRegularizer=fi(a.activityRegularizer),c.dilationRate=wo(null==a.dilationRate?1:a.dilationRate,i,"dilationRate"),1===c.rank&&Array.isArray(c.dilationRate)&&1!==c.dilationRate.length)throw new Ne("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(c.dilationRate));if(2===c.rank){if("number"==typeof c.dilationRate)c.dilationRate=[c.dilationRate,c.dilationRate];else if(2!==c.dilationRate.length)throw new Ne("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(c.dilationRate))}else if(3===c.rank)if("number"==typeof c.dilationRate)c.dilationRate=[c.dilationRate,c.dilationRate,c.dilationRate];else if(3!==c.dilationRate.length)throw new Ne("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(c.dilationRate));return c}return ft(o,s),o.verifyArgs=function(i){if(Gs("kernelSize"in i,"required key 'kernelSize' not in config"),"number"!=typeof i.kernelSize&&!dg(i.kernelSize,"number",1,3))throw new Ne("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(i.kernelSize)+".")},o.prototype.getConfig=function(){var i={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:ja(this.activation),useBias:this.useBias,biasInitializer:Ii(this.biasInitializer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),biasConstraint:Oi(this.biasConstraint)},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o}(ii),Ol=function(s){function o(i,a){var c=s.call(this,i,a)||this;return c.kernel=null,o.verifyArgs(a),c.filters=a.filters,xo(c.filters,"filters"),c.kernelInitializer=lr(a.kernelInitializer||c.DEFAULT_KERNEL_INITIALIZER),c.kernelConstraint=Dr(a.kernelConstraint),c.kernelRegularizer=fi(a.kernelRegularizer),c}return ft(o,s),o.prototype.build=function(i){var a;i=Qi(i);var c="channelsFirst"===this.dataFormat?1:i.length-1;if(null==i[c])throw new Ne("The channel dimension of the input should be defined. Found "+i[c]);var u=i[c],p=this.kernelSize.concat([u,this.filters]);this.kernel=this.addWeight("kernel",p,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(a={},a[c]=u,a)}],this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){var u;i=Qn(i);var p=null==c.bias?null:c.bias.read(),m=c1(c.activation.getClassName());if(null!=m&&2===c.rank)u=cC(i,c.kernel.read(),p,c.strides,c.padding,c.dataFormat,c.dilationRate,m);else{if(1===c.rank)u=function qt(s,o,i,a,c,u,p){return void 0===a&&(a=1),void 0===c&&(c="valid"),void 0===p&&(p=1),$e(function(){if(null==u&&(u="channelsLast"),Wr(u),3!==s.shape.length)throw new Ne("The input of a conv1dWithBias operation should be 3, but is "+s.shape.length+" instead.");if(3!==o.shape.length)throw new Ne("The kernel for a conv1dWithBias operation should be 3, but is "+o.shape.length+" instead");if(null!=i&&1!==i.shape.length)throw new Ne("The bias for a conv1dWithBias operation should be 1, but is "+o.shape.length+" instead");if("channelsFirst"===u&&(s=ur(s,[0,2,1])),"causal"===c)throw new ni("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var m=Pv(s,o,a,"same"===c?"same":"valid","NWC",p);return null!=i&&(m=vs(m,i)),m})}(i,c.kernel.read(),p,c.strides[0],c.padding,c.dataFormat,c.dilationRate[0]);else if(2===c.rank)u=cC(i,c.kernel.read(),p,c.strides,c.padding,c.dataFormat,c.dilationRate);else{if(3!==c.rank)throw new ni("convolutions greater than 3D are not implemented yet.");u=function l2(s,o,i,a,c,u,p){return void 0===a&&(a=[1,1,1]),void 0===c&&(c="valid"),$e(function(){if(null==u&&(u="channelsLast"),Wr(u),4!==s.rank&&5!==s.rank)throw new Ne("conv3dWithBias expects input to be of rank 4 or 5, but received "+s.rank+".");if(4!==o.rank&&5!==o.rank)throw new Ne("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+s.rank+".");var m=s2(s,u);if("causal"===c)throw new ni("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return m=Fm(m,o,a,"same"===c?"same":"valid","NDHWC",p),null!=i&&(m=vs(m,i)),"channelsFirst"===u&&(m=ur(m,[0,4,1,2,3])),m})}(i,c.kernel.read(),p,c.strides,c.padding,c.dataFormat,c.dilationRate)}null!=c.activation&&(u=c.activation.apply(u))}return u})},o.prototype.computeOutputShape=function(i){i=Qi(i);for(var a=[],c="channelsLast"===this.dataFormat?i.slice(1,i.length-1):i.slice(2),u=0;u<c.length;++u){var p=fc(c[u],this.kernelSize[u],this.padding,this.strides[u],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[u]);a.push(p)}var m=[i[0]];return"channelsLast"===this.dataFormat?(m=m.concat(a)).push(this.filters):(m.push(this.filters),m=m.concat(a)),m},o.prototype.getConfig=function(){var i={filters:this.filters,kernelInitializer:Ii(this.kernelInitializer),kernelRegularizer:ri(this.kernelRegularizer),kernelConstraint:Oi(this.kernelConstraint)},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.verifyArgs=function(i){if(!("filters"in i)||"number"!=typeof i.filters||i.filters<1)throw new Ne("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(i.filters))},o}(dC),cy=function(s){function o(i){var a=s.call(this,2,i)||this;return o.verifyArgs(i),a}return ft(o,s),o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this);return delete i.rank,i},o.verifyArgs=function(i){if("number"!=typeof i.kernelSize&&!dg(i.kernelSize,"number",1,2))throw new Ne("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(i.kernelSize)+".")},o.className="Conv2D",o}(Ol);bt.registerClass(cy);var Yp=function(s){function o(i){var a=s.call(this,3,i)||this;return o.verifyArgs(i),a}return ft(o,s),o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this);return delete i.rank,i},o.verifyArgs=function(i){if("number"!=typeof i.kernelSize&&(!Array.isArray(i.kernelSize)||1!==i.kernelSize.length&&3!==i.kernelSize.length))throw new Ne("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(i.kernelSize)+".")},o.className="Conv3D",o}(Ol);bt.registerClass(Yp);var Kp=function(s){function o(i){var a=s.call(this,i)||this;if(a.inputSpec=[new Nr({ndim:4})],"same"!==a.padding&&"valid"!==a.padding)throw new Ne("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+a.padding);return a}return ft(o,s),o.prototype.build=function(i){var a;if(4!==(i=Qi(i)).length)throw new Ne("Input should have rank 4; Received input shape: "+JSON.stringify(i));var c="channelsFirst"===this.dataFormat?1:i.length-1;if(null==i[c])throw new Ne("The channel dimension of the inputs should be defined. Found `None`.");var u=i[c],p=this.kernelSize.concat([this.filters,u]);this.kernel=this.addWeight("kernel",p,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Nr({ndim:4,axes:(a={},a[c]=u,a)})],this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){var u=Qn(i);if(4!==u.shape.length)throw new Ne("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+u.shape.length);var p,m,g=u.shape;"channelsFirst"===c.dataFormat?(p=2,m=3):(p=1,m=2);var C=g[m],M=c.kernelSize[1],N=c.strides[1],P=[g[0],qp(g[p],c.strides[0],c.kernelSize[0],c.padding),qp(C,N,M,c.padding),c.filters];"channelsLast"!==c.dataFormat&&(u=ur(u,[0,2,3,1]));var B=id(u,c.kernel.read(),P,c.strides,c.padding);return"channelsLast"!==c.dataFormat&&(B=ur(B,[0,3,1,2])),null!=c.bias&&(B=vs(B,c.bias.read(),c.dataFormat)),null!=c.activation&&(B=c.activation.apply(B)),B})},o.prototype.computeOutputShape=function(i){var a,c,u,p=(i=Qi(i)).slice();"channelsFirst"===this.dataFormat?(a=1,c=2,u=3):(a=3,c=1,u=2);var m=this.kernelSize[0],g=this.kernelSize[1],v=this.strides[0],y=this.strides[1];return p[a]=this.filters,p[c]=qp(p[c],v,m,this.padding),p[u]=qp(p[u],y,g,this.padding),p},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this);return delete i.dilationRate,i},o.className="Conv2DTranspose",o}(cy);bt.registerClass(Kp);var kr=function(s){function o(i,a){var c=s.call(this,i,a)||this;if(c.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",c.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",c.depthwiseKernel=null,c.pointwiseKernel=null,null==a.filters)throw new Ne("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=a.kernelInitializer||null!=a.kernelRegularizer||null!=a.kernelConstraint)throw new Ne("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=a.padding&&"same"!==a.padding&&"valid"!==a.padding)throw new Ne("SeparableConv"+c.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(a.padding));return c.depthMultiplier=null==a.depthMultiplier?1:a.depthMultiplier,c.depthwiseInitializer=lr(a.depthwiseInitializer||c.DEFAULT_DEPTHWISE_INITIALIZER),c.depthwiseRegularizer=fi(a.depthwiseRegularizer),c.depthwiseConstraint=Dr(a.depthwiseConstraint),c.pointwiseInitializer=lr(a.depthwiseInitializer||c.DEFAULT_POINTWISE_INITIALIZER),c.pointwiseRegularizer=fi(a.pointwiseRegularizer),c.pointwiseConstraint=Dr(a.pointwiseConstraint),c}return ft(o,s),o.prototype.build=function(i){var a;if((i=Qi(i)).length<this.rank+2)throw new Ne("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(i));var c="channelsFirst"===this.dataFormat?1:i.length-1;if(null==i[c]||i[c]<0)throw new Ne("The channel dimension of the inputs should be defined, but found "+JSON.stringify(i[c]));for(var u=i[c],p=this.kernelSize.concat([u,this.depthMultiplier]),m=[],g=0;g<this.rank;++g)m.push(1);m.push(u*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",p,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",m,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new Nr({ndim:this.rank+2,axes:(a={},a[c]=u,a)})],this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){var u;if(i=Qn(i),1===c.rank)throw new ni("1D separable convolution is not implemented yet.");return 2===c.rank&&("channelsFirst"===c.dataFormat&&(i=ur(i,[0,2,3,1])),u=Iu(i,c.depthwiseKernel.read(),c.pointwiseKernel.read(),c.strides,c.padding,c.dilationRate,"NHWC")),c.useBias&&(u=vs(u,c.bias.read(),c.dataFormat)),null!=c.activation&&(u=c.activation.apply(u)),"channelsFirst"===c.dataFormat&&(u=ur(u,[0,3,1,2])),u})},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this);return delete i.rank,delete i.kernelInitializer,delete i.kernelRegularizer,delete i.kernelConstraint,i.depthwiseInitializer=Ii(this.depthwiseInitializer),i.pointwiseInitializer=Ii(this.pointwiseInitializer),i.depthwiseRegularizer=ri(this.depthwiseRegularizer),i.pointwiseRegularizer=ri(this.pointwiseRegularizer),i.depthwiseConstraint=Oi(this.depthwiseConstraint),i.pointwiseConstraint=Oi(this.pointwiseConstraint),i},o.className="SeparableConv",o}(Ol),c2=function(s){function o(i){return s.call(this,2,i)||this}return ft(o,s),o.className="SeparableConv2D",o}(kr);bt.registerClass(c2);var dy=function(s){function o(i){var a=s.call(this,1,i)||this;return o.verifyArgs(i),a.inputSpec=[{ndim:3}],a}return ft(o,s),o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this);return delete i.rank,delete i.dataFormat,i},o.verifyArgs=function(i){if("number"!=typeof i.kernelSize&&!dg(i.kernelSize,"number",1,1))throw new Ne("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(i.kernelSize)+".")},o.className="Conv1D",o}(Ol);bt.registerClass(dy);var uy=function(s){function o(i){var a=s.call(this,i)||this;return a.cropping="number"==typeof i.cropping?[[i.cropping,i.cropping],[i.cropping,i.cropping]]:"number"==typeof i.cropping[0]?[[i.cropping[0],i.cropping[0]],[i.cropping[1],i.cropping[1]]]:i.cropping,a.dataFormat=void 0===i.dataFormat?"channelsLast":i.dataFormat,a.inputSpec=[{ndim:4}],a}return ft(o,s),o.prototype.computeOutputShape=function(i){return"channelsFirst"===this.dataFormat?[i[0],i[1],i[2]-this.cropping[0][0]-this.cropping[0][1],i[3]-this.cropping[1][0]-this.cropping[1][1]]:[i[0],i[1]-this.cropping[0][0]-this.cropping[0][1],i[2]-this.cropping[1][0]-this.cropping[1][1],i[3]]},o.prototype.call=function(i,a){var c=this;return $e(function(){return i=Qn(i),"channelsLast"===c.dataFormat?hg(hg(i,c.cropping[0][0],i.shape[1]-c.cropping[0][0]-c.cropping[0][1],2),c.cropping[1][0],i.shape[2]-c.cropping[1][1]-c.cropping[1][0],3):hg(hg(i,c.cropping[0][0],i.shape[2]-c.cropping[0][0]-c.cropping[0][1],3),c.cropping[1][0],i.shape[3]-c.cropping[1][1]-c.cropping[1][0],4)})},o.prototype.getConfig=function(){var i={cropping:this.cropping,dataFormat:this.dataFormat},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Cropping2D",o}(ii);bt.registerClass(uy);var uC=function(s){function o(i){var a=s.call(this,i)||this;return a.DEFAULT_SIZE=[2,2],a.inputSpec=[{ndim:4}],a.size=null==i.size?a.DEFAULT_SIZE:i.size,a.dataFormat=null==i.dataFormat?"channelsLast":i.dataFormat,a}return ft(o,s),o.prototype.computeOutputShape=function(i){if("channelsFirst"===this.dataFormat){var a=null==i[2]?null:this.size[0]*i[2],c=null==i[3]?null:this.size[1]*i[3];return[i[0],i[1],a,c]}return[i[0],a=null==i[1]?null:this.size[0]*i[1],c=null==i[2]?null:this.size[1]*i[2],i[3]]},o.prototype.call=function(i,a){var c=this;return $e(function(){var u=Qn(i),p=u.shape;if("channelsFirst"===c.dataFormat){u=ur(u,[0,2,3,1]);var m=c.size[0]*p[2],g=c.size[1]*p[3],v=u.resizeNearestNeighbor([m,g]);return ur(v,[0,3,1,2])}return u.resizeNearestNeighbor([m=c.size[0]*p[1],g=c.size[1]*p[2]])})},o.prototype.getConfig=function(){var i={size:this.size,dataFormat:this.dataFormat},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="UpSampling2D",o}(ii);bt.registerClass(uC);var hy=function(s){function o(i){var a=s.call(this,2,i)||this;return a.depthwiseKernel=null,a.depthMultiplier=null==i.depthMultiplier?1:i.depthMultiplier,a.depthwiseInitializer=lr(i.depthwiseInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.depthwiseConstraint=Dr(i.depthwiseConstraint),a.depthwiseRegularizer=fi(i.depthwiseRegularizer),a}return ft(o,s),o.prototype.build=function(i){if((i=Qi(i)).length<4)throw new Ne("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(i)+".");var a="channelsFirst"===this.dataFormat?1:3;if(null==i[a]||i[a]<0)throw new Ne("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+i[a]+").");var c=i[a];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],c,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[c*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){var u=function hC(s,o,i,a,c,u){return void 0===i&&(i=[1,1]),void 0===a&&(a="valid"),$e(function(){null==c&&(c="channelsLast"),Wr(c);var p=Tg(s,c);if(4!==s.rank)throw new Ne("Input for depthwiseConv2d is required to be 4-D, but is instead "+s.rank+"-D");if(4!==o.rank)throw new Ne("depthwiseKernel is required to be 4-D, but is instead "+o.rank+"-D");return p=nd(p,o,i,"same"===a?"same":"valid","NHWC",u),"channelsFirst"===c&&(p=ur(p,[0,3,1,2])),p})}(i=Qn(i),c.depthwiseKernel.read(),c.strides,c.padding,c.dataFormat,null);return c.useBias&&(u=vs(u,c.bias.read(),c.dataFormat)),null!=c.activation&&(u=c.activation.apply(u)),u})},o.prototype.computeOutputShape=function(i){i=Qi(i);var c="channelsFirst"===this.dataFormat?i[3]:i[2],u="channelsFirst"===this.dataFormat?i[1]*this.depthMultiplier:i[3]*this.depthMultiplier,p=fc("channelsFirst"===this.dataFormat?i[2]:i[1],this.kernelSize[0],this.padding,this.strides[0]),m=fc(c,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[i[0],u,p,m]:[i[0],p,m,u]},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this);return i.depthMultiplier=this.depthMultiplier,i.depthwiseInitializer=Ii(this.depthwiseInitializer),i.depthwiseRegularizer=ri(this.depthwiseRegularizer),i.depthwiseConstraint=Oi(this.depthwiseRegularizer),i},o.className="DepthwiseConv2D",o}(dC);bt.registerClass(hy);var py=function(s){function o(i){var a=s.call(this,i)||this;return a.rate=Math.max(Math.min(i.rate,1),0),a.noiseShape=i.noiseShape,a.seed=i.seed,a.supportsMasking=!0,a}return ft(o,s),o.prototype.getNoiseShape=function(i){if(null==this.noiseShape)return this.noiseShape;for(var a=i.shape,c=[],u=0;u<this.noiseShape.length;++u)c.push(null==this.noiseShape[u]?a[u]:this.noiseShape[u]);return c},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i);if(0<c.rate&&c.rate<1){var p=null!=a.training&&a.training,m=c.getNoiseShape(u);return Ml(function(){return Rp(u,c.rate,m,c.seed)},function(){return u},p)}return i})},o.prototype.getConfig=function(){var i={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.prototype.dispose=function(){return s.prototype.dispose.call(this)},o.className="Dropout",o}(ii);bt.registerClass(py);var fy=function(s){function o(i){var a=s.call(this,i)||this;if(a.activation=null,a.useBias=!0,a.kernel=null,a.bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",null==i.batchInputShape&&null==i.inputShape&&null!=i.inputDim){var c=null;null!=i.batchSize&&(c=i.batchSize),a.batchInputShape=[c,i.inputDim]}return a.units=i.units,xo(a.units,"units"),a.activation=Fl(i.activation),null!=i.useBias&&(a.useBias=i.useBias),a.kernelInitializer=lr(i.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.biasInitializer=lr(i.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.kernelConstraint=Dr(i.kernelConstraint),a.biasConstraint=Dr(i.biasConstraint),a.kernelRegularizer=fi(i.kernelRegularizer),a.biasRegularizer=fi(i.biasRegularizer),a.activityRegularizer=fi(i.activityRegularizer),a.supportsMasking=!0,a.inputSpec=[{minNDim:2}],a}return ft(o,s),o.prototype.build=function(i){var a,c=(i=Qi(i))[i.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[c,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(a={},a[-1]=c,a)}],this.built=!0},o.prototype.computeOutputShape=function(i){var a=(i=Qi(i)).slice();return a[a.length-1]=this.units,a},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u,p=Qn(i),m=c1(c.activation.getClassName());return null!=m?u=qs(p,c.kernel.read(),m,c.bias?c.bias.read():null):(u=qs(p,c.kernel.read()),null!=c.bias&&(u=vs(u,c.bias.read())),null!=c.activation&&(u=c.activation.apply(u))),u})},o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),biasInitializer:Ii(this.biasInitializer),kernelRegularizer:ri(this.kernelRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),biasConstraint:Oi(this.biasConstraint)},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Dense",o}(ii);bt.registerClass(fy);var pC=function(s){function o(i){var a=s.call(this,i||{})||this;return a.inputSpec=[{minNDim:3}],a}return ft(o,s),o.prototype.computeOutputShape=function(i){for(var a=0,c=(i=Qi(i)).slice(1);a<c.length;a++)if(null==c[a])throw new Ne('The shape of the input to "Flatten" is not fully defined (got '+i.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[i[0],kl(i,1)]},o.prototype.call=function(i,a){var c=this;return $e(function(){return c.invokeCallHook(i,a),function vM(s){if(s.rank<=1)throw new Ne("batchFlatten requires a minimum rank of 2. Got rank: "+s.rank+".");var o=[s.shape[0],kl(s.shape,1)];return s.reshape(o)}(Qn(i))})},o.className="Flatten",o}(ii);bt.registerClass(pC);var fC=function(s){function o(i){var a=s.call(this,i)||this;return a.supportsMasking=!0,a.activation=Fl(i.activation),a}return ft(o,s),o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i);return c.activation.apply(u)})},o.prototype.getConfig=function(){var i={activation:ja(this.activation)},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Activation",o}(ii);bt.registerClass(fC);var mC=function(s){function o(i){var a=s.call(this,i)||this;return a.n=i.n,a.inputSpec=[{ndim:2}],a}return ft(o,s),o.prototype.computeOutputShape=function(i){return[i[0],this.n,i[1]]},o.prototype.call=function(i,a){var c=this;return $e(function(){return function Tb(s,o){return $e(function(){if(2!==s.shape.length)throw new Ne("repeat() expects a rank-2 tensor, but received a rank-"+s.shape.length+" tensor.");return Ab(Ip(s,1),[1,o,1])})}(i=Qn(i),c.n)})},o.prototype.getConfig=function(){var i={n:this.n},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="RepeatVector",o}(ii);bt.registerClass(mC);var Ju=function(s){function o(i){var a=s.call(this,i)||this;a.targetShape=i.targetShape;for(var c=0;c<a.targetShape.length;++c)a.isUnknown(a.targetShape[c])&&(a.targetShape[c]=null);return a}return ft(o,s),o.prototype.isUnknown=function(i){return i<0||null==i},o.prototype.fixUnknownDimension=function(i,a){for(var c="Total size of new array must be unchanged.",u=a.slice(),p=1,m=null,g=0;g<u.length;++g){var v=u[g];if(this.isUnknown(v)){if(null!==m)throw new Ne("Can only specifiy one unknown dimension.");m=g}else p*=v}var y=kl(i);if(null!==m){if(0===p||y%p!=0)throw new Ne(c);u[m]=y/p}else if(y!==p)throw new Ne(c);return u},o.prototype.computeOutputShape=function(i){for(var a=!1,c=0;c<i.length;++c)if(this.isUnknown(i[c])){a=!0;break}return a?i.slice(0,1).concat(this.targetShape):i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape))},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i),p=u.shape,m=p.slice(0,1).concat(c.fixUnknownDimension(p.slice(1),c.targetShape));return u.reshape(m)})},o.prototype.getConfig=function(){var i={targetShape:this.targetShape},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Reshape",o}(ii);bt.registerClass(Ju);var gC=function(s){function o(i){var a=s.call(this,i)||this;if(null==i.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(i.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+i.dims+" instead.");var c=is(1,i.dims.length+1);if(!qe.arraysEqual(i.dims.slice().sort(),c))throw new Error("Invalid permutation `dims`: "+JSON.stringify(i.dims)+" `dims` must contain consecutive integers starting from 1.");return a.dims=i.dims,a.dimsIncludingBatch=[0].concat(a.dims),a.inputSpec=[new Nr({ndim:a.dims.length+1})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){var a=(i=Qi(i)).slice();return this.dims.forEach(function(c,u){a[u+1]=i[c]}),a},o.prototype.call=function(i,a){return ur(Qn(i),this.dimsIncludingBatch)},o.prototype.getConfig=function(){var i={dims:this.dims},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Permute",o}(ii);bt.registerClass(gC);var _C=function(s){function o(i){var a=s.call(this,i??{})||this;return a.supportsMasking=!0,a.maskValue=null!=i?null==i.maskValue?0:i.maskValue:0,a}return ft(o,s),o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this),a={maskValue:this.maskValue};return Object.assign(a,i),a},o.prototype.computeMask=function(i,a){var c=Qn(i);return sd(ed(c,this.maskValue),-1)},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i),p=sd(ed(u,c.maskValue),-1,!0);return u.mul(p.asType(u.dtype))})},o.className="Masking",o}(ii);bt.registerClass(_C);var vC=function(s){function o(i){var a=s.call(this,i)||this;if(a.embeddings=null,a.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==i.batchInputShape&&null==i.inputShape){var c=null;null!=i.batchSize&&(c=i.batchSize),a.batchInputShape=null==i.inputLength?[c,null]:[c].concat(Zi(i.inputLength))}return a.inputDim=i.inputDim,xo(a.inputDim,"inputDim"),a.outputDim=i.outputDim,xo(a.outputDim,"outputDim"),a.embeddingsInitializer=lr(i.embeddingsInitializer||a.DEFAULT_EMBEDDINGS_INITIALIZER),a.embeddingsRegularizer=fi(i.embeddingsRegularizer),a.activityRegularizer=fi(i.activityRegularizer),a.embeddingsConstraint=Dr(i.embeddingsConstraint),a.maskZero=i.maskZero,a.supportsMasking=i.maskZero,a.inputLength=i.inputLength,a}return ft(o,s),o.prototype.build=function(i){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},o.prototype.warnOnIncompatibleInputShape=function(i){},o.prototype.computeMask=function(i,a){var c=this;return $e(function(){return c.maskZero?(i=Qn(i),ed(i,$n(i))):null})},o.prototype.computeOutputShape=function(i){if(i=Qi(i),null==this.inputLength)return i.concat([this.outputDim]);var a=Zi(this.inputLength);if(a.length!==i.length-1)throw new Ne('"inputLength" is '+this.inputLength+", but received input shape has shape "+i);for(var c=0,u=0;u<a.length;++u){var p=a[u],m=i[u+1];if(null!=p&&null!=m&&p!==m)throw new Ne('"inputLength" is '+this.inputLength+", but received input shape has shape "+i);null==p&&(a[c]=m),c++}return[i[0]].concat(a,[this.outputDim])},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i);return"int32"!==u.dtype&&(u=Tp(u,"int32")),v1(c.embeddings.read(),u.as1D()).reshape(Qi(c.computeOutputShape(u.shape)))})},o.prototype.getConfig=function(){var i={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ii(this.embeddingsInitializer),embeddingsRegularizer:ri(this.embeddingsRegularizer),activityRegularizer:ri(this.activityRegularizer),embeddingsConstraint:Oi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Embedding",o}(ii);bt.registerClass(vC);var el=function(s){function o(i){var a=s.call(this,i||{})||this;return a.supportsMasking=!0,a}return ft(o,s),o.prototype.mergeFunction=function(i){throw new ni},o.prototype.computeElementwiseOpOutputShape=function(i,a){if(null==i||null==a)return null;if(i.length<a.length)return this.computeElementwiseOpOutputShape(a,i);if(0===a.length)return i;for(var c=i.slice(0,i.length-a.length),u=0;u<a.length;++u){var p=i[i.length-a.length+u],m=a[u];if(null==p||null==m||p<0||m<0)c.push(null);else if(1===p)c.push(m);else if(1===m)c.push(p);else{if(p!==m)throw new Ne("Operands could not be broadcast together with shapes "+JSON.stringify(i)+" "+JSON.stringify(a));c.push(p)}}return c},o.prototype.build=function(i){if(Array.isArray(i)&&!Array.isArray(i[0])&&(i=[Qi(i)]),i.length<2)throw new Ne("A merge layer should be called on an Array of at least 2 inputs. Got "+i.length+" input(s).");for(var a=[],c=0,u=i;c<u.length;c++)null!=(g=u[c])&&null!==g[0]&&a.push(g[0]);if((a=El(a)).length>1)throw new Ne("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(i)+".");for(var p=null==i[0]?null:i[0].slice(1),m=1;m<i.length;++m){var g=null==i[m]?null:i[m].slice(1);p=this.computeElementwiseOpOutputShape(p,g)}var v=i.map(function(y){return y.length});this.reshapeRequired=-1!==i.indexOf(null)||1!==El(v).length},o.prototype.call=function(i,a){var c=this;return $e(function(){if(c.reshapeRequired){var u=[],p=i.map(function(fe){return fe.rank});if(-1===p.indexOf(null)){for(var m=sc(p),g=0,v=i;g<v.length;g++){for(var y=(N=v[g]).rank,C=0;C<m-y;++C)N=Ip(N,1);u.push(N)}return c.mergeFunction(u)}for(var S=!1,M=0,O=i;M<O.length;M++){var N;if(null==(y=(N=O[M]).rank)){var P=N.shape,B=P[0],W=P.slice(1).concat([B]),G=N.reshape([B].concat(kl(P.slice(1))));G=(G=ur(G,[1,0])).reshape(W),u.push(G),S=!0}else if(y>1){var X=is(1,y).concat([0]);u.push(ur(N,X)),S=!0}else u.push(N)}var Q=c.mergeFunction(u),se=Q.rank;if(S)if(null==se){var ue=Q.shape;W=[B=ue[ue.length-1]].concat(ue.slice(0,ue.length-1)),Q=ur(Q.reshape([-1,B]),[1,0]).reshape(W)}else se>1&&(X=[se-1].concat(is(0,se-1)),Q=ur(Q,X));return Q}return c.mergeFunction(i)})},o.prototype.computeOutputShape=function(i){var a;a=null==i[0]?null:i[0].slice(1);for(var c=1;c<i.length;++c){var u=null==i[c]?null:i[c].slice(1);a=this.computeElementwiseOpOutputShape(a,u)}for(var p=[],m=0,g=i;m<g.length;m++)null!=(u=g[m])&&null!==u[0]&&p.push(u[0]);return 1===(p=El(p)).length?p.concat(a):[null].concat(a)},o.prototype.computeMask=function(i,a){return $e(function(){if(null==a)return null;if(!Array.isArray(a))throw new Ne("`mask` should be an Array");if(!Array.isArray(i))throw new Ne("`inputs` should be an Array");if(a.length!==i.length)throw new Ne("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+i.length+" vs "+a.length+")");if(a.every(function(p){return null==p}))return null;for(var c=(a=a.map(function(p){return null==p?p:Lo(p,0)}))[0],u=1;u<a.length-1;++u)c=fs(c,a[u]);return c})},o}(ii),my=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.mergeFunction=function(i){return $e(function(){for(var a=i[0].clone(),c=1;c<i.length;++c)a=ai(a,i[c]);return a})},o.className="Add",o}(el);bt.registerClass(my);var gy=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.mergeFunction=function(i){return $e(function(){for(var a=i[0].clone(),c=1;c<i.length;++c)a=Vn(a,i[c]);return a})},o.className="Multiply",o}(el);bt.registerClass(gy);var _y=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.mergeFunction=function(i){return $e(function(){for(var a=i[0].clone(),c=1;c<i.length;++c)a=ai(a,i[c]);return Vn(1/i.length,a)})},o.className="Average",o}(el);bt.registerClass(_y);var bC=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.mergeFunction=function(i){return $e(function(){for(var a=i[0],c=1;c<i.length;++c)a=zs(a,i[c]);return a})},o.className="Maximum",o}(el);bt.registerClass(bC);var eh=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.mergeFunction=function(i){return $e(function(){for(var a=i[0],c=1;c<i.length;++c)a=Yl(a,i[c]);return a})},o.className="Minimum",o}(el);bt.registerClass(eh);var th=function(s){function o(i){var a=s.call(this,i)||this;return a.DEFAULT_AXIS=-1,null==i&&(i={}),a.axis=null==i.axis?a.DEFAULT_AXIS:i.axis,a.supportsMasking=!0,a.reshapeRequired=!1,a}return ft(o,s),o.prototype.build=function(i){if(!Array.isArray(i)||!Array.isArray(i[0])||1===i.length)throw new Ne("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var a=!0,c=0,u=i;c<u.length;c++)if(null!=(S=u[c])){a=!1;break}if(!a){for(var p=[],m=0;m<i.length;++m){var g=i[m].slice();g.splice(this.axis,1);for(var v=!1,y=0,C=p;y<C.length;y++){var S=C[y];if(qe.arraysEqual(S,g)){v=!0;break}}v||p.push(g)}if(p.length>1)throw new Ne("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(i))}},o.prototype.mergeFunction=function(i){var a=this;return $e(function(){return _s(i,a.axis)})},o.prototype.computeOutputShape=function(i){if(!Array.isArray(i)||!Array.isArray(i[0]))throw new Ne("A `Concatenate` layer should be called on a list of inputs.");for(var a=i,c=a[0].slice(),u=this.axis<0?c.length+this.axis:this.axis,p=0,m=a.slice(1);p<m.length;p++){var g=m[p];if(null==c[u]||null==g[u]){c[u]=null;break}c[u]+=g[u]}return c},o.prototype.computeMask=function(i,a){var c=this;if(null==a)return null;if(!Array.isArray(a))throw new Ne("`mask` should be an array for Concatenate");if(!Array.isArray(i))throw new Ne("`inputs` should be an array for Concatenate");if(a.length!==i.length)throw new Ne("Mismatch in the length of mask ("+a.length+") and the legnth of inputs ("+i.length+")");return $e(function(){var u=!0;if(a.forEach(function(v){null==v||(u=!1)}),u)return null;for(var p=[],m=0;m<i.length;++m)p.push(null==a[m]?ua(i[m]).asType("bool"):a[m].rank<i[m].rank?Lo(a[m],-1):a[m]);var g=Ur(p,c.axis);return ad(g,-1,!1)})},o.prototype.getConfig=function(){var i={axis:this.axis},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Concatenate",o}(el);function Xp(s,o){for(;s<0;)s+=o;return s}bt.registerClass(th);var yC=function(s){function o(i){var a=s.call(this,i)||this;return a.axes=i.axes,a.normalize=null!=i.normalize&&i.normalize,a.supportsMasking=!0,a.reshapeRequired=!1,a}return ft(o,s),o.prototype.build=function(i){qe.assert(Array.isArray(i)&&2===i.length&&Array.isArray(i[0])&&Array.isArray(i[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var a=i[0],c=i[1];if(a.length>3||c.length>3)throw new ni("Dot layer does not support tensors of 4D or higher rank yet.");var u=this.interpretAxes(a,c);if(a[u[0]]!==c[u[1]])throw new Ne("Dimension incompatibility: "+a[u[0]]+" !== "+c[u[1]])},o.prototype.mergeFunction=function(i){if(2!==i.length)throw new Ne("A `Dot` layer must be called on exactly 2 inputs, but received "+i.length+" input(s).");var a,c=i[0],u=i[1];return a=Array.isArray(this.axes)?this.axes.map(function(p,m){return Xp(p,i[m].shape.length)}):[Xp(this.axes,c.shape.length),Xp(this.axes,u.shape.length)],this.normalize&&(c=vg(c,a[0]),u=vg(u,a[1])),function d2(s,o,i){if(s.shape.length>3||o.shape.length>3)throw new ni("batchDot is not implemented for tensors of 4D or higher rank yet");if(qe.assert(s.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+s.shape.length}),qe.assert(s.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+o.shape.length}),"number"==typeof i&&(i=[i,i]),"complex64"===s.dtype||"complex64"===o.dtype)throw new ni("batchDot is not implemented for complex64-type Tensors yet.");var a=s.shape.length,c=o.shape.length;null==i&&(i=[a-1,c-2]);var u=i;return $e(function(){var p,m;if(a>c){p=a-c;for(var g=[],v=0;v<p;++v)g.push(1);o=o.reshape(o.shape.concat(g))}else if(c>a){for(p=c-a,g=[],v=0;v<p;++v)g.push(1);s=s.reshape(s.shape.concat(g))}else p=0;if(m=2===s.shape.length&&2===o.shape.length?u[0]===u[1]?s.mulStrict(o).sum(u[0]):s.transpose([1,0]).mulStrict(o).sum(u[1]):s.matMul(o,u[0]!==s.shape.length-1,u[1]===o.shape.length-1),p>0){var S,M=[];for(v=S=a>c?a+c-3:a-1;v<S+p;++v)M.push(v);m=m.squeeze(M)}return 1===m.shape.length&&(m=m.expandDims(1)),m})}(c,u,a)},o.prototype.interpretAxes=function(i,a){return Array.isArray(this.axes)?this.axes:[Xp(this.axes,i.length),Xp(this.axes,a.length)]},o.prototype.computeOutputShape=function(i){qe.assert(Array.isArray(i)&&2===i.length&&Array.isArray(i[0])&&Array.isArray(i[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var a=i[0].slice(),c=i[1].slice();if(a.length>3||c.length>3)throw new ni("Dot layer does not support tensors of 4D or higher rank yet.");var u=this.interpretAxes(a,c);a.splice(u[0],1),c.splice(u[1],1),c.splice(0,1);var p=a.concat(c);return 1===p.length&&p.push(1),p},o.prototype.computeMask=function(i,a){return null},o.prototype.getConfig=function(){var i={axes:this.axes,normalize:this.normalize},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="Dot",o}(el);bt.registerClass(yC);var vy=function(s){function o(i){var a=s.call(this,i)||this;return a.supportsMasking=!0,a.stddev=i.stddev,a}return ft(o,s),o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this),a={stddev:this.stddev};return Object.assign(a,i),a},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i);return Ml(function(){return fg(u.shape,0,c.stddev).add(u)},function(){return u},a.training||!1)})},o.className="GaussianNoise",o}(ii);bt.registerClass(vy);var by=function(s){function o(i){var a=s.call(this,i)||this;return a.supportsMasking=!0,a.rate=i.rate,a}return ft(o,s),o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this),a={rate:this.rate};return Object.assign(a,i),a},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a);var u=Qn(i);return c.rate>0&&c.rate<1?Ml(function(){var p=Math.sqrt(c.rate/(1-c.rate));return u.mul(fg(u.shape,1,p))},function(){return u},a.training||!1):u})},o.className="GaussianDropout",o}(ii);bt.registerClass(by);var yy=function(s){function o(i){var a=s.call(this,i)||this;return a.supportsMasking=!0,a.rate=i.rate,a.noiseShape=i.noiseShape,a}return ft(o,s),o.prototype._getNoiseShape=function(i){return this.noiseShape||Qn(i).shape},o.prototype.computeOutputShape=function(i){return i},o.prototype.getConfig=function(){var i=s.prototype.getConfig.call(this),a={rate:this.rate};return Object.assign(a,i),a},o.prototype.call=function(i,a){var c=this;return $e(function(){if(c.rate<1&&c.rate>0){var u=c._getNoiseShape(i);return Ml(function(){var p=Qn(i),m=-1.7580993408473766,g=gp(Hl(u),c.rate);g=Tp(g,"float32");var v=Math.pow((1-c.rate)*(1+c.rate*Math.pow(m,2)),-.5),y=-v*m*c.rate;return p.mul(g).add(g.add(-1).mul(m)).mul(v).add(y)},function(){return Qn(i)},a.training||!1)}return i})},o.className="AlphaDropout",o}(ii);function Zp(s,o,i,a,c,u){var p;if(void 0===u&&(u=.001),2===s.rank)p=Dv(s,o,i,a,c,u);else if(3===s.rank)p=Ev(s,o,i,a,c,u);else{if(4!==s.rank)throw new ni("batchNormalization is not implemented for array of rank "+s.rank+" yet");p=Ho(s,o,i,a,c,u)}return p}bt.registerClass(yy);var p2=function(s){function o(i){var a=this;return null==i&&(i={}),(a=s.call(this,i)||this).supportsMasking=!0,a.axis=null==i.axis?-1:i.axis,a.momentum=null==i.momentum?.99:i.momentum,a.epsilon=null==i.epsilon?.001:i.epsilon,a.center=null==i.center||i.center,a.scale=null==i.scale||i.scale,a.betaInitializer=lr(i.betaInitializer||"zeros"),a.gammaInitializer=lr(i.gammaInitializer||"ones"),a.movingMeanInitializer=lr(i.movingMeanInitializer||"zeros"),a.movingVarianceInitializer=lr(i.movingVarianceInitializer||"ones"),a.betaConstraint=Dr(i.betaConstraint),a.gammaConstraint=Dr(i.gammaConstraint),a.betaRegularizer=fi(i.betaRegularizer),a.gammaRegularizer=fi(i.gammaRegularizer),a}return ft(o,s),o.prototype.build=function(i){var a;i=Qi(i);var c=this.axis>=0?this.axis:this.axis+i.length,u=i[c];if(null==u)throw new Ne("Axis "+c+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(i)+".");this.inputSpec=[new Nr({ndim:i.length,axes:(a={},a[c]=u,a)})];var p=[u];this.scale&&(this.gamma=this.addWeight("gamma",p,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",p,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",p,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",p,null,this.movingVarianceInitializer,null,!1),this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){var u=null!=a.training&&a.training,p=Qn(i),m=p.shape,g=m.length,v=is(0,g),y=c.axis>=0?c.axis:c.axis+g;v.splice(y,1);var C=Uu(1,g);C[y]=m[y];var S=v.slice();S.sort();var M=!qe.arraysEqual(S,is(0,g).slice(0,g-1));if(!u)return function(){if(M){var G=c.movingMean.read().reshape(C),X=c.movingVariance.read().reshape(C),Q=c.center?c.beta.read().reshape(C):null,se=c.scale?c.gamma.read().reshape(C):null;return Zp(p,G,X,Q,se,c.epsilon)}return Zp(p,c.movingMean.read(),c.movingVariance.read(),null==c.beta?null:c.beta.read(),null==c.gamma?null:c.gamma.read(),c.epsilon)}();var O=function h2(s,o,i,a,c){return void 0===c&&(c=.001),qe.arraysEqual(a.slice().sort(),is(0,s.rank-1))?function xC(s,o,i,a,c){return void 0===c&&(c=.001),$e(function(){var u=vp(s,a),p=u.mean,m=u.variance;return[Zp(s,p,m,i,o,c),p,m]})}(s,o,i,a,c):function u2(s,o,i,a,c){return void 0===c&&(c=.001),$e(function(){for(var u=vp(s,a),p=u.mean,m=u.variance,g=[],v=0,y=is(0,s.rank);v<y.length;v++){var C=y[v];-1!==a.indexOf(C)?g.push(1):g.push(s.shape[C])}var S=p.reshape(g),M=m.reshape(g),O=null==o?null:o.reshape(g),N=null==i?null:i.reshape(g);return[Zp(s,S,M,N,O,c),p,m]})}(s,o,i,a,c)}(p,c.gamma.read(),c.beta.read(),v,c.epsilon),N=O[0],B=O[2],W=function(G,X,Q){$e(function(){var se=1-Q,ue=G.read(),fe=ue.sub(X).mul(se);G.write(ue.sub(fe))})};return W(c.movingMean,O[1],c.momentum),W(c.movingVariance,B,c.momentum),N})},o.prototype.getConfig=function(){var i={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ii(this.betaInitializer),gammaInitializer:Ii(this.gammaInitializer),movingMeanInitializer:Ii(this.movingMeanInitializer),movingVarianceInitializer:Ii(this.movingVarianceInitializer),betaRegularizer:ri(this.betaRegularizer),gammaRegularizer:ri(this.gammaRegularizer),betaConstraint:Oi(this.betaConstraint),gammaConstraint:Oi(this.gammaConstraint)},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="BatchNormalization",o}(ii);bt.registerClass(p2);var f2=function(s){function o(i){var a=this;if(null==i&&(i={}),(a=s.call(this,i)||this).axis=null==i.axis?-1:i.axis,"number"==typeof a.axis){if(!Number.isInteger(a.axis))throw new Error("Expected axis to be an integer, but received "+a.axis)}else{if(!Array.isArray(a.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(a.axis));for(var c=0,u=a.axis;c<u.length;c++)if(!Number.isInteger(u[c]))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(a.axis))}return a.epsilon=null==i.epsilon?.001:i.epsilon,a.center=null==i.center||i.center,a.scale=null==i.scale||i.scale,a.betaInitializer=lr(i.betaInitializer||"zeros"),a.gammaInitializer=lr(i.gammaInitializer||"ones"),a.betaRegularizer=fi(i.betaRegularizer),a.gammaRegularizer=fi(i.gammaRegularizer),a.supportsMasking=!0,a}return ft(o,s),o.prototype.build=function(i){var a=(i=Qi(i)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var c=0;c<this.axis.length;++c)this.axis[c]<0&&(this.axis[c]+=a);for(var u=0,p=this.axis;u<p.length;u++){var m=p[u];if(m<0||m>=a)throw new Error("Invalid axis: "+m)}if(this.axis.length!==El(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var g=this.axis.map(function(v){return i[v]});this.gamma=this.scale?this.addWeight("gamma",g,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",g,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0},o.prototype.call=function(i,a){var c=this,u=Qn(i),p=u.shape,m=p.length;return $e(function(){for(var g=vp(u,c.axis,!0),v=g.mean,y=g.variance,C=Uu(1,m),S=0,M=c.axis;S<M.length;S++){var O=M[S];C[O]=p[O]}for(var N=function(Q){return null!=Q&&Q.shape.length!==m&&c.axis!==[m-1]?Q.reshape(C):Q},P=N(c.gamma.read()),B=N(c.beta.read()),W=[],G=[],X=0;X<m;++X)-1!==c.axis.indexOf(X)?(W.push(p[X]),G.push(1)):(W.push(1),G.push(p[X]));return v=v.tile(W),y=y.tile(W),P=P.tile(G),B=B.tile(G),Zp(u,v,y,B,P,c.epsilon)})},o.prototype.getConfig=function(){var i={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ii(this.betaInitializer),gammaInitializer:Ii(this.gammaInitializer),betaRegularizer:ri(this.betaRegularizer),gammaRegularizer:ri(this.gammaRegularizer)},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="LayerNormalization",o}(ii);bt.registerClass(f2);var m2=function(s){function o(i){var a=this;if(null==i&&(i={}),(a=s.call(this,i)||this).dataFormat=null==i.dataFormat?"channelsLast":i.dataFormat,null==i.padding)a.padding=[[1,1],[1,1]];else if("number"==typeof i.padding)a.padding=[[i.padding,i.padding],[i.padding,i.padding]];else{if(i.padding=i.padding,2!==i.padding.length)throw new Ne("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+i.padding.length+" array.");var c=void 0,u=void 0;if("number"==typeof i.padding[0])c=[i.padding[0],i.padding[0]],u=[i.padding[1],i.padding[1]];else{if(i.padding=i.padding,2!==i.padding[0].length)throw new Ne("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+i.padding[0].length+" array.");if(c=i.padding[0],2!==i.padding[1].length)throw new Ne("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+i.padding[1].length+" array.");u=i.padding[1]}a.padding=[c,u]}return a.inputSpec=[new Nr({ndim:4})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){return i=Qi(i),"channelsFirst"===this.dataFormat?[i[0],i[1],null!=i[2]&&i[2]>=0?i[2]+this.padding[0][0]+this.padding[0][1]:null,null!=i[3]&&i[3]>=0?i[3]+this.padding[1][0]+this.padding[1][1]:null]:[i[0],null!=i[1]&&i[1]>=0?i[1]+this.padding[0][0]+this.padding[0][1]:null,null!=i[2]&&i[2]>=0?i[2]+this.padding[1][0]+this.padding[1][1]:null,i[3]]},o.prototype.call=function(i,a){var c=this;return $e(function(){return function DF(s,o,i){return $e(function(){if(4!==s.rank)throw new Ne("temporalPadding expects input tensor to be 4-D, but received a "+s.rank+"-D tensor.");if(null==o&&(o=[[1,1],[1,1]]),2!==o.length||2!==o[0].length||2!==o[1].length)throw new Ne("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==i&&(i="channelsLast"),"channelsLast"!==i&&"channelsFirst"!==i)throw new Ne("Unknown data format: "+i+". Supported data formats are 'channelsLast' and 'channelsFirst.");return Xa(s,"channelsFirst"===i?[[0,0],[0,0],o[0],o[1]]:[[0,0],o[0],o[1],[0,0]])})}(Qn(i),c.padding,c.dataFormat)})},o.prototype.getConfig=function(){var i={padding:this.padding,dataFormat:this.dataFormat},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="ZeroPadding2D",o}(ii);function xy(s,o,i,a,c,u){return $e(function(){var p;Wr(c),g1(u),Ua(a),null==i&&(i=[1,1]),null==a&&(a="valid"),null==c&&(c="channelsLast"),null==u&&(u="max"),s=Tg(s,c);var m="same"===a?"same":"valid";return p="max"===u?_p(s,o,i,m):rd(s,o,i,m),"channelsFirst"===c&&(p=ur(p,[0,3,1,2])),p})}function g2(s,o,i,a,c,u){return $e(function(){var p;Wr(c),g1(u),Ua(a),null==i&&(i=[1,1,1]),null==a&&(a="valid"),null==c&&(c="channelsLast"),null==u&&(u="max"),s=s2(s,c);var m="same"===a?"same":"valid";return p="max"===u?Us(s,o,i,m):zm(s,o,i,m),"channelsFirst"===c&&(p=ur(p,[0,4,1,2,3])),p})}bt.registerClass(m2);var wy=function(s){function o(i){var a=this;if(null==i.poolSize&&(i.poolSize=2),a=s.call(this,i)||this,"number"==typeof i.poolSize)a.poolSize=[i.poolSize];else{if(!Array.isArray(i.poolSize)||1!==i.poolSize.length||"number"!=typeof i.poolSize[0])throw new Ne("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(i.poolSize));a.poolSize=i.poolSize}if(xo(a.poolSize,"poolSize"),null==i.strides)a.strides=a.poolSize;else if("number"==typeof i.strides)a.strides=[i.strides];else{if(!Array.isArray(i.strides)||1!==i.strides.length||"number"!=typeof i.strides[0])throw new Ne("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(i.strides));a.strides=i.strides}return xo(a.strides,"strides"),a.padding=null==i.padding?"valid":i.padding,Ua(a.padding),a.inputSpec=[new Nr({ndim:3})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){var a=fc((i=Qi(i))[1],this.poolSize[0],this.padding,this.strides[0]);return[i[0],a,i[2]]},o.prototype.call=function(i,a){var c=this;return $e(function(){c.invokeCallHook(i,a),i=Ip(Qn(i),2);var u=c.poolingFunction(Qn(i),[c.poolSize[0],1],[c.strides[0],1],c.padding,"channelsLast");return Vc(u,[2])})},o.prototype.getConfig=function(){var i={poolSize:this.poolSize,padding:this.padding,strides:this.strides},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o}(ii),Qp=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.poolingFunction=function(i,a,c,u,p){return Wr(p),Ua(u),xy(i,a,c,u,p,"max")},o.className="MaxPooling1D",o}(wy);bt.registerClass(Qp);var wC=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.poolingFunction=function(i,a,c,u,p){return Wr(p),Ua(u),xy(i,a,c,u,p,"avg")},o.className="AveragePooling1D",o}(wy);bt.registerClass(wC);var CC=function(s){function o(i){var a=this;if(null==i.poolSize&&(i.poolSize=[2,2]),(a=s.call(this,i)||this).poolSize=Array.isArray(i.poolSize)?i.poolSize:[i.poolSize,i.poolSize],null==i.strides)a.strides=a.poolSize;else if(Array.isArray(i.strides)){if(2!==i.strides.length)throw new Ne("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+i.strides.length+".");a.strides=i.strides}else a.strides=[i.strides,i.strides];return xo(a.poolSize,"poolSize"),xo(a.strides,"strides"),a.padding=null==i.padding?"valid":i.padding,a.dataFormat=null==i.dataFormat?"channelsLast":i.dataFormat,Wr(a.dataFormat),Ua(a.padding),a.inputSpec=[new Nr({ndim:4})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){i=Qi(i);var a="channelsFirst"===this.dataFormat?i[2]:i[1],c="channelsFirst"===this.dataFormat?i[3]:i[2];return a=fc(a,this.poolSize[0],this.padding,this.strides[0]),c=fc(c,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[i[0],i[1],a,c]:[i[0],a,c,i[3]]},o.prototype.call=function(i,a){var c=this;return $e(function(){return c.invokeCallHook(i,a),c.poolingFunction(Qn(i),c.poolSize,c.strides,c.padding,c.dataFormat)})},o.prototype.getConfig=function(){var i={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o}(ii),Cy=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.poolingFunction=function(i,a,c,u,p){return Wr(p),Ua(u),xy(i,a,c,u,p,"max")},o.className="MaxPooling2D",o}(CC);bt.registerClass(Cy);var nh=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.poolingFunction=function(i,a,c,u,p){return Wr(p),Ua(u),xy(i,a,c,u,p,"avg")},o.className="AveragePooling2D",o}(CC);bt.registerClass(nh);var SC=function(s){function o(i){var a=this;if(null==i.poolSize&&(i.poolSize=[2,2,2]),(a=s.call(this,i)||this).poolSize=Array.isArray(i.poolSize)?i.poolSize:[i.poolSize,i.poolSize,i.poolSize],null==i.strides)a.strides=a.poolSize;else if(Array.isArray(i.strides)){if(3!==i.strides.length)throw new Ne("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+i.strides.length+".");a.strides=i.strides}else a.strides=[i.strides,i.strides,i.strides];return xo(a.poolSize,"poolSize"),xo(a.strides,"strides"),a.padding=null==i.padding?"valid":i.padding,a.dataFormat=null==i.dataFormat?"channelsLast":i.dataFormat,Wr(a.dataFormat),Ua(a.padding),a.inputSpec=[new Nr({ndim:5})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){i=Qi(i);var a="channelsFirst"===this.dataFormat?i[2]:i[1],c="channelsFirst"===this.dataFormat?i[3]:i[2],u="channelsFirst"===this.dataFormat?i[4]:i[3];return a=fc(a,this.poolSize[0],this.padding,this.strides[0]),c=fc(c,this.poolSize[1],this.padding,this.strides[1]),u=fc(u,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[i[0],i[1],a,c,u]:[i[0],a,c,u,i[4]]},o.prototype.call=function(i,a){var c=this;return $e(function(){return c.invokeCallHook(i,a),c.poolingFunction(Qn(i),c.poolSize,c.strides,c.padding,c.dataFormat)})},o.prototype.getConfig=function(){var i={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o}(ii),DC=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.poolingFunction=function(i,a,c,u,p){return Wr(p),Ua(u),g2(i,a,c,u,p,"max")},o.className="MaxPooling3D",o}(SC);bt.registerClass(DC);var EC=function(s){function o(i){return s.call(this,i)||this}return ft(o,s),o.prototype.poolingFunction=function(i,a,c,u,p){return Wr(p),Ua(u),g2(i,a,c,u,p,"avg")},o.className="AveragePooling3D",o}(SC);bt.registerClass(EC);var kC=function(s){function o(i){var a=s.call(this,i)||this;return a.inputSpec=[new Nr({ndim:3})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){return[i[0],i[2]]},o.prototype.call=function(i,a){throw new ni},o}(ii),MC=function(s){function o(i){return s.call(this,i||{})||this}return ft(o,s),o.prototype.call=function(i,a){return $e(function(){var c=Qn(i);return Or(c,1)})},o.className="GlobalAveragePooling1D",o}(kC);bt.registerClass(MC);var Sy=function(s){function o(i){return s.call(this,i||{})||this}return ft(o,s),o.prototype.call=function(i,a){return $e(function(){var c=Qn(i);return xa(c,1)})},o.className="GlobalMaxPooling1D",o}(kC);bt.registerClass(Sy);var TC=function(s){function o(i){var a=s.call(this,i)||this;return a.dataFormat=null==i.dataFormat?"channelsLast":i.dataFormat,Wr(a.dataFormat),a.inputSpec=[new Nr({ndim:4})],a}return ft(o,s),o.prototype.computeOutputShape=function(i){return"channelsLast"===this.dataFormat?[i[0],i[3]]:[i[0],i[1]]},o.prototype.call=function(i,a){throw new ni},o.prototype.getConfig=function(){var i={dataFormat:this.dataFormat},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o}(ii),IC=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.call=function(i,a){var c=this;return $e(function(){var u=Qn(i);return Or(u,"channelsLast"===c.dataFormat?[1,2]:[2,3])})},o.className="GlobalAveragePooling2D",o}(TC);bt.registerClass(IC);var ih=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o.prototype.call=function(i,a){var c=this;return $e(function(){var u=Qn(i);return xa(u,"channelsLast"===c.dataFormat?[1,2]:[2,3])})},o.className="GlobalMaxPooling2D",o}(TC);function AC(s,o,i,a){if(Array.isArray(s)){if(null!=o||null!=i)throw new Ne("When inputs is an array, neither initialState or constants should be provided");null!=a&&(i=s.slice(s.length-a,s.length),s=s.slice(0,s.length-a)),s.length>1&&(o=s.slice(1,s.length)),s=s[0]}function c(u){return null==u||Array.isArray(u)?u:[u]}return{inputs:s,initialState:o=c(o),constants:i=c(i)}}function Dy(s,o,i,a,c,u,p,m){return void 0===a&&(a=!1),void 0===p&&(p=!1),void 0===m&&(m=!1),$e(function(){var g=o.shape.length;if(g<3)throw new Ne("Input should be at least 3D, but is "+g+"D.");var v=[1,0].concat(is(2,g));if(o=ur(o,v),null!=u)throw new ni("The rnn() functoin of the deeplearn.js backend does not support constants yet.");p&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=c&&((c=c.asType("bool").asType("float32")).rank===g-1&&(c=Lo(c,-1)),c=ur(c,v)),a&&(o=ya(o,0),null!=c&&(c=ya(c,0)));var y,C,S=[],M=i,O=o.shape[0],N=Ja(o);null!=c&&(C=Ja(c));for(var P,B=function(G){var X=N[G],Q=$e(function(){return s(X,M)});if(null==c)y=Q[0],M=Q[1];else{var se=$e(function(){var ue=C[G],fe=ua(ue).sub(ue);return{output:Q[0].mul(ue).addStrict(M[0].mul(fe)),newStates:M.map(function(_e,me){return Q[1][me].mul(ue).addStrict(_e.mul(fe))})}});y=se.output,M=se.newStates}m&&S.push(y)},W=0;W<O;++W)B(W);return m&&(P=Qa(S,1)),[y,P,M]})}bt.registerClass(ih);var Md=function(s){function o(i){var a,c=s.call(this,i)||this;if(null==i.cell)throw new Ne("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(i.cell)?new Ag({cells:i.cell}):i.cell).stateSize)throw new Ne("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return c.cell=a,c.returnSequences=null!=i.returnSequences&&i.returnSequences,c.returnState=null!=i.returnState&&i.returnState,c.goBackwards=null!=i.goBackwards&&i.goBackwards,c._stateful=null!=i.stateful&&i.stateful,c.unroll=null!=i.unroll&&i.unroll,c.supportsMasking=!0,c.inputSpec=[new Nr({ndim:3})],c.stateSpec=null,c.states_=null,c.numConstants=null,c.keptStates=[],c}return ft(o,s),o.prototype.getStates=function(){return null==this.states_?is(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(i){return null}):this.states_},o.prototype.setStates=function(i){this.states_=i},o.prototype.computeOutputShape=function(i){k1(i)&&(i=i[0]);var a=this.cell.stateSize;Array.isArray(a)||(a=[a]);var c,u=a[0];if(c=this.returnSequences?[i[0],i[1],u]:[i[0],u],this.returnState){for(var p=[],m=0,g=a;m<g.length;m++)p.push([i[0],g[m]]);return[c].concat(p)}return c},o.prototype.computeMask=function(i,a){var c=this;return $e(function(){Array.isArray(a)&&(a=a[0]);var u=c.returnSequences?a:null;if(c.returnState){var p=c.states.map(function(m){return null});return[u].concat(p)}return u})},Object.defineProperty(o.prototype,"states",{get:function(){if(null==this.states_){for(var i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,a=[],c=0;c<i;++c)a.push(null);return a}return this.states_},set:function(i){this.states_=i},enumerable:!0,configurable:!0}),o.prototype.build=function(i){if(null!=this.numConstants)throw new ni("Constants support is not implemented in RNN yet.");k1(i)&&(i=i[0]),this.inputSpec[0]=new Nr({shape:[this.stateful?i[0]:null,null,i[i.length-1]]});var u,p=[i[0]].concat(i.slice(2));if(this.cell.build(p),u=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!qe.arraysEqual(this.stateSpec.map(function(m){return m.shape[m.shape.length-1]}),u))throw new Ne("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=u.map(function(m){return new Nr({shape:[null,m]})});this.stateful&&this.resetStates()},o.prototype.resetStates=function(i,a){var c=this;void 0===a&&(a=!1),$e(function(){if(!c.stateful)throw new pd("Cannot call resetStates() on an RNN Layer that is not stateful.");var u=c.inputSpec[0].shape[0];if(null==u)throw new Ne("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==c.states_)c.states_=Array.isArray(c.cell.stateSize)?c.cell.stateSize.map(function(y){return fn([u,y])}):[fn([u,c.cell.stateSize])];else if(null==i)Kn(c.states_),null!=c.keptStates&&(Kn(c.keptStates),c.keptStates=[]),Array.isArray(c.cell.stateSize)?c.states_=c.cell.stateSize.map(function(y){return fn([u,y])}):c.states_[0]=fn([u,c.cell.stateSize]);else{if(Array.isArray(i)||(i=[i]),i.length!==c.states_.length)throw new Ne("Layer "+c.name+" expects "+c.states_.length+" state(s), but it received "+i.length+" state value(s). Input received: "+i);!0===a?c.keptStates.push(c.states_.slice()):Kn(c.states_);for(var p=0;p<c.states_.length;++p){var m=i[p],g=Array.isArray(c.cell.stateSize)?c.cell.stateSize[p]:c.cell.stateSize,v=[u,g];if(!qe.arraysEqual(m.shape,v))throw new Ne("State "+p+" is incompatible with layer "+c.name+": expected shape="+v+", received shape="+m.shape);c.states_[p]=m}}c.states_=c.states_.map(function(y){return Ka(y.clone())})})},o.prototype.apply=function(i,a){var c=null==a?null:a.initialState,u=null==a?null:a.constants;null==a&&(a={});var p=AC(i,c,u,this.numConstants);i=p.inputs,u=p.constants;var m=[],g=[];if(null!=(c=p.initialState)){a.initialState=c,m=m.concat(c),this.stateSpec=[];for(var v=0,y=c;v<y.length;v++)this.stateSpec.push(new Nr({shape:y[v].shape}));g=g.concat(this.stateSpec)}if(null!=u&&(a.constants=u,m=m.concat(u),this.numConstants=u.length),m[0]instanceof Er){var S=[i].concat(m),M=this.inputSpec.concat(g),O=this.inputSpec;this.inputSpec=M;var N=s.prototype.apply.call(this,S,a);return this.inputSpec=O,N}return s.prototype.apply.call(this,i,a)},o.prototype.call=function(i,a){var c=this;return $e(function(){var u=null==a?null:a.mask,p=null==a?null:a.training,m=null==a?null:a.initialState;i=Qn(i),null==m&&(m=c.stateful?c.states_:c.getInitialState(i));var g=Array.isArray(c.cell.stateSize)?c.cell.stateSize.length:1;if(m.length!==g)throw new Ne("RNN Layer has "+g+" state(s) but was passed "+m.length+" initial state(s).");c.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var v={training:p},y=Dy(function(N,P){var B=c.cell.call([N].concat(P),v);return[B[0],B.slice(1)]},i,m,c.goBackwards,u,null,c.unroll,c.returnSequences),C=y[0],S=y[1],M=y[2];c.stateful&&c.resetStates(M,p);var O=c.returnSequences?S:C;return c.returnState?[O].concat(M):O})},o.prototype.getInitialState=function(i){var a=this;return $e(function(){var c=fn(i.shape);return c=Ip(c=wa(c,[1,2])),Array.isArray(a.cell.stateSize)?a.cell.stateSize.map(function(u){return u>1?Ab(c,[1,u]):c}):a.cell.stateSize>1?[Ab(c,[1,a.cell.stateSize])]:[c]})},Object.defineProperty(o.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),o.prototype.setFastWeightInitDuringBuild=function(i){s.prototype.setFastWeightInitDuringBuild.call(this,i),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(i)},o.prototype.getConfig=function(){var i={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(i.numConstants=this.numConstants);var a=this.cell.getConfig();i.cell={className:this.cell.getClassName(),config:a};var c=s.prototype.getConfig.call(this);return Object.assign(i,c),i},o.fromConfig=function(i,a,c){void 0===c&&(c={});var u=Bt(a.cell,c);return new i(Object.assign(a,{cell:u}))},o.className="RNN",o}(ii);bt.registerClass(Md);var rh=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return ft(o,s),o}(ii),Ey=function(s){function o(i){var a=s.call(this,i)||this;return a.DEFAULT_ACTIVATION="tanh",a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_RECURRENT_INITIALIZER="orthogonal",a.DEFAULT_BIAS_INITIALIZER="zeros",a.units=i.units,xo(a.units,"units"),a.activation=Fl(null==i.activation?a.DEFAULT_ACTIVATION:i.activation),a.useBias=null==i.useBias||i.useBias,a.kernelInitializer=lr(i.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.recurrentInitializer=lr(i.recurrentInitializer||a.DEFAULT_RECURRENT_INITIALIZER),a.biasInitializer=lr(i.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.kernelRegularizer=fi(i.kernelRegularizer),a.recurrentRegularizer=fi(i.recurrentRegularizer),a.biasRegularizer=fi(i.biasRegularizer),a.kernelConstraint=Dr(i.kernelConstraint),a.recurrentConstraint=Dr(i.recurrentConstraint),a.biasConstraint=Dr(i.biasConstraint),a.dropout=Wu([1,sc([0,null==i.dropout?0:i.dropout])]),a.recurrentDropout=Wu([1,sc([0,null==i.recurrentDropout?0:i.recurrentDropout])]),a.stateSize=a.units,a.dropoutMask=null,a.recurrentDropoutMask=null,a}return ft(o,s),o.prototype.build=function(i){i=Qi(i),this.kernel=this.addWeight("kernel",[i[i.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){if(2!==i.length)throw new Ne("SimpleRNNCell expects 2 input Tensors, got "+i.length+".");var u=i[1];i=i[0];var p,m=null!=a.training&&a.training;0<c.dropout&&c.dropout<1&&null==c.dropoutMask&&(c.dropoutMask=oh(function(){return ua(i)},c.dropout,m)),0<c.recurrentDropout&&c.recurrentDropout<1&&null==c.recurrentDropoutMask&&(c.recurrentDropoutMask=oh(function(){return ua(u)},c.recurrentDropout,m));var g=c.dropoutMask,v=c.recurrentDropoutMask;p=qs(null!=g?Vn(i,g):i,c.kernel.read()),null!=c.bias&&(p=vs(p,c.bias.read())),null!=v&&(u=Vn(u,v));var y=ai(p,qs(u,c.recurrentKernel.read()));return null!=c.activation&&(y=c.activation.apply(y)),[y,y]})},o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),recurrentInitializer:Ii(this.recurrentInitializer),biasInitializer:Ii(this.biasInitializer),kernelRegularizer:ri(this.kernelRegularizer),recurrentRegularizer:ri(this.recurrentRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),recurrentConstraint:Oi(this.recurrentConstraint),biasConstraint:Oi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="SimpleRNNCell",o}(rh);bt.registerClass(Ey);var ky=function(s){function o(i){return i.cell=new Ey(i),s.call(this,i)||this}return ft(o,s),o.prototype.call=function(i,a){var c=this;return $e(function(){return null!=c.cell.dropoutMask&&(Kn(c.cell.dropoutMask),c.cell.dropoutMask=null),null!=c.cell.recurrentDropoutMask&&(Kn(c.cell.recurrentDropoutMask),c.cell.recurrentDropoutMask=null),s.prototype.call.call(c,i,{mask:null==a?null:a.mask,training:null==a?null:a.training,initialState:null==a?null:a.initialState})})},Object.defineProperty(o.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),recurrentInitializer:Ii(this.recurrentInitializer),biasInitializer:Ii(this.biasInitializer),kernelRegularizer:ri(this.kernelRegularizer),recurrentRegularizer:ri(this.recurrentRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),recurrentConstraint:Oi(this.recurrentConstraint),biasConstraint:Oi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},a=s.prototype.getConfig.call(this);return delete a.cell,Object.assign(i,a),i},o.fromConfig=function(i,a){return new i(a)},o.className="SimpleRNN",o}(Md);bt.registerClass(ky);var My=function(s){function o(i){var a=s.call(this,i)||this;return a.DEFAULT_ACTIVATION="tanh",a.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_RECURRENT_INITIALIZER="orthogonal",a.DEFAULT_BIAS_INITIALIZER="zeros",a.units=i.units,xo(a.units,"units"),a.activation=Fl(void 0===i.activation?a.DEFAULT_ACTIVATION:i.activation),a.recurrentActivation=Fl(void 0===i.recurrentActivation?a.DEFAULT_RECURRENT_ACTIVATION:i.recurrentActivation),a.useBias=null==i.useBias||i.useBias,a.kernelInitializer=lr(i.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.recurrentInitializer=lr(i.recurrentInitializer||a.DEFAULT_RECURRENT_INITIALIZER),a.biasInitializer=lr(i.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.kernelRegularizer=fi(i.kernelRegularizer),a.recurrentRegularizer=fi(i.recurrentRegularizer),a.biasRegularizer=fi(i.biasRegularizer),a.kernelConstraint=Dr(i.kernelConstraint),a.recurrentConstraint=Dr(i.recurrentConstraint),a.biasConstraint=Dr(i.biasConstraint),a.dropout=Wu([1,sc([0,null==i.dropout?0:i.dropout])]),a.recurrentDropout=Wu([1,sc([0,null==i.recurrentDropout?0:i.recurrentDropout])]),a.implementation=i.implementation,a.stateSize=a.units,a.dropoutMask=null,a.recurrentDropoutMask=null,a}return ft(o,s),o.prototype.build=function(i){var a=(i=Qi(i))[i.length-1];this.kernel=this.addWeight("kernel",[a,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){if(2!==i.length)throw new Ne("GRUCell expects 2 input Tensors (inputs, h, c), got "+i.length+".");var u=null!=a.training&&a.training,p=i[1];i=i[0],0<c.dropout&&c.dropout<1&&null==c.dropoutMask&&(c.dropoutMask=oh(function(){return ua(i)},c.dropout,u,3)),0<c.recurrentDropout&&c.recurrentDropout<1&&null==c.recurrentDropoutMask&&(c.recurrentDropoutMask=oh(function(){return ua(p)},c.recurrentDropout,u,3));var m,g,v,C=c.recurrentDropoutMask;0<c.dropout&&c.dropout<1&&(i=Vn(i,c.dropoutMask[0]));var S=qs(i,c.kernel.read());c.useBias&&(S=vs(S,c.bias.read())),0<c.recurrentDropout&&c.recurrentDropout<1&&(p=Vn(p,C[0]));var M=c.recurrentKernel.read(),O=Os(M,[2*c.units,c.units],M.rank-1),P=O[1],B=qs(p,O[0]),W=Os(S,3,S.rank-1),G=W[0],X=W[1],Q=W[2],se=Os(B,2,B.rank-1),fe=se[1];m=c.recurrentActivation.apply(ai(G,se[0])),g=c.recurrentActivation.apply(ai(X,fe));var _e=qs(Vn(g,p),P);v=c.activation.apply(ai(Q,_e));var me=ai(Vn(m,p),Vn(ai(1,Zc(m)),v));return[me,me]})},o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),recurrentActivation:ja(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),recurrentInitializer:Ii(this.recurrentInitializer),biasInitializer:Ii(this.biasInitializer),kernelRegularizer:ri(this.kernelRegularizer),recurrentRegularizer:ri(this.recurrentRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),recurrentConstraint:Oi(this.recurrentConstraint),biasConstraint:Oi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="GRUCell",o}(rh);bt.registerClass(My);var Ig=function(s){function o(i){return 0===i.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),i.cell=new My(i),s.call(this,i)||this}return ft(o,s),o.prototype.call=function(i,a){var c=this;return $e(function(){return null!=c.cell.dropoutMask&&(Kn(c.cell.dropoutMask),c.cell.dropoutMask=null),null!=c.cell.recurrentDropoutMask&&(Kn(c.cell.recurrentDropoutMask),c.cell.recurrentDropoutMask=null),s.prototype.call.call(c,i,{mask:null==a?null:a.mask,training:null==a?null:a.training,initialState:null==a?null:a.initialState})})},Object.defineProperty(o.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),recurrentActivation:ja(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),recurrentInitializer:Ii(this.recurrentInitializer),biasInitializer:Ii(this.biasInitializer),kernelRegularizer:ri(this.kernelRegularizer),recurrentRegularizer:ri(this.recurrentRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),recurrentConstraint:Oi(this.recurrentConstraint),biasConstraint:Oi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},a=s.prototype.getConfig.call(this);return delete a.cell,Object.assign(i,a),i},o.fromConfig=function(i,a){return 0===a.implmentation&&(a.implementation=1),new i(a)},o.className="GRU",o}(Md);bt.registerClass(Ig);var Ty=function(s){function o(i){var a=s.call(this,i)||this;return a.DEFAULT_ACTIVATION="tanh",a.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_RECURRENT_INITIALIZER="orthogonal",a.DEFAULT_BIAS_INITIALIZER="zeros",a.units=i.units,xo(a.units,"units"),a.activation=Fl(void 0===i.activation?a.DEFAULT_ACTIVATION:i.activation),a.recurrentActivation=Fl(void 0===i.recurrentActivation?a.DEFAULT_RECURRENT_ACTIVATION:i.recurrentActivation),a.useBias=null==i.useBias||i.useBias,a.kernelInitializer=lr(i.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.recurrentInitializer=lr(i.recurrentInitializer||a.DEFAULT_RECURRENT_INITIALIZER),a.biasInitializer=lr(i.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.unitForgetBias=i.unitForgetBias,a.kernelRegularizer=fi(i.kernelRegularizer),a.recurrentRegularizer=fi(i.recurrentRegularizer),a.biasRegularizer=fi(i.biasRegularizer),a.kernelConstraint=Dr(i.kernelConstraint),a.recurrentConstraint=Dr(i.recurrentConstraint),a.biasConstraint=Dr(i.biasConstraint),a.dropout=Wu([1,sc([0,null==i.dropout?0:i.dropout])]),a.recurrentDropout=Wu([1,sc([0,null==i.recurrentDropout?0:i.recurrentDropout])]),a.implementation=i.implementation,a.stateSize=[a.units,a.units],a.dropoutMask=null,a.recurrentDropoutMask=null,a}return ft(o,s),o.prototype.build=function(i){var a,c,u=(i=Qi(i))[i.length-1];if(this.kernel=this.addWeight("kernel",[u,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var p=this.biasInitializer,m=this.units;c=new((a=function(g){function v(){return null!==g&&g.apply(this,arguments)||this}return ft(v,g),v.prototype.apply=function(y,C){var S=p.apply([m]),M=(new mg).apply([m]),O=p.apply([2*m]);return pg(pg(S,M),O)},v}(rs)).className="CustomInit",a)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,c,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},o.prototype.call=function(i,a){var c=this;return $e(function(){var u=null!=a.training&&a.training;if(3!==i.length)throw new Ne("LSTMCell expects 3 input Tensors (inputs, h, c), got "+i.length+".");var p=i[1],m=i[2];i=i[0],0<c.dropout&&c.dropout<1&&null==c.dropoutMask&&(c.dropoutMask=oh(function(){return ua(i)},c.dropout,u,4)),0<c.recurrentDropout&&c.recurrentDropout<1&&null==c.recurrentDropoutMask&&(c.recurrentDropoutMask=oh(function(){return ua(p)},c.recurrentDropout,u,4));var g,v,y,C,M=c.recurrentDropoutMask;0<c.dropout&&c.dropout<1&&(i=Vn(i,c.dropoutMask[0]));var O=qs(i,c.kernel.read());0<c.recurrentDropout&&c.recurrentDropout<1&&(p=Vn(p,M[0])),O=ai(O,qs(p,c.recurrentKernel.read())),c.useBias&&(O=vs(O,c.bias.read()));var N=Os(O,4,O.rank-1),B=N[1],W=N[2],G=N[3];g=c.recurrentActivation.apply(N[0]),v=c.recurrentActivation.apply(B),y=ai(Vn(v,m),Vn(g,c.activation.apply(W))),C=c.recurrentActivation.apply(G);var X=Vn(C,c.activation.apply(y));return[X,X,y]})},o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),recurrentActivation:ja(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),recurrentInitializer:Ii(this.recurrentInitializer),biasInitializer:Ii(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ri(this.kernelRegularizer),recurrentRegularizer:ri(this.recurrentRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),recurrentConstraint:Oi(this.recurrentConstraint),biasConstraint:Oi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.className="LSTMCell",o}(rh);bt.registerClass(Ty);var Iy=function(s){function o(i){return 0===i.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),i.cell=new Ty(i),s.call(this,i)||this}return ft(o,s),o.prototype.call=function(i,a){var c=this;return $e(function(){return null!=c.cell.dropoutMask&&(Kn(c.cell.dropoutMask),c.cell.dropoutMask=null),null!=c.cell.recurrentDropoutMask&&(Kn(c.cell.recurrentDropoutMask),c.cell.recurrentDropoutMask=null),s.prototype.call.call(c,i,{mask:null==a?null:a.mask,training:null==a?null:a.training,initialState:null==a?null:a.initialState})})},Object.defineProperty(o.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),o.prototype.getConfig=function(){var i={units:this.units,activation:ja(this.activation),recurrentActivation:ja(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ii(this.kernelInitializer),recurrentInitializer:Ii(this.recurrentInitializer),biasInitializer:Ii(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ri(this.kernelRegularizer),recurrentRegularizer:ri(this.recurrentRegularizer),biasRegularizer:ri(this.biasRegularizer),activityRegularizer:ri(this.activityRegularizer),kernelConstraint:Oi(this.kernelConstraint),recurrentConstraint:Oi(this.recurrentConstraint),biasConstraint:Oi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},a=s.prototype.getConfig.call(this);return delete a.cell,Object.assign(i,a),i},o.fromConfig=function(i,a){return 0===a.implmentation&&(a.implementation=1),new i(a)},o.className="LSTM",o}(Md);bt.registerClass(Iy);var Ag=function(s){function o(i){var a=s.call(this,i)||this;return a.cells=i.cells,a}return ft(o,s),Object.defineProperty(o.prototype,"stateSize",{get:function(){for(var i=[],a=0,c=this.cells.slice().reverse();a<c.length;a++){var u=c[a];Array.isArray(u.stateSize)?i.push.apply(i,u.stateSize):i.push(u.stateSize)}return i},enumerable:!0,configurable:!0}),o.prototype.call=function(i,a){var c=this;return $e(function(){for(var u=i.slice(1),p=[],m=0,g=c.cells.slice().reverse();m<g.length;m++){var v=g[m];Array.isArray(v.stateSize)?p.push(u.splice(0,v.stateSize.length)):p.push(u.splice(0,1))}p.reverse();for(var y,C=[],S=0;S<c.cells.length;++S)v=c.cells[S],u=p[S],y=0===S?[i[0]].concat(u):[y[0]].concat(u),y=v.call(y,a),C.push(y.slice(1));u=[];for(var M=0,O=C.slice().reverse();M<O.length;M++)u.push.apply(u,O[M]);return[y[0]].concat(u)})},o.prototype.build=function(i){var a;k1(i)&&(i=i[0]),this.cells.forEach(function(c,u){vd("RNNCell_"+u,function(){c.build(i),a=Array.isArray(c.stateSize)?c.stateSize[0]:c.stateSize,i=[i[0],a]})}),this.built=!0},o.prototype.getConfig=function(){for(var i=[],a=0,c=this.cells;a<c.length;a++){var u=c[a];i.push({className:u.getClassName(),config:u.getConfig()})}var p={cells:i},m=s.prototype.getConfig.call(this);return Object.assign(p,m),p},o.fromConfig=function(i,a,c){void 0===c&&(c={});for(var u=[],p=0,m=a.cells;p<m.length;p++)u.push(Bt(m[p],c));return new i({cells:u})},Object.defineProperty(o.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var i=[],a=0,c=this.cells;a<c.length;a++)i.push.apply(i,c[a].trainableWeights);return i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nonTrainableWeights",{get:function(){for(var i=[],a=0,c=this.cells;a<c.length;a++){var u=c[a];i.push.apply(i,u.nonTrainableWeights)}if(!this.trainable){for(var p=[],m=0,g=this.cells;m<g.length;m++)p.push.apply(p,(u=g[m]).trainableWeights);return p.concat(i)}return i},enumerable:!0,configurable:!0}),o.prototype.getWeights=function(){for(var i=[],a=0,c=this.cells;a<c.length;a++)i.push.apply(i,c[a].weights);return lo(i)},o.prototype.setWeights=function(i){for(var a=[],c=0,u=this.cells;c<u.length;c++)for(var p=u[c],g=i.splice(p.weights.length),v=0;v<p.weights.length;++v)a.push([p.weights[v],g[v]]);Tl(a)},o.className="StackedRNNCells",o}(rh);function oh(s,o,i,a){function c(){return Rp(s(),o)}if(void 0===i&&(i=null),void 0===a&&(a=1),a>1){for(var u=[],p=0;p<a;p++)u.push(Ml(c,s,i));return u.map(function(m){return Ka(m.clone())})}return Ka(Ml(c,s,i).clone())}bt.registerClass(Ag);var RC=function(s){function o(i){var a=s.call(this,i)||this;return a.layer=i.layer,a}return ft(o,s),o.prototype.build=function(i){this.built=!0},Object.defineProperty(o.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(i){null!=this.layer&&(this.layer.trainable=i)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),o.prototype.getWeights=function(){return this.layer.getWeights()},o.prototype.setWeights=function(i){this.layer.setWeights(i)},o.prototype.getConfig=function(){var i={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.prototype.setFastWeightInitDuringBuild=function(i){s.prototype.setFastWeightInitDuringBuild.call(this,i),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(i)},o.fromConfig=function(i,a,c){void 0===c&&(c={});var u=Bt(a.layer,c);delete a.layer;var p={layer:u};return Object.assign(p,a),new i(p)},o}(ii),FC=function(s){function o(i){var a=s.call(this,i)||this;return a.supportsMasking=!0,a}return ft(o,s),o.prototype.build=function(i){if((i=Qi(i)).length<3)throw new Ne("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(i));this.inputSpec=[{shape:i}];var a=[i[0]].concat(i.slice(2));this.layer.built||(this.layer.build(a),this.layer.built=!0),s.prototype.build.call(this,i)},o.prototype.computeOutputShape=function(i){var a=[(i=Qi(i))[0]].concat(i.slice(2)),c=this.layer.computeOutputShape(a);return[c[0],i[1]].concat(c.slice(1))},o.prototype.call=function(i,a){var c=this;return $e(function(){return Dy(function(u,p){return[Qn(c.layer.call(u,a)),[]]},i=Qn(i),[],!1,null,null,!1,!0)[1]})},o.className="TimeDistributed",o}(RC);bt.registerClass(FC);var Ry=function(s){function o(i){var a=s.call(this,i)||this,c=i.layer.getConfig(),u={};u.className=i.layer.getClassName(),u.config=c,a.forwardLayer=Bt(u),c.goBackwards=!0!==c.goBackwards;var p={};if(p.className=i.layer.getClassName(),p.config=c,a.backwardLayer=Bt(p),a.forwardLayer.name="forward_"+a.forwardLayer.name,a.backwardLayer.name="backward_"+a.backwardLayer.name,a.mergeMode=void 0===i.mergeMode?"concat":i.mergeMode,function Ay(s){gd(Db,"BidirectionalMergeMode",s)}(a.mergeMode),i.weights)throw new ni("weights support is not implemented for Bidirectional layer yet.");return a._stateful=i.layer.stateful,a.returnSequences=i.layer.returnSequences,a.returnState=i.layer.returnState,a.supportsMasking=!0,a._trainable=!0,a.inputSpec=i.layer.inputSpec,a.numConstants=null,a}return ft(o,s),Object.defineProperty(o.prototype,"trainable",{get:function(){return this._trainable},set:function(i){this._trainable=i,null!=this.forwardLayer&&(this.forwardLayer.trainable=i),null!=this.backwardLayer&&(this.backwardLayer.trainable=i)},enumerable:!0,configurable:!0}),o.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},o.prototype.setWeights=function(i){var c=Math.floor(i.length/2);this.forwardLayer.setWeights(i.slice(0,c)),this.backwardLayer.setWeights(i.slice(c))},o.prototype.computeOutputShape=function(i){var a,c,u,p=this.forwardLayer.computeOutputShape(i);return Array.isArray(p)&&Array.isArray(p[0])||(p=[p]),this.returnState&&(u=p.slice(1)),a=p[0],"concat"===this.mergeMode?(a[a.length-1]*=2,c=[a]):c=null==this.mergeMode?[a,a.slice()]:[a],this.returnState?null==this.mergeMode?c.concat(u).concat(u.slice()):[a].concat(u).concat(u.slice()):Jo(c)},o.prototype.apply=function(i,a){var c=null==a?null:a.initialState,u=null==a?null:a.constants;null==a&&(a={});var p=AC(i,c,u,this.numConstants);if(i=p.inputs,c=p.initialState,u=p.constants,Array.isArray(i)&&(c=i.slice(1),i=i[0]),(null==c||0===c.length)&&null==u)return s.prototype.apply.call(this,i,a);var m=[],g=[];if(null!=c){var v=c.length;if(v%2>0)throw new Ne("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");a.initialState=c,m.push.apply(m,c);var y=c.map(function(W){return new Nr({shape:W.shape})});this.forwardLayer.stateSpec=y.slice(0,v/2),this.backwardLayer.stateSpec=y.slice(v/2),g.push.apply(g,y)}if(null!=u)throw new ni("Support for constants in Bidirectional layers is not implemented yet.");for(var C=m[0]instanceof Er,S=0,M=m;S<M.length;S++)if(M[S]instanceof Er!==C)throw new Ne("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(C){var O=[i].concat(m),N=this.inputSpec.concat(g),P=this.inputSpec;this.inputSpec=N;var B=s.prototype.apply.call(this,O,a);return this.inputSpec=P,B}return s.prototype.apply.call(this,i,a)},o.prototype.call=function(i,a){var c=this;return $e(function(){if(null!=a.mask)throw new ni("The support for masking is not implemented for Bidirectional layers yet.");var u,p,m,g,v=a.initialState;if(null==v)u=c.forwardLayer.call(i,a),p=c.backwardLayer.call(i,a);else{var y=v.slice(0,v.length/2),C=v.slice(v.length/2);u=c.forwardLayer.call(i,Object.assign(a,{initialState:y})),p=c.backwardLayer.call(i,Object.assign(a,{initialState:C}))}return c.returnState&&(Array.isArray(u)&&(m=u.slice(1).concat(p.slice(1))),u=u[0],p=p[0]),c.returnSequences&&(p=ya(p,1)),"concat"===c.mergeMode?g=_s([u,p]):"sum"===c.mergeMode?g=ai(u,p):"ave"===c.mergeMode?g=Vn(.5,ai(u,p)):"mul"===c.mergeMode?g=Vn(u,p):null==c.mergeMode&&(g=[u,p]),c.returnState?null==c.mergeMode?g.concat(m):[g].concat(m):g})},o.prototype.resetStates=function(i){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},o.prototype.build=function(i){var a=this;vd(this.forwardLayer.name,function(){a.forwardLayer.build(i)}),vd(this.backwardLayer.name,function(){a.backwardLayer.build(i)}),this.built=!0},Object.defineProperty(o.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),o.prototype.setFastWeightInitDuringBuild=function(i){s.prototype.setFastWeightInitDuringBuild.call(this,i),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(i),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(i)},o.prototype.getConfig=function(){var i={mergeMode:this.mergeMode},a=s.prototype.getConfig.call(this);return Object.assign(i,a),i},o.fromConfig=function(i,a){var c=Bt(a.layer);if(delete a.layer,null!=a.numConstants)throw new ni("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var u=a;return u.layer=c,new i(u)},o.className="Bidirectional",o}(RC);function By(s){return new wC(s)}function Fg(s){return new nh(s)}function Og(s){return new EC(s)}function Uy(s){return new Sy(s)}function V2(s){return new ih(s)}function Hy(s){return new Qp(s)}function HC(s){return new Cy(s)}bt.registerClass(Ry);var YC=Object.freeze({inputLayer:function v2(s){return new Xs(s)},elu:function b2(s){return new lC(s)},reLU:function y2(s){return new Mg(s)},leakyReLU:function x2(s){return new pc(s)},prelu:function w2(s){return new sC(s)},softmax:function C2(s){return new a2(s)},thresholdedReLU:function S2(s){return new kd(s)},conv1d:function D2(s){return new dy(s)},conv2d:function OC(s){return new cy(s)},conv2dTranspose:function NC(s){return new Kp(s)},conv3d:function E2(s){return new Yp(s)},separableConv2d:function k2(s){return new c2(s)},cropping2D:function PC(s){return new uy(s)},upSampling2d:function M2(s){return new uC(s)},depthwiseConv2d:function T2(s){return new hy(s)},activation:function I2(s){return new fC(s)},dense:function Fy(s){return new fy(s)},dropout:function Oy(s){return new py(s)},flatten:function LC(s){return new pC(s)},repeatVector:function Ny(s){return new mC(s)},reshape:function A2(s){return new Ju(s)},permute:function R2(s){return new gC(s)},embedding:function Py(s){return new vC(s)},add:function F2(s){return new my(s)},average:function Ht(s){return new _y(s)},concatenate:function ah(s){return new th(s)},maximum:function BC(s){return new bC(s)},minimum:function O2(s){return new eh(s)},multiply:function EF(s){return new gy(s)},dot:function zC(s){return new yC(s)},batchNormalization:function Ly(s){return new p2(s)},layerNormalization:function N2(s){return new f2(s)},zeroPadding2d:function Rg(s){return new m2(s)},averagePooling1d:By,avgPool1d:function zy(s){return By(s)},avgPooling1d:function Vy(s){return By(s)},averagePooling2d:Fg,avgPool2d:function VC(s){return Fg(s)},avgPooling2d:function UC(s){return Fg(s)},averagePooling3d:Og,avgPool3d:function P2(s){return Og(s)},avgPooling3d:function L2(s){return Og(s)},globalAveragePooling1d:function B2(s){return new MC(s)},globalAveragePooling2d:function z2(s){return new IC(s)},globalMaxPooling1d:Uy,globalMaxPooling2d:V2,maxPooling1d:Hy,maxPooling2d:HC,maxPooling3d:function U2(s){return new DC(s)},gru:function kF(s){return new Ig(s)},gruCell:function H2(s){return new My(s)},lstm:function j2(s){return new Iy(s)},lstmCell:function jC(s){return new Ty(s)},simpleRNN:function W2(s){return new ky(s)},simpleRNNCell:function G2(s){return new Ey(s)},rnn:function $2(s){return new Md(s)},stackedRNNCells:function q2(s){return new Ag(s)},bidirectional:function Y2(s){return new Ry(s)},timeDistributed:function K2(s){return new FC(s)},globalMaxPool1d:Uy,globalMaxPool2d:V2,maxPool1d:Hy,maxPool2d:HC,Layer:ii,RNN:Md,RNNCell:rh,input:iC,gaussianNoise:function WC(s){return new vy(s)},gaussianDropout:function GC(s){return new by(s)},alphaDropout:function $C(s){return new yy(s)},masking:function qC(s){return new _C(s)}}),aT=Object.freeze({binaryAccuracy:function KC(s,o){return $b(s,o)},binaryCrossentropy:function J2(s,o){return Sn(s,o)},sparseCategoricalAccuracy:function MF(s,o){return yg(s,o)},categoricalAccuracy:function XC(s,o){return bg(s,o)},categoricalCrossentropy:function eT(s,o){return xg(s,o)},precision:function tT(s,o){return N1(s,o)},recall:function nT(s,o){return function cr(s,o){return $e(function(){var i=qb(s,o),a=function O1(s,o){return $e(function(){return fs(s.equal(1),o.equal(0)).sum().cast("float32")})}(s,o),c=i.add(a);return Na(Tu(c,0),i.div(c),0).cast("float32")})}(s,o)},cosineProximity:function iT(s,o){return Lp(s,o)},meanAbsoluteError:function ef(s,o){return Dt(s,o)},meanAbsolutePercentageError:function rT(s,o){return cc(s,o)},MAPE:function jy(s,o){return cc(s,o)},mape:function En(s,o){return cc(s,o)},meanSquaredError:function oT(s,o){return Gr(s,o)},MSE:function sh(s,o){return Gr(s,o)},mse:function qr(s,o){return Gr(s,o)}}),sT=Object.freeze({modelFromJSON:function Z1(s,o){return nn(this,void 0,void 0,function(){var i,a,c,u,p,m,g,v;return Rn(this,function(y){switch(y.label){case 0:return"modelTopology"in s||(s={modelTopology:s}),null!=(i=s.modelTopology).model_config&&(i=i.model_config),a=Vp(i),c=Bt(a,o),null==s.weightsManifest?[3,2]:[4,Sa.loadWeights(s.weightsManifest,s.pathPrefix,c.weights.map(function(C){return C.originalName}))];case 1:for(u=y.sent(),p={},m=0,g=c.weights;m<g.length;m++)p[(v=g[m]).originalName]=u[v.originalName];c.loadWeights(p),Kn(u),y.label=2;case 2:return[2,c]}})})}}),cT=Object.freeze({l1l2:function lT(s){return new $p(s)},l1:function Ng(s){return function oC(s){return kg(s),new $p({l1:null!=s?s.l1:null,l2:0})}(s)},l2:function Lr(s){return function aC(s){return kg(s),new $p({l2:null!=s?s.l2:null,l1:0})}(s)}}),ZC=function(s){function o(){var i=null!==s&&s.apply(this,arguments)||this;return i.model=null,i}return ft(o,s),o.prototype.setModel=function(i){if(!(i instanceof Rl))throw new Error("model must be a LayersModel, not some other Container");this.model=i},o}(Dd);function tf(s,o){return s<o}function Wy(s,o){return s>o}var ws,$y,Pg=function(s){function o(i){var a=s.call(this)||this;if(null==i&&(i={}),i.restoreBestWeights)throw new ni("restoreBestWeights = True is not implemented in EarlyStopping yet.");return a.monitor=i.monitor||"val_loss",a.minDelta=Math.abs(i.minDelta||0),a.patience=i.patience||0,a.verbose=i.verbose||0,a.mode=i.mode||"auto",a.baseline=i.baseline,-1===["auto","min","max"].indexOf(a.mode)&&(console.warn("EarlyStopping mode '"+a.mode+"' is invalid. Falling back to mode 'auto'."),a.mode="auto"),a.monitorFunc="min"===a.mode?tf:"max"===a.mode||-1!==a.monitor.indexOf("acc")?Wy:tf,a.monitorFunc===tf&&(a.minDelta*=-1),a}return ft(o,s),o.prototype.onTrainBegin=function(i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return this.wait=0,this.stoppedEpoch=0,this.best=null!=this.baseline?this.baseline:this.monitorFunc===tf?1/0:-1/0,[2]})})},o.prototype.onEpochEnd=function(i,a){return nn(this,void 0,void 0,function(){var c;return Rn(this,function(u){switch(u.label){case 0:return[4,Al(a)];case 1:return u.sent(),null==(c=this.getMonitorValue(a))||(this.monitorFunc(c-this.minDelta,this.best)?(this.best=c,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=i,this.model.stopTraining=!0))),[2]}})})},o.prototype.onTrainEnd=function(i){return nn(this,void 0,void 0,function(){return Rn(this,function(a){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},o.prototype.getMonitorValue=function(i){null==i&&(i={});var a=i[this.monitor];return null==a&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(i)),a},o}(ZC),Gy={earlyStopping:function QC(s){return new Pg(s)}},nf=function(){return(nf=Object.assign||function(s){for(var o,i=1,a=arguments.length;i<a;i++)for(var c in o=arguments[i])Object.prototype.hasOwnProperty.call(o,c)&&(s[c]=o[c]);return s}).apply(this,arguments)};function Nl(s,o,i,a){return new(i||(i=Promise))(function(c,u){function p(v){try{g(a.next(v))}catch(y){u(y)}}function m(v){try{g(a.throw(v))}catch(y){u(y)}}function g(v){v.done?c(v.value):new i(function(y){y(v.value)}).then(p,m)}g((a=a.apply(s,o||[])).next())})}function Td(s,o){var i,a,c,u,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:m(0),throw:m(1),return:m(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function m(g){return function(v){return function(y){if(i)throw new TypeError("Generator is already executing.");for(;p;)try{if(i=1,a&&(c=2&y[0]?a.return:y[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,y[1])).done)return c;switch(a=0,c&&(y=[2&y[0],c.value]),y[0]){case 0:case 1:c=y;break;case 4:return p.label++,{value:y[1],done:!1};case 5:p.label++,a=y[1],y=[0];continue;case 7:y=p.ops.pop(),p.trys.pop();continue;default:if(!(c=(c=p.trys).length>0&&c[c.length-1])&&(6===y[0]||2===y[0])){p=0;continue}if(3===y[0]&&(!c||y[1]>c[0]&&y[1]<c[3])){p.label=y[1];break}if(6===y[0]&&p.label<c[1]){p.label=c[1],c=y;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(y);break}c[2]&&p.ops.pop(),p.trys.pop();continue}y=o.call(s,p)}catch(C){y=[6,C],a=0}finally{i=c=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([g,v])}}}(function(s){s[s.DT_INVALID=0]="DT_INVALID",s[s.DT_FLOAT=1]="DT_FLOAT",s[s.DT_DOUBLE=2]="DT_DOUBLE",s[s.DT_INT32=3]="DT_INT32",s[s.DT_UINT8=4]="DT_UINT8",s[s.DT_INT16=5]="DT_INT16",s[s.DT_INT8=6]="DT_INT8",s[s.DT_STRING=7]="DT_STRING",s[s.DT_COMPLEX64=8]="DT_COMPLEX64",s[s.DT_INT64=9]="DT_INT64",s[s.DT_BOOL=10]="DT_BOOL",s[s.DT_QINT8=11]="DT_QINT8",s[s.DT_QUINT8=12]="DT_QUINT8",s[s.DT_QINT32=13]="DT_QINT32",s[s.DT_BFLOAT16=14]="DT_BFLOAT16",s[s.DT_FLOAT_REF=101]="DT_FLOAT_REF",s[s.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",s[s.DT_INT32_REF=103]="DT_INT32_REF",s[s.DT_UINT8_REF=104]="DT_UINT8_REF",s[s.DT_INT16_REF=105]="DT_INT16_REF",s[s.DT_INT8_REF=106]="DT_INT8_REF",s[s.DT_STRING_REF=107]="DT_STRING_REF",s[s.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",s[s.DT_INT64_REF=109]="DT_INT64_REF",s[s.DT_BOOL_REF=110]="DT_BOOL_REF",s[s.DT_QINT8_REF=111]="DT_QINT8_REF",s[s.DT_QUINT8_REF=112]="DT_QUINT8_REF",s[s.DT_QINT32_REF=113]="DT_QINT32_REF",s[s.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(ws||(ws={})),function(s){var o;(o=s.CheckpointFormatVersion||(s.CheckpointFormatVersion={}))[o.LEGACY=0]="LEGACY",o[o.V1=1]="V1",o[o.V2=2]="V2"}($y||($y={}));var qy={};function dT(s,o){qy[s]={tfOpName:s,category:"custom",inputs:[],attrs:[],customExecutor:o}}function JC(s){return qy[s]}function eS(s){delete qy[s]}function le(s,o,i,a){var c=o.inputParams[s];if(c&&void 0!==c.inputIndexStart){var u=c.inputIndexStart,p=0===c.inputIndexEnd?void 0:void 0===c.inputIndexEnd?u+1:c.inputIndexEnd;if("tensor"===c.type)return Ot(o.inputNames[c.inputIndexStart],i,a);if("tensors"===c.type)return o.inputNames.slice(u,p).map(function(v){return Ot(v,i,a)});var m=Array.prototype.slice.call(Ot(o.inputNames.slice(u)[0],i,a).dataSync());return"number"===c.type?m[0]:m}var g=o.attrParams[s];return g&&g.value}function Ot(s,o,i){var a=rf(s),c=a[0],u=a[1],p=i.currentContextIds.find(function(m){return!!o[Kt(c,m)]});return void 0!==p?o[Kt(c,p)][u]:void 0}function vi(s,o){var i=rf(s),c=i[1];return[Kt(i[0],o&&o.currentContextId),c]}function Kt(s,o){return o?s+"-"+o:s}function rf(s){var o=s.lastIndexOf(":");return-1===o?[s,0]:[s.substring(0,o),Number(s.substring(o+1))]}function Lg(s,o){for(var i=[],a=0;a<s.length;a+=o)i.push(s.slice(a,a+o));return i}var uT=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),af=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),lh=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),pT=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),IF=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),rS=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),fT=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),mT=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),gT=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),vT=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),aS=Object.freeze({json:[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),Bg=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),AF=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),bT=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),ch=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),dS=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),Zy=function(){function s(){var i=[].concat.apply([],[uT,af,lh,pT,IF,rS,fT,vT,gT,mT,aS,Bg,AF,bT,ch,dS].map(function(a){return a.json}));this.opMappers=i.reduce(function(a,c){return a[c.tfOpName]=c,a},{})}return Object.defineProperty(s,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),s.prototype.transformGraph=function(o){var i=this,a=[],c=[],u=o.node.reduce(function(v,y){return v[y.name]=i.mapNode(y),"Placeholder"===y.op&&a.push(v[y.name]),"Const"===y.op&&c.push(v[y.name]),v},{}),p=[],m=[],g=Object.keys(u);return g.forEach(function(v){var y=u[v];y.inputNames.forEach(function(C){var S=vi(C)[0];y.inputs.push(u[S]),u[S].children.push(y)}),0===y.inputs.length&&p.push(y)}),g.forEach(function(v){var y=u[v];0===y.children.length&&m.push(y)}),{nodes:u,inputs:p,outputs:m,weights:c,placeholders:a}},s.prototype.mapNode=function(o){var i=JC(o.op)||this.opMappers[o.op]||{};null==o.attr&&(o.attr={});var a={name:o.name,op:o.op,category:i.category,inputNames:(o.input||[]).map(function(c){return c.startsWith("^")?c.substr(1):c}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:o.attr};return null!=i.inputs&&(a.inputParams=i.inputs.reduce(function(c,u){return c[u.name]={type:u.type,inputIndexStart:u.start,inputIndexEnd:u.end},c},{})),null!=i.attrs&&(a.attrParams=i.attrs.reduce(function(c,u){var p=u.type,m=void 0;switch(u.type){case"string":void 0===(m=hS(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=hS(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"string[]":void 0===(m=e0(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=e0(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"number":void 0===(m=Jy(o.attr,u.tfName,u.defaultValue||0))&&u.tfDeprecatedName&&(m=Jy(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"number[]":void 0===(m=Hg(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=Hg(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"bool":void 0===(m=Qy(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=Qy(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"bool[]":void 0===(m=jg(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=jg(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"shape":void 0===(m=Ug(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=Ug(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"shape[]":void 0===(m=t0(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=t0(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"dtype":void 0===(m=zg(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=zg(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"dtype[]":void 0===(m=Vg(o.attr,u.tfName,u.defaultValue))&&u.tfDeprecatedName&&(m=Vg(o.attr,u.tfDeprecatedName,u.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+u.type+" for op: "+o.op)}return c[u.name]={value:m,type:p},c},{})),a},s}();function uS(s,o){var i=Array.isArray(s)?String.fromCharCode.apply(null,s):function RF(s){var o=E().global;if(void 0!==o.atob)return o.atob(s);if(typeof Buffer<"u")return new Buffer(s,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(s);return o?i:i.toLowerCase()}function hS(s,o,i,a){void 0===a&&(a=!1);var c=s[o];return null!=c?uS(c.s,a):i}function Qy(s,o,i){var a=s[o];return a?a.b:i}function Jy(s,o,i){var a=s[o]||{},c=null!=a.i?a.i:null!=a.f?a.f:i;return"number"==typeof c?c:parseInt(c,10)}function pS(s){switch("string"==typeof s&&(s=ws[s]),s){case ws.DT_FLOAT:return"float32";case ws.DT_INT32:case ws.DT_INT64:return"int32";case ws.DT_BOOL:return"bool";case ws.DT_DOUBLE:return"float32";case ws.DT_STRING:return"string";default:return null}}function zg(s,o,i){var a=s[o];return a&&a.type?pS(a.type):i}function Vg(s,o,i){var a=s[o];return a&&a.list&&a.list.type?a.list.type.map(function(c){return pS(c)}):i}function fS(s){if(!s.unknownRank)return null!=s.dim?s.dim.map(function(o){return"number"==typeof o.size?o.size:parseInt(o.size,10)}):[]}function Ug(s,o,i){var a=s[o];return a&&a.shape?fS(a.shape):i}function Hg(s,o,i){var a=s[o];return a?((a.list.f&&a.list.f.length?a.list.f:a.list.i)||[]).map(function(c){return"number"==typeof c?c:parseInt(c,10)}):i}function e0(s,o,i,a){void 0===a&&(a=!1);var c=s[o];return c&&c.list&&c.list.s?c.list.s.map(function(u){return uS(u,a)}):i}function t0(s,o,i){var a=s[o];return a&&a.list&&a.list.shape?a.list.shape.map(function(c){return fS(c)}):i}function jg(s,o,i){var a=s[o];return a&&a.list&&a.list.b?a.list.b:i}var xT=function(){function s(o,i,a){var c=this;this.node=o,this.tensorMap=i,this.context=a,this.inputs=[],this.attrs={},this.inputs=o.inputNames.map(function(u){return c.getInput(u)}),null!=o.rawAttrs&&(this.attrs=Object.keys(o.rawAttrs).reduce(function(u,p){return u[p]=c.getAttr(p),u},{}))}return s.prototype.getInput=function(o){return Ot(o,this.tensorMap,this.context)},s.prototype.getAttr=function(o,i){var a=this.node.rawAttrs[o];if(null!=a.tensor)return Ot(o,this.tensorMap,this.context);if(null!=a.i||null!=a.f)return Jy(this.node.rawAttrs,o,i);if(null!=a.s)return hS(this.node.rawAttrs,o,i);if(null!=a.b)return Qy(this.node.rawAttrs,o,i);if(null!=a.shape)return Ug(this.node.rawAttrs,o,i);if(null!=a.type)return zg(this.node.rawAttrs,o,i);if(null!=a.list){if(null!=a.list.i||null!=a.list.f)return Hg(this.node.rawAttrs,o,i);if(null!=a.list.s)return e0(this.node.rawAttrs,o,i);if(null!=a.list.shape)return t0(this.node.rawAttrs,o,i);if(null!=a.list.b)return jg(this.node.rawAttrs,o,i);if(null!=a.list.type)return Vg(this.node.rawAttrs,o,i)}return i},s}(),_S=function(){function s(o,i,a,c,u,p,m){this.name=o,this.dtype=i,this.maxSize=a,this.elementShape=c,this.identicalElementShapes=u,this.dynamicSize=p,this.clearAfterRead=m,this.tensors=[],this.closed_=!1,this.id=s.nextId++}return Object.defineProperty(s.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),s.prototype.clearAndClose=function(){this.tensors.forEach(function(o){return o.tensor.dispose()}),this.tensors=[],this.closed_=!0},s.prototype.size=function(){return this.tensors.length},s.prototype.read=function(o){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(o<0||o>=this.tensors.length)throw new Error("Tried to read from index "+o+", but array size is: "+this.tensors.length);var i=this.tensors[o];if(i.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+o+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(i.cleared=!0),i.read=!0,i.tensor},s.prototype.readMany=function(o){var i=this;return o.map(function(a){return i.read(a)})},s.prototype.write=function(o,i){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(o<0||!this.dynamicSize&&o>=this.maxSize)throw new Error("Tried to write to index "+o+", but array is not resizeable and size is: "+this.maxSize);var a=this.tensors[o]||{};if(i.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+o+",\n          because the value dtype is "+i.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=i.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,i.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+o+"."),a&&a.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+o+", because it has already been read.");if(a&&a.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+o+", because it has already been written.");a.tensor=i,a.written=!0,this.tensors[o]=a},s.prototype.writeMany=function(o,i){var a=this;if(o.length!==i.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+o.length+" is not the same as tensors size: "+i.length+".");o.forEach(function(c,u){return a.write(c,i[u])})},s.prototype.gather=function(o,i){if(i&&i!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+i);if(!o){o=[];for(var a=0;a<this.size();a++)o.push(a)}if(0===o.length)return ei([],[0].concat(this.elementShape));var c=this.readMany(o);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,c[0].shape,"TensorArray shape mismatch: "),Qa(c,0)},s.prototype.concat=function(o){if(o&&o!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+o);if(0===this.size())return ei([],[0].concat(this.elementShape));for(var i=[],a=0;a<this.size();a++)i.push(a);var c=this.readMany(i);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,c[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+c[0].shape+")"),Ur(c,0)},s.prototype.scatter=function(o,i){if(i.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+i.dtype);if(o.length!==i.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+o.length+" vs. "+i.shape[0]);var a=Math.max.apply(Math,o);if(!this.dynamicSize&&a>=this.maxSize)throw new Error("Max index must be < array size ("+a+"  vs. "+this.maxSize+")");this.writeMany(o,Ja(i,0))},s.prototype.split=function(o,i){var a=this;if(i.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+i.dtype);var c=0,u=o.map(function(y){return c+=y});if(c!==i.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+c+", and tensor's shape is: "+i.shape);if(!this.dynamicSize&&o.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+o.length+"), and the TensorArray is not marked as dynamically resizeable");var p=0===c?0:i.size/c,m=[];$e(function(){i=i.reshape([1,c,p]);for(var y=0;y<o.length;++y)m[y]=Pa(i,[0,0===y?0:u[y-1],0],[1,o[y],p]).reshape(a.elementShape);return m});for(var g=[],v=0;v<o.length;v++)g[v]=v;this.writeMany(g,m)},s.prototype.assertShapesMatchAllowUndefinedSize=function(o,i,a){void 0===a&&(a=""),qe.assert(this.shapesEqualAllowUndefinedSize(o,i),function(){return a+" Shapes "+o+" and "+i+" must match"})},s.prototype.shapesEqualAllowUndefinedSize=function(o,i){if(o.length!==i.length)return!1;for(var a=0;a<o.length;a++)if(-1!==o[a]&&-1!==i[a]&&o[a]!==i[a])return!1;return!0},s.nextId=0,s}();function ST(s,o,i){var a=function(c,u,p){switch(c.category){case"arithmetic":return function(s,o,i){switch(s.op){case"BiasAdd":case"AddV2":case"Add":return[ai(le("a",s,o,i),le("b",s,o,i))];case"AddN":return[kv(le("tensors",s,o,i))];case"FloorMod":case"Mod":return[Iv(le("a",s,o,i),le("b",s,o,i))];case"Mul":return[Vn(le("a",s,o,i),le("b",s,o,i))];case"RealDiv":case"Div":return[bo(le("a",s,o,i),le("b",s,o,i))];case"FloorDiv":return[mp(le("a",s,o,i),le("b",s,o,i))];case"Sub":return[jr(le("a",s,o,i),le("b",s,o,i))];case"Minimum":return[Yl(le("a",s,o,i),le("b",s,o,i))];case"Maximum":return[zs(le("a",s,o,i),le("b",s,o,i))];case"Pow":return[Kl(le("a",s,o,i),le("b",s,o,i))];case"SquaredDifference":return[km(le("a",s,o,i),le("b",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"basic_math":return function(s,o,i){switch(s.op){case"Abs":case"ComplexAbs":return[Gl(le("x",s,o,i))];case"Acos":return[$l(le("x",s,o,i))];case"Acosh":return[Xc(le("x",s,o,i))];case"Asin":return[gv(le("x",s,o,i))];case"Asinh":return[mw(le("x",s,o,i))];case"Atan":return[mm(le("x",s,o,i))];case"Atan2":return[Tv(le("x",s,o,i),le("y",s,o,i))];case"Atanh":return[_v(le("x",s,o,i))];case"Ceil":return[gw(le("x",s,o,i))];case"Complex":return[Cn(le("real",s,o,i),le("imag",s,o,i))];case"Cos":return[vv(le("x",s,o,i))];case"Cosh":return[bv(le("x",s,o,i))];case"Elu":return[so(le("x",s,o,i))];case"Erf":return[Du(le("x",s,o,i))];case"Exp":return[gm(le("x",s,o,i))];case"Expm1":return[yv(le("x",s,o,i))];case"Floor":return[sp(le("x",s,o,i))];case"Log":return[ql(le("x",s,o,i))];case"Log1p":return[_m(le("x",s,o,i))];case"Imag":return[Xn(le("x",s,o,i))];case"Neg":return[Zc(le("x",s,o,i))];case"Reciprocal":return[xv(le("x",s,o,i))];case"Real":return[Ft(le("x",s,o,i))];case"Relu":return[Zl(le("x",s,o,i))];case"Round":return[lp(le("x",s,o,i))];case"Selu":return[$m(le("x",s,o,i))];case"Sigmoid":return[Cv(le("x",s,o,i))];case"Sin":return[_w(le("x",s,o,i))];case"Sign":return[cp(le("x",s,o,i))];case"Sinh":return[vw(le("x",s,o,i))];case"Softplus":return[dp(le("x",s,o,i))];case"Sqrt":return[Eu(le("x",s,o,i))];case"Square":return[mv(le("x",s,o,i))];case"Tanh":return[up(le("x",s,o,i))];case"Tan":return[bm(le("x",s,o,i))];case"Relu6":case"ClipByValue":return[Zo(le("x",s,o,i),le("clipValueMin",s,o,i),le("clipValueMax",s,o,i))];case"Rsqrt":return[wv(Ot(s.inputNames[0],o,i))];case"Prod":return[Wm(le("x",s,o,i),le("axes",s,o,i))];case"LeakyRelu":return[La(le("x",s,o,i),le("alpha",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"control":return function vS(s,o,i){return Nl(this,void 0,void 0,function(){var a,c,u,p,m,g,v,y,C,S,M,O,N,P,B,W,G,X,Q,se,ue,fe,_e,me,Me,Te,Ue,Xe,et,it,nt,je,ut,yt;return Td(this,function(Gt){switch(Gt.label){case 0:switch(s.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[le("pred",s,o,i).clone()]];case 2:return a=le("pred",s,o,i),c=le("data",s,o,i),[4,a.data()];case 3:return[2,Gt.sent()[0]?[void 0,c.clone()]:[c.clone(),void 0]];case 4:return[2,(u=s.inputNames.find(function(Xt){return void 0!==Ot(Xt,o,i)}))?[Ot(u,o,i).clone()]:void 0];case 5:return p=le("frameName",s,o,i),m=le("tensor",s,o,i),i.enterFrame(p),[2,[m.clone()]];case 6:return g=le("tensor",s,o,i),i.exitFrame(),[2,[g.clone()]];case 7:return v=le("tensor",s,o,i),i.nextIteration(),[2,[v.clone()]];case 8:return y=le("size",s,o,i),C=le("dtype",s,o,i),S=le("elementShape",s,o,i),M=le("dynamicSize",s,o,i),O=le("clearAfterRead",s,o,i),N=le("identicalElementShapes",s,o,i),P=le("name",s,o,i),B=new _S(P,C,y,S,N,M,O),i.addTensorArray(B),[2,[Nt(B.id),Nt(1)]];case 9:return W=le("tensorArrayId",s,o,i),G=le("index",s,o,i),X=le("tensor",s,o,i),i.getTensorArray(W).write(G,X),[2,[Nt(1)]];case 10:return Q=le("tensorArrayId",s,o,i),se=le("index",s,o,i),[2,[i.getTensorArray(Q).read(se)]];case 11:return ue=le("tensorArrayId",s,o,i),fe=le("indices",s,o,i),_e=le("dtype",s,o,i),[2,[i.getTensorArray(ue).gather(fe,_e)]];case 12:return me=le("tensorArrayId",s,o,i),Me=le("indices",s,o,i),Te=le("tensor",s,o,i),i.getTensorArray(me).scatter(Me,Te),[2,[Nt(1)]];case 13:return Ue=le("tensorArrayId",s,o,i),Xe=i.getTensorArray(Ue),et=le("dtype",s,o,i),[2,[Xe.concat(et)]];case 14:return it=le("tensorArrayId",s,o,i),nt=le("tensor",s,o,i),je=le("lengths",s,o,i),i.getTensorArray(it).split(je,nt),[2,[Nt(1)]];case 15:return ut=le("tensorArrayId",s,o,i),[2,[Nt(i.getTensorArray(ut).size(),"int32")]];case 16:return yt=le("tensorArrayId",s,o,i),i.getTensorArray(yt).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+s.op+" is not implemented")}})})}(c,u,p);case"convolution":return function(s,o,i){var a,c;switch(s.op){case"Conv1D":var u=le("stride",s,o,i),p=le("pad",s,o,i),m=le("dataFormat",s,o,i).toUpperCase(),g=le("dilation",s,o,i);return[Pv(le("x",s,o,i),le("filter",s,o,i),u,p,m,g)];case"Conv2D":u=le("strides",s,o,i),p=le("pad",s,o,i),m=le("dataFormat",s,o,i).toUpperCase();var v=le("dilations",s,o,i);return[Vs(le("x",s,o,i),le("filter",s,o,i),[u[1],u[2]],p,m,[v[1],v[2]])];case"_FusedConv2D":var y=(a=le("fusedOps",s,o,i))[0],C=a[1],S="biasadd"===y,M="prelu"===C,O="fusedbatchnorm"===y,N=le("numArgs",s,o,i);if(S){if(M&&2!==N)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!M&&1!==N)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(O)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");u=le("strides",s,o,i),p=le("pad",s,o,i),m=le("dataFormat",s,o,i).toUpperCase(),v=le("dilations",s,o,i);var P=(c=le("args",s,o,i))[0],B=c[1];return[Pu.conv2d({x:le("x",s,o,i),filter:le("filter",s,o,i),strides:[u[1],u[2]],pad:p,dataFormat:m,dilations:[v[1],v[2]],bias:P,activation:C,preluActivationWeights:B})];case"Conv2DBackpropInput":case"Conv2dTranspose":var W=le("outputShape",s,o,i);return u=le("strides",s,o,i),p=le("pad",s,o,i),[id(le("x",s,o,i),le("filter",s,o,i),W,[u[1],u[2]],p)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return u=le("strides",s,o,i),p=le("pad",s,o,i),v=le("dilations",s,o,i),m=le("dataFormat",s,o,i).toUpperCase(),[nd(le("input",s,o,i),le("filter",s,o,i),[u[1],u[2]],p,m,[v[1],v[2]])];case"Conv3D":return u=le("strides",s,o,i),p=le("pad",s,o,i),m=le("dataFormat",s,o,i).toUpperCase(),v=le("dilations",s,o,i),[Fm(le("x",s,o,i),le("filter",s,o,i),[u[1],u[2],u[3]],p,m,[v[1],v[2],v[3]])];case"AvgPool":u=le("strides",s,o,i),p=le("pad",s,o,i);var G=le("kernelSize",s,o,i);return[rd(le("x",s,o,i),[G[1],G[2]],[u[1],u[2]],p)];case"MaxPool":return u=le("strides",s,o,i),p=le("pad",s,o,i),G=le("kernelSize",s,o,i),[_p(le("x",s,o,i),[G[1],G[2]],[u[1],u[2]],p)];case"AvgPool3D":return u=le("strides",s,o,i),p=le("pad",s,o,i),G=le("kernelSize",s,o,i),[zm(le("x",s,o,i),[G[1],G[2],G[3]],[u[1],u[2],u[3]],p)];case"MaxPool3D":return u=le("strides",s,o,i),p=le("pad",s,o,i),G=le("kernelSize",s,o,i),[Us(le("x",s,o,i),[G[1],G[2],G[3]],[u[1],u[2],u[3]],p)];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"creation":return function(s,o,i){switch(s.op){case"Fill":var a=le("shape",s,o,i),c=le("dtype",s,o,i);return[ml(a,le("value",s,o,i),c)];case"LinSpace":var p=le("start",s,o,i);return[Bh(p,le("stop",s,o,i),le("num",s,o,i))];case"Multinomial":var v=le("logits",s,o,i),y=le("numSamples",s,o,i),C=le("seed",s,o,i);return[Zn(v,y,C)];case"OneHot":var S=le("indices",s,o,i),M=le("depth",s,o,i),O=le("onValue",s,o,i),N=le("offValue",s,o,i);return[Ul(S,M,O,N)];case"Ones":return[ao(le("shape",s,o,i),le("dtype",s,o,i))];case"OnesLike":return[ua(le("x",s,o,i))];case"RandomUniform":return[Hl(le("shape",s,o,i),le("minval",s,o,i),le("maxval",s,o,i),le("dtype",s,o,i))];case"Range":return[au(p=le("start",s,o,i),le("stop",s,o,i),le("step",s,o,i),le("dtype",s,o,i))];case"TruncatedNormal":a=le("shape",s,o,i);var W=le("mean",s,o,i),G=le("stdDev",s,o,i);return C=le("seed",s,o,i),[jl(a,W,G,le("dtype",s,o,i),C)];case"Zeros":return[fn(le("shape",s,o,i),le("dtype",s,o,i))];case"ZerosLike":return[$n(le("x",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"dynamic":return function FF(s,o,i){return Nl(this,void 0,void 0,function(){var a,c,u,p,m;return Td(this,function(g){switch(g.label){case 0:switch(s.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return a=le("boxes",s,o,i),c=le("scores",s,o,i),u=le("maxOutputSize",s,o,i),p=le("iouThreshold",s,o,i),m=le("scoreThreshold",s,o,i),[4,Ql.nonMaxSuppressionAsync(a,c,u,p,m)];case 2:case 4:return[2,[g.sent()]];case 3:return[4,fp(le("condition",s,o,i).asType("bool"))];case 5:return[2,_o(le("x",s,o,i),le("y",s,o,i))];case 6:throw TypeError("Node type "+s.op+" is not implemented")}})})}(c,u,p);case"evaluation":return function(s,o,i){if("TopKV2"===s.op){var a=le("x",s,o,i),c=le("k",s,o,i),u=le("sorted",s,o,i),p=Ou(a,c,u);return[p.values,p.indices]}throw TypeError("Node type "+s.op+" is not implemented")}(c,u,p);case"image":return function(s,o,i){switch(s.op){case"ResizeBilinear":var a=le("images",s,o,i),c=le("size",s,o,i),u=le("alignCorners",s,o,i);return[Ql.resizeBilinear(a,[c[0],c[1]],u)];case"ResizeNearestNeighbor":return a=le("images",s,o,i),c=le("size",s,o,i),u=le("alignCorners",s,o,i),[Ql.resizeNearestNeighbor(a,[c[0],c[1]],u)];case"CropAndResize":var p=le("image",s,o,i),m=le("boxes",s,o,i),g=le("boxInd",s,o,i),v=le("cropSize",s,o,i),y=le("method",s,o,i),C=le("extrapolationValue",s,o,i);return[Ql.cropAndResize(p,m,g,v,y,C)];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"graph":return function(s,o,i){switch(s.op){case"Const":return o[s.name];case"PlaceholderWithDefault":var a=le("default",s,o,i);return[Ot(s.name,o,i)||a];case"Placeholder":return[Ot(s.name,o,i)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[le("x",s,o,i).clone()];case"IdentityN":return le("x",s,o,i).map(function(v){return v.clone()});case"Shape":return[Pn(le("x",s,o,i).shape,"int32")];case"ShapeN":return le("x",s,o,i).map(function(v){return Pn(v.shape)});case"Size":return[Nt(le("x",s,o,i).size,"int32")];case"Rank":return[Nt(le("x",s,o,i).rank,"int32")];case"NoOp":return[];case"Print":var c=le("x",s,o,i),u=le("data",s,o,i),p=le("message",s,o,i),m=le("summarize",s,o,i);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(p);for(var g=0;g<u.length;g++)console.log(Array.prototype.slice.call(u[g].dataSync()).slice(0,m));return[c];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"logical":return function(s,o,i){switch(s.op){case"Equal":return[Jc(le("a",s,o,i),le("b",s,o,i))];case"NotEqual":return[ed(le("a",s,o,i),le("b",s,o,i))];case"Greater":return[Tu(le("a",s,o,i),le("b",s,o,i))];case"GreaterEqual":return[gp(le("a",s,o,i),le("b",s,o,i))];case"Less":return[Rv(le("a",s,o,i),le("b",s,o,i))];case"LessEqual":return[Fv(le("a",s,o,i),le("b",s,o,i))];case"LogicalAnd":return[fs(le("a",s,o,i),le("b",s,o,i))];case"LogicalNot":return[Cm(le("a",s,o,i))];case"LogicalOr":return[ku(le("a",s,o,i),le("b",s,o,i))];case"Select":return[Na(le("condition",s,o,i),le("a",s,o,i),le("b",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"matrices":return function(s,o,i){switch(s.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Au(le("a",s,o,i),le("b",s,o,i),le("transposeA",s,o,i),le("transposeB",s,o,i))];case"Transpose":return[ur(le("x",s,o,i),le("perm",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"normalization":return function(s,o,i){switch(s.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[wm(le("x",s,o,i),le("mean",s,o,i),le("variance",s,o,i),le("offset",s,o,i),le("scale",s,o,i),le("epsilon",s,o,i))];case"LRN":return[Gv(le("x",s,o,i),le("radius",s,o,i),le("bias",s,o,i),le("alpha",s,o,i),le("beta",s,o,i))];case"Softmax":return[du(le("x",s,o,i))];case"LogSoftmax":return[q_(le("x",s,o,i))];case"SparseToDense":return[qv(le("sparseIndices",s,o,i),le("outputShape",s,o,i),le("sparseValues",s,o,i),le("defaultValue",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"reduction":return function(s,o,i){switch(s.op){case"Max":var a=le("axis",s,o,i),c=le("keepDims",s,o,i);return[xa(le("x",s,o,i),a,c)];case"Mean":return a=le("axis",s,o,i),c=le("keepDims",s,o,i),[Or(le("x",s,o,i),a,c)];case"Min":return a=le("axis",s,o,i),c=le("keepDims",s,o,i),[jm(le("x",s,o,i),a,c)];case"Sum":return a=le("axis",s,o,i),c=le("keepDims",s,o,i),[wa(le("x",s,o,i),a,c)];case"All":return a=le("axis",s,o,i),c=le("keepDims",s,o,i),[ad(le("x",s,o,i),a,c)];case"Any":return a=le("axis",s,o,i),c=le("keepDims",s,o,i),[sd(le("x",s,o,i),a,c)];case"ArgMax":return a=le("axis",s,o,i),[Fu(le("x",s,o,i),a)];case"ArgMin":return a=le("axis",s,o,i),[Hm(le("x",s,o,i),a)];case"Prod":return a=le("axis",s,o,i),c=le("keepDims",s,o,i),[Wm(le("x",s,o,i),a,c)];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"slice_join":return function(s,o,i){switch(s.op){case"ConcatV2":case"Concat":var a=le("axis",s,o,i),c=le("tensors",s,o,i);return[Ur(c,a)];case"GatherV2":case"Gather":a=le("axis",s,o,i);var u=le("x",s,o,i),p=le("indices",s,o,i);return[td(u,p.asType("int32"),a)];case"ReverseV2":case"Reverse":return a=le("axis",s,o,i),u=le("x",s,o,i),[ya(u,a)];case"Slice":var m=le("begin",s,o,i),g=le("size",s,o,i);return[Pa(le("x",s,o,i),m,g)];case"StridedSlice":m=le("begin",s,o,i);var v=le("end",s,o,i),y=le("strides",s,o,i),C=le("beginMask",s,o,i),S=le("endMask",s,o,i),M=le("ellipsisMask",s,o,i),O=le("newAxisMask",s,o,i),N=le("shrinkAxisMask",s,o,i),P=le("x",s,o,i);if(1===m.length&&P.shape.length>1)for(var B=1;B<P.shape.length;B++)m.push(0),v.push(P.shape[B]),y.push(y[0]);return[$v(P,m,v,y,C,S,M,O,N)];case"Pack":return $e(function(){var _e=le("axis",s,o,i),me=le("tensors",s,o,i),Me=me[0].shape,Te=me[0].squeeze().shape,Ue=me.map(function(Xe){var et=qe.arraysEqual(Xe.shape,Me);if(!et&&!qe.arraysEqual(Xe.squeeze().shape,Te))throw new Error("the input tensors shape does not match");return et?Xe:Xe.reshape(Me)});return[Qa(Ue,_e)]});case"Unpack":return $e(function(){var _e=le("axis",s,o,i),me=le("tensor",s,o,i);return Ja(me,_e)});case"Tile":var W=le("reps",s,o,i);return[us(le("x",s,o,i),W)];case"Split":case"SplitV":a=le("axis",s,o,i);var G=le("numOrSizeSplits",s,o,i);return Os(le("x",s,o,i),G,a);case"ScatterNd":p=le("indices",s,o,i);var X=le("values",s,o,i),Q=le("shape",s,o,i);return[ms(p,X,Q)];case"GatherNd":var se=le("x",s,o,i);return p=le("indices",s,o,i),[Lw(se,p)];case"SparseToDense":p=le("sparseIndices",s,o,i),Q=le("outputShape",s,o,i);var ue=le("sparseValues",s,o,i),fe=le("defaultValue",s,o,i);return[qv(p,ue,Q,ue.dtype===fe.dtype?fe:fe.asType(ue.dtype))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"spectral":return function(s,o,i){switch(s.op){case"FFT":return[xl(le("x",s,o,i))];case"IFFT":return[ld(le("x",s,o,i))];case"RFFT":return[Nu(le("x",s,o,i))];case"IRFFT":return[bp(le("x",s,o,i))];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"transformation":return function(s,o,i){switch(s.op){case"Cast":return[Ns(le("x",s,o,i),le("dtype",s,o,i))];case"ExpandDims":var a=le("axis",s,o,i);return[Lo(le("x",s,o,i),a)];case"Squeeze":return a=le("axis",s,o,i),[Vc(le("x",s,o,i),a)];case"Reshape":return[Yi(le("x",s,o,i),le("shape",s,o,i))];case"PadV2":case"Pad":return[Xa(le("x",s,o,i),Lg(le("padding",s,o,i),2),le("constantValue",s,o,i))];case"SpaceToBatchND":var c=le("blockShape",s,o,i),u=Lg(le("paddings",s,o,i),2);return[j_(le("x",s,o,i),c,u)];case"BatchToSpaceND":c=le("blockShape",s,o,i);var p=Lg(le("crops",s,o,i),2);return[pa(le("x",s,o,i),c,p)];case"DepthToSpace":var m=le("blockSize",s,o,i),g=le("dataFormat",s,o,i).toUpperCase();return[gr(le("x",s,o,i),m,g)];default:throw TypeError("Node type "+s.op+" is not implemented")}}(c,u,p);case"custom":var m=JC(c.op);if(m&&m.customExecutor)return m.customExecutor(new xT(c,u,p));throw TypeError("Custom op "+c.op+" is not registered.");default:throw TypeError("Unknown op '"+c.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(s,o,i);return a instanceof Promise?a.then(function(c){return[].concat(c)}):[].concat(a)}var lf=function(){function s(o,i){this.weightMap=o,this.tensorArrayMap=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return s.prototype.newFrame=function(o,i){return{id:o,frameName:i,iterationId:0}},Object.defineProperty(s.prototype,"currentContext",{get:function(){return this.contexts},set:function(o){this.contexts!==o&&(this.contexts=o,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),s.prototype.generateCurrentContextIds=function(){for(var o=[],i=0;i<this.contexts.length-1;i++){var a=this.contexts.slice(0,this.contexts.length-i);o.push(this.contextIdforContexts(a))}o.push(""),this._currentContextIds=o},s.prototype.contextIdforContexts=function(o){return o?o.map(function(i){return 0===i.id&&0===i.iterationId?"":i.frameName+"-"+i.iterationId}).join("/"):""},s.prototype.enterFrame=function(o){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,o)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},s.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},s.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var o=Object.assign({},this.contexts[this.contexts.length-1]);o.iterationId+=1,o.id=this.lastId,this.contexts.splice(-1,1,o),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},s.prototype.getWeight=function(o){return this.weightMap[o]},s.prototype.addTensorArray=function(o){this.tensorArrayMap[o.id]=o},s.prototype.getTensorArray=function(o){return this.tensorArrayMap[o]},s}();function cf(s,o,i){for(var a=new Set,c=[],u=null,p=null,m=new Set,g=o.slice();g.length>0;){var v=g.pop();(Gg(v)||xS(v))&&null==u&&(p=(u=v).children.map(function(y){return y.name}).filter(function(y){return a.has(y)})),a.add(v.name),null==i[v.name]&&null==s[v.name]&&(0!==v.inputs.length?v.inputs.forEach(function(y){m.has(y.name)||(m.add(y.name),g.push(y))}):c.push(v.name))}return{inputs:s,outputs:o,usedNodes:a,missingInputs:c,dynamicNode:u,syncInputs:p}}var yS=["Switch","Merge","Enter","Exit","NextIteration"],HF=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function Gg(s){return yS.indexOf(s.op)>=0}function xS(s){return HF.indexOf(s.op)>=0}var n0=function(){function s(o){this.graph=o,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=o.placeholders,this._outputs=o.outputs}return Object.defineProperty(s.prototype,"weightMap",{get:function(){return this._weightMap},set:function(o){var i=Object.keys(o).map(function(a){return o[a].map(function(c){return c.id})});this.weightIds=[].concat.apply([],i),this._weightMap=o},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"inputs",{get:function(){return this.placeholders.map(function(o){return{name:o.name,shape:o.attrParams.shape?o.attrParams.shape.value:void 0,dtype:o.attrParams.dtype?o.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"outputs",{get:function(){return this._outputs.map(function(o){return{name:o.name,shape:o.attrParams.shape?o.attrParams.shape.value:void 0,dtype:o.attrParams.dtype?o.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(o){return o.name})},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"outputNodes",{get:function(){return this.outputs.map(function(o){return o.name})},enumerable:!0,configurable:!0}),s.prototype.getCompilationKey=function(o,i){var a=o.map(function(u){return u.name}).sort(),c=i.map(function(u){return u.name}).sort();return a.join(this.SEPERATOR)+"--"+c.join(this.SEPERATOR)},s.prototype.compile=function(o,i){var a=cf(o,i,this.weightMap),c=a.missingInputs,u=a.dynamicNode;if(null!=u)throw new Error("This execution contains the node '"+u.name+"', which has the dynamic op '"+u.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+a.syncInputs+"]");if(c.length>0){var m=i.map(function(v){return v.name}),g=Object.keys(o);throw new Error("Cannot compute the outputs ["+m+"] from the provided inputs ["+g+"]. Missing the following inputs: ["+c+"]")}return function dh(s,o,i){var a=i.usedNodes,u=[];Object.keys(i.inputs).map(function(v){return s.nodes[v]}).forEach(function(v){a.has(v.name)&&u.push(v)}),s.weights.forEach(function(v){a.has(v.name)&&u.push(v)});for(var p=new Set,m=[];u.length>0;){var g=u.pop();p.add(g.name),o[g.name]||m.push(g),g.children.forEach(function(v){!p.has(v.name)&&a.has(v.name)&&v.inputs.every(function(y){return p.has(y.name)})&&u.push(v)})}return m}(this.graph,this.weightMap,a)},s.prototype.execute=function(o,i){var a=this,c=Object.keys(o).sort();this.checkInputs(o),this.checkInputShapeAndType(o),this.checkOutputs(i);var u=c.map(function(y){return a.graph.nodes[y]}),p=i.map(function(y){return a.graph.nodes[rf(y)[0]]}),m=this.getCompilationKey(u,p),g=this.compiledMap.get(m);null==g&&(g=this.compile(o,p),this.compiledMap.set(m,g));var v={};return $e(function(){var y=new lf(a._weightMap,v),C=nf({},a.weightMap);Object.keys(o).forEach(function(B){C[B]=[o[B]]});for(var S=a.getFrozenTensorIds(C),M={},O=0;O<g.length;O++){var N=g[O];if(!C[N.name]){var P=ST(N,C,y);if(P instanceof Promise)throw new Error("The execution of the op '"+N.op+"' returned a promise. Please use model.executeAsync() instead.");C[N.name]=P,a.checkTensorForDisposal(N.name,N,C,y,S,i,M)}}return i.map(function(B){return Ot(B,C,y)})})},s.prototype.getFrozenTensorIds=function(o){var i=[].concat.apply([],Object.keys(o).map(function(a){return o[a]}).map(function(a){return a.map(function(c){return c.id})}));return new Set(i)},s.prototype.checkTensorForDisposal=function(o,i,a,c,u,p,m){"control"!==i.category&&-1===p.indexOf(o)&&(a[o].forEach(function(g){null!=g&&(m[g.id]=(m[g.id]||0)+i.children.length)}),i.inputs.forEach(function(g){if("control"!==g.category){var v=function Ti(s,o,i){return o[Kt(s,i.currentContextId)]}(g.name,a,c);v?.forEach(function(y){if(y&&!u.has(y.id)){var C=m[y.id];1===C?(y.dispose(),delete m[y.id]):null!=C&&m[y.id]--}})}}))},s.prototype.executeAsync=function(o,i){return Nl(this,void 0,void 0,function(){var c,u,p,m,g,v=this;return Td(this,function(y){switch(y.label){case 0:return this.checkInputs(o),this.checkInputShapeAndType(o),this.checkOutputs(i),c=new lf(this._weightMap,{}),[4,this.executeWithControlFlow(o,c,i)];case 1:return u=y.sent(),p=i.map(function(C){return Ot(C,u,c)}),m=new Set(p.map(function(C){return C.id})),g=new Set(Object.keys(o).map(function(C){return o[C].id})),Object.keys(u).forEach(function(C){u[C].forEach(function(S){!S||S.isDisposed||m.has(S.id)||g.has(S.id)||-1!==v.weightIds.indexOf(S.id)||S.dispose()})}),[2,p]}})})},s.prototype.executeWithControlFlow=function(o,i,a){return Nl(this,void 0,void 0,function(){var c,u,p,m,g,v,y,C,S,M,O,N,P,B,W,G,X=this;return Td(this,function(Q){switch(Q.label){case 0:c=Object.keys(o),u=c.map(function(se){return X.graph.nodes[se]}),p=a.map(function(se){return X.graph.nodes[rf(se)[0]]}),m=cf(o,p,this.weightMap),g=m.usedNodes,v=m.missingInputs,y=m.dynamicNode,C=m.syncInputs,S=u.concat(this.graph.weights).map(function(se){return{node:se,contexts:i.currentContext}}),M=nf({},this.weightMap),Object.keys(o).forEach(function(se){M[se]=[o[se]]}),O={},N=this.getFrozenTensorIds(M),P={},Q.label=1;case 1:return S.length>0?(B=this.processStack(u,S,i,M,P,N,a,O,g),[4,Promise.all(B)]):[3,3];case 2:return Q.sent(),[3,1];case 3:if(null==y&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(W=p.filter(function(se){return!Gg(se)&&!Ot(se.name,M,i)}).map(function(se){return se.name})).length>0)throw G="",null!=y&&(G="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+C+"]"),new Error("Cannot compute the outputs ["+W+"] from the provided inputs ["+c+"]. Consider providing the following inputs: ["+v+"]. "+G);return[2,M]}})})},s.prototype.processStack=function(o,i,a,c,u,p,m,g,v){for(var y=this,C=[],S=function(){var O=i.pop();a.currentContext=O.contexts;var N="";if("Enter"===O.node.op&&le("isConstant",O.node,c,a)&&(N=vi(O.node.name,a)[0]),-1===o.indexOf(O.node)){var P=ST(O.node,c,a);N||(N=vi(O.node.name,a)[0]);var B=a.currentContext;P instanceof Promise?C.push(P.then(function(W){return c[N]=W,a.currentContext=B,y.checkTensorForDisposal(N,O.node,c,a,p,m,g),y.processChildNodes(O.node,i,a,c,u,v),W})):(c[N]=P,M.checkTensorForDisposal(N,O.node,c,a,p,m,g),M.processChildNodes(O.node,i,a,c,u,v))}else M.processChildNodes(O.node,i,a,c,u,v)},M=this;i.length>0;)S();return C},s.prototype.processChildNodes=function(o,i,a,c,u,p){o.children.forEach(function(m){var g=vi(m.name,a)[0];!u[g]&&p.has(m.name)&&("Merge"===m.op?m.inputNames.some(function(v){return!!Ot(v,c,a)})&&(u[g]=!0,i.push({contexts:a.currentContext,node:m})):m.inputNames.every(function(v){return!!Ot(v,c,a)})&&(u[g]=!0,i.push({contexts:a.currentContext,node:m})))})},s.prototype.dispose=function(){var o=this;Object.keys(this.weightMap).forEach(function(i){return o.weightMap[i].forEach(function(a){return a.dispose()})})},s.prototype.checkInputShapeAndType=function(o){var i=this;Object.keys(o).forEach(function(a){var c=o[a],u=i.graph.nodes[a];if(u.attrParams.shape&&u.attrParams.shape.value){var p=u.attrParams.shape.value,m=p.length===c.shape.length&&c.shape.every(function(g,v){return-1===p[v]||p[v]===g});qe.assert(m,function(){return"The shape of dict['"+u.name+"'] provided in model.execute(dict) must be ["+p+"], but was ["+c.shape+"]"})}u.attrParams.dtype&&u.attrParams.dtype.value&&qe.assert(c.dtype===u.attrParams.dtype.value,function(){return"The dtype of dict['"+u.name+"'] provided in model.execute(dict) must be "+u.attrParams.dtype.value+", but was "+c.dtype})})},s.prototype.checkInputs=function(o){var i=this,a=Object.keys(o).filter(function(c){return!i.graph.nodes[c]});if(a.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+a+"] that are not part of graph")},s.prototype.checkOutputs=function(o){var i=this;o.forEach(function(a){var c=rf(a)[0];if(!i.graph.nodes[c])throw new Error("The output '"+a+"' is not found in the graph")})},s}(),no=function(){function s(o,i){void 0===i&&(i={}),this.modelUrl=o,this.loadOptions=i,this.version="n/a",null==i&&(this.loadOptions={})}return Object.defineProperty(s.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),s.prototype.findIOHandler=function(){var o=this.modelUrl;if(null!=o.load)this.handler=o;else if(null!=this.loadOptions.requestInit)this.handler=Sa.browserHTTPRequest(o,this.loadOptions);else{var i=Sa.getLoadHandlers(o,this.loadOptions.onProgress);if(0===i.length)i.push(Sa.browserHTTPRequest(o,this.loadOptions));else if(i.length>1)throw new Error("Found more than one ("+i.length+") load handlers for URL '"+[o]+"'");this.handler=i[0]}},s.prototype.load=function(){return Nl(this,void 0,void 0,function(){var o,i,a;return Td(this,function(c){switch(c.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return o=c.sent(),this.version=(i=o.modelTopology).versions.producer+"."+i.versions.minConsumer,a=Sa.decodeWeights(o.weightData,o.weightSpecs),this.executor=new n0(Zy.Instance.transformGraph(i)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),[2,!0]}})})},s.prototype.predict=function(o,i){return this.execute(o,this.outputNodes)},s.prototype.normalizeInputs=function(o){if(!(o instanceof ki||Array.isArray(o)))return o;if((o=Array.isArray(o)?o:[o]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+o.length+" input tensors.");return this.inputNodes.reduce(function(i,a,c){return i[a]=o[c],i},{})},s.prototype.normalizeOutputs=function(o){return o=o||this.outputNodes,Array.isArray(o)?o:[o]},s.prototype.execute=function(o,i){o=this.normalizeInputs(o),i=this.normalizeOutputs(i);var a=this.executor.execute(o,i);return a.length>1?a:a[0]},s.prototype.executeAsync=function(o,i){return Nl(this,void 0,void 0,function(){var a;return Td(this,function(c){switch(c.label){case 0:return o=this.normalizeInputs(o),i=this.normalizeOutputs(i),[4,this.executor.executeAsync(o,i)];case 1:return[2,(a=c.sent()).length>1?a:a[0]]}})})},s.prototype.convertTensorMapToTensorsMap=function(o){return Object.keys(o).reduce(function(i,a){return i[a]=[o[a]],i},{})},s.prototype.dispose=function(){this.executor.dispose()},s}();function DT(s,o){return void 0===o&&(o={}),Nl(this,void 0,void 0,function(){var i;return Td(this,function(a){switch(a.label){case 0:if(null==s)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==o&&(o={}),o.fromTFHub&&null==s.load&&(s.endsWith("/")||(s+="/"),s+="model.json?tfjs-format=file"),[4,(i=new no(s,o)).load()];case 1:return a.sent(),[2,i]}})})}var CS="1.3.1",Cs=function(s,o){return(Cs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var c in a)a.hasOwnProperty(c)&&(i[c]=a[c])})(s,o)};function Vi(s,o){function i(){this.constructor=s}Cs(s,o),s.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}function jt(s,o,i,a){return new(i||(i=Promise))(function(c,u){function p(v){try{g(a.next(v))}catch(y){u(y)}}function m(v){try{g(a.throw(v))}catch(y){u(y)}}function g(v){v.done?c(v.value):new i(function(y){y(v.value)}).then(p,m)}g((a=a.apply(s,o||[])).next())})}function Wt(s,o){var i,a,c,u,p={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:m(0),throw:m(1),return:m(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function m(g){return function(v){return function(y){if(i)throw new TypeError("Generator is already executing.");for(;p;)try{if(i=1,a&&(c=2&y[0]?a.return:y[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,y[1])).done)return c;switch(a=0,c&&(y=[2&y[0],c.value]),y[0]){case 0:case 1:c=y;break;case 4:return p.label++,{value:y[1],done:!1};case 5:p.label++,a=y[1],y=[0];continue;case 7:y=p.ops.pop(),p.trys.pop();continue;default:if(!(c=(c=p.trys).length>0&&c[c.length-1])&&(6===y[0]||2===y[0])){p=0;continue}if(3===y[0]&&(!c||y[1]>c[0]&&y[1]<c[3])){p.label=y[1];break}if(6===y[0]&&p.label<c[1]){p.label=c[1],c=y;break}if(c&&p.label<c[2]){p.label=c[2],p.ops.push(y);break}c[2]&&p.ops.pop(),p.trys.pop();continue}y=o.call(s,p)}catch(C){y=[6,C],a=0}finally{i=c=0}if(5&y[0])throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}([g,v])}}}function Id(s,o){return s(o={exports:{}},o.exports),o.exports}typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;var SS=Id(function(s){!function(o,i,a){function c(p,m){return m.c=p.c,m.s0=p.s0,m.s1=p.s1,m.s2=p.s2,m}function u(p,m){var g=new function(C){var S,M=this,O=(S=4022871197,function(N){N=N.toString();for(var P=0;P<N.length;P++){var B=.02519603282416938*(S+=N.charCodeAt(P));B-=S=B>>>0,S=(B*=S)>>>0,S+=4294967296*(B-=S)}return 2.3283064365386963e-10*(S>>>0)});M.next=function(){var N=2091639*M.s0+2.3283064365386963e-10*M.c;return M.s0=M.s1,M.s1=M.s2,M.s2=N-(M.c=0|N)},M.c=1,M.s0=O(" "),M.s1=O(" "),M.s2=O(" "),M.s0-=O(C),M.s0<0&&(M.s0+=1),M.s1-=O(C),M.s1<0&&(M.s1+=1),M.s2-=O(C),M.s2<0&&(M.s2+=1),O=null}(p),v=m&&m.state,y=g.next;return y.int32=function(){return 4294967296*g.next()|0},y.double=function(){return y()+11102230246251565e-32*(2097152*y()|0)},y.quick=y,v&&("object"==typeof v&&c(v,g),y.state=function(){return c(g,{})}),y}i&&i.exports?i.exports=u:this.alea=u}(0,s)}),ET=Id(function(s){!function(o,i,a){function c(p,m){return m.x=p.x,m.y=p.y,m.z=p.z,m.w=p.w,m}function u(p,m){var g=new function(C){var S=this,M="";S.x=0,S.y=0,S.z=0,S.w=0,S.next=function(){var N=S.x^S.x<<11;return S.x=S.y,S.y=S.z,S.z=S.w,S.w^=S.w>>>19^N^N>>>8},C===(0|C)?S.x=C:M+=C;for(var O=0;O<M.length+64;O++)S.x^=0|M.charCodeAt(O),S.next()}(p),v=m&&m.state,y=function(){return(g.next()>>>0)/4294967296};return y.double=function(){do{var C=((g.next()>>>11)+(g.next()>>>0)/4294967296)/2097152}while(0===C);return C},y.int32=g.next,y.quick=y,v&&("object"==typeof v&&c(v,g),y.state=function(){return c(g,{})}),y}i&&i.exports?i.exports=u:this.xor128=u}(0,s)}),WF=Id(function(s){!function(o,i,a){function c(p,m){return m.x=p.x,m.y=p.y,m.z=p.z,m.w=p.w,m.v=p.v,m.d=p.d,m}function u(p,m){var g=new function(C){var S=this,M="";S.next=function(){var N=S.x^S.x>>>2;return S.x=S.y,S.y=S.z,S.z=S.w,S.w=S.v,(S.d=S.d+362437|0)+(S.v=S.v^S.v<<4^N^N<<1)|0},S.x=0,S.y=0,S.z=0,S.w=0,S.v=0,C===(0|C)?S.x=C:M+=C;for(var O=0;O<M.length+64;O++)S.x^=0|M.charCodeAt(O),O==M.length&&(S.d=S.x<<10^S.x>>>4),S.next()}(p),v=m&&m.state,y=function(){return(g.next()>>>0)/4294967296};return y.double=function(){do{var C=((g.next()>>>11)+(g.next()>>>0)/4294967296)/2097152}while(0===C);return C},y.int32=g.next,y.quick=y,v&&("object"==typeof v&&c(v,g),y.state=function(){return c(g,{})}),y}i&&i.exports?i.exports=u:this.xorwow=u}(0,s)}),kT=Id(function(s){!function(o,i,a){function c(p,m){return m.x=p.x.slice(),m.i=p.i,m}function u(p,m){null==p&&(p=+new Date);var g=new function(C){var S=this;S.next=function(){var M,O,N=S.x,P=S.i;return M=N[P],O=(M^=M>>>7)^M<<24,O^=(M=N[P+1&7])^M>>>10,O^=(M=N[P+3&7])^M>>>3,O^=(M=N[P+4&7])^M<<7,M=N[P+7&7],O^=(M^=M<<13)^M<<9,N[P]=O,S.i=P+1&7,O},function(M,O){var N,P=[];if(O===(0|O))P[0]=O;else for(O=""+O,N=0;N<O.length;++N)P[7&N]=P[7&N]<<15^O.charCodeAt(N)+P[N+1&7]<<13;for(;P.length<8;)P.push(0);for(N=0;N<8&&0===P[N];++N);for(8==N&&(P[7]=-1),M.x=P,M.i=0,N=256;N>0;--N)M.next()}(S,C)}(p),v=m&&m.state,y=function(){return(g.next()>>>0)/4294967296};return y.double=function(){do{var C=((g.next()>>>11)+(g.next()>>>0)/4294967296)/2097152}while(0===C);return C},y.int32=g.next,y.quick=y,v&&(v.x&&c(v,g),y.state=function(){return c(g,{})}),y}i&&i.exports?i.exports=u:this.xorshift7=u}(0,s)}),DS=Id(function(s){!function(o,i,a){function c(p,m){return m.i=p.i,m.w=p.w,m.X=p.X.slice(),m}function u(p,m){null==p&&(p=+new Date);var g=new function(C){var S=this;S.next=function(){var M,O,N=S.w,P=S.X,B=S.i;return S.w=N=N+1640531527|0,O=P[B+34&127],M=P[B=B+1&127],O^=O<<13,M^=M<<17,O=P[B]=(O^=O>>>15)^(M^=M>>>12),S.i=B,O+(N^N>>>16)|0},function(M,O){var N,P,B,W,G,X=[],Q=128;for(O===(0|O)?(P=O,O=null):(O+="\0",P=0,Q=Math.max(Q,O.length)),B=0,W=-32;W<Q;++W)O&&(P^=O.charCodeAt((W+32)%O.length)),0===W&&(G=P),P^=P<<10,P^=P>>>15,P^=P<<4,P^=P>>>13,W>=0&&(B=0==(N=X[127&W]^=P+(G=G+1640531527|0))?B+1:0);for(B>=128&&(X[127&(O&&O.length||0)]=-1),B=127,W=512;W>0;--W)P=X[B+34&127],N=X[B=B+1&127],P^=P<<13,N^=N<<17,X[B]=(P^=P>>>15)^(N^=N>>>12);M.w=G,M.X=X,M.i=B}(S,C)}(p),v=m&&m.state,y=function(){return(g.next()>>>0)/4294967296};return y.double=function(){do{var C=((g.next()>>>11)+(g.next()>>>0)/4294967296)/2097152}while(0===C);return C},y.int32=g.next,y.quick=y,v&&(v.X&&c(v,g),y.state=function(){return c(g,{})}),y}i&&i.exports?i.exports=u:this.xor4096=u}(0,s)}),ES=Id(function(s){!function(o,i,a){function c(p,m){return m.a=p.a,m.b=p.b,m.c=p.c,m.d=p.d,m}function u(p,m){var g=new function(C){var S=this,M="";S.next=function(){var N=S.b,P=S.c,B=S.d,W=S.a;return N=N<<25^N>>>7^P,P=P-B|0,B=B<<24^B>>>8^W,W=W-N|0,S.b=N=N<<20^N>>>12^P,S.c=P=P-B|0,S.d=B<<16^P>>>16^W,S.a=W-N|0},S.a=0,S.b=0,S.c=-1640531527,S.d=1367130551,C===Math.floor(C)?(S.a=C/4294967296|0,S.b=0|C):M+=C;for(var O=0;O<M.length+20;O++)S.b^=0|M.charCodeAt(O),S.next()}(p),v=m&&m.state,y=function(){return(g.next()>>>0)/4294967296};return y.double=function(){do{var C=((g.next()>>>11)+(g.next()>>>0)/4294967296)/2097152}while(0===C);return C},y.int32=g.next,y.quick=y,v&&("object"==typeof v&&c(v,g),y.state=function(){return c(g,{})}),y}i&&i.exports?i.exports=u:this.tychei=u}(0,s)}),uh=Id(function(s){!function(o,i){var a,c=this,u=256,m="random",g=i.pow(u,6),v=i.pow(2,52),y=2*v,C=255;function S(P,B,W){var G=[],X=O(function ue(fe,_e){var me,Me=[],Te=typeof fe;if(_e&&"object"==Te)for(me in fe)try{Me.push(ue(fe[me],_e-1))}catch{}return Me.length?Me:"string"==Te?fe:fe+"\0"}((B=1==B?{entropy:!0}:B||{}).entropy?[P,N(o)]:P??function(){try{var ue;return a&&(ue=a.randomBytes)?ue=ue(u):(ue=new Uint8Array(u),(c.crypto||c.msCrypto).getRandomValues(ue)),N(ue)}catch{var fe=c.navigator,_e=fe&&fe.plugins;return[+new Date,c,_e,c.screen,N(o)]}}(),3),G),Q=new function(ue){var fe,_e=ue.length,me=this,Me=0,Te=me.i=me.j=0,Ue=me.S=[];for(_e||(ue=[_e++]);Me<u;)Ue[Me]=Me++;for(Me=0;Me<u;Me++)Ue[Me]=Ue[Te=C&Te+ue[Me%_e]+(fe=Ue[Me])],Ue[Te]=fe;(me.g=function(Xe){for(var et,it=0,nt=me.i,je=me.j,ut=me.S;Xe--;)et=ut[nt=C&nt+1],it=it*u+ut[C&(ut[nt]=ut[je=C&je+et])+(ut[je]=et)];return me.i=nt,me.j=je,it})(u)}(G),se=function(){for(var ue=Q.g(6),fe=g,_e=0;ue<v;)ue=(ue+_e)*u,fe*=u,_e=Q.g(1);for(;ue>=y;)ue/=2,fe/=2,_e>>>=1;return(ue+_e)/fe};return se.int32=function(){return 0|Q.g(4)},se.quick=function(){return Q.g(4)/4294967296},se.double=se,O(N(Q.S),o),(B.pass||W||function(ue,fe,_e,me){return me&&(me.S&&M(me,Q),ue.state=function(){return M(Q,{})}),_e?(i[m]=ue,fe):ue})(se,X,"global"in B?B.global:this==i,B.state)}function M(P,B){return B.i=P.i,B.j=P.j,B.S=P.S.slice(),B}function O(P,B){for(var W,G=P+"",X=0;X<G.length;)B[C&X]=C&(W^=19*B[C&X])+G.charCodeAt(X++);return N(B)}function N(P){return String.fromCharCode.apply(0,P)}if(i["seed"+m]=S,O(i.random(),o),s.exports){s.exports=S;try{a=Re(802)}catch{}}}([],Math)});uh.alea=SS,uh.xor128=ET,uh.xorwow=WF,uh.xorshift7=kT,uh.xor4096=DS,uh.tychei=ES;var kS=uh.alea;function $g(s,o,i,a){if(void 0===i&&(i=new Map),void 0===a&&(a=new Set),null==s)return null;if(a.has(s))throw new Error("Circular references are not supported.");if(i.has(s))return i.get(s);var c=o(s);if(c.recurse&&null!==c.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(c.recurse){if(hh(s)){var u=Array.isArray(s)?[]:{};for(var p in a.add(s),s){var m=$g(s[p],o,i,a);u[p]=m}return a.delete(s),u}throw new Error("Can't recurse into non-iterable type: "+s)}return i.set(s,c.value),c.value}function GF(s,o){return void 0===o&&(o=MS),ln(s,o)}function ln(s,o,i){void 0===i&&(i=new Set);var a=s[0];if(i.has(a))throw new Error("Circular references are not supported.");var c=o(s);if(c.recurse&&null!==c.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(c.recurse){if(hh(a)){var u=Array.isArray(a)?[]:{};i.add(a);var p=function(g){var v=ln(s.map(function(y){return y[g]}),o,i);u[g]=v};for(var m in a)p(m);return i.delete(a),u}throw new Error("Can't recurse into non-iterable type: "+a)}return c.value}function MS(s){return null===s?null:hh(s[0])?{value:null,recurse:!0}:{value:s,recurse:!1}}function qg(s,o){return jt(this,void 0,void 0,function(){var i,a,c,u,p,m;return Wt(this,function(g){switch(g.label){case 0:$g(s,o,i=new Map),a=0,c=Array.from(i.keys()),g.label=1;case 1:return a<c.length?(p=i.get(u=c[a]))instanceof Promise?[4,p]:[3,3]:[3,4];case 2:m=g.sent(),i.set(u,m),g.label=3;case 3:return a++,[3,1];case 4:return[2,$g(s,o,i)]}})})}function hh(s){return null!=s&&!ArrayBuffer.isView(s)&&(Array.isArray(s)||"object"==typeof s&&!(s instanceof ki))}function TS(s){return function r0(s,o){return $g(s,o)}(s,IS)}function IS(s){return s instanceof ki?{value:s.clone(),recurse:!1}:hh(s)?{value:null,recurse:!0}:{value:s,recurse:!1}}var AS=function(){function s(o){if(this.capacity=o,this.begin=0,this.end=0,null==o)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(o<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(o),this.doubledCapacity=2*o}return s.prototype.wrap=function(o){for(;o<0;)o+=this.doubledCapacity;return o%this.doubledCapacity},s.prototype.get=function(o){if(o<0)throw new RangeError("Can't get item at a negative index.");return this.data[o%this.capacity]},s.prototype.set=function(o,i){if(o<0)throw new RangeError("Can't set item at a negative index.");this.data[o%this.capacity]=i},s.prototype.length=function(){var o=this.end-this.begin;return o<0&&(o=this.doubledCapacity+o),o},s.prototype.isFull=function(){return this.length()===this.capacity},s.prototype.isEmpty=function(){return 0===this.length()},s.prototype.push=function(o){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,o),this.end=this.wrap(this.end+1)},s.prototype.pushAll=function(o){for(var i=0,a=o;i<a.length;i++)this.push(a[i])},s.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var o=this.get(this.end);return this.set(this.end,void 0),o},s.prototype.unshift=function(o){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,o)},s.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var o=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),o},s.prototype.shuffleExcise=function(o){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var i=this.wrap(this.begin+o),a=this.get(i);return this.set(i,this.pop()),a},s}(),RS=function(s){function o(){return s.call(this,o.INITIAL_CAPACITY)||this}return Vi(o,s),o.prototype.isFull=function(){return!1},o.prototype.push=function(i){s.prototype.isFull.call(this)&&this.expand(),s.prototype.push.call(this,i)},o.prototype.unshift=function(i){s.prototype.isFull.call(this)&&this.expand(),s.prototype.unshift.call(this,i)},o.prototype.expand=function(){for(var i=2*this.capacity,a=new Array(i),c=this.length(),u=0;u<c;u++)a[u]=this.get(this.wrap(this.begin+u));this.data=a,this.capacity=i,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=c},o.INITIAL_CAPACITY=32,o}(AS);function df(s){return new FS(s)}function uf(s){return new s0(s)}function a0(s,o){return new LS(s,o)}function TT(s,o){return void 0===o&&(o=tl.FAIL),new BS(s,o)}var tl,nr=function(){function s(){}return s.prototype.toArray=function(){return jt(this,void 0,void 0,function(){var o,i;return Wt(this,function(a){switch(a.label){case 0:return o=[],[4,this.next()];case 1:i=a.sent(),a.label=2;case 2:return i.done?[3,4]:(o.push(i.value),[4,this.next()]);case 3:return i=a.sent(),[3,2];case 4:return[2,o]}})})},s.prototype.toArrayForTest=function(){return jt(this,void 0,void 0,function(){var o,i,a;return Wt(this,function(c){switch(c.label){case 0:return o=this.prefetch(100),i=[],[4,o.next()];case 1:a=c.sent(),c.label=2;case 2:return a.done?[3,4]:(i.push(a.value),[4,o.next()]);case 3:return a=c.sent(),[3,2];case 4:return[2,i]}})})},s.prototype.resolveFully=function(){return jt(this,void 0,void 0,function(){var o;return Wt(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:o=i.sent(),i.label=2;case 2:return o.done?[3,4]:[4,this.next()];case 3:return o=i.sent(),[3,2];case 4:return[2]}})})},s.prototype.resolveWhile=function(o){return jt(this,void 0,void 0,function(){var i,a;return Wt(this,function(c){switch(c.label){case 0:return[4,this.next()];case 1:i=c.sent(),a=o(i.value),c.label=2;case 2:return i.done||!a?[3,4]:[4,this.next()];case 3:return i=c.sent(),a=o(i.value),[3,2];case 4:return[2]}})})},s.prototype.handleErrors=function(o){return new FT(this,o)},s.prototype.filter=function(o){return new OS(this,o)},s.prototype.map=function(o){return new RT(this,o)},s.prototype.mapAsync=function(o){return new l0(this,o)},s.prototype.serialMapAsync=function(o){return new l0(this,o).serial()},s.prototype.flatmap=function(o){return new PS(this,o)},s.prototype.forEachAsync=function(o){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return[2,this.map(o).resolveFully()]})})},s.prototype.serialForEach=function(o){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return[2,this.serialMapAsync(o).resolveWhile(function(a){return!0===a})]})})},s.prototype.rowMajorBatch=function(o,i){return void 0===i&&(i=!0),new AT(this,o,i)},s.prototype.columnMajorBatch=function(o,i,a){return void 0===i&&(i=!0),void 0===a&&(a=MS),this.rowMajorBatch(o,i).map(function(c){return GF(c,a)})},s.prototype.concatenate=function(o,i){return new LS(df([this,o]),i)},s.prototype.take=function(o){return o<0||null==o?this:new $F(this,o)},s.prototype.skip=function(o){return o<0||null==o?this:new IT(this,o)},s.prototype.prefetch=function(o){return new OT(this,o)},s.prototype.shuffle=function(o,i){return new c0(this,o,i)},s.prototype.serial=function(){return new Pl(this)},s}(),FS=function(s){function o(i){var a=s.call(this)||this;return a.items=i,a.trav=0,a}return Vi(o,s),o.prototype.summary=function(){return"Array of "+this.items.length+" items"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(a){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(i=this.items[this.trav],this.trav++,[2,{value:TS(i),done:!1}])})})},o}(nr),s0=function(s){function o(i){var a=s.call(this)||this;return a.nextFn=i,a}return Vi(o,s),o.prototype.summary=function(){return"Function call"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){try{return[2,this.nextFn()]}catch(a){throw a.message="Error thrown while iterating through a dataset: "+a.message,a}return[2]})})},o}(nr),Pl=function(s){function o(i){var a=s.call(this)||this;return a.upstream=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return[2,this.upstream.next()]})})},o}(nr),IT=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.maxCount=a,c.count=0,c.lastRead=Promise.resolve({value:null,done:!1}),c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(a){switch(a.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(i=a.sent()).done?[2,i]:(Kn(i.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},o}(nr),$F=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.maxCount=a,c.count=0,c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Take"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},o}(nr),AT=function(s){function o(i,a,c){void 0===c&&(c=!0);var u=s.call(this)||this;return u.upstream=i,u.batchSize=a,u.enableSmallLastBatch=c,u.lastRead=Promise.resolve({value:null,done:!1}),u}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){var i,a;return Wt(this,function(c){switch(c.label){case 0:i=[],c.label=1;case 1:return i.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(a=c.sent()).done?this.enableSmallLastBatch&&i.length>0?[2,{value:i,done:!1}]:[2,{value:null,done:!0}]:(i.push(a.value),[3,1]);case 3:return[2,{value:i,done:!1}]}})})},o}(nr),OS=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.predicate=a,c.lastRead=Promise.resolve({value:null,done:!1}),c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(i=a.sent()).done||this.predicate(i.value)?[2,i]:(Kn(i.value),[3,0]);case 2:return[2]}})})},o}(nr),RT=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.transform=a,c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Map"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i,a,c,u,p,m,g;return Wt(this,function(v){switch(v.label){case 0:return[4,this.upstream.next()];case 1:if((i=v.sent()).done)return[2,{value:null,done:!0}];for(a=ar.getTensorsInContainer(i.value),c=this.transform(i.value),u=ar.getTensorsInContainer(c),p=0,m=a;p<m.length;p++)ar.isTensorInList(g=m[p],u)||g.dispose();return[2,{value:c,done:!1}]}})})},o}(nr),FT=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.handler=a,c.count=0,c.lastRead=Promise.resolve({value:null,done:!1}),c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(a){switch(a.label){case 0:a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,a.sent()];case 3:return i=a.sent(),this.handler(i)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},o}(nr),l0=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.transform=a,c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i,a,c,u,p,m,g;return Wt(this,function(v){switch(v.label){case 0:return[4,this.upstream.next()];case 1:return(i=v.sent()).done?[2,{value:null,done:!0}]:(a=ar.getTensorsInContainer(i.value),[4,this.transform(i.value)]);case 2:for(c=v.sent(),u=ar.getTensorsInContainer(c),p=0,m=a;p<m.length;p++)ar.isTensorInList(g=m[p],u)||g.dispose();return[2,{value:c,done:!1}]}})})},o}(nr),NS=function(s){function o(){var i=s.call(this)||this;return i.outputQueue=new RS,i.lastRead=Promise.resolve({value:null,done:!1}),i}return Vi(o,s),o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){switch(i.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return i.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},o}(nr),PS=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.transform=a,c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},o.prototype.pump=function(){return jt(this,void 0,void 0,function(){var i,a,c,u,p,m,g;return Wt(this,function(v){switch(v.label){case 0:return[4,this.upstream.next()];case 1:if((i=v.sent()).done)return[2,!1];for(a=ar.getTensorsInContainer(i.value),c=this.transform(i.value),u=ar.getTensorsInContainer(c),this.outputQueue.pushAll(c),p=0,m=a;p<m.length;p++)ar.isTensorInList(g=m[p],u)||g.dispose();return[2,!0]}})})},o}(NS),LS=function(s){function o(i,a){var c=s.call(this)||this;return c.baseErrorHandler=a,c.lastRead=null,c.iterator=null,c.moreIterators=i,c}return Vi(o,s),o.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},o.prototype.next=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},o.prototype.readFromChain=function(i){return jt(this,void 0,void 0,function(){var a,c;return Wt(this,function(u){switch(u.label){case 0:return[4,i];case 1:return u.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((a=u.sent()).done)return[2,{value:null,done:!0}];this.iterator=a.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),u.label=3;case 3:return[4,this.iterator.next()];case 4:return(c=u.sent()).done?(this.iterator=null,[2,this.readFromChain(i)]):[2,c]}})})},o}(nr);!function(s){s[s.FAIL=0]="FAIL",s[s.SHORTEST=1]="SHORTEST",s[s.LONGEST=2]="LONGEST"}(tl||(tl={}));var BS=function(s){function o(i,a){void 0===a&&(a=tl.FAIL);var c=s.call(this)||this;return c.iterators=i,c.mismatchMode=a,c.count=0,c.currentPromise=null,c}return Vi(o,s),o.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},o.prototype.nextState=function(i){return jt(this,void 0,void 0,function(){function a(m){return m instanceof nr?{value:m.next().then(function(g){return c++,g.done&&u++,g.value}),recurse:!1}:{value:null,recurse:!0}}var c,u,p;return Wt(this,function(m){switch(m.label){case 0:return[4,i];case 1:return m.sent(),c=0,u=0,[4,qg(this.iterators,a)];case 2:if(p=m.sent(),c===u)return[2,{value:null,done:!0}];if(u>0)switch(this.mismatchMode){case tl.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case tl.SHORTEST:return[2,{value:null,done:!0}]}return this.count++,[2,{value:p,done:!1}]}})})},o.prototype.next=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},o}(nr),OT=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.bufferSize=a,c.buffer=new AS(a),c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},o.prototype.refill=function(){for(;!this.buffer.isFull();){var i=this.upstream.next();this.buffer.push(i)}},o.prototype.next=function(){return this.refill(),this.buffer.shift()},o}(nr),c0=function(s){function o(i,a,c){var u=s.call(this,i,a)||this;return u.upstream=i,u.windowSize=a,u.upstreamExhausted=!1,u.random=kS(c||qe.now().toString()),u.lastRead=Promise.resolve({value:null,done:!1}),u}return Vi(o,s),o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i=this;return Wt(this,function(a){return this.lastRead=this.lastRead.then(function(){return i.serialNext()}),[2,this.lastRead]})})},o.prototype.randomInt=function(i){return Math.floor(this.random()*i)},o.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},o.prototype.serialNext=function(){return jt(this,void 0,void 0,function(){var i,a;return Wt(this,function(c){switch(c.label){case 0:this.upstreamExhausted||this.refill(),c.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(i=this.chooseIndex(),[4,this.buffer.shuffleExcise(i)]);case 2:return(a=c.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,a]);case 3:return[2,{value:null,done:!0}]}})})},o}(OT),ph=function(){function s(){this.size=null}return s.prototype.batch=function(o,i){var a=this;void 0===i&&(i=!0);var c=this;return qe.assert(o>0,function(){return"batchSize needs to be positive, but it is\n      "+o}),ia(function(){return jt(a,void 0,void 0,function(){return Wt(this,function(u){switch(u.label){case 0:return[4,c.iterator()];case 1:return[2,u.sent().columnMajorBatch(o,i,US)]}})})},this.size===1/0||null==this.size?this.size:i?Math.ceil(this.size/o):Math.floor(this.size/o))},s.prototype.concatenate=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){var c,u;return Wt(this,function(p){switch(p.label){case 0:return[4,a.iterator()];case 1:return u=(c=p.sent()).concatenate,[4,o.iterator()];case 2:return[2,u.apply(c,[p.sent()])]}})})},this.size===1/0||o.size===1/0?1/0:null!=this.size&&null!=o.size?this.size+o.size:null)},s.prototype.filter=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,a.iterator()];case 1:return[2,c.sent().filter(function(u){return $e(function(){return o(u)})})]}})})},this.size===1/0?1/0:null)},s.prototype.forEachAsync=function(o){return jt(this,void 0,void 0,function(){return Wt(this,function(i){switch(i.label){case 0:return[4,this.iterator()];case 1:return[2,i.sent().forEachAsync(o)]}})})},s.prototype.forEach=function(o){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return St("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(o)]})})},s.prototype.map=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,a.iterator()];case 1:return[2,c.sent().map(function(u){return $e(function(){return o(u)})})]}})})},this.size)},s.prototype.mapAsync=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,a.iterator()];case 1:return[2,c.sent().mapAsync(o)]}})})},this.size)},s.prototype.prefetch=function(o){var i=this;if(null==o)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var a=this;return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,a.iterator()];case 1:return[2,c.sent().prefetch(o)]}})})},this.size)},s.prototype.repeat=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){var c=this;return Wt(this,function(u){return[2,a0(uf(function(){return jt(c,void 0,void 0,function(){var p;return Wt(this,function(m){switch(m.label){case 0:return p={},[4,a.iterator()];case 1:return[2,(p.value=m.sent(),p.done=!1,p)]}})})}).take(o))]})})},null!=this.size&&o>0?this.size*o:0===o?0:null!=this.size&&(void 0===o||o<0)?1/0:null)},s.prototype.skip=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,a.iterator()];case 1:return[2,c.sent().skip(o)]}})})},null!=this.size&&o>=0&&this.size>=o?this.size-o:null!=this.size&&(this.size<o||void 0===o||o<0)?0:null)},s.prototype.shuffle=function(o,i,a){var c=this;if(void 0===a&&(a=!0),null==o||o<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var u=this,p=kS(i||qe.now().toString());return ia(function(){return jt(c,void 0,void 0,function(){var m;return Wt(this,function(g){switch(g.label){case 0:return m=p.int32(),a&&(m+=p.int32()),[4,u.iterator()];case 1:return[2,g.sent().shuffle(o,m.toString())]}})})},this.size)},s.prototype.take=function(o){var i=this,a=this;return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,a.iterator()];case 1:return[2,c.sent().take(o)]}})})},null!=this.size&&this.size>o?o:null!=this.size&&this.size<=o?this.size:null)},s.prototype.toArray=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(o){switch(o.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,o.sent().toArray()]}})})},s.prototype.toArrayForTest=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(o){switch(o.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,o.sent().toArrayForTest()]}})})},s.MAX_BUFFER_SIZE=1e4,s}();function ia(s,o){return void 0===o&&(o=null),new(function(i){function a(){var c=null!==i&&i.apply(this,arguments)||this;return c.size=o,c}return Vi(a,i),a.prototype.iterator=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(c){return[2,s()]})})},a}(ph))}function zS(s){var o=this;return ia(function(){return jt(o,void 0,void 0,function(){return Wt(this,function(i){return[2,df(s)]})})},s.length)}function VS(s){var o,i=this;if(!hh(s))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(s))for(var a=0;a<s.length;a++)o=null==o?s[a].size:Math.min(o,s[a].size);else if(s instanceof Object)for(var c in s)o=null==o?s[c].size:Math.min(o,s[c].size);return ia(function(){return jt(i,void 0,void 0,function(){return Wt(this,function(u){switch(u.label){case 0:return[4,qg(s,function(p){if(p instanceof ph)return{value:p.iterator(),recurse:!1};if(hh(p))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,TT(u.sent(),tl.SHORTEST)]}})})},o)}function US(s){return null===s?null:function MT(s){return null==s||function o0(s){return null===s||"object"!=typeof s&&"function"!=typeof s}(s)||Array.isArray(s)||"object"==typeof s&&s instanceof ki||qe.isTypedArray(s)}(s[0])?{value:fh(s),recurse:!1}:{value:null,recurse:!0}}function fh(s){if(0===s.length)throw new Error("Can't make a batch of zero elements.");return s[0]instanceof ki?Qa(s):ei(s)}var hf=function(s){function o(i){var a=s.call(this)||this;return a.input=i,a}return Vi(o,s),o.prototype.iterator=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(c){switch(c.label){case 0:return[4,this.input.iterator()];case 1:return[2,c.sent().decodeUTF8().split("\n").map(function(u){return u.endsWith("\r")&&(u=u.slice(0,-1)),u})]}})})},o}(ph),ff=Symbol("out"),NT=Symbol("field"),d0=Symbol("quote"),HS=Symbol("quoteafterquote"),PT=Symbol("quoteinquote"),u0=function(s){function o(i,a){var c=s.call(this)||this;return c.input=i,c.hasHeader=!0,c.fullColumnNames=null,c.columnNamesValidated=!1,c.columnConfigs=null,c.configuredColumnsOnly=!1,c.delimiter=",",c.delimWhitespace=!1,c.base=new hf(i),a||(a={}),c.hasHeader=!1!==a.hasHeader,c.fullColumnNames=a.columnNames,c.columnConfigs=a.columnConfigs,c.configuredColumnsOnly=a.configuredColumnsOnly,a.delimWhitespace?(qe.assert(null==a.delimiter,function(){return"Delimiter should not be provided when delimWhitespace is true."}),c.delimWhitespace=!0,c.delimiter=" "):c.delimiter=a.delimiter?a.delimiter:",",c}return Vi(o,s),o.prototype.columnNames=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},o.prototype.setColumnNames=function(){return jt(this,void 0,void 0,function(){var i,a,c,u,p,m,g=this;return Wt(this,function(v){switch(v.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(i=v.sent(),!this.fullColumnNames&&!i)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&i&&qe.assert(i.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+g.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+i.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=i),a=this.fullColumnNames.reduce(function(y,C){return y[C]=y[C]+1||1,y},{}),c=Object.keys(a).filter(function(y){return a[y]>1}),qe.assert(0===c.length,function(){return"Duplicate column names found: "+c.toString()}),this.columnConfigs)for(u=0,p=Object.keys(this.columnConfigs);u<p.length;u++)if(-1===this.fullColumnNames.indexOf(m=p[u]))throw new Error('The key "'+m+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}})})},o.prototype.maybeReadHeaderLine=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(c){switch(c.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,c.sent().next()];case 2:if((i=c.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,this.parseRow(i.value,!1)];case 3:return[2,null]}})})},o.prototype.iterator=function(){return jt(this,void 0,void 0,function(){var i,a=this;return Wt(this,function(c){switch(c.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:c.sent(),c.label=2;case 2:return[4,this.base.iterator()];case 3:return i=c.sent(),this.hasHeader&&(i=i.skip(1)),[2,i.map(function(u){return a.makeDataElement(u)})]}})})},o.prototype.makeDataElement=function(i){for(var a=this.parseRow(i),c={},u={},p=0;p<this.fullColumnNames.length;p++){var m=this.fullColumnNames[p],g=this.columnConfigs?this.columnConfigs[m]:null;if(!this.configuredColumnsOnly||g){var v=a[p],y=null;if(""===v)if(g&&void 0!==g.default)y=g.default;else{if(g&&(g.required||g.isLabel))throw new Error("Required column "+m+" is empty in this line: "+i);y=void 0}else{var C=Number(v);if(isNaN(C))y=g&&"bool"===g.dtype?this.getBoolean(v):v;else if(g&&g.dtype)switch(g.dtype){case"float32":default:y=C;break;case"int32":y=Math.floor(C);break;case"bool":y=this.getBoolean(v)}else y=C}g&&g.isLabel?u[m]=y:c[m]=y}}return 0===Object.keys(u).length?c:{xs:c,ys:u}},o.prototype.getBoolean=function(i){return"1"===i||"true"===i.toLowerCase()?1:0},o.prototype.parseRow=function(i,a){void 0===a&&(a=!0);for(var c=[],u=0,p=i.length,m=ff,g=0;g<p;g++)switch(m){case ff:switch(i.charAt(g)){case'"':u=g+1,m=d0;break;case this.delimiter:if(u=g+1," "===this.delimiter&&this.delimWhitespace)break;c.push(""),m=ff;break;default:m=NT,u=g}break;case NT:i.charAt(g)===this.delimiter&&(c.push(i.substring(u,g)),m=ff,u=g+1);break;case d0:'"'===i.charAt(g)&&(m=HS);break;case HS:switch(i.charAt(g)){case this.delimiter:c.push(i.substring(u,g-1)),m=ff,u=g+1;break;case'"':m=d0;break;default:m=PT}break;case PT:'"'===i.charAt(g)&&(m=d0)}if(c.push(m===HS?i.substring(u,p-1):i.substring(u)),a&&c.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+c);return c},o}(ph),ir=function(s){function o(i){var a=s.call(this)||this;a.microphoneConfig=i,a.isClosed=!1,a.fftSize=i.fftSize||1024;var c=Math.log2(a.fftSize);if(a.fftSize<0||c<4||c>14||!Number.isInteger(c))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+a.fftSize);if(a.numFrames=i.numFramesPerSpectrogram||43,a.sampleRateHz=i.sampleRateHz,a.columnTruncateLength=i.columnTruncateLength||a.fftSize,a.audioTrackConstraints=i.audioTrackConstraints,a.smoothingTimeConstant=i.smoothingTimeConstant||0,a.includeSpectrogram=!1!==i.includeSpectrogram,a.includeWaveform=!0===i.includeWaveform,!a.includeSpectrogram&&!a.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return a}return Vi(o,s),o.prototype.summary=function(){return"microphone"},o.create=function(i){return void 0===i&&(i={}),jt(this,void 0,void 0,function(){var a;return Wt(this,function(c){switch(c.label){case 0:if(E().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(a=new o(i)).start()];case 1:return c.sent(),[2,a]}})})},o.prototype.start=function(){return jt(this,void 0,void 0,function(){var i,a,c,u;return Wt(this,function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),i=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return i.stream=p.sent(),[3,3];case 2:throw a=p.sent(),new Error("Error thrown while initializing video stream: "+a.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(c=window.AudioContext||window.webkitAudioContext,this.audioContext=new c,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return u=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,u.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i,a,c,u,p;return Wt(this,function(m){switch(m.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return c=m.sent(),this.includeSpectrogram&&(u=this.flattenQueue(c.freqDataQueue),i=this.getTensorFromAudioDataArray(u,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(p=this.flattenQueue(c.timeDataQueue),a=this.getTensorFromAudioDataArray(p,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:i,waveform:a},done:!1}]}})})},o.prototype.capture=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:return[2,i.sent().value]}})})},o.prototype.getAudioData=function(){return jt(this,void 0,void 0,function(){var i,a,c,u=this;return Wt(this,function(p){return i=[],a=[],c=0,[2,new Promise(function(m){var g=setInterval(function(){u.includeSpectrogram&&(u.analyser.getFloatFrequencyData(u.freqData),u.freqData[0]===-1/0&&m({freqDataQueue:i,timeDataQueue:a}),i.push(u.freqData.slice(0,u.columnTruncateLength))),u.includeWaveform&&(u.analyser.getFloatTimeDomainData(u.timeData),a.push(u.timeData.slice())),++c===u.numFrames&&(clearInterval(g),m({freqDataQueue:i,timeDataQueue:a}))},u.fftSize/u.sampleRateHz*1e3)})]})})},o.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},o.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},o.prototype.getSampleRate=function(){return this.sampleRateHz},o.prototype.flattenQueue=function(i){var a=i[0].length,c=new Float32Array(i.length*a);return i.forEach(function(u,p){return c.set(u,p*a)}),c},o.prototype.getTensorFromAudioDataArray=function(i,a){var c=new Float32Array(qe.sizeFromShape(a));return c.set(i,c.length-i.length),ei(c,a)},o}(nr),LT=function(s){function o(i,a){var c=s.call(this)||this;if(c.webcamVideoElement=i,c.webcamConfig=a,c.isClosed=!0,c.resize=!1,c.needToResize())if(c.resize=!0,c.cropSize=[c.webcamConfig.resizeHeight,c.webcamConfig.resizeWidth],c.cropBoxInd=Pn([0],"int32"),c.webcamConfig.centerCrop){var u=1*c.webcamConfig.resizeWidth/c.webcamVideoElement.width,p=1*c.webcamConfig.resizeHeight/c.webcamVideoElement.height,m=(1-u)/2,g=(1-p)/2;c.cropBox=qi([g,m,p+g,m+u],[1,4])}else c.cropBox=qi([0,0,1,1],[1,4]);return c}return Vi(o,s),o.prototype.summary=function(){return"webcam"},o.create=function(i,a){return void 0===a&&(a={}),jt(this,void 0,void 0,function(){var c;return Wt(this,function(u){switch(u.label){case 0:if(E().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!i){if(i=document.createElement("video"),!a.resizeWidth||!a.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");i.width=a.resizeWidth,i.height=a.resizeHeight}return[4,(c=new o(i,a)).start()];case 1:return u.sent(),[2,c]}})})},o.prototype.start=function(){return jt(this,void 0,void 0,function(){var i,a,c=this;return Wt(this,function(u){switch(u.label){case 0:this.webcamConfig.facingMode&&qe.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,function(){return"Invalid webcam facing mode: "+c.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),u.label=1;case 1:return u.trys.push([1,3,,4]),i=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return i.stream=u.sent(),[3,4];case 3:throw(a=u.sent()).message="Error thrown while initializing video stream: "+a.message,a;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(p){console.log(p),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(p){c.webcamVideoElement.onloadedmetadata=function(){p()}})]}})})},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(a){if(this.isClosed)return[2,{value:null,done:!0}];try{i=o1.fromPixels(this.webcamVideoElement)}catch(c){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(c))}if(!this.resize)return[2,{value:i,done:!1}];try{return[2,{value:this.cropAndResizeFrame(i),done:!1}]}catch(c){throw new Error("Error thrown cropping the video: "+c.message)}finally{i.dispose()}return[2]})})},o.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},o.prototype.cropAndResizeFrame=function(i){var a=this;return $e(function(){var c,u=i.toFloat().expandDims(0),p=(c=Ql.cropAndResize(u,a.cropBox,a.cropBoxInd,a.cropSize,"bilinear")).shape;return c.reshape(p.slice(1))})},o.prototype.capture=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:return[2,i.sent().value]}})})},o.prototype.stop=function(){this.stream.getTracks().forEach(function(i){return i.stop()});try{this.webcamVideoElement.srcObject=null}catch(i){console.log(i),this.webcamVideoElement.src=null}this.isClosed=!0},o.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},o}(nr),jS=function(){},BT=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return Vi(o,s),o.prototype.split=function(i){return new qF(this,i)},o}(nr),qF=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.impl=new YF(i,a),c}return Vi(o,s),o.prototype.summary=function(){return this.impl.summary()},o.prototype.next=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return[2,this.impl.next()]})})},o}(BT),YF=function(s){function o(i,a){var c=s.call(this)||this;return c.upstream=i,c.separator=a,c.carryover="",c}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},o.prototype.pump=function(){return jt(this,void 0,void 0,function(){var i,a,c,u;return Wt(this,function(m){switch(m.label){case 0:return[4,this.upstream.next()];case 1:if((i=m.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((a=i.value.split(this.separator))[0]=this.carryover+a[0],c=0,u=a.slice(0,-1);c<u.length;c++)this.outputQueue.push(u[c]);return this.carryover=a[a.length-1],[2,!0]}})})},o}(NS),KF=function(s){function o(){return null!==s&&s.apply(this,arguments)||this}return Vi(o,s),o.prototype.decodeUTF8=function(){return new XF(this)},o}(nr),XF=function(s){function o(i){var a=s.call(this)||this;return a.upstream=i,a.impl=new zT(i),a}return Vi(o,s),o.prototype.summary=function(){return this.impl.summary()},o.prototype.next=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return[2,this.impl.next()]})})},o}(BT),zT=function(s){function o(i){var a=s.call(this)||this;if(a.upstream=i,E().get("IS_BROWSER"))a.decoder=new TextDecoder("utf-8");else{var c=Re(688).StringDecoder;a.decoder=new c("utf8")}return a}return Vi(o,s),o.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},o.prototype.pump=function(){return jt(this,void 0,void 0,function(){var i,a,c;return Wt(this,function(u){switch(u.label){case 0:return[4,this.upstream.next()];case 1:return(i=u.sent()).done?[2,!1]:(a=i.value,c=E().get("IS_BROWSER")?this.decoder.decode(a,{stream:!0}):this.decoder.write(Buffer.from(a.buffer)),this.outputQueue.push(c),[2,!0])}})})},o}(NS),mf=function(s){function o(i,a){void 0===a&&(a={});var c=s.call(this)||this;return c.file=i,c.options=a,qe.assert(i instanceof Uint8Array||!!E().get("IS_BROWSER")&&(i instanceof File||i instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),c.offset=a.offset||0,c.chunkSize=a.chunkSize||1048576,c}return Vi(o,s),o.prototype.summary=function(){return"FileChunks "+this.file},o.prototype.next=function(){return jt(this,void 0,void 0,function(){var i,a,c=this;return Wt(this,function(u){switch(u.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(i=new Promise(function(p,m){var g=c.offset+c.chunkSize;if(c.file instanceof Uint8Array)p(new Uint8Array(c.file.slice(c.offset,g)));else{var v=new FileReader;v.onload=function(C){var S=v.result;if(S instanceof ArrayBuffer&&(S=new Uint8Array(S)),!(S instanceof Uint8Array))return m(new TypeError("FileReader returned unknown type."));p(S)},v.onabort=function(C){return m(new Error("Aborted"))},v.onerror=function(C){return m(new Error(C.type))};var y=c.file.slice(c.offset,g);v.readAsArrayBuffer(y)}c.offset=g}),a={},[4,i]);case 1:return[2,(a.value=u.sent(),a.done=!1,a)]}})})},o}(KF);function VT(s,o){return void 0===o&&(o={}),jt(this,void 0,void 0,function(){var i,a,c,u,p;return Wt(this,function(m){switch(m.label){case 0:return"string"==typeof s?i=s:(i=s.url,a=UT(s)),[4,qe.fetch(i,a)];case 1:return(c=m.sent()).ok?(p=Uint8Array.bind,[4,c.arrayBuffer()]):[3,3];case 2:return u=new(p.apply(Uint8Array,[void 0,m.sent()])),[2,new mf(u,o)];case 3:throw new Error(c.statusText)}})})}var UT=function(s){return{method:s.method,headers:s.headers,body:s.body,mode:s.mode,credentials:s.credentials,cache:s.cache,redirect:s.redirect,referrer:s.referrer,integrity:s.integrity}};function h0(s){return"string"==typeof s&&"file://"===s.substr(0,7)}var mc=function(s){function o(i,a){void 0===a&&(a={});var c=s.call(this)||this;return c.input=i,c.options=a,c}return Vi(o,s),o.prototype.iterator=function(){return jt(this,void 0,void 0,function(){var i;return Wt(this,function(a){return h0(this.input)&&E().get("IS_NODE")&&(i=Re(633),this.input=i.readFileSync(this.input.substr(7))),[2,new mf(this.input,this.options)]})})},o}(jS),p0=function(s){function o(i,a){void 0===a&&(a={});var c=s.call(this)||this;return c.url=i,c.fileOptions=a,c}return Vi(o,s),o.prototype.iterator=function(){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return h0(this.url)?[2,new mc(this.url,this.fileOptions).iterator()]:[2,VT(this.url,this.fileOptions)]})})},o}(jS);function f0(s,o){return void 0===o&&(o={}),new u0(new p0(s),o)}function m0(s){var o=this,i=uf(s);return ia(function(){return jt(o,void 0,void 0,function(){return Wt(this,function(a){return[2,i]})})})}function HT(s){var o=this;return ia(function(){return jt(o,void 0,void 0,function(){var i;return Wt(this,function(a){switch(a.label){case 0:return[4,s()];case 1:return i=a.sent(),[2,uf(function(){return i.next()})]}})})})}function g0(s,o){return jt(this,void 0,void 0,function(){return Wt(this,function(i){return[2,LT.create(s,o)]})})}function _0(s){return jt(this,void 0,void 0,function(){return Wt(this,function(o){return[2,ir.create(s)]})})}var gf="1.3.1",QF={"tfjs-core":pb,"tfjs-data":gf,"tfjs-layers":Up,"tfjs-converter":CS,tfjs:"1.3.1"}},125:(cn,ye,Re)=>{"use strict";function ie(K){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(E){return typeof E}:function(E){return E&&"function"==typeof Symbol&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E})(K)}function ce(K,xe,E){var pe=E.value;if("function"!=typeof pe)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(ie(pe)));var te=!1;return{configurable:!0,get:function(){if(te||this===K.prototype||this.hasOwnProperty(xe)||"function"!=typeof pe)return pe;var Y=pe.bind(this);return te=!0,Object.defineProperty(this,xe,{configurable:!0,get:function(){return Y},set:function(f){pe=f,delete this[xe]}}),te=!1,Y},set:function(Y){pe=Y}}}function j(K){var xe;return typeof Reflect<"u"&&"function"==typeof Reflect.ownKeys?xe=Reflect.ownKeys(K.prototype):(xe=Object.getOwnPropertyNames(K.prototype),"function"==typeof Object.getOwnPropertySymbols&&(xe=xe.concat(Object.getOwnPropertySymbols(K.prototype)))),xe.forEach(function(E){if("constructor"!==E){var pe=Object.getOwnPropertyDescriptor(K.prototype,E);"function"==typeof pe.value&&Object.defineProperty(K.prototype,E,ce(K,E,pe))}}),K}function J(){return 1===arguments.length?j.apply(void 0,arguments):ce.apply(void 0,arguments)}Re.r(ye),Re.d(ye,{boundClass:()=>j,boundMethod:()=>ce,default:()=>J})},650:cn=>{cn.exports=function ye(Re,ie,ce){function j(xe,E){if(!ie[xe]){if(!Re[xe]){if(J)return J(xe,!0);var te=new Error("Cannot find module '"+xe+"'");throw te.code="MODULE_NOT_FOUND",te}var Z=ie[xe]={exports:{}};Re[xe][0].call(Z.exports,function(Y){return j(Re[xe][1][Y]||Y)},Z,Z.exports,ye,Re,ie,ce)}return ie[xe].exports}for(var J=void 0,K=0;K<ce.length;K++)j(ce[K]);return j}({1:[function(ye,Re,ie){"use strict";var ce=ye("./utils"),j=ye("./support"),J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";ie.encode=function(K){for(var xe,E,pe,Z,Y,z,f=[],b=0,w=K.length,T=w,R="string"!==ce.getTypeOf(K);b<K.length;)T=w-b,pe=R?(xe=K[b++],E=b<w?K[b++]:0,b<w?K[b++]:0):(xe=K.charCodeAt(b++),E=b<w?K.charCodeAt(b++):0,b<w?K.charCodeAt(b++):0),Z=(3&xe)<<4|E>>4,Y=1<T?(15&E)<<2|pe>>6:64,z=2<T?63&pe:64,f.push(J.charAt(xe>>2)+J.charAt(Z)+J.charAt(Y)+J.charAt(z));return f.join("")},ie.decode=function(K){var xe,E,pe,te,Z,Y,z=0,f=0,b="data:";if(K.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var w,T=3*(K=K.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(K.charAt(K.length-1)===J.charAt(64)&&T--,K.charAt(K.length-2)===J.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=j.uint8array?new Uint8Array(0|T):new Array(0|T);z<K.length;)xe=J.indexOf(K.charAt(z++))<<2|(te=J.indexOf(K.charAt(z++)))>>4,E=(15&te)<<4|(Z=J.indexOf(K.charAt(z++)))>>2,pe=(3&Z)<<6|(Y=J.indexOf(K.charAt(z++))),w[f++]=xe,64!==Z&&(w[f++]=E),64!==Y&&(w[f++]=pe);return w}},{"./support":30,"./utils":32}],2:[function(ye,Re,ie){"use strict";var ce=ye("./external"),j=ye("./stream/DataWorker"),J=ye("./stream/Crc32Probe"),K=ye("./stream/DataLengthProbe");function xe(E,pe,te,Z,Y){this.compressedSize=E,this.uncompressedSize=pe,this.crc32=te,this.compression=Z,this.compressedContent=Y}xe.prototype={getContentWorker:function(){var E=new j(ce.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new K("data_length")),pe=this;return E.on("end",function(){if(this.streamInfo.data_length!==pe.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),E},getCompressedWorker:function(){return new j(ce.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},xe.createWorkerFrom=function(E,pe,te){return E.pipe(new J).pipe(new K("uncompressedSize")).pipe(pe.compressWorker(te)).pipe(new K("compressedSize")).withStreamInfo("compression",pe)},Re.exports=xe},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(ye,Re,ie){"use strict";var ce=ye("./stream/GenericWorker");ie.STORE={magic:"\0\0",compressWorker:function(){return new ce("STORE compression")},uncompressWorker:function(){return new ce("STORE decompression")}},ie.DEFLATE=ye("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(ye,Re,ie){"use strict";var ce=ye("./utils"),j=function(){for(var J,K=[],xe=0;xe<256;xe++){J=xe;for(var E=0;E<8;E++)J=1&J?3988292384^J>>>1:J>>>1;K[xe]=J}return K}();Re.exports=function(J,K){return void 0!==J&&J.length?"string"!==ce.getTypeOf(J)?function(xe,E,pe,te){var Z=j,Y=0+pe;xe^=-1;for(var z=0;z<Y;z++)xe=xe>>>8^Z[255&(xe^E[z])];return-1^xe}(0|K,J,J.length):function(xe,E,pe,te){var Z=j,Y=0+pe;xe^=-1;for(var z=0;z<Y;z++)xe=xe>>>8^Z[255&(xe^E.charCodeAt(z))];return-1^xe}(0|K,J,J.length):0}},{"./utils":32}],5:[function(ye,Re,ie){"use strict";ie.base64=!1,ie.binary=!1,ie.dir=!1,ie.createFolders=!0,ie.date=null,ie.compression=null,ie.compressionOptions=null,ie.comment=null,ie.unixPermissions=null,ie.dosPermissions=null},{}],6:[function(ye,Re,ie){"use strict";var ce;ce=typeof Promise<"u"?Promise:ye("lie"),Re.exports={Promise:ce}},{lie:37}],7:[function(ye,Re,ie){"use strict";var ce=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",j=ye("pako"),J=ye("./utils"),K=ye("./stream/GenericWorker"),xe=ce?"uint8array":"array";function E(pe,te){K.call(this,"FlateWorker/"+pe),this._pako=null,this._pakoAction=pe,this._pakoOptions=te,this.meta={}}ie.magic="\b\0",J.inherits(E,K),E.prototype.processChunk=function(pe){this.meta=pe.meta,null===this._pako&&this._createPako(),this._pako.push(J.transformTo(xe,pe.data),!1)},E.prototype.flush=function(){K.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},E.prototype.cleanUp=function(){K.prototype.cleanUp.call(this),this._pako=null},E.prototype._createPako=function(){this._pako=new j[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var pe=this;this._pako.onData=function(te){pe.push({data:te,meta:pe.meta})}},ie.compressWorker=function(pe){return new E("Deflate",pe)},ie.uncompressWorker=function(){return new E("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(ye,Re,ie){"use strict";function ce(Z,Y){var z,f="";for(z=0;z<Y;z++)f+=String.fromCharCode(255&Z),Z>>>=8;return f}function j(Z,Y,z,f,b,w){var T,R,H=Z.file,L=Z.compression,oe=w!==xe.utf8encode,ve=J.transformTo("string",w(H.name)),we=J.transformTo("string",xe.utf8encode(H.name)),de=H.comment,ke=J.transformTo("string",w(de)),ae=J.transformTo("string",xe.utf8encode(de)),De=we.length!==H.name.length,$=ae.length!==de.length,Ee="",ht="",Be="",kt=H.dir,Ve=H.date,pt={crc32:0,compressedSize:0,uncompressedSize:0};Y&&!z||(pt.crc32=Z.crc32,pt.compressedSize=Z.compressedSize,pt.uncompressedSize=Z.uncompressedSize);var ze=0;Y&&(ze|=8),oe||!De&&!$||(ze|=2048);var Le,dn,Ge=0,Jt=0;kt&&(Ge|=16),"UNIX"===b?(Jt=798,Ge|=(dn=Le=H.unixPermissions,Le||(dn=kt?16893:33204),(65535&dn)<<16)):(Jt=20,Ge|=function(Le){return 63&(Le||0)}(H.dosPermissions)),T=Ve.getUTCHours(),T<<=6,T|=Ve.getUTCMinutes(),T<<=5,T|=Ve.getUTCSeconds()/2,R=Ve.getUTCFullYear()-1980,R<<=4,R|=Ve.getUTCMonth()+1,R<<=5,R|=Ve.getUTCDate(),De&&(ht=ce(1,1)+ce(E(ve),4)+we,Ee+="up"+ce(ht.length,2)+ht),$&&(Be=ce(1,1)+ce(E(ke),4)+ae,Ee+="uc"+ce(Be.length,2)+Be);var zt="";return zt+="\n\0",zt+=ce(ze,2),zt+=L.magic,zt+=ce(T,2),zt+=ce(R,2),zt+=ce(pt.crc32,4),zt+=ce(pt.compressedSize,4),zt+=ce(pt.uncompressedSize,4),zt+=ce(ve.length,2),zt+=ce(Ee.length,2),{fileRecord:pe.LOCAL_FILE_HEADER+zt+ve+Ee,dirRecord:pe.CENTRAL_FILE_HEADER+ce(Jt,2)+zt+ce(ke.length,2)+"\0\0\0\0"+ce(Ge,4)+ce(f,4)+ve+Ee+ke}}var J=ye("../utils"),K=ye("../stream/GenericWorker"),xe=ye("../utf8"),E=ye("../crc32"),pe=ye("../signature");function te(Z,Y,z,f){K.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Y,this.zipPlatform=z,this.encodeFileName=f,this.streamFiles=Z,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}J.inherits(te,K),te.prototype.push=function(Z){var Y=Z.meta.percent||0,z=this.entriesCount,f=this._sources.length;this.accumulate?this.contentBuffer.push(Z):(this.bytesWritten+=Z.data.length,K.prototype.push.call(this,{data:Z.data,meta:{currentFile:this.currentFile,percent:z?(Y+100*(z-f-1))/z:100}}))},te.prototype.openedSource=function(Z){this.currentSourceOffset=this.bytesWritten,this.currentFile=Z.file.name;var Y=this.streamFiles&&!Z.file.dir;if(Y){var z=j(Z,Y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:z.fileRecord,meta:{percent:0}})}else this.accumulate=!0},te.prototype.closedSource=function(Z){this.accumulate=!1;var f,Y=this.streamFiles&&!Z.file.dir,z=j(Z,Y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(z.dirRecord),Y)this.push({data:(f=Z,pe.DATA_DESCRIPTOR+ce(f.crc32,4)+ce(f.compressedSize,4)+ce(f.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:z.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},te.prototype.flush=function(){for(var Z=this.bytesWritten,Y=0;Y<this.dirRecords.length;Y++)this.push({data:this.dirRecords[Y],meta:{percent:100}});var b,w,T,L,f=(b=this.dirRecords.length,w=this.bytesWritten-Z,T=Z,L=J.transformTo("string",(0,this.encodeFileName)(this.zipComment)),pe.CENTRAL_DIRECTORY_END+"\0\0\0\0"+ce(b,2)+ce(b,2)+ce(w,4)+ce(T,4)+ce(L.length,2)+L);this.push({data:f,meta:{percent:100}})},te.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},te.prototype.registerPrevious=function(Z){this._sources.push(Z);var Y=this;return Z.on("data",function(z){Y.processChunk(z)}),Z.on("end",function(){Y.closedSource(Y.previous.streamInfo),Y._sources.length?Y.prepareNextSource():Y.end()}),Z.on("error",function(z){Y.error(z)}),this},te.prototype.resume=function(){return!!K.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},te.prototype.error=function(Z){var Y=this._sources;if(!K.prototype.error.call(this,Z))return!1;for(var z=0;z<Y.length;z++)try{Y[z].error(Z)}catch{}return!0},te.prototype.lock=function(){K.prototype.lock.call(this);for(var Z=this._sources,Y=0;Y<Z.length;Y++)Z[Y].lock()},Re.exports=te},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(ye,Re,ie){"use strict";var ce=ye("../compressions"),j=ye("./ZipFileWorker");ie.generateWorker=function(J,K,xe){var E=new j(K.streamFiles,xe,K.platform,K.encodeFileName),pe=0;try{J.forEach(function(te,Z){pe++;var Y=function(w,T){var R=w||T,H=ce[R];if(!H)throw new Error(R+" is not a valid compression method !");return H}(Z.options.compression,K.compression),f=Z.dir,b=Z.date;Z._compressWorker(Y,Z.options.compressionOptions||K.compressionOptions||{}).withStreamInfo("file",{name:te,dir:f,date:b,comment:Z.comment||"",unixPermissions:Z.unixPermissions,dosPermissions:Z.dosPermissions}).pipe(E)}),E.entriesCount=pe}catch(te){E.error(te)}return E}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(ye,Re,ie){"use strict";function ce(){if(!(this instanceof ce))return new ce;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var j=new ce;for(var J in this)"function"!=typeof this[J]&&(j[J]=this[J]);return j}}(ce.prototype=ye("./object")).loadAsync=ye("./load"),ce.support=ye("./support"),ce.defaults=ye("./defaults"),ce.version="3.10.1",ce.loadAsync=function(j,J){return(new ce).loadAsync(j,J)},ce.external=ye("./external"),Re.exports=ce},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(ye,Re,ie){"use strict";var ce=ye("./utils"),j=ye("./external"),J=ye("./utf8"),K=ye("./zipEntries"),xe=ye("./stream/Crc32Probe"),E=ye("./nodejsUtils");function pe(te){return new j.Promise(function(Z,Y){var z=te.decompressed.getContentWorker().pipe(new xe);z.on("error",function(f){Y(f)}).on("end",function(){z.streamInfo.crc32!==te.decompressed.crc32?Y(new Error("Corrupted zip : CRC32 mismatch")):Z()}).resume()})}Re.exports=function(te,Z){var Y=this;return Z=ce.extend(Z||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:J.utf8decode}),E.isNode&&E.isStream(te)?j.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):ce.prepareContent("the loaded zip file",te,!0,Z.optimizedBinaryString,Z.base64).then(function(z){var f=new K(Z);return f.load(z),f}).then(function(z){var f=[j.Promise.resolve(z)],b=z.files;if(Z.checkCRC32)for(var w=0;w<b.length;w++)f.push(pe(b[w]));return j.Promise.all(f)}).then(function(z){for(var f=z.shift(),b=f.files,w=0;w<b.length;w++){var T=b[w],R=T.fileNameStr,H=ce.resolve(T.fileNameStr);Y.file(H,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:Z.createFolders}),T.dir||(Y.file(H).unsafeOriginalName=R)}return f.zipComment.length&&(Y.comment=f.zipComment),Y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(ye,Re,ie){"use strict";var ce=ye("../utils"),j=ye("../stream/GenericWorker");function J(K,xe){j.call(this,"Nodejs stream input adapter for "+K),this._upstreamEnded=!1,this._bindStream(xe)}ce.inherits(J,j),J.prototype._bindStream=function(K){var xe=this;(this._stream=K).pause(),K.on("data",function(E){xe.push({data:E,meta:{percent:0}})}).on("error",function(E){xe.isPaused?this.generatedError=E:xe.error(E)}).on("end",function(){xe.isPaused?xe._upstreamEnded=!0:xe.end()})},J.prototype.pause=function(){return!!j.prototype.pause.call(this)&&(this._stream.pause(),!0)},J.prototype.resume=function(){return!!j.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Re.exports=J},{"../stream/GenericWorker":28,"../utils":32}],13:[function(ye,Re,ie){"use strict";var ce=ye("readable-stream").Readable;function j(J,K,xe){ce.call(this,K),this._helper=J;var E=this;J.on("data",function(pe,te){E.push(pe)||E._helper.pause(),xe&&xe(te)}).on("error",function(pe){E.emit("error",pe)}).on("end",function(){E.push(null)})}ye("../utils").inherits(j,ce),j.prototype._read=function(){this._helper.resume()},Re.exports=j},{"../utils":32,"readable-stream":16}],14:[function(ye,Re,ie){"use strict";Re.exports={isNode:typeof Buffer<"u",newBufferFrom:function(ce,j){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(ce,j);if("number"==typeof ce)throw new Error('The "data" argument must not be a number');return new Buffer(ce,j)},allocBuffer:function(ce){if(Buffer.alloc)return Buffer.alloc(ce);var j=new Buffer(ce);return j.fill(0),j},isBuffer:function(ce){return Buffer.isBuffer(ce)},isStream:function(ce){return ce&&"function"==typeof ce.on&&"function"==typeof ce.pause&&"function"==typeof ce.resume}}},{}],15:[function(ye,Re,ie){"use strict";function ce(H,L,oe){var ve,we=J.getTypeOf(L),de=J.extend(oe||{},E);de.date=de.date||new Date,null!==de.compression&&(de.compression=de.compression.toUpperCase()),"string"==typeof de.unixPermissions&&(de.unixPermissions=parseInt(de.unixPermissions,8)),de.unixPermissions&&16384&de.unixPermissions&&(de.dir=!0),de.dosPermissions&&16&de.dosPermissions&&(de.dir=!0),de.dir&&(H=b(H)),de.createFolders&&(ve=f(H))&&w.call(this,ve,!0),oe&&void 0!==oe.binary||(de.binary=!("string"===we&&!1===de.binary&&!1===de.base64)),(L instanceof pe&&0===L.uncompressedSize||de.dir||!L||0===L.length)&&(de.base64=!1,de.binary=!0,L="",de.compression="STORE",we="string");var ae;ae=L instanceof pe||L instanceof K?L:Y.isNode&&Y.isStream(L)?new z(H,L):J.prepareContent(H,L,de.binary,de.optimizedBinaryString,de.base64);var De=new te(H,ae,de);this.files[H]=De}var j=ye("./utf8"),J=ye("./utils"),K=ye("./stream/GenericWorker"),xe=ye("./stream/StreamHelper"),E=ye("./defaults"),pe=ye("./compressedObject"),te=ye("./zipObject"),Z=ye("./generate"),Y=ye("./nodejsUtils"),z=ye("./nodejs/NodejsStreamInputAdapter"),f=function(H){"/"===H.slice(-1)&&(H=H.substring(0,H.length-1));var L=H.lastIndexOf("/");return 0<L?H.substring(0,L):""},b=function(H){return"/"!==H.slice(-1)&&(H+="/"),H},w=function(H,L){return L=void 0!==L?L:E.createFolders,H=b(H),this.files[H]||ce.call(this,H,null,{dir:!0,createFolders:L}),this.files[H]};function T(H){return"[object RegExp]"===Object.prototype.toString.call(H)}var R={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(H){var L,oe,ve;for(L in this.files)ve=this.files[L],(oe=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&H(oe,ve)},filter:function(H){var L=[];return this.forEach(function(oe,ve){H(oe,ve)&&L.push(ve)}),L},file:function(H,L,oe){if(1!==arguments.length)return ce.call(this,H=this.root+H,L,oe),this;if(T(H)){var ve=H;return this.filter(function(de,ke){return!ke.dir&&ve.test(de)})}var we=this.files[this.root+H];return we&&!we.dir?we:null},folder:function(H){if(!H)return this;if(T(H))return this.filter(function(we,de){return de.dir&&H.test(we)});var oe=w.call(this,this.root+H),ve=this.clone();return ve.root=oe.name,ve},remove:function(H){var L=this.files[H=this.root+H];if(L||("/"!==H.slice(-1)&&(H+="/"),L=this.files[H]),L&&!L.dir)delete this.files[H];else for(var oe=this.filter(function(we,de){return de.name.slice(0,H.length)===H}),ve=0;ve<oe.length;ve++)delete this.files[oe[ve].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(H){var L,oe={};try{if((oe=J.extend(H||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:j.utf8encode})).type=oe.type.toLowerCase(),oe.compression=oe.compression.toUpperCase(),"binarystring"===oe.type&&(oe.type="string"),!oe.type)throw new Error("No output type specified.");J.checkSupport(oe.type),"darwin"!==oe.platform&&"freebsd"!==oe.platform&&"linux"!==oe.platform&&"sunos"!==oe.platform||(oe.platform="UNIX"),"win32"===oe.platform&&(oe.platform="DOS"),L=Z.generateWorker(this,oe,oe.comment||this.comment||"")}catch(we){(L=new K("error")).error(we)}return new xe(L,oe.type||"string",oe.mimeType)},generateAsync:function(H,L){return this.generateInternalStream(H).accumulate(L)},generateNodeStream:function(H,L){return(H=H||{}).type||(H.type="nodebuffer"),this.generateInternalStream(H).toNodejsStream(L)}};Re.exports=R},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(ye,Re,ie){"use strict";Re.exports=ye("stream")},{stream:void 0}],17:[function(ye,Re,ie){"use strict";var ce=ye("./DataReader");function j(J){ce.call(this,J);for(var K=0;K<this.data.length;K++)J[K]=255&J[K]}ye("../utils").inherits(j,ce),j.prototype.byteAt=function(J){return this.data[this.zero+J]},j.prototype.lastIndexOfSignature=function(J){for(var K=J.charCodeAt(0),xe=J.charCodeAt(1),E=J.charCodeAt(2),pe=J.charCodeAt(3),te=this.length-4;0<=te;--te)if(this.data[te]===K&&this.data[te+1]===xe&&this.data[te+2]===E&&this.data[te+3]===pe)return te-this.zero;return-1},j.prototype.readAndCheckSignature=function(J){var K=J.charCodeAt(0),xe=J.charCodeAt(1),E=J.charCodeAt(2),pe=J.charCodeAt(3),te=this.readData(4);return K===te[0]&&xe===te[1]&&E===te[2]&&pe===te[3]},j.prototype.readData=function(J){if(this.checkOffset(J),0===J)return[];var K=this.data.slice(this.zero+this.index,this.zero+this.index+J);return this.index+=J,K},Re.exports=j},{"../utils":32,"./DataReader":18}],18:[function(ye,Re,ie){"use strict";var ce=ye("../utils");function j(J){this.data=J,this.length=J.length,this.index=0,this.zero=0}j.prototype={checkOffset:function(J){this.checkIndex(this.index+J)},checkIndex:function(J){if(this.length<this.zero+J||J<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+J+"). Corrupted zip ?")},setIndex:function(J){this.checkIndex(J),this.index=J},skip:function(J){this.setIndex(this.index+J)},byteAt:function(){},readInt:function(J){var K,xe=0;for(this.checkOffset(J),K=this.index+J-1;K>=this.index;K--)xe=(xe<<8)+this.byteAt(K);return this.index+=J,xe},readString:function(J){return ce.transformTo("string",this.readData(J))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var J=this.readInt(4);return new Date(Date.UTC(1980+(J>>25&127),(J>>21&15)-1,J>>16&31,J>>11&31,J>>5&63,(31&J)<<1))}},Re.exports=j},{"../utils":32}],19:[function(ye,Re,ie){"use strict";var ce=ye("./Uint8ArrayReader");function j(J){ce.call(this,J)}ye("../utils").inherits(j,ce),j.prototype.readData=function(J){this.checkOffset(J);var K=this.data.slice(this.zero+this.index,this.zero+this.index+J);return this.index+=J,K},Re.exports=j},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(ye,Re,ie){"use strict";var ce=ye("./DataReader");function j(J){ce.call(this,J)}ye("../utils").inherits(j,ce),j.prototype.byteAt=function(J){return this.data.charCodeAt(this.zero+J)},j.prototype.lastIndexOfSignature=function(J){return this.data.lastIndexOf(J)-this.zero},j.prototype.readAndCheckSignature=function(J){return J===this.readData(4)},j.prototype.readData=function(J){this.checkOffset(J);var K=this.data.slice(this.zero+this.index,this.zero+this.index+J);return this.index+=J,K},Re.exports=j},{"../utils":32,"./DataReader":18}],21:[function(ye,Re,ie){"use strict";var ce=ye("./ArrayReader");function j(J){ce.call(this,J)}ye("../utils").inherits(j,ce),j.prototype.readData=function(J){if(this.checkOffset(J),0===J)return new Uint8Array(0);var K=this.data.subarray(this.zero+this.index,this.zero+this.index+J);return this.index+=J,K},Re.exports=j},{"../utils":32,"./ArrayReader":17}],22:[function(ye,Re,ie){"use strict";var ce=ye("../utils"),j=ye("../support"),J=ye("./ArrayReader"),K=ye("./StringReader"),xe=ye("./NodeBufferReader"),E=ye("./Uint8ArrayReader");Re.exports=function(pe){var te=ce.getTypeOf(pe);return ce.checkSupport(te),"string"!==te||j.uint8array?"nodebuffer"===te?new xe(pe):j.uint8array?new E(ce.transformTo("uint8array",pe)):new J(ce.transformTo("array",pe)):new K(pe)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(ye,Re,ie){"use strict";ie.LOCAL_FILE_HEADER="PK\x03\x04",ie.CENTRAL_FILE_HEADER="PK\x01\x02",ie.CENTRAL_DIRECTORY_END="PK\x05\x06",ie.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",ie.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",ie.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(ye,Re,ie){"use strict";var ce=ye("./GenericWorker"),j=ye("../utils");function J(K){ce.call(this,"ConvertWorker to "+K),this.destType=K}j.inherits(J,ce),J.prototype.processChunk=function(K){this.push({data:j.transformTo(this.destType,K.data),meta:K.meta})},Re.exports=J},{"../utils":32,"./GenericWorker":28}],25:[function(ye,Re,ie){"use strict";var ce=ye("./GenericWorker"),j=ye("../crc32");function J(){ce.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}ye("../utils").inherits(J,ce),J.prototype.processChunk=function(K){this.streamInfo.crc32=j(K.data,this.streamInfo.crc32||0),this.push(K)},Re.exports=J},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(ye,Re,ie){"use strict";var ce=ye("../utils"),j=ye("./GenericWorker");function J(K){j.call(this,"DataLengthProbe for "+K),this.propName=K,this.withStreamInfo(K,0)}ce.inherits(J,j),J.prototype.processChunk=function(K){K&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+K.data.length),j.prototype.processChunk.call(this,K)},Re.exports=J},{"../utils":32,"./GenericWorker":28}],27:[function(ye,Re,ie){"use strict";var ce=ye("../utils"),j=ye("./GenericWorker");function J(K){j.call(this,"DataWorker");var xe=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,K.then(function(E){xe.dataIsReady=!0,xe.data=E,xe.max=E&&E.length||0,xe.type=ce.getTypeOf(E),xe.isPaused||xe._tickAndRepeat()},function(E){xe.error(E)})}ce.inherits(J,j),J.prototype.cleanUp=function(){j.prototype.cleanUp.call(this),this.data=null},J.prototype.resume=function(){return!!j.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,ce.delay(this._tickAndRepeat,[],this)),!0)},J.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(ce.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},J.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var K=null,xe=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":K=this.data.substring(this.index,xe);break;case"uint8array":K=this.data.subarray(this.index,xe);break;case"array":case"nodebuffer":K=this.data.slice(this.index,xe)}return this.index=xe,this.push({data:K,meta:{percent:this.max?this.index/this.max*100:0}})},Re.exports=J},{"../utils":32,"./GenericWorker":28}],28:[function(ye,Re,ie){"use strict";function ce(j){this.name=j||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}ce.prototype={push:function(j){this.emit("data",j)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(j){this.emit("error",j)}return!0},error:function(j){return!this.isFinished&&(this.isPaused?this.generatedError=j:(this.isFinished=!0,this.emit("error",j),this.previous&&this.previous.error(j),this.cleanUp()),!0)},on:function(j,J){return this._listeners[j].push(J),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(j,J){if(this._listeners[j])for(var K=0;K<this._listeners[j].length;K++)this._listeners[j][K].call(this,J)},pipe:function(j){return j.registerPrevious(this)},registerPrevious:function(j){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=j.streamInfo,this.mergeStreamInfo(),this.previous=j;var J=this;return j.on("data",function(K){J.processChunk(K)}),j.on("end",function(){J.end()}),j.on("error",function(K){J.error(K)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var j=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),j=!0),this.previous&&this.previous.resume(),!j},flush:function(){},processChunk:function(j){this.push(j)},withStreamInfo:function(j,J){return this.extraStreamInfo[j]=J,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var j in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,j)&&(this.streamInfo[j]=this.extraStreamInfo[j])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var j="Worker "+this.name;return this.previous?this.previous+" -> "+j:j}},Re.exports=ce},{}],29:[function(ye,Re,ie){"use strict";var ce=ye("../utils"),j=ye("./ConvertWorker"),J=ye("./GenericWorker"),K=ye("../base64"),xe=ye("../support"),E=ye("../external"),pe=null;if(xe.nodestream)try{pe=ye("../nodejs/NodejsStreamOutputAdapter")}catch{}function Z(Y,z,f){var b=z;switch(z){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=z,this._mimeType=f,ce.checkSupport(b),this._worker=Y.pipe(new j(b)),Y.lock()}catch(w){this._worker=new J("error"),this._worker.error(w)}}Z.prototype={accumulate:function(Y){return function te(Y,z){return new E.Promise(function(f,b){var w=[],T=Y._internalType,R=Y._outputType,H=Y._mimeType;Y.on("data",function(L,oe){w.push(L),z&&z(oe)}).on("error",function(L){w=[],b(L)}).on("end",function(){try{var L=function(oe,ve,we){switch(oe){case"blob":return ce.newBlob(ce.transformTo("arraybuffer",ve),we);case"base64":return K.encode(ve);default:return ce.transformTo(oe,ve)}}(R,function(oe,ve){var we,de=0,ke=null,ae=0;for(we=0;we<ve.length;we++)ae+=ve[we].length;switch(oe){case"string":return ve.join("");case"array":return Array.prototype.concat.apply([],ve);case"uint8array":for(ke=new Uint8Array(ae),we=0;we<ve.length;we++)ke.set(ve[we],de),de+=ve[we].length;return ke;case"nodebuffer":return Buffer.concat(ve);default:throw new Error("concat : unsupported type '"+oe+"'")}}(T,w),H);f(L)}catch(oe){b(oe)}w=[]}).resume()})}(this,Y)},on:function(Y,z){var f=this;return this._worker.on(Y,"data"===Y?function(b){z.call(f,b.data,b.meta)}:function(){ce.delay(z,arguments,f)}),this},resume:function(){return ce.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Y){if(ce.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new pe(this,{objectMode:"nodebuffer"!==this._outputType},Y)}},Re.exports=Z},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(ye,Re,ie){"use strict";if(ie.base64=!0,ie.array=!0,ie.string=!0,ie.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",ie.nodebuffer=typeof Buffer<"u",ie.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")ie.blob=!1;else{var ce=new ArrayBuffer(0);try{ie.blob=0===new Blob([ce],{type:"application/zip"}).size}catch{try{var j=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);j.append(ce),ie.blob=0===j.getBlob("application/zip").size}catch{ie.blob=!1}}}try{ie.nodestream=!!ye("readable-stream").Readable}catch{ie.nodestream=!1}},{"readable-stream":16}],31:[function(ye,Re,ie){"use strict";for(var ce=ye("./utils"),j=ye("./support"),J=ye("./nodejsUtils"),K=ye("./stream/GenericWorker"),xe=new Array(256),E=0;E<256;E++)xe[E]=252<=E?6:248<=E?5:240<=E?4:224<=E?3:192<=E?2:1;function pe(){K.call(this,"utf-8 decode"),this.leftOver=null}function te(){K.call(this,"utf-8 encode")}xe[254]=xe[254]=1,ie.utf8encode=function(Z){return j.nodebuffer?J.newBufferFrom(Z,"utf-8"):function(Y){var z,f,b,w,T,R=Y.length,H=0;for(w=0;w<R;w++)55296==(64512&(f=Y.charCodeAt(w)))&&w+1<R&&56320==(64512&(b=Y.charCodeAt(w+1)))&&(f=65536+(f-55296<<10)+(b-56320),w++),H+=f<128?1:f<2048?2:f<65536?3:4;for(z=j.uint8array?new Uint8Array(H):new Array(H),w=T=0;T<H;w++)55296==(64512&(f=Y.charCodeAt(w)))&&w+1<R&&56320==(64512&(b=Y.charCodeAt(w+1)))&&(f=65536+(f-55296<<10)+(b-56320),w++),f<128?z[T++]=f:(f<2048?z[T++]=192|f>>>6:(f<65536?z[T++]=224|f>>>12:(z[T++]=240|f>>>18,z[T++]=128|f>>>12&63),z[T++]=128|f>>>6&63),z[T++]=128|63&f);return z}(Z)},ie.utf8decode=function(Z){return j.nodebuffer?ce.transformTo("nodebuffer",Z).toString("utf-8"):function(Y){var z,f,b,w,T=Y.length,R=new Array(2*T);for(z=f=0;z<T;)if((b=Y[z++])<128)R[f++]=b;else if(4<(w=xe[b]))R[f++]=65533,z+=w-1;else{for(b&=2===w?31:3===w?15:7;1<w&&z<T;)b=b<<6|63&Y[z++],w--;1<w?R[f++]=65533:b<65536?R[f++]=b:(R[f++]=55296|(b-=65536)>>10&1023,R[f++]=56320|1023&b)}return R.length!==f&&(R.subarray?R=R.subarray(0,f):R.length=f),ce.applyFromCharCode(R)}(Z=ce.transformTo(j.uint8array?"uint8array":"array",Z))},ce.inherits(pe,K),pe.prototype.processChunk=function(Z){var Y=ce.transformTo(j.uint8array?"uint8array":"array",Z.data);if(this.leftOver&&this.leftOver.length){if(j.uint8array){var z=Y;(Y=new Uint8Array(z.length+this.leftOver.length)).set(this.leftOver,0),Y.set(z,this.leftOver.length)}else Y=this.leftOver.concat(Y);this.leftOver=null}var f=function(w,T){var R;for((T=T||w.length)>w.length&&(T=w.length),R=T-1;0<=R&&128==(192&w[R]);)R--;return R<0||0===R?T:R+xe[w[R]]>T?R:T}(Y),b=Y;f!==Y.length&&(j.uint8array?(b=Y.subarray(0,f),this.leftOver=Y.subarray(f,Y.length)):(b=Y.slice(0,f),this.leftOver=Y.slice(f,Y.length))),this.push({data:ie.utf8decode(b),meta:Z.meta})},pe.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:ie.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},ie.Utf8DecodeWorker=pe,ce.inherits(te,K),te.prototype.processChunk=function(Z){this.push({data:ie.utf8encode(Z.data),meta:Z.meta})},ie.Utf8EncodeWorker=te},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(ye,Re,ie){"use strict";var ce=ye("./support"),j=ye("./base64"),J=ye("./nodejsUtils"),K=ye("./external");function xe(z){return z}function E(z,f){for(var b=0;b<z.length;++b)f[b]=255&z.charCodeAt(b);return f}ye("setimmediate"),ie.newBlob=function(z,f){ie.checkSupport("blob");try{return new Blob([z],{type:f})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(z),b.getBlob(f)}catch{throw new Error("Bug : can't construct the Blob.")}}};var pe={stringifyByChunk:function(z,f,b){var w=[],T=0,R=z.length;if(R<=b)return String.fromCharCode.apply(null,z);for(;T<R;)w.push(String.fromCharCode.apply(null,"array"===f||"nodebuffer"===f?z.slice(T,Math.min(T+b,R)):z.subarray(T,Math.min(T+b,R)))),T+=b;return w.join("")},stringifyByChar:function(z){for(var f="",b=0;b<z.length;b++)f+=String.fromCharCode(z[b]);return f},applyCanBeUsed:{uint8array:function(){try{return ce.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return ce.nodebuffer&&1===String.fromCharCode.apply(null,J.allocBuffer(1)).length}catch{return!1}}()}};function te(z){var f=65536,b=ie.getTypeOf(z),w=!0;if("uint8array"===b?w=pe.applyCanBeUsed.uint8array:"nodebuffer"===b&&(w=pe.applyCanBeUsed.nodebuffer),w)for(;1<f;)try{return pe.stringifyByChunk(z,b,f)}catch{f=Math.floor(f/2)}return pe.stringifyByChar(z)}function Z(z,f){for(var b=0;b<z.length;b++)f[b]=z[b];return f}ie.applyFromCharCode=te;var Y={};Y.string={string:xe,array:function(z){return E(z,new Array(z.length))},arraybuffer:function(z){return Y.string.uint8array(z).buffer},uint8array:function(z){return E(z,new Uint8Array(z.length))},nodebuffer:function(z){return E(z,J.allocBuffer(z.length))}},Y.array={string:te,array:xe,arraybuffer:function(z){return new Uint8Array(z).buffer},uint8array:function(z){return new Uint8Array(z)},nodebuffer:function(z){return J.newBufferFrom(z)}},Y.arraybuffer={string:function(z){return te(new Uint8Array(z))},array:function(z){return Z(new Uint8Array(z),new Array(z.byteLength))},arraybuffer:xe,uint8array:function(z){return new Uint8Array(z)},nodebuffer:function(z){return J.newBufferFrom(new Uint8Array(z))}},Y.uint8array={string:te,array:function(z){return Z(z,new Array(z.length))},arraybuffer:function(z){return z.buffer},uint8array:xe,nodebuffer:function(z){return J.newBufferFrom(z)}},Y.nodebuffer={string:te,array:function(z){return Z(z,new Array(z.length))},arraybuffer:function(z){return Y.nodebuffer.uint8array(z).buffer},uint8array:function(z){return Z(z,new Uint8Array(z.length))},nodebuffer:xe},ie.transformTo=function(z,f){if(f=f||"",!z)return f;ie.checkSupport(z);var b=ie.getTypeOf(f);return Y[b][z](f)},ie.resolve=function(z){for(var f=z.split("/"),b=[],w=0;w<f.length;w++){var T=f[w];"."===T||""===T&&0!==w&&w!==f.length-1||(".."===T?b.pop():b.push(T))}return b.join("/")},ie.getTypeOf=function(z){return"string"==typeof z?"string":"[object Array]"===Object.prototype.toString.call(z)?"array":ce.nodebuffer&&J.isBuffer(z)?"nodebuffer":ce.uint8array&&z instanceof Uint8Array?"uint8array":ce.arraybuffer&&z instanceof ArrayBuffer?"arraybuffer":void 0},ie.checkSupport=function(z){if(!ce[z.toLowerCase()])throw new Error(z+" is not supported by this platform")},ie.MAX_VALUE_16BITS=65535,ie.MAX_VALUE_32BITS=-1,ie.pretty=function(z){var f,b,w="";for(b=0;b<(z||"").length;b++)w+="\\x"+((f=z.charCodeAt(b))<16?"0":"")+f.toString(16).toUpperCase();return w},ie.delay=function(z,f,b){setImmediate(function(){z.apply(b||null,f||[])})},ie.inherits=function(z,f){function b(){}b.prototype=f.prototype,z.prototype=new b},ie.extend=function(){var z,f,b={};for(z=0;z<arguments.length;z++)for(f in arguments[z])Object.prototype.hasOwnProperty.call(arguments[z],f)&&void 0===b[f]&&(b[f]=arguments[z][f]);return b},ie.prepareContent=function(z,f,b,w,T){return K.Promise.resolve(f).then(function(R){return ce.blob&&(R instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(R)))&&typeof FileReader<"u"?new K.Promise(function(H,L){var oe=new FileReader;oe.onload=function(ve){H(ve.target.result)},oe.onerror=function(ve){L(ve.target.error)},oe.readAsArrayBuffer(R)}):R}).then(function(R){var L,H=ie.getTypeOf(R);return H?("arraybuffer"===H?R=ie.transformTo("uint8array",R):"string"===H&&(T?R=j.decode(R):b&&!0!==w&&(R=E(L=R,ce.uint8array?new Uint8Array(L.length):new Array(L.length)))),R):K.Promise.reject(new Error("Can't read the data of '"+z+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(ye,Re,ie){"use strict";var ce=ye("./reader/readerFor"),j=ye("./utils"),J=ye("./signature"),K=ye("./zipEntry"),xe=ye("./support");function E(pe){this.files=[],this.loadOptions=pe}E.prototype={checkSignature:function(pe){if(!this.reader.readAndCheckSignature(pe)){this.reader.index-=4;var te=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+j.pretty(te)+", expected "+j.pretty(pe)+")")}},isSignature:function(pe,te){var Z=this.reader.index;this.reader.setIndex(pe);var Y=this.reader.readString(4)===te;return this.reader.setIndex(Z),Y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var pe=this.reader.readData(this.zipCommentLength),Z=j.transformTo(xe.uint8array?"uint8array":"array",pe);this.zipComment=this.loadOptions.decodeFileName(Z)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var pe,te,Z,Y=this.zip64EndOfCentralSize-44;0<Y;)pe=this.reader.readInt(2),te=this.reader.readInt(4),Z=this.reader.readData(te),this.zip64ExtensibleData[pe]={id:pe,length:te,value:Z}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var pe,te;for(pe=0;pe<this.files.length;pe++)this.reader.setIndex((te=this.files[pe]).localHeaderOffset),this.checkSignature(J.LOCAL_FILE_HEADER),te.readLocalPart(this.reader),te.handleUTF8(),te.processAttributes()},readCentralDir:function(){var pe;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(J.CENTRAL_FILE_HEADER);)(pe=new K({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(pe);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var pe=this.reader.lastIndexOfSignature(J.CENTRAL_DIRECTORY_END);if(pe<0)throw this.isSignature(0,J.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(pe);var te=pe;if(this.checkSignature(J.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===j.MAX_VALUE_16BITS||this.diskWithCentralDirStart===j.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===j.MAX_VALUE_16BITS||this.centralDirRecords===j.MAX_VALUE_16BITS||this.centralDirSize===j.MAX_VALUE_32BITS||this.centralDirOffset===j.MAX_VALUE_32BITS){if(this.zip64=!0,(pe=this.reader.lastIndexOfSignature(J.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(pe),this.checkSignature(J.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,J.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(J.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(J.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Z=this.centralDirOffset+this.centralDirSize;this.zip64&&(Z+=20,Z+=12+this.zip64EndOfCentralSize);var Y=te-Z;if(0<Y)this.isSignature(te,J.CENTRAL_FILE_HEADER)||(this.reader.zero=Y);else if(Y<0)throw new Error("Corrupted zip: missing "+Math.abs(Y)+" bytes.")},prepareReader:function(pe){this.reader=ce(pe)},load:function(pe){this.prepareReader(pe),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Re.exports=E},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(ye,Re,ie){"use strict";var ce=ye("./reader/readerFor"),j=ye("./utils"),J=ye("./compressedObject"),K=ye("./crc32"),xe=ye("./utf8"),E=ye("./compressions"),pe=ye("./support");function te(Z,Y){this.options=Z,this.loadOptions=Y}te.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(Z){var Y,z;if(Z.skip(22),this.fileNameLength=Z.readInt(2),z=Z.readInt(2),this.fileName=Z.readData(this.fileNameLength),Z.skip(z),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(Y=function(f){for(var b in E)if(Object.prototype.hasOwnProperty.call(E,b)&&E[b].magic===f)return E[b];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+j.pretty(this.compressionMethod)+" unknown (inner file : "+j.transformTo("string",this.fileName)+")");this.decompressed=new J(this.compressedSize,this.uncompressedSize,this.crc32,Y,Z.readData(this.compressedSize))},readCentralPart:function(Z){this.versionMadeBy=Z.readInt(2),Z.skip(2),this.bitFlag=Z.readInt(2),this.compressionMethod=Z.readString(2),this.date=Z.readDate(),this.crc32=Z.readInt(4),this.compressedSize=Z.readInt(4),this.uncompressedSize=Z.readInt(4);var Y=Z.readInt(2);if(this.extraFieldsLength=Z.readInt(2),this.fileCommentLength=Z.readInt(2),this.diskNumberStart=Z.readInt(2),this.internalFileAttributes=Z.readInt(2),this.externalFileAttributes=Z.readInt(4),this.localHeaderOffset=Z.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");Z.skip(Y),this.readExtraFields(Z),this.parseZIP64ExtraField(Z),this.fileComment=Z.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var Z=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==Z&&(this.dosPermissions=63&this.externalFileAttributes),3==Z&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var Z=ce(this.extraFields[1].value);this.uncompressedSize===j.MAX_VALUE_32BITS&&(this.uncompressedSize=Z.readInt(8)),this.compressedSize===j.MAX_VALUE_32BITS&&(this.compressedSize=Z.readInt(8)),this.localHeaderOffset===j.MAX_VALUE_32BITS&&(this.localHeaderOffset=Z.readInt(8)),this.diskNumberStart===j.MAX_VALUE_32BITS&&(this.diskNumberStart=Z.readInt(4))}},readExtraFields:function(Z){var Y,z,f,b=Z.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});Z.index+4<b;)Y=Z.readInt(2),z=Z.readInt(2),f=Z.readData(z),this.extraFields[Y]={id:Y,length:z,value:f};Z.setIndex(b)},handleUTF8:function(){var Z=pe.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=xe.utf8decode(this.fileName),this.fileCommentStr=xe.utf8decode(this.fileComment);else{var Y=this.findExtraFieldUnicodePath();if(null!==Y)this.fileNameStr=Y;else{var z=j.transformTo(Z,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(z)}var f=this.findExtraFieldUnicodeComment();if(null!==f)this.fileCommentStr=f;else{var b=j.transformTo(Z,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var Z=this.extraFields[28789];if(Z){var Y=ce(Z.value);return 1!==Y.readInt(1)||K(this.fileName)!==Y.readInt(4)?null:xe.utf8decode(Y.readData(Z.length-5))}return null},findExtraFieldUnicodeComment:function(){var Z=this.extraFields[25461];if(Z){var Y=ce(Z.value);return 1!==Y.readInt(1)||K(this.fileComment)!==Y.readInt(4)?null:xe.utf8decode(Y.readData(Z.length-5))}return null}},Re.exports=te},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(ye,Re,ie){"use strict";function ce(Y,z,f){this.name=Y,this.dir=f.dir,this.date=f.date,this.comment=f.comment,this.unixPermissions=f.unixPermissions,this.dosPermissions=f.dosPermissions,this._data=z,this._dataBinary=f.binary,this.options={compression:f.compression,compressionOptions:f.compressionOptions}}var j=ye("./stream/StreamHelper"),J=ye("./stream/DataWorker"),K=ye("./utf8"),xe=ye("./compressedObject"),E=ye("./stream/GenericWorker");ce.prototype={internalStream:function(Y){var z=null,f="string";try{if(!Y)throw new Error("No output type specified.");var b="string"===(f=Y.toLowerCase())||"text"===f;"binarystring"!==f&&"text"!==f||(f="string"),z=this._decompressWorker();var w=!this._dataBinary;w&&!b&&(z=z.pipe(new K.Utf8EncodeWorker)),!w&&b&&(z=z.pipe(new K.Utf8DecodeWorker))}catch(T){(z=new E("error")).error(T)}return new j(z,f,"")},async:function(Y,z){return this.internalStream(Y).accumulate(z)},nodeStream:function(Y,z){return this.internalStream(Y||"nodebuffer").toNodejsStream(z)},_compressWorker:function(Y,z){if(this._data instanceof xe&&this._data.compression.magic===Y.magic)return this._data.getCompressedWorker();var f=this._decompressWorker();return this._dataBinary||(f=f.pipe(new K.Utf8EncodeWorker)),xe.createWorkerFrom(f,Y,z)},_decompressWorker:function(){return this._data instanceof xe?this._data.getContentWorker():this._data instanceof E?this._data:new J(this._data)}};for(var pe=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],te=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Z=0;Z<pe.length;Z++)ce.prototype[pe[Z]]=te;Re.exports=ce},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(ye,Re,ie){(function(ce){"use strict";var j,J,K=ce.MutationObserver||ce.WebKitMutationObserver;if(K){var xe=0,E=new K(Y),pe=ce.document.createTextNode("");E.observe(pe,{characterData:!0}),j=function(){pe.data=xe=++xe%2}}else if(ce.setImmediate||void 0===ce.MessageChannel)j="document"in ce&&"onreadystatechange"in ce.document.createElement("script")?function(){var z=ce.document.createElement("script");z.onreadystatechange=function(){Y(),z.onreadystatechange=null,z.parentNode.removeChild(z),z=null},ce.document.documentElement.appendChild(z)}:function(){setTimeout(Y,0)};else{var te=new ce.MessageChannel;te.port1.onmessage=Y,j=function(){te.port2.postMessage(0)}}var Z=[];function Y(){var z,f;J=!0;for(var b=Z.length;b;){for(f=Z,Z=[],z=-1;++z<b;)f[z]();b=Z.length}J=!1}Re.exports=function(z){1!==Z.push(z)||J||j()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(ye,Re,ie){"use strict";var ce=ye("immediate");function j(){}var J={},K=["REJECTED"],xe=["FULFILLED"],E=["PENDING"];function pe(b){if("function"!=typeof b)throw new TypeError("resolver must be a function");this.state=E,this.queue=[],this.outcome=void 0,b!==j&&z(this,b)}function te(b,w,T){this.promise=b,"function"==typeof w&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),"function"==typeof T&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function Z(b,w,T){ce(function(){var R;try{R=w(T)}catch(H){return J.reject(b,H)}R===b?J.reject(b,new TypeError("Cannot resolve promise with itself")):J.resolve(b,R)})}function Y(b){var w=b&&b.then;if(b&&("object"==typeof b||"function"==typeof b)&&"function"==typeof w)return function(){w.apply(b,arguments)}}function z(b,w){var T=!1;function R(oe){T||(T=!0,J.reject(b,oe))}function H(oe){T||(T=!0,J.resolve(b,oe))}var L=f(function(){w(H,R)});"error"===L.status&&R(L.value)}function f(b,w){var T={};try{T.value=b(w),T.status="success"}catch(R){T.status="error",T.value=R}return T}(Re.exports=pe).prototype.finally=function(b){if("function"!=typeof b)return this;var w=this.constructor;return this.then(function(T){return w.resolve(b()).then(function(){return T})},function(T){return w.resolve(b()).then(function(){throw T})})},pe.prototype.catch=function(b){return this.then(null,b)},pe.prototype.then=function(b,w){if("function"!=typeof b&&this.state===xe||"function"!=typeof w&&this.state===K)return this;var T=new this.constructor(j);return this.state!==E?Z(T,this.state===xe?b:w,this.outcome):this.queue.push(new te(T,b,w)),T},te.prototype.callFulfilled=function(b){J.resolve(this.promise,b)},te.prototype.otherCallFulfilled=function(b){Z(this.promise,this.onFulfilled,b)},te.prototype.callRejected=function(b){J.reject(this.promise,b)},te.prototype.otherCallRejected=function(b){Z(this.promise,this.onRejected,b)},J.resolve=function(b,w){var T=f(Y,w);if("error"===T.status)return J.reject(b,T.value);var R=T.value;if(R)z(b,R);else{b.state=xe,b.outcome=w;for(var H=-1,L=b.queue.length;++H<L;)b.queue[H].callFulfilled(w)}return b},J.reject=function(b,w){b.state=K,b.outcome=w;for(var T=-1,R=b.queue.length;++T<R;)b.queue[T].callRejected(w);return b},pe.resolve=function(b){return b instanceof this?b:J.resolve(new this(j),b)},pe.reject=function(b){var w=new this(j);return J.reject(w,b)},pe.all=function(b){var w=this;if("[object Array]"!==Object.prototype.toString.call(b))return this.reject(new TypeError("must be an array"));var T=b.length,R=!1;if(!T)return this.resolve([]);for(var H=new Array(T),L=0,oe=-1,ve=new this(j);++oe<T;)we(b[oe],oe);return ve;function we(de,ke){w.resolve(de).then(function(ae){H[ke]=ae,++L!==T||R||(R=!0,J.resolve(ve,H))},function(ae){R||(R=!0,J.reject(ve,ae))})}},pe.race=function(b){if("[object Array]"!==Object.prototype.toString.call(b))return this.reject(new TypeError("must be an array"));var T=b.length,R=!1;if(!T)return this.resolve([]);for(var H=-1,L=new this(j);++H<T;)this.resolve(b[H]).then(function(ve){R||(R=!0,J.resolve(L,ve))},function(ve){R||(R=!0,J.reject(L,ve))});return L}},{immediate:36}],38:[function(ye,Re,ie){"use strict";var ce={};(0,ye("./lib/utils/common").assign)(ce,ye("./lib/deflate"),ye("./lib/inflate"),ye("./lib/zlib/constants")),Re.exports=ce},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(ye,Re,ie){"use strict";var ce=ye("./zlib/deflate"),j=ye("./utils/common"),J=ye("./utils/strings"),K=ye("./zlib/messages"),xe=ye("./zlib/zstream"),E=Object.prototype.toString;function z(b){if(!(this instanceof z))return new z(b);this.options=j.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},b||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new xe,this.strm.avail_out=0;var T=ce.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(0!==T)throw new Error(K[T]);if(w.header&&ce.deflateSetHeader(this.strm,w.header),w.dictionary){var R;if(R="string"==typeof w.dictionary?J.string2buf(w.dictionary):"[object ArrayBuffer]"===E.call(w.dictionary)?new Uint8Array(w.dictionary):w.dictionary,0!==(T=ce.deflateSetDictionary(this.strm,R)))throw new Error(K[T]);this._dict_set=!0}}function f(b,w){var T=new z(w);if(T.push(b,!0),T.err)throw T.msg||K[T.err];return T.result}z.prototype.push=function(b,w){var T,R,H=this.strm,L=this.options.chunkSize;if(this.ended)return!1;R=w===~~w?w:!0===w?4:0,H.input="string"==typeof b?J.string2buf(b):"[object ArrayBuffer]"===E.call(b)?new Uint8Array(b):b,H.next_in=0,H.avail_in=H.input.length;do{if(0===H.avail_out&&(H.output=new j.Buf8(L),H.next_out=0,H.avail_out=L),1!==(T=ce.deflate(H,R))&&0!==T)return this.onEnd(T),!(this.ended=!0);0!==H.avail_out&&(0!==H.avail_in||4!==R&&2!==R)||this.onData("string"===this.options.to?J.buf2binstring(j.shrinkBuf(H.output,H.next_out)):j.shrinkBuf(H.output,H.next_out))}while((0<H.avail_in||0===H.avail_out)&&1!==T);return 4===R?(T=ce.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,0===T):2!==R||(this.onEnd(0),!(H.avail_out=0))},z.prototype.onData=function(b){this.chunks.push(b)},z.prototype.onEnd=function(b){0===b&&(this.result="string"===this.options.to?this.chunks.join(""):j.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},ie.Deflate=z,ie.deflate=f,ie.deflateRaw=function(b,w){return(w=w||{}).raw=!0,f(b,w)},ie.gzip=function(b,w){return(w=w||{}).gzip=!0,f(b,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(ye,Re,ie){"use strict";var ce=ye("./zlib/inflate"),j=ye("./utils/common"),J=ye("./utils/strings"),K=ye("./zlib/constants"),xe=ye("./zlib/messages"),E=ye("./zlib/zstream"),pe=ye("./zlib/gzheader"),te=Object.prototype.toString;function Z(z){if(!(this instanceof Z))return new Z(z);this.options=j.assign({chunkSize:16384,windowBits:0,to:""},z||{});var f=this.options;f.raw&&0<=f.windowBits&&f.windowBits<16&&(f.windowBits=-f.windowBits,0===f.windowBits&&(f.windowBits=-15)),!(0<=f.windowBits&&f.windowBits<16)||z&&z.windowBits||(f.windowBits+=32),15<f.windowBits&&f.windowBits<48&&0==(15&f.windowBits)&&(f.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new E,this.strm.avail_out=0;var b=ce.inflateInit2(this.strm,f.windowBits);if(b!==K.Z_OK)throw new Error(xe[b]);this.header=new pe,ce.inflateGetHeader(this.strm,this.header)}function Y(z,f){var b=new Z(f);if(b.push(z,!0),b.err)throw b.msg||xe[b.err];return b.result}Z.prototype.push=function(z,f){var b,w,T,R,H,L,oe=this.strm,ve=this.options.chunkSize,we=this.options.dictionary,de=!1;if(this.ended)return!1;w=f===~~f?f:!0===f?K.Z_FINISH:K.Z_NO_FLUSH,oe.input="string"==typeof z?J.binstring2buf(z):"[object ArrayBuffer]"===te.call(z)?new Uint8Array(z):z,oe.next_in=0,oe.avail_in=oe.input.length;do{if(0===oe.avail_out&&(oe.output=new j.Buf8(ve),oe.next_out=0,oe.avail_out=ve),(b=ce.inflate(oe,K.Z_NO_FLUSH))===K.Z_NEED_DICT&&we&&(L="string"==typeof we?J.string2buf(we):"[object ArrayBuffer]"===te.call(we)?new Uint8Array(we):we,b=ce.inflateSetDictionary(this.strm,L)),b===K.Z_BUF_ERROR&&!0===de&&(b=K.Z_OK,de=!1),b!==K.Z_STREAM_END&&b!==K.Z_OK)return this.onEnd(b),!(this.ended=!0);oe.next_out&&(0!==oe.avail_out&&b!==K.Z_STREAM_END&&(0!==oe.avail_in||w!==K.Z_FINISH&&w!==K.Z_SYNC_FLUSH)||("string"===this.options.to?(T=J.utf8border(oe.output,oe.next_out),R=oe.next_out-T,H=J.buf2string(oe.output,T),oe.next_out=R,oe.avail_out=ve-R,R&&j.arraySet(oe.output,oe.output,T,R,0),this.onData(H)):this.onData(j.shrinkBuf(oe.output,oe.next_out)))),0===oe.avail_in&&0===oe.avail_out&&(de=!0)}while((0<oe.avail_in||0===oe.avail_out)&&b!==K.Z_STREAM_END);return b===K.Z_STREAM_END&&(w=K.Z_FINISH),w===K.Z_FINISH?(b=ce.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===K.Z_OK):w!==K.Z_SYNC_FLUSH||(this.onEnd(K.Z_OK),!(oe.avail_out=0))},Z.prototype.onData=function(z){this.chunks.push(z)},Z.prototype.onEnd=function(z){z===K.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):j.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg},ie.Inflate=Z,ie.inflate=Y,ie.inflateRaw=function(z,f){return(f=f||{}).raw=!0,Y(z,f)},ie.ungzip=Y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(ye,Re,ie){"use strict";var ce=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";ie.assign=function(K){for(var xe=Array.prototype.slice.call(arguments,1);xe.length;){var E=xe.shift();if(E){if("object"!=typeof E)throw new TypeError(E+"must be non-object");for(var pe in E)E.hasOwnProperty(pe)&&(K[pe]=E[pe])}}return K},ie.shrinkBuf=function(K,xe){return K.length===xe?K:K.subarray?K.subarray(0,xe):(K.length=xe,K)};var j={arraySet:function(K,xe,E,pe,te){if(xe.subarray&&K.subarray)K.set(xe.subarray(E,E+pe),te);else for(var Z=0;Z<pe;Z++)K[te+Z]=xe[E+Z]},flattenChunks:function(K){var xe,E,pe,te,Z,Y;for(xe=pe=0,E=K.length;xe<E;xe++)pe+=K[xe].length;for(Y=new Uint8Array(pe),xe=te=0,E=K.length;xe<E;xe++)Y.set(Z=K[xe],te),te+=Z.length;return Y}},J={arraySet:function(K,xe,E,pe,te){for(var Z=0;Z<pe;Z++)K[te+Z]=xe[E+Z]},flattenChunks:function(K){return[].concat.apply([],K)}};ie.setTyped=function(K){K?(ie.Buf8=Uint8Array,ie.Buf16=Uint16Array,ie.Buf32=Int32Array,ie.assign(ie,j)):(ie.Buf8=Array,ie.Buf16=Array,ie.Buf32=Array,ie.assign(ie,J))},ie.setTyped(ce)},{}],42:[function(ye,Re,ie){"use strict";var ce=ye("./common"),j=!0,J=!0;try{String.fromCharCode.apply(null,[0])}catch{j=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{J=!1}for(var K=new ce.Buf8(256),xe=0;xe<256;xe++)K[xe]=252<=xe?6:248<=xe?5:240<=xe?4:224<=xe?3:192<=xe?2:1;function E(pe,te){if(te<65537&&(pe.subarray&&J||!pe.subarray&&j))return String.fromCharCode.apply(null,ce.shrinkBuf(pe,te));for(var Z="",Y=0;Y<te;Y++)Z+=String.fromCharCode(pe[Y]);return Z}K[254]=K[254]=1,ie.string2buf=function(pe){var te,Z,Y,z,f,b=pe.length,w=0;for(z=0;z<b;z++)55296==(64512&(Z=pe.charCodeAt(z)))&&z+1<b&&56320==(64512&(Y=pe.charCodeAt(z+1)))&&(Z=65536+(Z-55296<<10)+(Y-56320),z++),w+=Z<128?1:Z<2048?2:Z<65536?3:4;for(te=new ce.Buf8(w),z=f=0;f<w;z++)55296==(64512&(Z=pe.charCodeAt(z)))&&z+1<b&&56320==(64512&(Y=pe.charCodeAt(z+1)))&&(Z=65536+(Z-55296<<10)+(Y-56320),z++),Z<128?te[f++]=Z:(Z<2048?te[f++]=192|Z>>>6:(Z<65536?te[f++]=224|Z>>>12:(te[f++]=240|Z>>>18,te[f++]=128|Z>>>12&63),te[f++]=128|Z>>>6&63),te[f++]=128|63&Z);return te},ie.buf2binstring=function(pe){return E(pe,pe.length)},ie.binstring2buf=function(pe){for(var te=new ce.Buf8(pe.length),Z=0,Y=te.length;Z<Y;Z++)te[Z]=pe.charCodeAt(Z);return te},ie.buf2string=function(pe,te){var Z,Y,z,f,b=te||pe.length,w=new Array(2*b);for(Z=Y=0;Z<b;)if((z=pe[Z++])<128)w[Y++]=z;else if(4<(f=K[z]))w[Y++]=65533,Z+=f-1;else{for(z&=2===f?31:3===f?15:7;1<f&&Z<b;)z=z<<6|63&pe[Z++],f--;1<f?w[Y++]=65533:z<65536?w[Y++]=z:(w[Y++]=55296|(z-=65536)>>10&1023,w[Y++]=56320|1023&z)}return E(w,Y)},ie.utf8border=function(pe,te){var Z;for((te=te||pe.length)>pe.length&&(te=pe.length),Z=te-1;0<=Z&&128==(192&pe[Z]);)Z--;return Z<0||0===Z?te:Z+K[pe[Z]]>te?Z:te}},{"./common":41}],43:[function(ye,Re,ie){"use strict";Re.exports=function(ce,j,J,K){for(var xe=65535&ce|0,E=ce>>>16&65535|0,pe=0;0!==J;){for(J-=pe=2e3<J?2e3:J;E=E+(xe=xe+j[K++]|0)|0,--pe;);xe%=65521,E%=65521}return xe|E<<16|0}},{}],44:[function(ye,Re,ie){"use strict";Re.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(ye,Re,ie){"use strict";var ce=function(){for(var j,J=[],K=0;K<256;K++){j=K;for(var xe=0;xe<8;xe++)j=1&j?3988292384^j>>>1:j>>>1;J[K]=j}return J}();Re.exports=function(j,J,K,xe){var E=ce,pe=xe+K;j^=-1;for(var te=xe;te<pe;te++)j=j>>>8^E[255&(j^J[te])];return-1^j}},{}],46:[function(ye,Re,ie){"use strict";var ce,j=ye("../utils/common"),J=ye("./trees"),K=ye("./adler32"),xe=ye("./crc32"),E=ye("./messages"),Y=-2,de=258,ke=262;function kt(q,mt){return q.msg=E[mt],mt}function Ve(q){return(q<<1)-(4<q?9:0)}function pt(q){for(var mt=q.length;0<=--mt;)q[mt]=0}function ze(q){var mt=q.state,tt=mt.pending;tt>q.avail_out&&(tt=q.avail_out),0!==tt&&(j.arraySet(q.output,mt.pending_buf,mt.pending_out,tt,q.next_out),q.next_out+=tt,mt.pending_out+=tt,q.total_out+=tt,q.avail_out-=tt,mt.pending-=tt,0===mt.pending&&(mt.pending_out=0))}function Ge(q,mt){J._tr_flush_block(q,0<=q.block_start?q.block_start:-1,q.strstart-q.block_start,mt),q.block_start=q.strstart,ze(q.strm)}function Jt(q,mt){q.pending_buf[q.pending++]=mt}function zt(q,mt){q.pending_buf[q.pending++]=mt>>>8&255,q.pending_buf[q.pending++]=255&mt}function Le(q,mt){var tt,Se,be=q.max_chain_length,Oe=q.strstart,_t=q.prev_length,xt=q.nice_match,We=q.strstart>q.w_size-ke?q.strstart-(q.w_size-ke):0,qe=q.window,Yt=q.w_mask,It=q.prev,sn=q.strstart+de,pi=qe[Oe+_t-1],Nn=qe[Oe+_t];q.prev_length>=q.good_match&&(be>>=2),xt>q.lookahead&&(xt=q.lookahead);do{if(qe[(tt=mt)+_t]===Nn&&qe[tt+_t-1]===pi&&qe[tt]===qe[Oe]&&qe[++tt]===qe[Oe+1]){Oe+=2,tt++;do{}while(qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&qe[++Oe]===qe[++tt]&&Oe<sn);if(Se=de-(sn-Oe),Oe=sn-de,_t<Se){if(q.match_start=mt,xt<=(_t=Se))break;pi=qe[Oe+_t-1],Nn=qe[Oe+_t]}}}while((mt=It[mt&Yt])>We&&0!=--be);return _t<=q.lookahead?_t:q.lookahead}function Di(q){var mt,tt,Se,be,Oe,_t,xt,We,qe,Yt,It=q.w_size;do{if(be=q.window_size-q.lookahead-q.strstart,q.strstart>=It+(It-ke)){for(j.arraySet(q.window,q.window,It,It,0),q.match_start-=It,q.strstart-=It,q.block_start-=It,mt=tt=q.hash_size;Se=q.head[--mt],q.head[mt]=It<=Se?Se-It:0,--tt;);for(mt=tt=It;Se=q.prev[--mt],q.prev[mt]=It<=Se?Se-It:0,--tt;);be+=It}if(0===q.strm.avail_in)break;if(xt=q.window,We=q.strstart+q.lookahead,Yt=void 0,(qe=be)<(Yt=(_t=q.strm).avail_in)&&(Yt=qe),tt=0===Yt?0:(_t.avail_in-=Yt,j.arraySet(xt,_t.input,_t.next_in,Yt,We),1===_t.state.wrap?_t.adler=K(_t.adler,xt,Yt,We):2===_t.state.wrap&&(_t.adler=xe(_t.adler,xt,Yt,We)),_t.next_in+=Yt,_t.total_in+=Yt,Yt),q.lookahead+=tt,q.lookahead+q.insert>=3)for(q.ins_h=q.window[Oe=q.strstart-q.insert],q.ins_h=(q.ins_h<<q.hash_shift^q.window[Oe+1])&q.hash_mask;q.insert&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[Oe+3-1])&q.hash_mask,q.prev[Oe&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=Oe,Oe++,q.insert--,!(q.lookahead+q.insert<3)););}while(q.lookahead<ke&&0!==q.strm.avail_in)}function dn(q,mt){for(var tt,Se;;){if(q.lookahead<ke){if(Di(q),q.lookahead<ke&&0===mt)return 1;if(0===q.lookahead)break}if(tt=0,q.lookahead>=3&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+3-1])&q.hash_mask,tt=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart),0!==tt&&q.strstart-tt<=q.w_size-ke&&(q.match_length=Le(q,tt)),q.match_length>=3)if(Se=J._tr_tally(q,q.strstart-q.match_start,q.match_length-3),q.lookahead-=q.match_length,q.match_length<=q.max_lazy_match&&q.lookahead>=3){for(q.match_length--;q.strstart++,q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+3-1])&q.hash_mask,tt=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart,0!=--q.match_length;);q.strstart++}else q.strstart+=q.match_length,q.match_length=0,q.ins_h=q.window[q.strstart],q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+1])&q.hash_mask;else Se=J._tr_tally(q,0,q.window[q.strstart]),q.lookahead--,q.strstart++;if(Se&&(Ge(q,!1),0===q.strm.avail_out))return 1}return q.insert=q.strstart<2?q.strstart:2,4===mt?(Ge(q,!0),0===q.strm.avail_out?3:4):q.last_lit&&(Ge(q,!1),0===q.strm.avail_out)?1:2}function en(q,mt){for(var tt,Se,be;;){if(q.lookahead<ke){if(Di(q),q.lookahead<ke&&0===mt)return 1;if(0===q.lookahead)break}if(tt=0,q.lookahead>=3&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+3-1])&q.hash_mask,tt=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart),q.prev_length=q.match_length,q.prev_match=q.match_start,q.match_length=2,0!==tt&&q.prev_length<q.max_lazy_match&&q.strstart-tt<=q.w_size-ke&&(q.match_length=Le(q,tt),q.match_length<=5&&(1===q.strategy||3===q.match_length&&4096<q.strstart-q.match_start)&&(q.match_length=2)),q.prev_length>=3&&q.match_length<=q.prev_length){for(be=q.strstart+q.lookahead-3,Se=J._tr_tally(q,q.strstart-1-q.prev_match,q.prev_length-3),q.lookahead-=q.prev_length-1,q.prev_length-=2;++q.strstart<=be&&(q.ins_h=(q.ins_h<<q.hash_shift^q.window[q.strstart+3-1])&q.hash_mask,tt=q.prev[q.strstart&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=q.strstart),0!=--q.prev_length;);if(q.match_available=0,q.match_length=2,q.strstart++,Se&&(Ge(q,!1),0===q.strm.avail_out))return 1}else if(q.match_available){if((Se=J._tr_tally(q,0,q.window[q.strstart-1]))&&Ge(q,!1),q.strstart++,q.lookahead--,0===q.strm.avail_out)return 1}else q.match_available=1,q.strstart++,q.lookahead--}return q.match_available&&(Se=J._tr_tally(q,0,q.window[q.strstart-1]),q.match_available=0),q.insert=q.strstart<2?q.strstart:2,4===mt?(Ge(q,!0),0===q.strm.avail_out?3:4):q.last_lit&&(Ge(q,!1),0===q.strm.avail_out)?1:2}function pn(q,mt,tt,Se,be){this.good_length=q,this.max_lazy=mt,this.nice_length=tt,this.max_chain=Se,this.func=be}function fr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new j.Buf16(1146),this.dyn_dtree=new j.Buf16(122),this.bl_tree=new j.Buf16(78),pt(this.dyn_ltree),pt(this.dyn_dtree),pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new j.Buf16(16),this.heap=new j.Buf16(573),pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new j.Buf16(573),pt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Pt(q){var mt;return q&&q.state?(q.total_in=q.total_out=0,q.data_type=2,(mt=q.state).pending=0,mt.pending_out=0,mt.wrap<0&&(mt.wrap=-mt.wrap),mt.status=mt.wrap?42:113,q.adler=2===mt.wrap?0:1,mt.last_flush=0,J._tr_init(mt),0):kt(q,Y)}function or(q){var tt,mt=Pt(q);return 0===mt&&((tt=q.state).window_size=2*tt.w_size,pt(tt.head),tt.max_lazy_match=ce[tt.level].max_lazy,tt.good_match=ce[tt.level].good_length,tt.nice_match=ce[tt.level].nice_length,tt.max_chain_length=ce[tt.level].max_chain,tt.strstart=0,tt.block_start=0,tt.lookahead=0,tt.insert=0,tt.match_length=tt.prev_length=2,tt.match_available=0,tt.ins_h=0),mt}function zr(q,mt,tt,Se,be,Oe){if(!q)return Y;var _t=1;if(-1===mt&&(mt=6),Se<0?(_t=0,Se=-Se):15<Se&&(_t=2,Se-=16),be<1||9<be||8!==tt||Se<8||15<Se||mt<0||9<mt||Oe<0||4<Oe)return kt(q,Y);8===Se&&(Se=9);var xt=new fr;return(q.state=xt).strm=q,xt.wrap=_t,xt.gzhead=null,xt.w_bits=Se,xt.w_size=1<<xt.w_bits,xt.w_mask=xt.w_size-1,xt.hash_bits=be+7,xt.hash_size=1<<xt.hash_bits,xt.hash_mask=xt.hash_size-1,xt.hash_shift=~~((xt.hash_bits+3-1)/3),xt.window=new j.Buf8(2*xt.w_size),xt.head=new j.Buf16(xt.hash_size),xt.prev=new j.Buf16(xt.w_size),xt.lit_bufsize=1<<be+6,xt.pending_buf_size=4*xt.lit_bufsize,xt.pending_buf=new j.Buf8(xt.pending_buf_size),xt.d_buf=1*xt.lit_bufsize,xt.l_buf=3*xt.lit_bufsize,xt.level=mt,xt.strategy=Oe,xt.method=tt,or(q)}ce=[new pn(0,0,0,0,function(q,mt){var tt=65535;for(tt>q.pending_buf_size-5&&(tt=q.pending_buf_size-5);;){if(q.lookahead<=1){if(Di(q),0===q.lookahead&&0===mt)return 1;if(0===q.lookahead)break}q.strstart+=q.lookahead,q.lookahead=0;var Se=q.block_start+tt;if((0===q.strstart||q.strstart>=Se)&&(q.lookahead=q.strstart-Se,q.strstart=Se,Ge(q,!1),0===q.strm.avail_out)||q.strstart-q.block_start>=q.w_size-ke&&(Ge(q,!1),0===q.strm.avail_out))return 1}return q.insert=0,4===mt?(Ge(q,!0),0===q.strm.avail_out?3:4):(q.strstart>q.block_start&&Ge(q,!1),1)}),new pn(4,4,8,4,dn),new pn(4,5,16,8,dn),new pn(4,6,32,32,dn),new pn(4,4,16,16,en),new pn(8,16,32,32,en),new pn(8,16,128,128,en),new pn(8,32,128,256,en),new pn(32,128,258,1024,en),new pn(32,258,258,4096,en)],ie.deflateInit=function(q,mt){return zr(q,mt,8,15,8,0)},ie.deflateInit2=zr,ie.deflateReset=or,ie.deflateResetKeep=Pt,ie.deflateSetHeader=function(q,mt){return q&&q.state?2!==q.state.wrap?Y:(q.state.gzhead=mt,0):Y},ie.deflate=function(q,mt){var tt,Se,be,Oe;if(!q||!q.state||5<mt||mt<0)return q?kt(q,Y):Y;if(Se=q.state,!q.output||!q.input&&0!==q.avail_in||666===Se.status&&4!==mt)return kt(q,0===q.avail_out?-5:Y);if(Se.strm=q,tt=Se.last_flush,Se.last_flush=mt,42===Se.status)if(2===Se.wrap)q.adler=0,Jt(Se,31),Jt(Se,139),Jt(Se,8),Se.gzhead?(Jt(Se,(Se.gzhead.text?1:0)+(Se.gzhead.hcrc?2:0)+(Se.gzhead.extra?4:0)+(Se.gzhead.name?8:0)+(Se.gzhead.comment?16:0)),Jt(Se,255&Se.gzhead.time),Jt(Se,Se.gzhead.time>>8&255),Jt(Se,Se.gzhead.time>>16&255),Jt(Se,Se.gzhead.time>>24&255),Jt(Se,9===Se.level?2:2<=Se.strategy||Se.level<2?4:0),Jt(Se,255&Se.gzhead.os),Se.gzhead.extra&&Se.gzhead.extra.length&&(Jt(Se,255&Se.gzhead.extra.length),Jt(Se,Se.gzhead.extra.length>>8&255)),Se.gzhead.hcrc&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending,0)),Se.gzindex=0,Se.status=69):(Jt(Se,0),Jt(Se,0),Jt(Se,0),Jt(Se,0),Jt(Se,0),Jt(Se,9===Se.level?2:2<=Se.strategy||Se.level<2?4:0),Jt(Se,3),Se.status=113);else{var _t=8+(Se.w_bits-8<<4)<<8;_t|=(2<=Se.strategy||Se.level<2?0:Se.level<6?1:6===Se.level?2:3)<<6,0!==Se.strstart&&(_t|=32),_t+=31-_t%31,Se.status=113,zt(Se,_t),0!==Se.strstart&&(zt(Se,q.adler>>>16),zt(Se,65535&q.adler)),q.adler=1}if(69===Se.status)if(Se.gzhead.extra){for(be=Se.pending;Se.gzindex<(65535&Se.gzhead.extra.length)&&(Se.pending!==Se.pending_buf_size||(Se.gzhead.hcrc&&Se.pending>be&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending-be,be)),ze(q),be=Se.pending,Se.pending!==Se.pending_buf_size));)Jt(Se,255&Se.gzhead.extra[Se.gzindex]),Se.gzindex++;Se.gzhead.hcrc&&Se.pending>be&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending-be,be)),Se.gzindex===Se.gzhead.extra.length&&(Se.gzindex=0,Se.status=73)}else Se.status=73;if(73===Se.status)if(Se.gzhead.name){be=Se.pending;do{if(Se.pending===Se.pending_buf_size&&(Se.gzhead.hcrc&&Se.pending>be&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending-be,be)),ze(q),be=Se.pending,Se.pending===Se.pending_buf_size)){Oe=1;break}Oe=Se.gzindex<Se.gzhead.name.length?255&Se.gzhead.name.charCodeAt(Se.gzindex++):0,Jt(Se,Oe)}while(0!==Oe);Se.gzhead.hcrc&&Se.pending>be&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending-be,be)),0===Oe&&(Se.gzindex=0,Se.status=91)}else Se.status=91;if(91===Se.status)if(Se.gzhead.comment){be=Se.pending;do{if(Se.pending===Se.pending_buf_size&&(Se.gzhead.hcrc&&Se.pending>be&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending-be,be)),ze(q),be=Se.pending,Se.pending===Se.pending_buf_size)){Oe=1;break}Oe=Se.gzindex<Se.gzhead.comment.length?255&Se.gzhead.comment.charCodeAt(Se.gzindex++):0,Jt(Se,Oe)}while(0!==Oe);Se.gzhead.hcrc&&Se.pending>be&&(q.adler=xe(q.adler,Se.pending_buf,Se.pending-be,be)),0===Oe&&(Se.status=103)}else Se.status=103;if(103===Se.status&&(Se.gzhead.hcrc?(Se.pending+2>Se.pending_buf_size&&ze(q),Se.pending+2<=Se.pending_buf_size&&(Jt(Se,255&q.adler),Jt(Se,q.adler>>8&255),q.adler=0,Se.status=113)):Se.status=113),0!==Se.pending){if(ze(q),0===q.avail_out)return Se.last_flush=-1,0}else if(0===q.avail_in&&Ve(mt)<=Ve(tt)&&4!==mt)return kt(q,-5);if(666===Se.status&&0!==q.avail_in)return kt(q,-5);if(0!==q.avail_in||0!==Se.lookahead||0!==mt&&666!==Se.status){var xt=2===Se.strategy?function(We,qe){for(var Yt;;){if(0===We.lookahead&&(Di(We),0===We.lookahead)){if(0===qe)return 1;break}if(We.match_length=0,Yt=J._tr_tally(We,0,We.window[We.strstart]),We.lookahead--,We.strstart++,Yt&&(Ge(We,!1),0===We.strm.avail_out))return 1}return We.insert=0,4===qe?(Ge(We,!0),0===We.strm.avail_out?3:4):We.last_lit&&(Ge(We,!1),0===We.strm.avail_out)?1:2}(Se,mt):3===Se.strategy?function(We,qe){for(var Yt,It,sn,pi,Nn=We.window;;){if(We.lookahead<=de){if(Di(We),We.lookahead<=de&&0===qe)return 1;if(0===We.lookahead)break}if(We.match_length=0,We.lookahead>=3&&0<We.strstart&&(It=Nn[sn=We.strstart-1])===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]){pi=We.strstart+de;do{}while(It===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]&&It===Nn[++sn]&&sn<pi);We.match_length=de-(pi-sn),We.match_length>We.lookahead&&(We.match_length=We.lookahead)}if(We.match_length>=3?(Yt=J._tr_tally(We,1,We.match_length-3),We.lookahead-=We.match_length,We.strstart+=We.match_length,We.match_length=0):(Yt=J._tr_tally(We,0,We.window[We.strstart]),We.lookahead--,We.strstart++),Yt&&(Ge(We,!1),0===We.strm.avail_out))return 1}return We.insert=0,4===qe?(Ge(We,!0),0===We.strm.avail_out?3:4):We.last_lit&&(Ge(We,!1),0===We.strm.avail_out)?1:2}(Se,mt):ce[Se.level].func(Se,mt);if(3!==xt&&4!==xt||(Se.status=666),1===xt||3===xt)return 0===q.avail_out&&(Se.last_flush=-1),0;if(2===xt&&(1===mt?J._tr_align(Se):5!==mt&&(J._tr_stored_block(Se,0,0,!1),3===mt&&(pt(Se.head),0===Se.lookahead&&(Se.strstart=0,Se.block_start=0,Se.insert=0))),ze(q),0===q.avail_out))return Se.last_flush=-1,0}return 4!==mt?0:Se.wrap<=0?1:(2===Se.wrap?(Jt(Se,255&q.adler),Jt(Se,q.adler>>8&255),Jt(Se,q.adler>>16&255),Jt(Se,q.adler>>24&255),Jt(Se,255&q.total_in),Jt(Se,q.total_in>>8&255),Jt(Se,q.total_in>>16&255),Jt(Se,q.total_in>>24&255)):(zt(Se,q.adler>>>16),zt(Se,65535&q.adler)),ze(q),0<Se.wrap&&(Se.wrap=-Se.wrap),0!==Se.pending?0:1)},ie.deflateEnd=function(q){var mt;return q&&q.state?42!==(mt=q.state.status)&&69!==mt&&73!==mt&&91!==mt&&103!==mt&&113!==mt&&666!==mt?kt(q,Y):(q.state=null,113===mt?kt(q,-3):0):Y},ie.deflateSetDictionary=function(q,mt){var tt,Se,be,Oe,_t,xt,We,qe,Yt=mt.length;if(!q||!q.state||2===(Oe=(tt=q.state).wrap)||1===Oe&&42!==tt.status||tt.lookahead)return Y;for(1===Oe&&(q.adler=K(q.adler,mt,Yt,0)),tt.wrap=0,Yt>=tt.w_size&&(0===Oe&&(pt(tt.head),tt.strstart=0,tt.block_start=0,tt.insert=0),qe=new j.Buf8(tt.w_size),j.arraySet(qe,mt,Yt-tt.w_size,tt.w_size,0),mt=qe,Yt=tt.w_size),_t=q.avail_in,xt=q.next_in,We=q.input,q.avail_in=Yt,q.next_in=0,q.input=mt,Di(tt);tt.lookahead>=3;){for(Se=tt.strstart,be=tt.lookahead-2;tt.ins_h=(tt.ins_h<<tt.hash_shift^tt.window[Se+3-1])&tt.hash_mask,tt.prev[Se&tt.w_mask]=tt.head[tt.ins_h],tt.head[tt.ins_h]=Se,Se++,--be;);tt.strstart=Se,tt.lookahead=2,Di(tt)}return tt.strstart+=tt.lookahead,tt.block_start=tt.strstart,tt.insert=tt.lookahead,tt.lookahead=0,tt.match_length=tt.prev_length=2,tt.match_available=0,q.next_in=xt,q.input=We,q.avail_in=_t,tt.wrap=Oe,0},ie.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(ye,Re,ie){"use strict";Re.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(ye,Re,ie){"use strict";Re.exports=function(ce,j){var J,K,xe,E,pe,te,Z,Y,z,f,b,w,T,R,H,L,oe,ve,we,de,ke,ae,De,$,Ee;$=ce.input,xe=(K=ce.next_in)+(ce.avail_in-5),Ee=ce.output,pe=(E=ce.next_out)-(j-ce.avail_out),te=E+(ce.avail_out-257),Z=(J=ce.state).dmax,Y=J.wsize,z=J.whave,f=J.wnext,b=J.window,w=J.hold,T=J.bits,R=J.lencode,H=J.distcode,L=(1<<J.lenbits)-1,oe=(1<<J.distbits)-1;e:do{T<15&&(w+=$[K++]<<T,w+=$[K++]<<(T+=8),T+=8),ve=R[w&L];t:for(;;){if(w>>>=we=ve>>>24,T-=we,0==(we=ve>>>16&255))Ee[E++]=65535&ve;else{if(!(16&we)){if(0==(64&we)){ve=R[(65535&ve)+(w&(1<<we)-1)];continue t}if(32&we){J.mode=12;break e}ce.msg="invalid literal/length code",J.mode=30;break e}de=65535&ve,(we&=15)&&(T<we&&(w+=$[K++]<<T,T+=8),de+=w&(1<<we)-1,w>>>=we,T-=we),T<15&&(w+=$[K++]<<T,w+=$[K++]<<(T+=8),T+=8),ve=H[w&oe];n:for(;;){if(w>>>=we=ve>>>24,T-=we,!(16&(we=ve>>>16&255))){if(0==(64&we)){ve=H[(65535&ve)+(w&(1<<we)-1)];continue n}ce.msg="invalid distance code",J.mode=30;break e}if(ke=65535&ve,T<(we&=15)&&(w+=$[K++]<<T,(T+=8)<we&&(w+=$[K++]<<T,T+=8)),Z<(ke+=w&(1<<we)-1)){ce.msg="invalid distance too far back",J.mode=30;break e}if(w>>>=we,T-=we,(we=E-pe)<ke){if(z<(we=ke-we)&&J.sane){ce.msg="invalid distance too far back",J.mode=30;break e}if(De=b,(ae=0)===f){if(ae+=Y-we,we<de){for(de-=we;Ee[E++]=b[ae++],--we;);ae=E-ke,De=Ee}}else if(f<we){if(ae+=Y+f-we,(we-=f)<de){for(de-=we;Ee[E++]=b[ae++],--we;);if(ae=0,f<de){for(de-=we=f;Ee[E++]=b[ae++],--we;);ae=E-ke,De=Ee}}}else if(ae+=f-we,we<de){for(de-=we;Ee[E++]=b[ae++],--we;);ae=E-ke,De=Ee}for(;2<de;)Ee[E++]=De[ae++],Ee[E++]=De[ae++],Ee[E++]=De[ae++],de-=3;de&&(Ee[E++]=De[ae++],1<de&&(Ee[E++]=De[ae++]))}else{for(ae=E-ke;Ee[E++]=Ee[ae++],Ee[E++]=Ee[ae++],Ee[E++]=Ee[ae++],2<(de-=3););de&&(Ee[E++]=Ee[ae++],1<de&&(Ee[E++]=Ee[ae++]))}break}}break}}while(K<xe&&E<te);K-=de=T>>3,w&=(1<<(T-=de<<3))-1,ce.next_in=K,ce.next_out=E,ce.avail_in=K<xe?xe-K+5:5-(K-xe),ce.avail_out=E<te?te-E+257:257-(E-te),J.hold=w,J.bits=T}},{}],49:[function(ye,Re,ie){"use strict";var ce=ye("../utils/common"),j=ye("./adler32"),J=ye("./crc32"),K=ye("./inffast"),xe=ye("./inftrees"),Z=-2;function b(ae){return(ae>>>24&255)+(ae>>>8&65280)+((65280&ae)<<8)+((255&ae)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ce.Buf16(320),this.work=new ce.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(ae){var De;return ae&&ae.state?(ae.total_in=ae.total_out=(De=ae.state).total=0,ae.msg="",De.wrap&&(ae.adler=1&De.wrap),De.mode=1,De.last=0,De.havedict=0,De.dmax=32768,De.head=null,De.hold=0,De.bits=0,De.lencode=De.lendyn=new ce.Buf32(852),De.distcode=De.distdyn=new ce.Buf32(592),De.sane=1,De.back=-1,0):Z}function R(ae){var De;return ae&&ae.state?((De=ae.state).wsize=0,De.whave=0,De.wnext=0,T(ae)):Z}function H(ae,De){var $,Ee;return ae&&ae.state?(Ee=ae.state,De<0?($=0,De=-De):($=1+(De>>4),De<48&&(De&=15)),De&&(De<8||15<De)?Z:(null!==Ee.window&&Ee.wbits!==De&&(Ee.window=null),Ee.wrap=$,Ee.wbits=De,R(ae))):Z}function L(ae,De){var $,Ee;return ae?(Ee=new w,(ae.state=Ee).window=null,0!==($=H(ae,De))&&(ae.state=null),$):Z}var oe,ve,we=!0;function de(ae){if(we){var De;for(oe=new ce.Buf32(512),ve=new ce.Buf32(32),De=0;De<144;)ae.lens[De++]=8;for(;De<256;)ae.lens[De++]=9;for(;De<280;)ae.lens[De++]=7;for(;De<288;)ae.lens[De++]=8;for(xe(1,ae.lens,0,288,oe,0,ae.work,{bits:9}),De=0;De<32;)ae.lens[De++]=5;xe(2,ae.lens,0,32,ve,0,ae.work,{bits:5}),we=!1}ae.lencode=oe,ae.lenbits=9,ae.distcode=ve,ae.distbits=5}function ke(ae,De,$,Ee){var ht,Be=ae.state;return null===Be.window&&(Be.wsize=1<<Be.wbits,Be.wnext=0,Be.whave=0,Be.window=new ce.Buf8(Be.wsize)),Ee>=Be.wsize?(ce.arraySet(Be.window,De,$-Be.wsize,Be.wsize,0),Be.wnext=0,Be.whave=Be.wsize):(Ee<(ht=Be.wsize-Be.wnext)&&(ht=Ee),ce.arraySet(Be.window,De,$-Ee,ht,Be.wnext),(Ee-=ht)?(ce.arraySet(Be.window,De,$-Ee,Ee,0),Be.wnext=Ee,Be.whave=Be.wsize):(Be.wnext+=ht,Be.wnext===Be.wsize&&(Be.wnext=0),Be.whave<Be.wsize&&(Be.whave+=ht))),0}ie.inflateReset=R,ie.inflateReset2=H,ie.inflateResetKeep=T,ie.inflateInit=function(ae){return L(ae,15)},ie.inflateInit2=L,ie.inflate=function(ae,De){var $,Ee,ht,Be,kt,Ve,pt,ze,Ge,Jt,zt,Le,Di,dn,en,pn,fr,Pt,or,zr,q,mt,tt,Se,be=0,Oe=new ce.Buf8(4),_t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ae||!ae.state||!ae.output||!ae.input&&0!==ae.avail_in)return Z;12===($=ae.state).mode&&($.mode=13),kt=ae.next_out,ht=ae.output,Be=ae.next_in,Ee=ae.input,ze=$.hold,Ge=$.bits,Jt=Ve=ae.avail_in,zt=pt=ae.avail_out,mt=0;e:for(;;)switch($.mode){case 1:if(0===$.wrap){$.mode=13;break}for(;Ge<16;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(2&$.wrap&&35615===ze){Oe[$.check=0]=255&ze,Oe[1]=ze>>>8&255,$.check=J($.check,Oe,2,0),Ge=ze=0,$.mode=2;break}if($.flags=0,$.head&&($.head.done=!1),!(1&$.wrap)||(((255&ze)<<8)+(ze>>8))%31){ae.msg="incorrect header check",$.mode=30;break}if(8!=(15&ze)){ae.msg="unknown compression method",$.mode=30;break}if(Ge-=4,q=8+(15&(ze>>>=4)),0===$.wbits)$.wbits=q;else if(q>$.wbits){ae.msg="invalid window size",$.mode=30;break}$.dmax=1<<q,ae.adler=$.check=1,$.mode=512&ze?10:12,Ge=ze=0;break;case 2:for(;Ge<16;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if($.flags=ze,8!=(255&$.flags)){ae.msg="unknown compression method",$.mode=30;break}if(57344&$.flags){ae.msg="unknown header flags set",$.mode=30;break}$.head&&($.head.text=ze>>8&1),512&$.flags&&(Oe[0]=255&ze,Oe[1]=ze>>>8&255,$.check=J($.check,Oe,2,0)),Ge=ze=0,$.mode=3;case 3:for(;Ge<32;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}$.head&&($.head.time=ze),512&$.flags&&(Oe[0]=255&ze,Oe[1]=ze>>>8&255,Oe[2]=ze>>>16&255,Oe[3]=ze>>>24&255,$.check=J($.check,Oe,4,0)),Ge=ze=0,$.mode=4;case 4:for(;Ge<16;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}$.head&&($.head.xflags=255&ze,$.head.os=ze>>8),512&$.flags&&(Oe[0]=255&ze,Oe[1]=ze>>>8&255,$.check=J($.check,Oe,2,0)),Ge=ze=0,$.mode=5;case 5:if(1024&$.flags){for(;Ge<16;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}$.length=ze,$.head&&($.head.extra_len=ze),512&$.flags&&(Oe[0]=255&ze,Oe[1]=ze>>>8&255,$.check=J($.check,Oe,2,0)),Ge=ze=0}else $.head&&($.head.extra=null);$.mode=6;case 6:if(1024&$.flags&&(Ve<(Le=$.length)&&(Le=Ve),Le&&($.head&&(q=$.head.extra_len-$.length,$.head.extra||($.head.extra=new Array($.head.extra_len)),ce.arraySet($.head.extra,Ee,Be,Le,q)),512&$.flags&&($.check=J($.check,Ee,Le,Be)),Ve-=Le,Be+=Le,$.length-=Le),$.length))break e;$.length=0,$.mode=7;case 7:if(2048&$.flags){if(0===Ve)break e;for(Le=0;q=Ee[Be+Le++],$.head&&q&&$.length<65536&&($.head.name+=String.fromCharCode(q)),q&&Le<Ve;);if(512&$.flags&&($.check=J($.check,Ee,Le,Be)),Ve-=Le,Be+=Le,q)break e}else $.head&&($.head.name=null);$.length=0,$.mode=8;case 8:if(4096&$.flags){if(0===Ve)break e;for(Le=0;q=Ee[Be+Le++],$.head&&q&&$.length<65536&&($.head.comment+=String.fromCharCode(q)),q&&Le<Ve;);if(512&$.flags&&($.check=J($.check,Ee,Le,Be)),Ve-=Le,Be+=Le,q)break e}else $.head&&($.head.comment=null);$.mode=9;case 9:if(512&$.flags){for(;Ge<16;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(ze!==(65535&$.check)){ae.msg="header crc mismatch",$.mode=30;break}Ge=ze=0}$.head&&($.head.hcrc=$.flags>>9&1,$.head.done=!0),ae.adler=$.check=0,$.mode=12;break;case 10:for(;Ge<32;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}ae.adler=$.check=b(ze),Ge=ze=0,$.mode=11;case 11:if(0===$.havedict)return ae.next_out=kt,ae.avail_out=pt,ae.next_in=Be,ae.avail_in=Ve,$.hold=ze,$.bits=Ge,2;ae.adler=$.check=1,$.mode=12;case 12:if(5===De||6===De)break e;case 13:if($.last){ze>>>=7&Ge,Ge-=7&Ge,$.mode=27;break}for(;Ge<3;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}switch($.last=1&ze,Ge-=1,3&(ze>>>=1)){case 0:$.mode=14;break;case 1:if(de($),$.mode=20,6!==De)break;ze>>>=2,Ge-=2;break e;case 2:$.mode=17;break;case 3:ae.msg="invalid block type",$.mode=30}ze>>>=2,Ge-=2;break;case 14:for(ze>>>=7&Ge,Ge-=7&Ge;Ge<32;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if((65535&ze)!=(ze>>>16^65535)){ae.msg="invalid stored block lengths",$.mode=30;break}if($.length=65535&ze,Ge=ze=0,$.mode=15,6===De)break e;case 15:$.mode=16;case 16:if(Le=$.length){if(Ve<Le&&(Le=Ve),pt<Le&&(Le=pt),0===Le)break e;ce.arraySet(ht,Ee,Be,Le,kt),Ve-=Le,Be+=Le,pt-=Le,kt+=Le,$.length-=Le;break}$.mode=12;break;case 17:for(;Ge<14;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if($.nlen=257+(31&ze),Ge-=5,$.ndist=1+(31&(ze>>>=5)),Ge-=5,$.ncode=4+(15&(ze>>>=5)),ze>>>=4,Ge-=4,286<$.nlen||30<$.ndist){ae.msg="too many length or distance symbols",$.mode=30;break}$.have=0,$.mode=18;case 18:for(;$.have<$.ncode;){for(;Ge<3;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}$.lens[_t[$.have++]]=7&ze,ze>>>=3,Ge-=3}for(;$.have<19;)$.lens[_t[$.have++]]=0;if($.lencode=$.lendyn,$.lenbits=7,mt=xe(0,$.lens,0,19,$.lencode,0,$.work,tt={bits:$.lenbits}),$.lenbits=tt.bits,mt){ae.msg="invalid code lengths set",$.mode=30;break}$.have=0,$.mode=19;case 19:for(;$.have<$.nlen+$.ndist;){for(;pn=(be=$.lencode[ze&(1<<$.lenbits)-1])>>>16&255,fr=65535&be,!((en=be>>>24)<=Ge);){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(fr<16)ze>>>=en,Ge-=en,$.lens[$.have++]=fr;else{if(16===fr){for(Se=en+2;Ge<Se;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(ze>>>=en,Ge-=en,0===$.have){ae.msg="invalid bit length repeat",$.mode=30;break}q=$.lens[$.have-1],Le=3+(3&ze),ze>>>=2,Ge-=2}else if(17===fr){for(Se=en+3;Ge<Se;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}Ge-=en,q=0,Le=3+(7&(ze>>>=en)),ze>>>=3,Ge-=3}else{for(Se=en+7;Ge<Se;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}Ge-=en,q=0,Le=11+(127&(ze>>>=en)),ze>>>=7,Ge-=7}if($.have+Le>$.nlen+$.ndist){ae.msg="invalid bit length repeat",$.mode=30;break}for(;Le--;)$.lens[$.have++]=q}}if(30===$.mode)break;if(0===$.lens[256]){ae.msg="invalid code -- missing end-of-block",$.mode=30;break}if($.lenbits=9,mt=xe(1,$.lens,0,$.nlen,$.lencode,0,$.work,tt={bits:$.lenbits}),$.lenbits=tt.bits,mt){ae.msg="invalid literal/lengths set",$.mode=30;break}if($.distbits=6,$.distcode=$.distdyn,mt=xe(2,$.lens,$.nlen,$.ndist,$.distcode,0,$.work,tt={bits:$.distbits}),$.distbits=tt.bits,mt){ae.msg="invalid distances set",$.mode=30;break}if($.mode=20,6===De)break e;case 20:$.mode=21;case 21:if(6<=Ve&&258<=pt){ae.next_out=kt,ae.avail_out=pt,ae.next_in=Be,ae.avail_in=Ve,$.hold=ze,$.bits=Ge,K(ae,zt),kt=ae.next_out,ht=ae.output,pt=ae.avail_out,Be=ae.next_in,Ee=ae.input,Ve=ae.avail_in,ze=$.hold,Ge=$.bits,12===$.mode&&($.back=-1);break}for($.back=0;pn=(be=$.lencode[ze&(1<<$.lenbits)-1])>>>16&255,fr=65535&be,!((en=be>>>24)<=Ge);){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(pn&&0==(240&pn)){for(Pt=en,or=pn,zr=fr;pn=(be=$.lencode[zr+((ze&(1<<Pt+or)-1)>>Pt)])>>>16&255,fr=65535&be,!(Pt+(en=be>>>24)<=Ge);){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}ze>>>=Pt,Ge-=Pt,$.back+=Pt}if(ze>>>=en,Ge-=en,$.back+=en,$.length=fr,0===pn){$.mode=26;break}if(32&pn){$.back=-1,$.mode=12;break}if(64&pn){ae.msg="invalid literal/length code",$.mode=30;break}$.extra=15&pn,$.mode=22;case 22:if($.extra){for(Se=$.extra;Ge<Se;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}$.length+=ze&(1<<$.extra)-1,ze>>>=$.extra,Ge-=$.extra,$.back+=$.extra}$.was=$.length,$.mode=23;case 23:for(;pn=(be=$.distcode[ze&(1<<$.distbits)-1])>>>16&255,fr=65535&be,!((en=be>>>24)<=Ge);){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(0==(240&pn)){for(Pt=en,or=pn,zr=fr;pn=(be=$.distcode[zr+((ze&(1<<Pt+or)-1)>>Pt)])>>>16&255,fr=65535&be,!(Pt+(en=be>>>24)<=Ge);){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}ze>>>=Pt,Ge-=Pt,$.back+=Pt}if(ze>>>=en,Ge-=en,$.back+=en,64&pn){ae.msg="invalid distance code",$.mode=30;break}$.offset=fr,$.extra=15&pn,$.mode=24;case 24:if($.extra){for(Se=$.extra;Ge<Se;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}$.offset+=ze&(1<<$.extra)-1,ze>>>=$.extra,Ge-=$.extra,$.back+=$.extra}if($.offset>$.dmax){ae.msg="invalid distance too far back",$.mode=30;break}$.mode=25;case 25:if(0===pt)break e;if($.offset>(Le=zt-pt)){if((Le=$.offset-Le)>$.whave&&$.sane){ae.msg="invalid distance too far back",$.mode=30;break}Di=Le>$.wnext?$.wsize-(Le-=$.wnext):$.wnext-Le,Le>$.length&&(Le=$.length),dn=$.window}else dn=ht,Di=kt-$.offset,Le=$.length;for(pt<Le&&(Le=pt),pt-=Le,$.length-=Le;ht[kt++]=dn[Di++],--Le;);0===$.length&&($.mode=21);break;case 26:if(0===pt)break e;ht[kt++]=$.length,pt--,$.mode=21;break;case 27:if($.wrap){for(;Ge<32;){if(0===Ve)break e;Ve--,ze|=Ee[Be++]<<Ge,Ge+=8}if(ae.total_out+=zt-=pt,$.total+=zt,zt&&(ae.adler=$.check=$.flags?J($.check,ht,zt,kt-zt):j($.check,ht,zt,kt-zt)),zt=pt,($.flags?ze:b(ze))!==$.check){ae.msg="incorrect data check",$.mode=30;break}Ge=ze=0}$.mode=28;case 28:if($.wrap&&$.flags){for(;Ge<32;){if(0===Ve)break e;Ve--,ze+=Ee[Be++]<<Ge,Ge+=8}if(ze!==(4294967295&$.total)){ae.msg="incorrect length check",$.mode=30;break}Ge=ze=0}$.mode=29;case 29:mt=1;break e;case 30:mt=-3;break e;case 31:return-4;default:return Z}return ae.next_out=kt,ae.avail_out=pt,ae.next_in=Be,ae.avail_in=Ve,$.hold=ze,$.bits=Ge,($.wsize||zt!==ae.avail_out&&$.mode<30&&($.mode<27||4!==De))&&ke(ae,ae.output,ae.next_out,zt-ae.avail_out)?($.mode=31,-4):(zt-=ae.avail_out,ae.total_in+=Jt-=ae.avail_in,ae.total_out+=zt,$.total+=zt,$.wrap&&zt&&(ae.adler=$.check=$.flags?J($.check,ht,zt,ae.next_out-zt):j($.check,ht,zt,ae.next_out-zt)),ae.data_type=$.bits+($.last?64:0)+(12===$.mode?128:0)+(20===$.mode||15===$.mode?256:0),(0==Jt&&0===zt||4===De)&&0===mt&&(mt=-5),mt)},ie.inflateEnd=function(ae){if(!ae||!ae.state)return Z;var De=ae.state;return De.window&&(De.window=null),ae.state=null,0},ie.inflateGetHeader=function(ae,De){var $;return ae&&ae.state?0==(2&($=ae.state).wrap)?Z:(($.head=De).done=!1,0):Z},ie.inflateSetDictionary=function(ae,De){var $,Ee=De.length;return ae&&ae.state?0!==($=ae.state).wrap&&11!==$.mode?Z:11===$.mode&&j(1,De,Ee,0)!==$.check?-3:ke(ae,De,Ee,Ee)?($.mode=31,-4):($.havedict=1,0):Z},ie.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(ye,Re,ie){"use strict";var ce=ye("../utils/common"),j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],J=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],xe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Re.exports=function(E,pe,te,Z,Y,z,f,b){var w,T,R,H,L,oe,ve,we,de,ke=b.bits,ae=0,De=0,$=0,Ee=0,ht=0,Be=0,kt=0,Ve=0,pt=0,ze=0,Ge=null,Jt=0,zt=new ce.Buf16(16),Le=new ce.Buf16(16),Di=null,dn=0;for(ae=0;ae<=15;ae++)zt[ae]=0;for(De=0;De<Z;De++)zt[pe[te+De]]++;for(ht=ke,Ee=15;1<=Ee&&0===zt[Ee];Ee--);if(Ee<ht&&(ht=Ee),0===Ee)return Y[z++]=20971520,Y[z++]=20971520,b.bits=1,0;for($=1;$<Ee&&0===zt[$];$++);for(ht<$&&(ht=$),ae=Ve=1;ae<=15;ae++)if(Ve<<=1,(Ve-=zt[ae])<0)return-1;if(0<Ve&&(0===E||1!==Ee))return-1;for(Le[1]=0,ae=1;ae<15;ae++)Le[ae+1]=Le[ae]+zt[ae];for(De=0;De<Z;De++)0!==pe[te+De]&&(f[Le[pe[te+De]]++]=De);if(oe=0===E?(Ge=Di=f,19):1===E?(Ge=j,Jt-=257,Di=J,dn-=257,256):(Ge=K,Di=xe,-1),ae=$,L=z,kt=De=ze=0,R=-1,H=(pt=1<<(Be=ht))-1,1===E&&852<pt||2===E&&592<pt)return 1;for(;;){for(ve=ae-kt,de=f[De]<oe?(we=0,f[De]):f[De]>oe?(we=Di[dn+f[De]],Ge[Jt+f[De]]):(we=96,0),w=1<<ae-kt,$=T=1<<Be;Y[L+(ze>>kt)+(T-=w)]=ve<<24|we<<16|de|0,0!==T;);for(w=1<<ae-1;ze&w;)w>>=1;if(0!==w?(ze&=w-1,ze+=w):ze=0,De++,0==--zt[ae]){if(ae===Ee)break;ae=pe[te+f[De]]}if(ht<ae&&(ze&H)!==R){for(0===kt&&(kt=ht),L+=$,Ve=1<<(Be=ae-kt);Be+kt<Ee&&!((Ve-=zt[Be+kt])<=0);)Be++,Ve<<=1;if(pt+=1<<Be,1===E&&852<pt||2===E&&592<pt)return 1;Y[R=ze&H]=ht<<24|Be<<16|L-z|0}}return 0!==ze&&(Y[L+ze]=ae-kt<<24|64<<16|0),b.bits=ht,0}},{"../utils/common":41}],51:[function(ye,Re,ie){"use strict";Re.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(ye,Re,ie){"use strict";var ce=ye("../utils/common");function K(be){for(var Oe=be.length;0<=--Oe;)be[Oe]=0}var Z=30,f=15,oe=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ve=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],de=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ke=new Array(576);K(ke);var ae=new Array(60);K(ae);var De=new Array(512);K(De);var $=new Array(256);K($);var Ee=new Array(29);K(Ee);var ht,Be,kt,Ve=new Array(Z);function pt(be,Oe,_t,xt,We){this.static_tree=be,this.extra_bits=Oe,this.extra_base=_t,this.elems=xt,this.max_length=We,this.has_stree=be&&be.length}function ze(be,Oe){this.dyn_tree=be,this.max_code=0,this.stat_desc=Oe}function Ge(be){return be<256?De[be]:De[256+(be>>>7)]}function Jt(be,Oe){be.pending_buf[be.pending++]=255&Oe,be.pending_buf[be.pending++]=Oe>>>8&255}function zt(be,Oe,_t){be.bi_valid>16-_t?(be.bi_buf|=Oe<<be.bi_valid&65535,Jt(be,be.bi_buf),be.bi_buf=Oe>>16-be.bi_valid,be.bi_valid+=_t-16):(be.bi_buf|=Oe<<be.bi_valid&65535,be.bi_valid+=_t)}function Le(be,Oe,_t){zt(be,_t[2*Oe],_t[2*Oe+1])}function Di(be,Oe){for(var _t=0;_t|=1&be,be>>>=1,_t<<=1,0<--Oe;);return _t>>>1}function dn(be,Oe,_t){var xt,We,qe=new Array(16),Yt=0;for(xt=1;xt<=f;xt++)qe[xt]=Yt=Yt+_t[xt-1]<<1;for(We=0;We<=Oe;We++){var It=be[2*We+1];0!==It&&(be[2*We]=Di(qe[It]++,It))}}function en(be){var Oe;for(Oe=0;Oe<286;Oe++)be.dyn_ltree[2*Oe]=0;for(Oe=0;Oe<Z;Oe++)be.dyn_dtree[2*Oe]=0;for(Oe=0;Oe<19;Oe++)be.bl_tree[2*Oe]=0;be.dyn_ltree[512]=1,be.opt_len=be.static_len=0,be.last_lit=be.matches=0}function pn(be){8<be.bi_valid?Jt(be,be.bi_buf):0<be.bi_valid&&(be.pending_buf[be.pending++]=be.bi_buf),be.bi_buf=0,be.bi_valid=0}function fr(be,Oe,_t,xt){var We=2*Oe,qe=2*_t;return be[We]<be[qe]||be[We]===be[qe]&&xt[Oe]<=xt[_t]}function Pt(be,Oe,_t){for(var xt=be.heap[_t],We=_t<<1;We<=be.heap_len&&(We<be.heap_len&&fr(Oe,be.heap[We+1],be.heap[We],be.depth)&&We++,!fr(Oe,xt,be.heap[We],be.depth));)be.heap[_t]=be.heap[We],_t=We,We<<=1;be.heap[_t]=xt}function or(be,Oe,_t){var xt,We,qe,Yt,It=0;if(0!==be.last_lit)for(;xt=be.pending_buf[be.d_buf+2*It]<<8|be.pending_buf[be.d_buf+2*It+1],We=be.pending_buf[be.l_buf+It],It++,0===xt?Le(be,We,Oe):(Le(be,(qe=$[We])+256+1,Oe),0!==(Yt=oe[qe])&&zt(be,We-=Ee[qe],Yt),Le(be,qe=Ge(--xt),_t),0!==(Yt=ve[qe])&&zt(be,xt-=Ve[qe],Yt)),It<be.last_lit;);Le(be,256,Oe)}function zr(be,Oe){var _t,xt,We,qe=Oe.dyn_tree,Yt=Oe.stat_desc.static_tree,It=Oe.stat_desc.has_stree,sn=Oe.stat_desc.elems,pi=-1;for(be.heap_len=0,be.heap_max=573,_t=0;_t<sn;_t++)0!==qe[2*_t]?(be.heap[++be.heap_len]=pi=_t,be.depth[_t]=0):qe[2*_t+1]=0;for(;be.heap_len<2;)qe[2*(We=be.heap[++be.heap_len]=pi<2?++pi:0)]=1,be.depth[We]=0,be.opt_len--,It&&(be.static_len-=Yt[2*We+1]);for(Oe.max_code=pi,_t=be.heap_len>>1;1<=_t;_t--)Pt(be,qe,_t);for(We=sn;_t=be.heap[1],be.heap[1]=be.heap[be.heap_len--],Pt(be,qe,1),xt=be.heap[1],be.heap[--be.heap_max]=_t,be.heap[--be.heap_max]=xt,qe[2*We]=qe[2*_t]+qe[2*xt],be.depth[We]=(be.depth[_t]>=be.depth[xt]?be.depth[_t]:be.depth[xt])+1,qe[2*_t+1]=qe[2*xt+1]=We,be.heap[1]=We++,Pt(be,qe,1),2<=be.heap_len;);be.heap[--be.heap_max]=be.heap[1],function(Nn,po){var Io,Ao,Ma,Bi,Xr,Je,Ro=po.dyn_tree,ki=po.max_code,dl=po.stat_desc.static_tree,As=po.stat_desc.has_stree,Rs=po.stat_desc.extra_bits,Ta=po.stat_desc.extra_base,Ia=po.stat_desc.max_length,da=0;for(Bi=0;Bi<=f;Bi++)Nn.bl_count[Bi]=0;for(Ro[2*Nn.heap[Nn.heap_max]+1]=0,Io=Nn.heap_max+1;Io<573;Io++)Ia<(Bi=Ro[2*Ro[2*(Ao=Nn.heap[Io])+1]+1]+1)&&(Bi=Ia,da++),Ro[2*Ao+1]=Bi,ki<Ao||(Nn.bl_count[Bi]++,Xr=0,Ta<=Ao&&(Xr=Rs[Ao-Ta]),Nn.opt_len+=(Je=Ro[2*Ao])*(Bi+Xr),As&&(Nn.static_len+=Je*(dl[2*Ao+1]+Xr)));if(0!==da){do{for(Bi=Ia-1;0===Nn.bl_count[Bi];)Bi--;Nn.bl_count[Bi]--,Nn.bl_count[Bi+1]+=2,Nn.bl_count[Ia]--,da-=2}while(0<da);for(Bi=Ia;0!==Bi;Bi--)for(Ao=Nn.bl_count[Bi];0!==Ao;)ki<(Ma=Nn.heap[--Io])||(Ro[2*Ma+1]!==Bi&&(Nn.opt_len+=(Bi-Ro[2*Ma+1])*Ro[2*Ma],Ro[2*Ma+1]=Bi),Ao--)}}(be,Oe),dn(qe,pi,be.bl_count)}function q(be,Oe,_t){var xt,We,qe=-1,Yt=Oe[1],It=0,sn=7,pi=4;for(0===Yt&&(sn=138,pi=3),Oe[2*(_t+1)+1]=65535,xt=0;xt<=_t;xt++)We=Yt,Yt=Oe[2*(xt+1)+1],++It<sn&&We===Yt||(It<pi?be.bl_tree[2*We]+=It:0!==We?(We!==qe&&be.bl_tree[2*We]++,be.bl_tree[32]++):It<=10?be.bl_tree[34]++:be.bl_tree[36]++,qe=We,pi=(It=0)===Yt?(sn=138,3):We===Yt?(sn=6,3):(sn=7,4))}function mt(be,Oe,_t){var xt,We,qe=-1,Yt=Oe[1],It=0,sn=7,pi=4;for(0===Yt&&(sn=138,pi=3),xt=0;xt<=_t;xt++)if(We=Yt,Yt=Oe[2*(xt+1)+1],!(++It<sn&&We===Yt)){if(It<pi)for(;Le(be,We,be.bl_tree),0!=--It;);else 0!==We?(We!==qe&&(Le(be,We,be.bl_tree),It--),Le(be,16,be.bl_tree),zt(be,It-3,2)):It<=10?(Le(be,17,be.bl_tree),zt(be,It-3,3)):(Le(be,18,be.bl_tree),zt(be,It-11,7));qe=We,pi=(It=0)===Yt?(sn=138,3):We===Yt?(sn=6,3):(sn=7,4)}}K(Ve);var tt=!1;function Se(be,Oe,_t,xt){var We,qe,Yt;zt(be,0+(xt?1:0),3),qe=Oe,Yt=_t,pn(We=be),Jt(We,Yt),Jt(We,~Yt),ce.arraySet(We.pending_buf,We.window,qe,Yt,We.pending),We.pending+=Yt}ie._tr_init=function(be){tt||(function(){var Oe,_t,xt,We,qe,Yt=new Array(16);for(We=xt=0;We<28;We++)for(Ee[We]=xt,Oe=0;Oe<1<<oe[We];Oe++)$[xt++]=We;for($[xt-1]=We,We=qe=0;We<16;We++)for(Ve[We]=qe,Oe=0;Oe<1<<ve[We];Oe++)De[qe++]=We;for(qe>>=7;We<Z;We++)for(Ve[We]=qe<<7,Oe=0;Oe<1<<ve[We]-7;Oe++)De[256+qe++]=We;for(_t=0;_t<=f;_t++)Yt[_t]=0;for(Oe=0;Oe<=143;)ke[2*Oe+1]=8,Oe++,Yt[8]++;for(;Oe<=255;)ke[2*Oe+1]=9,Oe++,Yt[9]++;for(;Oe<=279;)ke[2*Oe+1]=7,Oe++,Yt[7]++;for(;Oe<=287;)ke[2*Oe+1]=8,Oe++,Yt[8]++;for(dn(ke,287,Yt),Oe=0;Oe<Z;Oe++)ae[2*Oe+1]=5,ae[2*Oe]=Di(Oe,5);ht=new pt(ke,oe,257,286,f),Be=new pt(ae,ve,0,Z,f),kt=new pt(new Array(0),we,0,19,7)}(),tt=!0),be.l_desc=new ze(be.dyn_ltree,ht),be.d_desc=new ze(be.dyn_dtree,Be),be.bl_desc=new ze(be.bl_tree,kt),be.bi_buf=0,be.bi_valid=0,en(be)},ie._tr_stored_block=Se,ie._tr_flush_block=function(be,Oe,_t,xt){var We,qe,Yt=0;0<be.level?(2===be.strm.data_type&&(be.strm.data_type=function(It){var sn,pi=4093624447;for(sn=0;sn<=31;sn++,pi>>>=1)if(1&pi&&0!==It.dyn_ltree[2*sn])return 0;if(0!==It.dyn_ltree[18]||0!==It.dyn_ltree[20]||0!==It.dyn_ltree[26])return 1;for(sn=32;sn<256;sn++)if(0!==It.dyn_ltree[2*sn])return 1;return 0}(be)),zr(be,be.l_desc),zr(be,be.d_desc),Yt=function(It){var sn;for(q(It,It.dyn_ltree,It.l_desc.max_code),q(It,It.dyn_dtree,It.d_desc.max_code),zr(It,It.bl_desc),sn=18;3<=sn&&0===It.bl_tree[2*de[sn]+1];sn--);return It.opt_len+=3*(sn+1)+5+5+4,sn}(be),(qe=be.static_len+3+7>>>3)<=(We=be.opt_len+3+7>>>3)&&(We=qe)):We=qe=_t+5,_t+4<=We&&-1!==Oe?Se(be,Oe,_t,xt):4===be.strategy||qe===We?(zt(be,2+(xt?1:0),3),or(be,ke,ae)):(zt(be,4+(xt?1:0),3),function(It,sn,pi,Nn){var po;for(zt(It,sn-257,5),zt(It,pi-1,5),zt(It,Nn-4,4),po=0;po<Nn;po++)zt(It,It.bl_tree[2*de[po]+1],3);mt(It,It.dyn_ltree,sn-1),mt(It,It.dyn_dtree,pi-1)}(be,be.l_desc.max_code+1,be.d_desc.max_code+1,Yt+1),or(be,be.dyn_ltree,be.dyn_dtree)),en(be),xt&&pn(be)},ie._tr_tally=function(be,Oe,_t){return be.pending_buf[be.d_buf+2*be.last_lit]=Oe>>>8&255,be.pending_buf[be.d_buf+2*be.last_lit+1]=255&Oe,be.pending_buf[be.l_buf+be.last_lit]=255&_t,be.last_lit++,0===Oe?be.dyn_ltree[2*_t]++:(be.matches++,Oe--,be.dyn_ltree[2*($[_t]+256+1)]++,be.dyn_dtree[2*Ge(Oe)]++),be.last_lit===be.lit_bufsize-1},ie._tr_align=function(be){var Oe;zt(be,2,3),Le(be,256,ke),16===(Oe=be).bi_valid?(Jt(Oe,Oe.bi_buf),Oe.bi_buf=0,Oe.bi_valid=0):8<=Oe.bi_valid&&(Oe.pending_buf[Oe.pending++]=255&Oe.bi_buf,Oe.bi_buf>>=8,Oe.bi_valid-=8)}},{"../utils/common":41}],53:[function(ye,Re,ie){"use strict";Re.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(ye,Re,ie){(function(ce){!function(j,J){"use strict";if(!j.setImmediate){var K,xe,E,pe,te=1,Z={},Y=!1,z=j.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(j);f=f&&f.setTimeout?f:j,K="[object process]"==={}.toString.call(j.process)?function(R){process.nextTick(function(){w(R)})}:function(){if(j.postMessage&&!j.importScripts){var R=!0,H=j.onmessage;return j.onmessage=function(){R=!1},j.postMessage("","*"),j.onmessage=H,R}}()?(pe="setImmediate$"+Math.random()+"$",j.addEventListener?j.addEventListener("message",T,!1):j.attachEvent("onmessage",T),function(R){j.postMessage(pe+R,"*")}):j.MessageChannel?((E=new MessageChannel).port1.onmessage=function(R){w(R.data)},function(R){E.port2.postMessage(R)}):z&&"onreadystatechange"in z.createElement("script")?(xe=z.documentElement,function(R){var H=z.createElement("script");H.onreadystatechange=function(){w(R),H.onreadystatechange=null,xe.removeChild(H),H=null},xe.appendChild(H)}):function(R){setTimeout(w,0,R)},f.setImmediate=function(R){"function"!=typeof R&&(R=new Function(""+R));for(var H=new Array(arguments.length-1),L=0;L<H.length;L++)H[L]=arguments[L+1];return Z[te]={callback:R,args:H},K(te),te++},f.clearImmediate=b}function b(R){delete Z[R]}function w(R){if(Y)setTimeout(w,0,R);else{var H=Z[R];if(H){Y=!0;try{!function(L){var oe=L.callback,ve=L.args;switch(ve.length){case 0:oe();break;case 1:oe(ve[0]);break;case 2:oe(ve[0],ve[1]);break;case 3:oe(ve[0],ve[1],ve[2]);break;default:oe.apply(undefined,ve)}}(H)}finally{b(R),Y=!1}}}}function T(R){R.source===j&&"string"==typeof R.data&&0===R.data.indexOf(pe)&&w(+R.data.slice(pe.length))}}(typeof self>"u"?void 0===ce?this:ce:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},153:(cn,ye)=>{var f,H,ie=(f=new Date,H=4,{setLogLevel:function(oe){H=oe==this.debug?1:oe==this.info?2:oe==this.warn?3:4},debug:function(oe,ve){void 0===console.debug&&(console.debug=console.log),1>=H&&console.debug("["+ie.getDurationString(new Date-f,1e3)+"]","["+oe+"]",ve)},log:function(oe,ve){this.debug(oe.msg)},info:function(oe,ve){2>=H&&console.info("["+ie.getDurationString(new Date-f,1e3)+"]","["+oe+"]",ve)},warn:function(oe,ve){3>=H&&console.warn("["+ie.getDurationString(new Date-f,1e3)+"]","["+oe+"]",ve)},error:function(oe,ve){4>=H&&console.error("["+ie.getDurationString(new Date-f,1e3)+"]","["+oe+"]",ve)}});ie.getDurationString=function(f,b){var w;function T(we,de){for(var ae=(""+we).split(".");ae[0].length<de;)ae[0]="0"+ae[0];return ae.join(".")}f<0?(w=!0,f=-f):w=!1;var H=f/(b||1),L=Math.floor(H/3600);H-=3600*L;var oe=Math.floor(H/60),ve=1e3*(H-=60*oe);return ve-=1e3*(H=Math.floor(H)),ve=Math.floor(ve),(w?"-":"")+L+":"+T(oe,2)+":"+T(H,2)+"."+T(ve,3)},ie.printRanges=function(f){var b=f.length;if(b>0){for(var w="",T=0;T<b;T++)T>0&&(w+=","),w+="["+ie.getDurationString(f.start(T))+","+ie.getDurationString(f.end(T))+"]";return w}return"(empty)"};var ce=function(f){if(!(f instanceof ArrayBuffer))throw"Needs an array buffer";this.buffer=f,this.dataview=new DataView(f),this.position=0};ce.prototype.getPosition=function(){return this.position},ce.prototype.getEndPosition=function(){return this.buffer.byteLength},ce.prototype.getLength=function(){return this.buffer.byteLength},ce.prototype.seek=function(f){var b=Math.max(0,Math.min(this.buffer.byteLength,f));return this.position=isNaN(b)||!isFinite(b)?0:b,!0},ce.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},ce.prototype.readAnyInt=function(f,b){var w=0;if(this.position+f<=this.buffer.byteLength){switch(f){case 1:w=b?this.dataview.getInt8(this.position):this.dataview.getUint8(this.position);break;case 2:w=b?this.dataview.getInt16(this.position):this.dataview.getUint16(this.position);break;case 3:if(b)throw"No method for reading signed 24 bits values";w=this.dataview.getUint8(this.position)<<16,w|=this.dataview.getUint8(this.position+1)<<8,w|=this.dataview.getUint8(this.position+2);break;case 4:w=b?this.dataview.getInt32(this.position):this.dataview.getUint32(this.position);break;case 8:if(b)throw"No method for reading signed 64 bits values";w=this.dataview.getUint32(this.position)<<32,w|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+f}return this.position+=f,w}throw"Not enough bytes in buffer"},ce.prototype.readUint8=function(){return this.readAnyInt(1,!1)},ce.prototype.readUint16=function(){return this.readAnyInt(2,!1)},ce.prototype.readUint24=function(){return this.readAnyInt(3,!1)},ce.prototype.readUint32=function(){return this.readAnyInt(4,!1)},ce.prototype.readUint64=function(){return this.readAnyInt(8,!1)},ce.prototype.readString=function(f){if(this.position+f<=this.buffer.byteLength){for(var b="",w=0;w<f;w++)b+=String.fromCharCode(this.readUint8());return b}throw"Not enough bytes in buffer"},ce.prototype.readCString=function(){for(var f=[];;){var b=this.readUint8();if(0===b)break;f.push(b)}return String.fromCharCode.apply(null,f)},ce.prototype.readInt8=function(){return this.readAnyInt(1,!0)},ce.prototype.readInt16=function(){return this.readAnyInt(2,!0)},ce.prototype.readInt32=function(){return this.readAnyInt(4,!0)},ce.prototype.readInt64=function(){return this.readAnyInt(8,!1)},ce.prototype.readUint8Array=function(f){for(var b=new Uint8Array(f),w=0;w<f;w++)b[w]=this.readUint8();return b},ce.prototype.readInt16Array=function(f){for(var b=new Int16Array(f),w=0;w<f;w++)b[w]=this.readInt16();return b},ce.prototype.readUint16Array=function(f){for(var b=new Int16Array(f),w=0;w<f;w++)b[w]=this.readUint16();return b},ce.prototype.readUint32Array=function(f){for(var b=new Uint32Array(f),w=0;w<f;w++)b[w]=this.readUint32();return b},ce.prototype.readInt32Array=function(f){for(var b=new Int32Array(f),w=0;w<f;w++)b[w]=this.readInt32();return b};var j=function(f,b,w){this._byteOffset=b||0,f instanceof ArrayBuffer?this.buffer=f:"object"==typeof f?(this.dataView=f,b&&(this._byteOffset+=b)):this.buffer=new ArrayBuffer(f||0),this.position=0,this.endianness=w??j.LITTLE_ENDIAN};j.prototype={},j.prototype.getPosition=function(){return this.position},j.prototype._realloc=function(f){if(this._dynamicSize){var b=this._byteOffset+this.position+f,w=this._buffer.byteLength;if(b<=w)return void(b>this._byteLength&&(this._byteLength=b));for(w<1&&(w=1);b>w;)w*=2;var T=new ArrayBuffer(w),R=new Uint8Array(this._buffer);new Uint8Array(T,0,R.length).set(R),this.buffer=T,this._byteLength=b}},j.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var f=new ArrayBuffer(this._byteLength),b=new Uint8Array(f),w=new Uint8Array(this._buffer,0,b.length);b.set(w),this.buffer=f}},j.BIG_ENDIAN=!1,j.LITTLE_ENDIAN=!0,j.prototype._byteLength=0,Object.defineProperty(j.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(j.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(f){this._buffer=f,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(j.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(f){this._byteOffset=f,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(j.prototype,"dataView",{get:function(){return this._dataView},set:function(f){this._byteOffset=f.byteOffset,this._buffer=f.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+f.byteLength}}),j.prototype.seek=function(f){var b=Math.max(0,Math.min(this.byteLength,f));this.position=isNaN(b)||!isFinite(b)?0:b},j.prototype.isEof=function(){return this.position>=this._byteLength},j.prototype.mapUint8Array=function(f){this._realloc(1*f);var b=new Uint8Array(this._buffer,this.byteOffset+this.position,f);return this.position+=1*f,b},j.prototype.readInt32Array=function(f,b){f=f??this.byteLength-this.position/4;var w=new Int32Array(f);return j.memcpy(w.buffer,0,this.buffer,this.byteOffset+this.position,f*w.BYTES_PER_ELEMENT),j.arrayToNative(w,b??this.endianness),this.position+=w.byteLength,w},j.prototype.readInt16Array=function(f,b){f=f??this.byteLength-this.position/2;var w=new Int16Array(f);return j.memcpy(w.buffer,0,this.buffer,this.byteOffset+this.position,f*w.BYTES_PER_ELEMENT),j.arrayToNative(w,b??this.endianness),this.position+=w.byteLength,w},j.prototype.readInt8Array=function(f){f=f??this.byteLength-this.position;var b=new Int8Array(f);return j.memcpy(b.buffer,0,this.buffer,this.byteOffset+this.position,f*b.BYTES_PER_ELEMENT),this.position+=b.byteLength,b},j.prototype.readUint32Array=function(f,b){f=f??this.byteLength-this.position/4;var w=new Uint32Array(f);return j.memcpy(w.buffer,0,this.buffer,this.byteOffset+this.position,f*w.BYTES_PER_ELEMENT),j.arrayToNative(w,b??this.endianness),this.position+=w.byteLength,w},j.prototype.readUint16Array=function(f,b){f=f??this.byteLength-this.position/2;var w=new Uint16Array(f);return j.memcpy(w.buffer,0,this.buffer,this.byteOffset+this.position,f*w.BYTES_PER_ELEMENT),j.arrayToNative(w,b??this.endianness),this.position+=w.byteLength,w},j.prototype.readUint8Array=function(f){f=f??this.byteLength-this.position;var b=new Uint8Array(f);return j.memcpy(b.buffer,0,this.buffer,this.byteOffset+this.position,f*b.BYTES_PER_ELEMENT),this.position+=b.byteLength,b},j.prototype.readFloat64Array=function(f,b){f=f??this.byteLength-this.position/8;var w=new Float64Array(f);return j.memcpy(w.buffer,0,this.buffer,this.byteOffset+this.position,f*w.BYTES_PER_ELEMENT),j.arrayToNative(w,b??this.endianness),this.position+=w.byteLength,w},j.prototype.readFloat32Array=function(f,b){f=f??this.byteLength-this.position/4;var w=new Float32Array(f);return j.memcpy(w.buffer,0,this.buffer,this.byteOffset+this.position,f*w.BYTES_PER_ELEMENT),j.arrayToNative(w,b??this.endianness),this.position+=w.byteLength,w},j.prototype.readInt32=function(f){var b=this._dataView.getInt32(this.position,f??this.endianness);return this.position+=4,b},j.prototype.readInt16=function(f){var b=this._dataView.getInt16(this.position,f??this.endianness);return this.position+=2,b},j.prototype.readInt8=function(){var f=this._dataView.getInt8(this.position);return this.position+=1,f},j.prototype.readUint32=function(f){var b=this._dataView.getUint32(this.position,f??this.endianness);return this.position+=4,b},j.prototype.readUint16=function(f){var b=this._dataView.getUint16(this.position,f??this.endianness);return this.position+=2,b},j.prototype.readUint8=function(){var f=this._dataView.getUint8(this.position);return this.position+=1,f},j.prototype.readFloat32=function(f){var b=this._dataView.getFloat32(this.position,f??this.endianness);return this.position+=4,b},j.prototype.readFloat64=function(f){var b=this._dataView.getFloat64(this.position,f??this.endianness);return this.position+=8,b},j.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,j.memcpy=function(f,b,w,T,R){var H=new Uint8Array(f,b,R),L=new Uint8Array(w,T,R);H.set(L)},j.arrayToNative=function(f,b){return b==this.endianness?f:this.flipArrayEndianness(f)},j.nativeToEndian=function(f,b){return this.endianness==b?f:this.flipArrayEndianness(f)},j.flipArrayEndianness=function(f){for(var b=new Uint8Array(f.buffer,f.byteOffset,f.byteLength),w=0;w<f.byteLength;w+=f.BYTES_PER_ELEMENT)for(var T=w+f.BYTES_PER_ELEMENT-1,R=w;T>R;T--,R++){var H=b[R];b[R]=b[T],b[T]=H}return f},j.prototype.failurePosition=0,String.fromCharCodeUint8=function(f){for(var b=[],w=0;w<f.length;w++)b[w]=f[w];return String.fromCharCode.apply(null,b)},j.prototype.readString=function(f,b){return null==b||"ASCII"==b?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(f??this.byteLength-this.position)]):new TextDecoder(b).decode(this.mapUint8Array(f))},j.prototype.readCString=function(f){var b=this.byteLength-this.position,w=new Uint8Array(this._buffer,this._byteOffset+this.position),T=b;null!=f&&(T=Math.min(f,b));for(var R=0;R<T&&0!==w[R];R++);var H=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(R)]);return null!=f?this.position+=T-R:R!=b&&(this.position+=1),H};var J=Math.pow(2,32);j.prototype.readInt64=function(){return this.readInt32()*J+this.readUint32()},j.prototype.readUint64=function(){return this.readUint32()*J+this.readUint32()},j.prototype.readInt64=function(){return this.readUint32()*J+this.readUint32()},j.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},ye.hb=j,j.prototype.save=function(f){var b=new Blob([this.buffer]);if(!window.URL||!URL.createObjectURL)throw"DataStream.save: Can't create object URL.";var w=window.URL.createObjectURL(b),T=document.createElement("a");document.body.appendChild(T),T.setAttribute("href",w),T.setAttribute("download",f),T.setAttribute("target","_self"),T.click(),window.URL.revokeObjectURL(w)},j.prototype._dynamicSize=!0,Object.defineProperty(j.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(f){f||this._trimAlloc(),this._dynamicSize=f}}),j.prototype.shift=function(f){var b=new ArrayBuffer(this._byteLength-f),w=new Uint8Array(b),T=new Uint8Array(this._buffer,f,w.length);w.set(T),this.buffer=b,this.position-=f},j.prototype.writeInt32Array=function(f,b){if(this._realloc(4*f.length),f instanceof Int32Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapInt32Array(f.length,b);else for(var w=0;w<f.length;w++)this.writeInt32(f[w],b)},j.prototype.writeInt16Array=function(f,b){if(this._realloc(2*f.length),f instanceof Int16Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapInt16Array(f.length,b);else for(var w=0;w<f.length;w++)this.writeInt16(f[w],b)},j.prototype.writeInt8Array=function(f){if(this._realloc(1*f.length),f instanceof Int8Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapInt8Array(f.length);else for(var b=0;b<f.length;b++)this.writeInt8(f[b])},j.prototype.writeUint32Array=function(f,b){if(this._realloc(4*f.length),f instanceof Uint32Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapUint32Array(f.length,b);else for(var w=0;w<f.length;w++)this.writeUint32(f[w],b)},j.prototype.writeUint16Array=function(f,b){if(this._realloc(2*f.length),f instanceof Uint16Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapUint16Array(f.length,b);else for(var w=0;w<f.length;w++)this.writeUint16(f[w],b)},j.prototype.writeUint8Array=function(f){if(this._realloc(1*f.length),f instanceof Uint8Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapUint8Array(f.length);else for(var b=0;b<f.length;b++)this.writeUint8(f[b])},j.prototype.writeFloat64Array=function(f,b){if(this._realloc(8*f.length),f instanceof Float64Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapFloat64Array(f.length,b);else for(var w=0;w<f.length;w++)this.writeFloat64(f[w],b)},j.prototype.writeFloat32Array=function(f,b){if(this._realloc(4*f.length),f instanceof Float32Array&&this.byteOffset+this.position%f.BYTES_PER_ELEMENT===0)j.memcpy(this._buffer,this.byteOffset+this.position,f.buffer,0,f.byteLength),this.mapFloat32Array(f.length,b);else for(var w=0;w<f.length;w++)this.writeFloat32(f[w],b)},j.prototype.writeInt32=function(f,b){this._realloc(4),this._dataView.setInt32(this.position,f,b??this.endianness),this.position+=4},j.prototype.writeInt16=function(f,b){this._realloc(2),this._dataView.setInt16(this.position,f,b??this.endianness),this.position+=2},j.prototype.writeInt8=function(f){this._realloc(1),this._dataView.setInt8(this.position,f),this.position+=1},j.prototype.writeUint32=function(f,b){this._realloc(4),this._dataView.setUint32(this.position,f,b??this.endianness),this.position+=4},j.prototype.writeUint16=function(f,b){this._realloc(2),this._dataView.setUint16(this.position,f,b??this.endianness),this.position+=2},j.prototype.writeUint8=function(f){this._realloc(1),this._dataView.setUint8(this.position,f),this.position+=1},j.prototype.writeFloat32=function(f,b){this._realloc(4),this._dataView.setFloat32(this.position,f,b??this.endianness),this.position+=4},j.prototype.writeFloat64=function(f,b){this._realloc(8),this._dataView.setFloat64(this.position,f,b??this.endianness),this.position+=8},j.prototype.writeUCS2String=function(f,b,w){null==w&&(w=f.length);for(var T=0;T<f.length&&T<w;T++)this.writeUint16(f.charCodeAt(T),b);for(;T<w;T++)this.writeUint16(0)},j.prototype.writeString=function(f,b,w){var T=0;if(null==b||"ASCII"==b)if(null!=w){var R=Math.min(f.length,w);for(T=0;T<R;T++)this.writeUint8(f.charCodeAt(T));for(;T<w;T++)this.writeUint8(0)}else for(T=0;T<f.length;T++)this.writeUint8(f.charCodeAt(T));else this.writeUint8Array(new TextEncoder(b).encode(f.substring(0,w)))},j.prototype.writeCString=function(f,b){var w=0;if(null!=b){var T=Math.min(f.length,b);for(w=0;w<T;w++)this.writeUint8(f.charCodeAt(w));for(;w<b;w++)this.writeUint8(0)}else{for(w=0;w<f.length;w++)this.writeUint8(f.charCodeAt(w));this.writeUint8(0)}},j.prototype.writeStruct=function(f,b){for(var w=0;w<f.length;w+=2)this.writeType(f[w+1],b[f[w]],b)},j.prototype.writeType=function(f,b,w){var T;if("function"==typeof f)return f(this,b);if("object"==typeof f&&!(f instanceof Array))return f.set(this,b,w);var R=null,H="ASCII",L=this.position;switch("string"==typeof f&&/:/.test(f)&&(T=f.split(":"),f=T[0],R=parseInt(T[1])),"string"==typeof f&&/,/.test(f)&&(T=f.split(","),f=T[0],H=parseInt(T[1])),f){case"uint8":this.writeUint8(b);break;case"int8":this.writeInt8(b);break;case"uint16":this.writeUint16(b,this.endianness);break;case"int16":this.writeInt16(b,this.endianness);break;case"uint32":this.writeUint32(b,this.endianness);break;case"int32":this.writeInt32(b,this.endianness);break;case"float32":this.writeFloat32(b,this.endianness);break;case"float64":this.writeFloat64(b,this.endianness);break;case"uint16be":this.writeUint16(b,j.BIG_ENDIAN);break;case"int16be":this.writeInt16(b,j.BIG_ENDIAN);break;case"uint32be":this.writeUint32(b,j.BIG_ENDIAN);break;case"int32be":this.writeInt32(b,j.BIG_ENDIAN);break;case"float32be":this.writeFloat32(b,j.BIG_ENDIAN);break;case"float64be":this.writeFloat64(b,j.BIG_ENDIAN);break;case"uint16le":this.writeUint16(b,j.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(b,j.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(b,j.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(b,j.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(b,j.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(b,j.LITTLE_ENDIAN);break;case"cstring":this.writeCString(b,R);break;case"string":this.writeString(b,H,R);break;case"u16string":this.writeUCS2String(b,this.endianness,R);break;case"u16stringle":this.writeUCS2String(b,j.LITTLE_ENDIAN,R);break;case"u16stringbe":this.writeUCS2String(b,j.BIG_ENDIAN,R);break;default:if(3==f.length){for(var oe=f[1],ve=0;ve<b.length;ve++)this.writeType(oe,b[ve]);break}this.writeStruct(f,b)}null!=R&&(this.position=L,this._realloc(R),this.position=L+R)},j.prototype.writeUint64=function(f){var b=Math.floor(f/J);this.writeUint32(b),this.writeUint32(4294967295&f)},j.prototype.writeUint24=function(f){this.writeUint8((16711680&f)>>16),this.writeUint8((65280&f)>>8),this.writeUint8(255&f)},j.prototype.adjustUint32=function(f,b){var w=this.position;this.seek(f),this.writeUint32(b),this.seek(w)},j.prototype.mapInt32Array=function(f,b){this._realloc(4*f);var w=new Int32Array(this._buffer,this.byteOffset+this.position,f);return j.arrayToNative(w,b??this.endianness),this.position+=4*f,w},j.prototype.mapInt16Array=function(f,b){this._realloc(2*f);var w=new Int16Array(this._buffer,this.byteOffset+this.position,f);return j.arrayToNative(w,b??this.endianness),this.position+=2*f,w},j.prototype.mapInt8Array=function(f){this._realloc(1*f);var b=new Int8Array(this._buffer,this.byteOffset+this.position,f);return this.position+=1*f,b},j.prototype.mapUint32Array=function(f,b){this._realloc(4*f);var w=new Uint32Array(this._buffer,this.byteOffset+this.position,f);return j.arrayToNative(w,b??this.endianness),this.position+=4*f,w},j.prototype.mapUint16Array=function(f,b){this._realloc(2*f);var w=new Uint16Array(this._buffer,this.byteOffset+this.position,f);return j.arrayToNative(w,b??this.endianness),this.position+=2*f,w},j.prototype.mapFloat64Array=function(f,b){this._realloc(8*f);var w=new Float64Array(this._buffer,this.byteOffset+this.position,f);return j.arrayToNative(w,b??this.endianness),this.position+=8*f,w},j.prototype.mapFloat32Array=function(f,b){this._realloc(4*f);var w=new Float32Array(this._buffer,this.byteOffset+this.position,f);return j.arrayToNative(w,b??this.endianness),this.position+=4*f,w};var K=function(f){this.buffers=[],this.bufferIndex=-1,f&&(this.insertBuffer(f),this.bufferIndex=0)};(K.prototype=new j(new ArrayBuffer,0,j.BIG_ENDIAN)).initialized=function(){var f;return this.bufferIndex>-1||(this.buffers.length>0?0===(f=this.buffers[0]).fileStart?(this.buffer=f,this.bufferIndex=0,ie.debug("MultiBufferStream","Stream ready for parsing"),!0):(ie.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1):(ie.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1))},ArrayBuffer.concat=function(f,b){ie.debug("ArrayBuffer","Trying to create a new buffer of size: "+(f.byteLength+b.byteLength));var w=new Uint8Array(f.byteLength+b.byteLength);return w.set(new Uint8Array(f),0),w.set(new Uint8Array(b),f.byteLength),w.buffer},K.prototype.reduceBuffer=function(f,b,w){var T;return(T=new Uint8Array(w)).set(new Uint8Array(f,b,w)),T.buffer.fileStart=f.fileStart+b,T.buffer.usedBytes=0,T.buffer},K.prototype.insertBuffer=function(f){for(var b=!0,w=0;w<this.buffers.length;w++){var T=this.buffers[w];if(f.fileStart<=T.fileStart){if(f.fileStart===T.fileStart){if(f.byteLength>T.byteLength){this.buffers.splice(w,1),w--;continue}ie.warn("MultiBufferStream","Buffer (fileStart: "+f.fileStart+" - Length: "+f.byteLength+") already appended, ignoring")}else f.fileStart+f.byteLength<=T.fileStart||(f=this.reduceBuffer(f,0,T.fileStart-f.fileStart)),ie.debug("MultiBufferStream","Appending new buffer (fileStart: "+f.fileStart+" - Length: "+f.byteLength+")"),this.buffers.splice(w,0,f),0===w&&(this.buffer=f);b=!1;break}if(f.fileStart<T.fileStart+T.byteLength){var R=T.fileStart+T.byteLength-f.fileStart,H=f.byteLength-R;if(!(H>0)){b=!1;break}f=this.reduceBuffer(f,R,H)}}b&&(ie.debug("MultiBufferStream","Appending new buffer (fileStart: "+f.fileStart+" - Length: "+f.byteLength+")"),this.buffers.push(f),0===w&&(this.buffer=f))},K.prototype.logBufferLevel=function(f){var b,w,T,R,L,H=[],oe="";for(T=0,R=0,b=0;b<this.buffers.length;b++)w=this.buffers[b],0===b?(H.push(L={}),L.start=w.fileStart,L.end=w.fileStart+w.byteLength,oe+="["+L.start+"-"):L.end===w.fileStart?L.end=w.fileStart+w.byteLength:((L={}).start=w.fileStart,oe+=H[H.length-1].end-1+"], ["+L.start+"-",L.end=w.fileStart+w.byteLength,H.push(L)),T+=w.usedBytes,R+=w.byteLength;H.length>0&&(oe+=L.end-1+"]"),(f?ie.info:ie.debug)("MultiBufferStream",0===this.buffers.length?"No more buffer in memory":this.buffers.length+" stored buffer(s) ("+T+"/"+R+" bytes), continuous ranges: "+oe)},K.prototype.cleanBuffers=function(){var f,b;for(f=0;f<this.buffers.length;f++)(b=this.buffers[f]).usedBytes===b.byteLength&&(ie.debug("MultiBufferStream","Removing buffer #"+f),this.buffers.splice(f,1),f--)},K.prototype.mergeNextBuffer=function(){var f;if(this.bufferIndex+1<this.buffers.length){if((f=this.buffers[this.bufferIndex+1]).fileStart===this.buffer.fileStart+this.buffer.byteLength){var b=this.buffer.byteLength,w=this.buffer.usedBytes,T=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,f),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=w,this.buffer.fileStart=T,ie.debug("ISOFile","Concatenating buffer for box parsing (length: "+b+"->"+this.buffer.byteLength+")"),!0}return!1}return!1},K.prototype.findPosition=function(f,b,w){var T,R=null,H=-1;for(T=!0===f?0:this.bufferIndex;T<this.buffers.length&&(R=this.buffers[T]).fileStart<=b;)H=T,w&&(R.usedBytes=R.fileStart+R.byteLength<=b?R.byteLength:b-R.fileStart,this.logBufferLevel()),T++;return-1!==H&&(R=this.buffers[H]).fileStart+R.byteLength>=b?(ie.debug("MultiBufferStream","Found position in existing buffer #"+H),H):-1},K.prototype.findEndContiguousBuf=function(f){var b,w,T,R=void 0!==f?f:this.bufferIndex;if(w=this.buffers[R],this.buffers.length>R+1)for(b=R+1;b<this.buffers.length&&(T=this.buffers[b]).fileStart===w.fileStart+w.byteLength;b++)w=T;return w.fileStart+w.byteLength},K.prototype.getEndFilePositionAfter=function(f){var b=this.findPosition(!0,f,!1);return-1!==b?this.findEndContiguousBuf(b):f},K.prototype.addUsedBytes=function(f){this.buffer.usedBytes+=f,this.logBufferLevel()},K.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},K.prototype.seek=function(f,b,w){var T;return-1!==(T=this.findPosition(b,f,w))?(this.buffer=this.buffers[T],this.bufferIndex=T,this.position=f-this.buffer.fileStart,ie.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(ie.debug("MultiBufferStream","Position "+f+" not found in buffered data"),!1)},K.prototype.getPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},K.prototype.getLength=function(){return this.byteLength},K.prototype.getEndPosition=function(){if(-1===this.bufferIndex||null===this.buffers[this.bufferIndex])throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength};var xe=function(){var R=[];R[3]="ES_Descriptor",R[4]="DecoderConfigDescriptor",R[5]="DecoderSpecificInfo",R[6]="SLConfigDescriptor",this.getDescriptorName=function(oe){return R[oe]};var H=this,L={};return this.parseOneDescriptor=function(oe){var de,ke,ae,we=0;for(de=oe.readUint8(),ae=oe.readUint8();128&ae;)we=(127&ae)<<7,ae=oe.readUint8();return ie.debug("MPEG4DescriptorParser","Found "+(R[de]||"Descriptor "+de)+", size "+(we+=127&ae)+" at position "+oe.getPosition()),(ke=R[de]?new L[R[de]](we):new L.Descriptor(we)).parse(oe),ke},L.Descriptor=function(oe,ve){this.tag=oe,this.size=ve,this.descs=[]},L.Descriptor.prototype.parse=function(oe){this.data=oe.readUint8Array(this.size)},L.Descriptor.prototype.findDescriptor=function(oe){for(var ve=0;ve<this.descs.length;ve++)if(this.descs[ve].tag==oe)return this.descs[ve];return null},L.Descriptor.prototype.parseRemainingDescriptors=function(oe){for(var ve=oe.position;oe.position<ve+this.size;){var we=H.parseOneDescriptor(oe);this.descs.push(we)}},L.ES_Descriptor=function(oe){L.Descriptor.call(this,3,oe)},L.ES_Descriptor.prototype=new L.Descriptor,L.ES_Descriptor.prototype.parse=function(oe){if(this.ES_ID=oe.readUint16(),this.flags=oe.readUint8(),this.size-=3,128&this.flags?(this.dependsOn_ES_ID=oe.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,64&this.flags){var ve=oe.readUint8();this.URL=oe.readString(ve),this.size-=ve+1}else this.URL="";32&this.flags?(this.OCR_ES_ID=oe.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(oe)},L.ES_Descriptor.prototype.getOTI=function(oe){var ve=this.findDescriptor(4);return ve?ve.oti:0},L.ES_Descriptor.prototype.getAudioConfig=function(oe){var ve=this.findDescriptor(4);if(!ve)return null;var we=ve.findDescriptor(5);if(we&&we.data){var de=(248&we.data[0])>>3;return 31===de&&we.data.length>=2&&(de=32+((7&we.data[0])<<3)+((224&we.data[1])>>5)),de}return null},L.DecoderConfigDescriptor=function(oe){L.Descriptor.call(this,4,oe)},L.DecoderConfigDescriptor.prototype=new L.Descriptor,L.DecoderConfigDescriptor.prototype.parse=function(oe){this.oti=oe.readUint8(),this.streamType=oe.readUint8(),this.bufferSize=oe.readUint24(),this.maxBitrate=oe.readUint32(),this.avgBitrate=oe.readUint32(),this.size-=13,this.parseRemainingDescriptors(oe)},L.DecoderSpecificInfo=function(oe){L.Descriptor.call(this,5,oe)},L.DecoderSpecificInfo.prototype=new L.Descriptor,L.SLConfigDescriptor=function(oe){L.Descriptor.call(this,6,oe)},L.SLConfigDescriptor.prototype=new L.Descriptor,this},E={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:["mdat","idat","free","skip","meco","strk"],FULL_BOXES:["hmhd","nmhd","iods","xml ","bxml","ipro","mere"],CONTAINER_BOXES:[["moov",["trak","pssh"]],["trak"],["edts"],["mdia"],["minf"],["dinf"],["stbl",["sgpd","sbgp"]],["mvex",["trex"]],["moof",["traf"]],["traf",["trun","sgpd","sbgp"]],["vttc"],["tref"],["iref"],["mfra",["tfra"]],["meco"],["hnti"],["hinf"],["strk"],["strd"],["sinf"],["rinf"],["schi"],["trgr"],["udta",["kind"]],["iprp",["ipma"]],["ipco"]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){E.FullBox.prototype=new E.Box,E.ContainerBox.prototype=new E.Box,E.SampleEntry.prototype=new E.Box,E.TrackGroupTypeBox.prototype=new E.FullBox,E.BASIC_BOXES.forEach(function(f){E.createBoxCtor(f)}),E.FULL_BOXES.forEach(function(f){E.createFullBoxCtor(f)}),E.CONTAINER_BOXES.forEach(function(f){E.createContainerBoxCtor(f[0],null,f[1])})},Box:function(f,b,w){this.type=f,this.size=b,this.uuid=w},FullBox:function(f,b,w){E.Box.call(this,f,b,w),this.flags=0,this.version=0},ContainerBox:function(f,b,w){E.Box.call(this,f,b,w),this.boxes=[]},SampleEntry:function(f,b,w,T){E.ContainerBox.call(this,f,b),this.hdr_size=w,this.start=T},SampleGroupEntry:function(f){this.grouping_type=f},TrackGroupTypeBox:function(f,b){E.FullBox.call(this,f,b)},createBoxCtor:function(f,b){E.boxCodes.push(f),E[f+"Box"]=function(w){E.Box.call(this,f,w)},E[f+"Box"].prototype=new E.Box,b&&(E[f+"Box"].prototype.parse=b)},createFullBoxCtor:function(f,b){E[f+"Box"]=function(w){E.FullBox.call(this,f,w)},E[f+"Box"].prototype=new E.FullBox,E[f+"Box"].prototype.parse=function(w){this.parseFullHeader(w),b&&b.call(this,w)}},addSubBoxArrays:function(f){if(f){this.subBoxNames=f;for(var b=f.length,w=0;w<b;w++)this[f[w]+"s"]=[]}},createContainerBoxCtor:function(f,b,w){E[f+"Box"]=function(T){E.ContainerBox.call(this,f,T),E.addSubBoxArrays.call(this,w)},E[f+"Box"].prototype=new E.ContainerBox,b&&(E[f+"Box"].prototype.parse=b)},createMediaSampleEntryCtor:function(f,b,w){E.sampleEntryCodes[f]=[],E[f+"SampleEntry"]=function(T,R){E.SampleEntry.call(this,T,R),E.addSubBoxArrays.call(this,w)},E[f+"SampleEntry"].prototype=new E.SampleEntry,b&&(E[f+"SampleEntry"].prototype.parse=b)},createSampleEntryCtor:function(f,b,w,T){E.sampleEntryCodes[f].push(b),E[b+"SampleEntry"]=function(R){E[f+"SampleEntry"].call(this,b,R),E.addSubBoxArrays.call(this,T)},E[b+"SampleEntry"].prototype=new E[f+"SampleEntry"],w&&(E[b+"SampleEntry"].prototype.parse=w)},createEncryptedSampleEntryCtor:function(f,b,w){E.createSampleEntryCtor.call(this,f,b,w,["sinf"])},createSampleGroupCtor:function(f,b){E[f+"SampleGroupEntry"]=function(w){E.SampleGroupEntry.call(this,f,w)},E[f+"SampleGroupEntry"].prototype=new E.SampleGroupEntry,b&&(E[f+"SampleGroupEntry"].prototype.parse=b)},createTrackGroupCtor:function(f,b){E[f+"TrackGroupTypeBox"]=function(w){E.TrackGroupTypeBox.call(this,f,w)},E[f+"TrackGroupTypeBox"].prototype=new E.TrackGroupTypeBox,b&&(E[f+"TrackGroupTypeBox"].prototype.parse=b)},createUUIDBox:function(f,b,w,T){E.UUIDs.push(f),E.UUIDBoxes[f]=function(R){b?E.FullBox.call(this,"uuid",R,f):w?E.ContainerBox.call(this,"uuid",R,f):E.Box.call(this,"uuid",R,f)},E.UUIDBoxes[f].prototype=b?new E.FullBox:w?new E.ContainerBox:new E.Box,T&&(E.UUIDBoxes[f].prototype.parse=b?function(R){this.parseFullHeader(R),T&&T.call(this,R)}:T)}};E.initialize(),E.TKHD_FLAG_ENABLED=1,E.TKHD_FLAG_IN_MOVIE=2,E.TKHD_FLAG_IN_PREVIEW=4,E.TFHD_FLAG_BASE_DATA_OFFSET=1,E.TFHD_FLAG_SAMPLE_DESC=2,E.TFHD_FLAG_SAMPLE_DUR=8,E.TFHD_FLAG_SAMPLE_SIZE=16,E.TFHD_FLAG_SAMPLE_FLAGS=32,E.TFHD_FLAG_DUR_EMPTY=65536,E.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,E.TRUN_FLAGS_DATA_OFFSET=1,E.TRUN_FLAGS_FIRST_FLAG=4,E.TRUN_FLAGS_DURATION=256,E.TRUN_FLAGS_SIZE=512,E.TRUN_FLAGS_FLAGS=1024,E.TRUN_FLAGS_CTS_OFFSET=2048,E.Box.prototype.add=function(f){return this.addBox(new E[f+"Box"])},E.Box.prototype.addBox=function(f){return this.boxes.push(f),this[f.type+"s"]?this[f.type+"s"].push(f):this[f.type]=f,f},E.Box.prototype.set=function(f,b){return this[f]=b,this},E.Box.prototype.addEntry=function(f,b){var w=b||"entries";return this[w]||(this[w]=[]),this[w].push(f),this},E.parseUUID=function(f){return E.parseHex16(f)},E.parseHex16=function(f){for(var b="",w=0;w<16;w++){var T=f.readUint8().toString(16);b+=1===T.length?"0"+T:T}return b},E.parseOneBox=function(f,b,w){var T,L,oe,R=f.getPosition(),H=0;if(f.getEndPosition()-R<8)return ie.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:E.ERR_NOT_ENOUGH_DATA};if(w&&w<8)return ie.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:E.ERR_NOT_ENOUGH_DATA};var ve=f.readUint32(),we=f.readString(4),de=we;if(ie.debug("BoxParser","Found box of type '"+we+"' and size "+ve+" at position "+R),H=8,"uuid"==we){if(f.getEndPosition()-f.getPosition()<16||w-H<16)return f.seek(R),ie.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:E.ERR_NOT_ENOUGH_DATA};H+=16,de=oe=E.parseUUID(f)}if(1==ve){if(f.getEndPosition()-f.getPosition()<8||w&&w-H<8)return f.seek(R),ie.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+we+'" box'),{code:E.ERR_NOT_ENOUGH_DATA};ve=f.readUint64(),H+=8}else if(0===ve)if(w)ve=w;else if("mdat"!==we)return ie.error("BoxParser","Unlimited box size not supported for type: '"+we+"'"),T=new E.Box(we,ve),{code:E.OK,box:T,size:T.size};return 0!==ve&&ve<H?(ie.error("BoxParser","Box of type "+we+" has an invalid size "+ve+" (too small to be a box)"),{code:E.ERR_NOT_ENOUGH_DATA,type:we,size:ve,hdr_size:H,start:R}):0!==ve&&w&&ve>w?(ie.error("BoxParser","Box of type '"+we+"' has a size "+ve+" greater than its container size "+w),{code:E.ERR_NOT_ENOUGH_DATA,type:we,size:ve,hdr_size:H,start:R}):0!==ve&&R+ve>f.getEndPosition()?(f.seek(R),ie.info("BoxParser","Not enough data in stream to parse the entire '"+we+"' box"),{code:E.ERR_NOT_ENOUGH_DATA,type:we,size:ve,hdr_size:H,start:R}):b?{code:E.OK,type:we,size:ve,hdr_size:H,start:R}:(E[we+"Box"]?T=new E[we+"Box"](ve):"uuid"!==we?(ie.warn("BoxParser","Unknown box type: '"+we+"'"),(T=new E.Box(we,ve)).has_unparsed_data=!0):E.UUIDBoxes[oe]?T=new E.UUIDBoxes[oe](ve):(ie.warn("BoxParser","Unknown uuid type: '"+oe+"'"),(T=new E.Box(we,ve)).uuid=oe,T.has_unparsed_data=!0),T.hdr_size=H,T.start=R,T.write===E.Box.prototype.write&&"mdat"!==T.type&&(ie.info("BoxParser","'"+de+"' box writing not yet implemented, keeping unparsed data in memory for later write"),T.parseDataAndRewind(f)),T.parse(f),(L=f.getPosition()-(T.start+T.size))<0?(ie.warn("BoxParser","Parsing of box '"+de+"' did not read the entire indicated box data size (missing "+-L+" bytes), seeking forward"),f.seek(T.start+T.size)):L>0&&(ie.error("BoxParser","Parsing of box '"+de+"' read "+L+" more bytes than the indicated box data size, seeking backwards"),0!==T.size&&f.seek(T.start+T.size)),{code:E.OK,box:T,size:T.size})},E.Box.prototype.parse=function(f){"mdat"!=this.type?this.data=f.readUint8Array(this.size-this.hdr_size):f.seek(0===this.size?f.getEndPosition():this.start+this.size)},E.Box.prototype.parseDataAndRewind=function(f){this.data=f.readUint8Array(this.size-this.hdr_size),f.position-=this.size-this.hdr_size},E.FullBox.prototype.parseDataAndRewind=function(f){this.parseFullHeader(f),this.data=f.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,f.position-=this.size-this.hdr_size},E.FullBox.prototype.parseFullHeader=function(f){this.version=f.readUint8(),this.flags=f.readUint24(),this.hdr_size+=4},E.FullBox.prototype.parse=function(f){this.parseFullHeader(f),this.data=f.readUint8Array(this.size-this.hdr_size)},E.ContainerBox.prototype.parse=function(f){for(var b,w;f.getPosition()<this.start+this.size;){if((b=E.parseOneBox(f,!1,this.size-(f.getPosition()-this.start))).code!==E.OK)return;if(this.boxes.push(w=b.box),this.subBoxNames&&-1!=this.subBoxNames.indexOf(w.type))this[this.subBoxNames[this.subBoxNames.indexOf(w.type)]+"s"].push(w);else{var T="uuid"!==w.type?w.type:w.uuid;this[T]?ie.warn("Box of type "+T+" already stored in field of this type"):this[T]=w}}},E.Box.prototype.parseLanguage=function(f){this.language=f.readUint16();var b=[];b[0]=this.language>>10&31,b[1]=this.language>>5&31,b[2]=31&this.language,this.languageString=String.fromCharCode(b[0]+96,b[1]+96,b[2]+96)},E.SAMPLE_ENTRY_TYPE_VISUAL="Visual",E.SAMPLE_ENTRY_TYPE_AUDIO="Audio",E.SAMPLE_ENTRY_TYPE_HINT="Hint",E.SAMPLE_ENTRY_TYPE_METADATA="Metadata",E.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",E.SAMPLE_ENTRY_TYPE_SYSTEM="System",E.SAMPLE_ENTRY_TYPE_TEXT="Text",E.SampleEntry.prototype.parseHeader=function(f){f.readUint8Array(6),this.data_reference_index=f.readUint16(),this.hdr_size+=8},E.SampleEntry.prototype.parse=function(f){this.parseHeader(f),this.data=f.readUint8Array(this.size-this.hdr_size)},E.SampleEntry.prototype.parseDataAndRewind=function(f){this.parseHeader(f),this.data=f.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,f.position-=this.size-this.hdr_size},E.SampleEntry.prototype.parseFooter=function(f){E.ContainerBox.prototype.parse.call(this,f)},E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_HINT),E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_METADATA),E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SUBTITLE),E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SYSTEM),E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_TEXT),E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,function(f){var b;this.parseHeader(f),f.readUint16(),f.readUint16(),f.readUint32Array(3),this.width=f.readUint16(),this.height=f.readUint16(),this.horizresolution=f.readUint32(),this.vertresolution=f.readUint32(),f.readUint32(),this.frame_count=f.readUint16(),b=Math.min(31,f.readUint8()),this.compressorname=f.readString(b),b<31&&f.readString(31-b),this.depth=f.readUint16(),f.readUint16(),this.parseFooter(f)}),E.createMediaSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_AUDIO,function(f){this.parseHeader(f),f.readUint32Array(2),this.channel_count=f.readUint16(),this.samplesize=f.readUint16(),f.readUint16(),f.readUint16(),this.samplerate=f.readUint32()/65536,this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),E.createEncryptedSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),E.createEncryptedSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),E.createEncryptedSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),E.createEncryptedSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),E.createEncryptedSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_TEXT,"enct"),E.createEncryptedSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_METADATA,"encm"),E.createBoxCtor("a1lx",function(f){var w=16*(1+(1&f.readUint8()));this.layer_size=[];for(var T=0;T<3;T++)this.layer_size[T]=16==w?f.readUint16():f.readUint32()}),E.createBoxCtor("a1op",function(f){this.op_index=f.readUint8()}),E.createFullBoxCtor("auxC",function(f){this.aux_type=f.readCString(),this.aux_subtype=f.readUint8Array(this.size-this.hdr_size-(this.aux_type.length+1))}),E.createBoxCtor("av1C",function(f){var T=f.readUint8();if(T>>7&!1)ie.error("av1C marker problem");else if(this.version=127&T,1===this.version)if(T=f.readUint8(),this.seq_profile=T>>5&7,this.seq_level_idx_0=31&T,T=f.readUint8(),this.seq_tier_0=T>>7&1,this.high_bitdepth=T>>6&1,this.twelve_bit=T>>5&1,this.monochrome=T>>4&1,this.chroma_subsampling_x=T>>3&1,this.chroma_subsampling_y=T>>2&1,this.chroma_sample_position=3&T,T=f.readUint8(),this.reserved_1=T>>5&7,0===this.reserved_1){if(this.initial_presentation_delay_present=T>>4&1,1===this.initial_presentation_delay_present)this.initial_presentation_delay_minus_one=15&T;else if(this.reserved_2=15&T,0!==this.reserved_2)return void ie.error("av1C reserved_2 parsing problem");this.configOBUs=f.readUint8Array(this.size-this.hdr_size-4)}else ie.error("av1C reserved_1 parsing problem");else ie.error("av1C version "+this.version+" not supported")}),E.createBoxCtor("avcC",function(f){var b,w;for(this.configurationVersion=f.readUint8(),this.AVCProfileIndication=f.readUint8(),this.profile_compatibility=f.readUint8(),this.AVCLevelIndication=f.readUint8(),this.lengthSizeMinusOne=3&f.readUint8(),this.nb_SPS_nalus=31&f.readUint8(),w=this.size-this.hdr_size-6,this.SPS=[],b=0;b<this.nb_SPS_nalus;b++)this.SPS[b]={},this.SPS[b].length=f.readUint16(),this.SPS[b].nalu=f.readUint8Array(this.SPS[b].length),w-=2+this.SPS[b].length;for(this.nb_PPS_nalus=f.readUint8(),w--,this.PPS=[],b=0;b<this.nb_PPS_nalus;b++)this.PPS[b]={},this.PPS[b].length=f.readUint16(),this.PPS[b].nalu=f.readUint8Array(this.PPS[b].length),w-=2+this.PPS[b].length;w>0&&(this.ext=f.readUint8Array(w))}),E.createBoxCtor("btrt",function(f){this.bufferSizeDB=f.readUint32(),this.maxBitrate=f.readUint32(),this.avgBitrate=f.readUint32()}),E.createBoxCtor("clap",function(f){this.cleanApertureWidthN=f.readUint32(),this.cleanApertureWidthD=f.readUint32(),this.cleanApertureHeightN=f.readUint32(),this.cleanApertureHeightD=f.readUint32(),this.horizOffN=f.readUint32(),this.horizOffD=f.readUint32(),this.vertOffN=f.readUint32(),this.vertOffD=f.readUint32()}),E.createBoxCtor("clli",function(f){this.max_content_light_level=f.readUint16(),this.max_pic_average_light_level=f.readUint16()}),E.createFullBoxCtor("co64",function(f){var b,w;if(b=f.readUint32(),this.chunk_offsets=[],0===this.version)for(w=0;w<b;w++)this.chunk_offsets.push(f.readUint64())}),E.createFullBoxCtor("CoLL",function(f){this.maxCLL=f.readUint16(),this.maxFALL=f.readUint16()}),E.createBoxCtor("colr",function(f){if(this.colour_type=f.readString(4),"nclx"===this.colour_type){this.colour_primaries=f.readUint16(),this.transfer_characteristics=f.readUint16(),this.matrix_coefficients=f.readUint16();var b=f.readUint8();this.full_range_flag=b>>7}else("rICC"===this.colour_type||"prof"===this.colour_type)&&(this.ICC_profile=f.readUint8Array(this.size-4))}),E.createFullBoxCtor("cprt",function(f){this.parseLanguage(f),this.notice=f.readCString()}),E.createFullBoxCtor("cslg",function(f){0===this.version&&(this.compositionToDTSShift=f.readInt32(),this.leastDecodeToDisplayDelta=f.readInt32(),this.greatestDecodeToDisplayDelta=f.readInt32(),this.compositionStartTime=f.readInt32(),this.compositionEndTime=f.readInt32())}),E.createFullBoxCtor("ctts",function(f){var b,w;if(b=f.readUint32(),this.sample_counts=[],this.sample_offsets=[],0===this.version)for(w=0;w<b;w++){this.sample_counts.push(f.readUint32());var T=f.readInt32();T<0&&ie.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(T)}else if(1==this.version)for(w=0;w<b;w++)this.sample_counts.push(f.readUint32()),this.sample_offsets.push(f.readInt32())}),E.createBoxCtor("dac3",function(f){var b=f.readUint8(),w=f.readUint8(),T=f.readUint8();this.fscod=b>>6,this.bsid=b>>1&31,this.bsmod=(1&b)<<2|w>>6&3,this.acmod=w>>3&7,this.lfeon=w>>2&1,this.bit_rate_code=3&w|T>>5&7}),E.createBoxCtor("dec3",function(f){var b=f.readUint16();this.data_rate=b>>3,this.num_ind_sub=7&b,this.ind_subs=[];for(var w=0;w<this.num_ind_sub+1;w++){var T={};this.ind_subs.push(T);var R=f.readUint8(),H=f.readUint8(),L=f.readUint8();T.fscod=R>>6,T.bsid=R>>1&31,T.bsmod=(1&R)<<4|H>>4&15,T.acmod=H>>1&7,T.lfeon=1&H,T.num_dep_sub=L>>1&15,T.num_dep_sub>0&&(T.chan_loc=(1&L)<<8|f.readUint8())}}),E.createFullBoxCtor("dfLa",function(f){var T=[],R=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];for(this.parseFullHeader(f);;){var H=f.readUint8(),L=Math.min(127&H,R.length-1);if(L?f.readUint8Array(f.readUint24()):(f.readUint8Array(13),this.samplerate=f.readUint32()>>12,f.readUint8Array(20)),T.push(R[L]),128&H)break}this.numMetadataBlocks=T.length+" ("+T.join(", ")+")"}),E.createBoxCtor("dimm",function(f){this.bytessent=f.readUint64()}),E.createBoxCtor("dmax",function(f){this.time=f.readUint32()}),E.createBoxCtor("dmed",function(f){this.bytessent=f.readUint64()}),E.createBoxCtor("dOps",function(f){if(this.Version=f.readUint8(),this.OutputChannelCount=f.readUint8(),this.PreSkip=f.readUint16(),this.InputSampleRate=f.readUint32(),this.OutputGain=f.readInt16(),this.ChannelMappingFamily=f.readUint8(),0!==this.ChannelMappingFamily){this.StreamCount=f.readUint8(),this.CoupledCount=f.readUint8(),this.ChannelMapping=[];for(var b=0;b<this.OutputChannelCount;b++)this.ChannelMapping[b]=f.readUint8()}}),E.createFullBoxCtor("dref",function(f){var b;this.entries=[];for(var T=f.readUint32(),R=0;R<T;R++){if((b=E.parseOneBox(f,!1,this.size-(f.getPosition()-this.start))).code!==E.OK)return;this.entries.push(b.box)}}),E.createBoxCtor("drep",function(f){this.bytessent=f.readUint64()}),E.createFullBoxCtor("elng",function(f){this.extended_language=f.readString(this.size-this.hdr_size)}),E.createFullBoxCtor("elst",function(f){this.entries=[];for(var b=f.readUint32(),w=0;w<b;w++){var T={};this.entries.push(T),1===this.version?(T.segment_duration=f.readUint64(),T.media_time=f.readInt64()):(T.segment_duration=f.readUint32(),T.media_time=f.readInt32()),T.media_rate_integer=f.readInt16(),T.media_rate_fraction=f.readInt16()}}),E.createFullBoxCtor("emsg",function(f){1==this.version?(this.timescale=f.readUint32(),this.presentation_time=f.readUint64(),this.event_duration=f.readUint32(),this.id=f.readUint32(),this.scheme_id_uri=f.readCString(),this.value=f.readCString()):(this.scheme_id_uri=f.readCString(),this.value=f.readCString(),this.timescale=f.readUint32(),this.presentation_time_delta=f.readUint32(),this.event_duration=f.readUint32(),this.id=f.readUint32());var b=this.size-this.hdr_size-(16+(this.scheme_id_uri.length+1)+(this.value.length+1));1==this.version&&(b-=4),this.message_data=f.readUint8Array(b)}),E.createFullBoxCtor("esds",function(f){var b=f.readUint8Array(this.size-this.hdr_size),w=new xe;this.esd=w.parseOneDescriptor(new j(b.buffer,0,j.BIG_ENDIAN))}),E.createBoxCtor("fiel",function(f){this.fieldCount=f.readUint8(),this.fieldOrdering=f.readUint8()}),E.createBoxCtor("frma",function(f){this.data_format=f.readString(4)}),E.createBoxCtor("ftyp",function(f){var b=this.size-this.hdr_size;this.major_brand=f.readString(4),this.minor_version=f.readUint32(),b-=8,this.compatible_brands=[];for(var w=0;b>=4;)this.compatible_brands[w]=f.readString(4),b-=4,w++}),E.createFullBoxCtor("hdlr",function(f){0===this.version&&(f.readUint32(),this.handler=f.readString(4),f.readUint32Array(3),this.name=f.readString(this.size-this.hdr_size-20),"\0"===this.name[this.name.length-1]&&(this.name=this.name.slice(0,-1)))}),E.createBoxCtor("hvcC",function(f){var b,w,R,H;this.configurationVersion=f.readUint8(),H=f.readUint8(),this.general_profile_space=H>>6,this.general_tier_flag=(32&H)>>5,this.general_profile_idc=31&H,this.general_profile_compatibility=f.readUint32(),this.general_constraint_indicator=f.readUint8Array(6),this.general_level_idc=f.readUint8(),this.min_spatial_segmentation_idc=4095&f.readUint16(),this.parallelismType=3&f.readUint8(),this.chroma_format_idc=3&f.readUint8(),this.bit_depth_luma_minus8=7&f.readUint8(),this.bit_depth_chroma_minus8=7&f.readUint8(),this.avgFrameRate=f.readUint16(),H=f.readUint8(),this.constantFrameRate=H>>6,this.numTemporalLayers=(13&H)>>3,this.temporalIdNested=(4&H)>>2,this.lengthSizeMinusOne=3&H,this.nalu_arrays=[];var L=f.readUint8();for(b=0;b<L;b++){var oe=[];this.nalu_arrays.push(oe),H=f.readUint8(),oe.completeness=(128&H)>>7,oe.nalu_type=63&H;var ve=f.readUint16();for(w=0;w<ve;w++){var we={};oe.push(we),R=f.readUint16(),we.data=f.readUint8Array(R)}}}),E.createFullBoxCtor("iinf",function(f){var b;this.entry_count=0===this.version?f.readUint16():f.readUint32(),this.item_infos=[];for(var w=0;w<this.entry_count;w++){if((b=E.parseOneBox(f,!1,this.size-(f.getPosition()-this.start))).code!==E.OK)return;"infe"!==b.box.type&&ie.error("BoxParser","Expected 'infe' box, got "+b.box.type),this.item_infos[w]=b.box}}),E.createFullBoxCtor("iloc",function(f){var b;b=f.readUint8(),this.offset_size=b>>4&15,this.length_size=15&b,b=f.readUint8(),this.base_offset_size=b>>4&15,this.index_size=1===this.version||2===this.version?15&b:0,this.items=[];var w=0;if(this.version<2)w=f.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";w=f.readUint32()}for(var T=0;T<w;T++){var R={};if(this.items.push(R),this.version<2)R.item_ID=f.readUint16();else{if(2!==this.version)throw"version of iloc box not supported";R.item_ID=f.readUint16()}switch(R.construction_method=1===this.version||2===this.version?15&f.readUint16():0,R.data_reference_index=f.readUint16(),this.base_offset_size){case 0:R.base_offset=0;break;case 4:R.base_offset=f.readUint32();break;case 8:R.base_offset=f.readUint64();break;default:throw"Error reading base offset size"}var H=f.readUint16();R.extents=[];for(var L=0;L<H;L++){var oe={};if(R.extents.push(oe),1===this.version||2===this.version)switch(this.index_size){case 0:oe.extent_index=0;break;case 4:oe.extent_index=f.readUint32();break;case 8:oe.extent_index=f.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:oe.extent_offset=0;break;case 4:oe.extent_offset=f.readUint32();break;case 8:oe.extent_offset=f.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:oe.extent_length=0;break;case 4:oe.extent_length=f.readUint32();break;case 8:oe.extent_length=f.readUint64();break;default:throw"Error reading extent index"}}}}),E.createBoxCtor("imir",function(f){var b=f.readUint8();this.reserved=b>>7,this.axis=1&b}),E.createFullBoxCtor("infe",function(f){if((0===this.version||1===this.version)&&(this.item_ID=f.readUint16(),this.item_protection_index=f.readUint16(),this.item_name=f.readCString(),this.content_type=f.readCString(),this.content_encoding=f.readCString()),1===this.version)return this.extension_type=f.readString(4),ie.warn("BoxParser","Cannot parse extension type"),void f.seek(this.start+this.size);this.version>=2&&(2===this.version?this.item_ID=f.readUint16():3===this.version&&(this.item_ID=f.readUint32()),this.item_protection_index=f.readUint16(),this.item_type=f.readString(4),this.item_name=f.readCString(),"mime"===this.item_type?(this.content_type=f.readCString(),this.content_encoding=f.readCString()):"uri "===this.item_type&&(this.item_uri_type=f.readCString()))}),E.createFullBoxCtor("ipma",function(f){var b,w;for(entry_count=f.readUint32(),this.associations=[],b=0;b<entry_count;b++){var T={};this.associations.push(T),T.id=this.version<1?f.readUint16():f.readUint32();var R=f.readUint8();for(T.props=[],w=0;w<R;w++){var H=f.readUint8(),L={};T.props.push(L),L.essential=(128&H)>>7==1,L.property_index=1&this.flags?(127&H)<<8|f.readUint8():127&H}}}),E.createFullBoxCtor("iref",function(f){var b,T;for(this.references=[];f.getPosition()<this.start+this.size;){if((b=E.parseOneBox(f,!0,this.size-(f.getPosition()-this.start))).code!==E.OK)return;(T=0===this.version?new E.SingleItemTypeReferenceBox(b.type,b.size,b.hdr_size,b.start):new E.SingleItemTypeReferenceBoxLarge(b.type,b.size,b.hdr_size,b.start)).write===E.Box.prototype.write&&"mdat"!==T.type&&(ie.warn("BoxParser",T.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),T.parseDataAndRewind(f)),T.parse(f),this.references.push(T)}}),E.createBoxCtor("irot",function(f){this.angle=3&f.readUint8()}),E.createFullBoxCtor("ispe",function(f){this.image_width=f.readUint32(),this.image_height=f.readUint32()}),E.createFullBoxCtor("kind",function(f){this.schemeURI=f.readCString(),this.value=f.readCString()}),E.createFullBoxCtor("leva",function(f){var b=f.readUint8();this.levels=[];for(var w=0;w<b;w++){var T={};this.levels[w]=T,T.track_ID=f.readUint32();var R=f.readUint8();switch(T.padding_flag=R>>7,T.assignment_type=127&R,T.assignment_type){case 0:T.grouping_type=f.readString(4);break;case 1:T.grouping_type=f.readString(4),T.grouping_type_parameter=f.readUint32();break;case 2:case 3:break;case 4:T.sub_track_id=f.readUint32();break;default:ie.warn("BoxParser","Unknown leva assignement type")}}}),E.createBoxCtor("lsel",function(f){this.layer_id=f.readUint16()}),E.createBoxCtor("maxr",function(f){this.period=f.readUint32(),this.bytes=f.readUint32()}),E.createBoxCtor("mdcv",function(f){this.display_primaries=[],this.display_primaries[0]={},this.display_primaries[0].x=f.readUint16(),this.display_primaries[0].y=f.readUint16(),this.display_primaries[1]={},this.display_primaries[1].x=f.readUint16(),this.display_primaries[1].y=f.readUint16(),this.display_primaries[2]={},this.display_primaries[2].x=f.readUint16(),this.display_primaries[2].y=f.readUint16(),this.white_point={},this.white_point.x=f.readUint16(),this.white_point.y=f.readUint16(),this.max_display_mastering_luminance=f.readUint32(),this.min_display_mastering_luminance=f.readUint32()}),E.createFullBoxCtor("mdhd",function(f){1==this.version?(this.creation_time=f.readUint64(),this.modification_time=f.readUint64(),this.timescale=f.readUint32(),this.duration=f.readUint64()):(this.creation_time=f.readUint32(),this.modification_time=f.readUint32(),this.timescale=f.readUint32(),this.duration=f.readUint32()),this.parseLanguage(f),f.readUint16()}),E.createFullBoxCtor("mehd",function(f){1&this.flags&&(ie.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.fragment_duration=1==this.version?f.readUint64():f.readUint32()}),E.createFullBoxCtor("meta",function(f){this.boxes=[],E.ContainerBox.prototype.parse.call(this,f)}),E.createFullBoxCtor("mfhd",function(f){this.sequence_number=f.readUint32()}),E.createFullBoxCtor("mfro",function(f){this._size=f.readUint32()}),E.createFullBoxCtor("mvhd",function(f){1==this.version?(this.creation_time=f.readUint64(),this.modification_time=f.readUint64(),this.timescale=f.readUint32(),this.duration=f.readUint64()):(this.creation_time=f.readUint32(),this.modification_time=f.readUint32(),this.timescale=f.readUint32(),this.duration=f.readUint32()),this.rate=f.readUint32(),this.volume=f.readUint16()>>8,f.readUint16(),f.readUint32Array(2),this.matrix=f.readUint32Array(9),f.readUint32Array(6),this.next_track_id=f.readUint32()}),E.createBoxCtor("npck",function(f){this.packetssent=f.readUint32()}),E.createBoxCtor("nump",function(f){this.packetssent=f.readUint64()}),E.createFullBoxCtor("padb",function(f){var b=f.readUint32();this.padbits=[];for(var w=0;w<Math.floor((b+1)/2);w++)this.padbits=f.readUint8()}),E.createBoxCtor("pasp",function(f){this.hSpacing=f.readUint32(),this.vSpacing=f.readUint32()}),E.createBoxCtor("payl",function(f){this.text=f.readString(this.size-this.hdr_size)}),E.createBoxCtor("payt",function(f){this.payloadID=f.readUint32();var b=f.readUint8();this.rtpmap_string=f.readString(b)}),E.createFullBoxCtor("pdin",function(f){var b=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var w=0;w<b;w++)this.rate[w]=f.readUint32(),this.initial_delay[w]=f.readUint32()}),E.createFullBoxCtor("pitm",function(f){this.item_id=0===this.version?f.readUint16():f.readUint32()}),E.createFullBoxCtor("pixi",function(f){var b;for(this.num_channels=f.readUint8(),this.bits_per_channels=[],b=0;b<this.num_channels;b++)this.bits_per_channels[b]=f.readUint8()}),E.createBoxCtor("pmax",function(f){this.bytes=f.readUint32()}),E.createFullBoxCtor("prft",function(f){this.ref_track_id=f.readUint32(),this.ntp_timestamp=f.readUint64(),this.media_time=0===this.version?f.readUint32():f.readUint64()}),E.createFullBoxCtor("pssh",function(f){if(this.system_id=E.parseHex16(f),this.version>0){var b=f.readUint32();this.kid=[];for(var w=0;w<b;w++)this.kid[w]=E.parseHex16(f)}var T=f.readUint32();T>0&&(this.data=f.readUint8Array(T))}),E.createFullBoxCtor("clef",function(f){this.width=f.readUint32(),this.height=f.readUint32()}),E.createFullBoxCtor("enof",function(f){this.width=f.readUint32(),this.height=f.readUint32()}),E.createFullBoxCtor("prof",function(f){this.width=f.readUint32(),this.height=f.readUint32()}),E.createContainerBoxCtor("tapt",null,["clef","prof","enof"]),E.createBoxCtor("rtp ",function(f){this.descriptionformat=f.readString(4),this.sdptext=f.readString(this.size-this.hdr_size-4)}),E.createFullBoxCtor("saio",function(f){1&this.flags&&(this.aux_info_type=f.readUint32(),this.aux_info_type_parameter=f.readUint32());var b=f.readUint32();this.offset=[];for(var w=0;w<b;w++)this.offset[w]=0===this.version?f.readUint32():f.readUint64()}),E.createFullBoxCtor("saiz",function(f){1&this.flags&&(this.aux_info_type=f.readUint32(),this.aux_info_type_parameter=f.readUint32()),this.default_sample_info_size=f.readUint8();var b=f.readUint32();if(this.sample_info_size=[],0===this.default_sample_info_size)for(var w=0;w<b;w++)this.sample_info_size[w]=f.readUint8()}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_METADATA,"mett",function(f){this.parseHeader(f),this.content_encoding=f.readCString(),this.mime_format=f.readCString(),this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_METADATA,"metx",function(f){this.parseHeader(f),this.content_encoding=f.readCString(),this.namespace=f.readCString(),this.schema_location=f.readCString(),this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",function(f){this.parseHeader(f),this.content_encoding=f.readCString(),this.mime_format=f.readCString(),this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",function(f){this.parseHeader(f),this.namespace=f.readCString(),this.schema_location=f.readCString(),this.auxiliary_mime_types=f.readCString(),this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",function(f){this.parseHeader(f),this.content_encoding=f.readCString(),this.mime_format=f.readCString(),this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",function(f){this.parseHeader(f),this.displayFlags=f.readUint32(),this.horizontal_justification=f.readInt8(),this.vertical_justification=f.readInt8(),this.bg_color_rgba=f.readUint8Array(4),this.box_record=f.readInt16Array(4),this.style_record=f.readUint8Array(12),this.parseFooter(f)}),E.createSampleEntryCtor(E.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",function(f){this.parseHeader(f),this.parseFooter(f)}),E.createSampleGroupCtor("alst",function(f){var b,w=f.readUint16();for(this.first_output_sample=f.readUint16(),this.sample_offset=[],b=0;b<w;b++)this.sample_offset[b]=f.readUint32();var T=this.description_length-4-4*w;for(this.num_output_samples=[],this.num_total_samples=[],b=0;b<T/4;b++)this.num_output_samples[b]=f.readUint16(),this.num_total_samples[b]=f.readUint16()}),E.createSampleGroupCtor("avll",function(f){this.layerNumber=f.readUint8(),this.accurateStatisticsFlag=f.readUint8(),this.avgBitRate=f.readUint16(),this.avgFrameRate=f.readUint16()}),E.createSampleGroupCtor("avss",function(f){this.subSequenceIdentifier=f.readUint16(),this.layerNumber=f.readUint8();var b=f.readUint8();this.durationFlag=b>>7,this.avgRateFlag=b>>6&1,this.durationFlag&&(this.duration=f.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=f.readUint8(),this.avgBitRate=f.readUint16(),this.avgFrameRate=f.readUint16()),this.dependency=[];for(var w=f.readUint8(),T=0;T<w;T++){var R={};this.dependency.push(R),R.subSeqDirectionFlag=f.readUint8(),R.layerNumber=f.readUint8(),R.subSequenceIdentifier=f.readUint16()}}),E.createSampleGroupCtor("dtrt",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("mvif",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("prol",function(f){this.roll_distance=f.readInt16()}),E.createSampleGroupCtor("rap ",function(f){var b=f.readUint8();this.num_leading_samples_known=b>>7,this.num_leading_samples=127&b}),E.createSampleGroupCtor("rash",function(f){if(this.operation_point_count=f.readUint16(),this.description_length!==2+(1===this.operation_point_count?2:6*this.operation_point_count)+9)ie.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=f.readUint8Array(this.description_length-2);else{if(1===this.operation_point_count)this.target_rate_share=f.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var b=0;b<this.operation_point_count;b++)this.available_bitrate[b]=f.readUint32(),this.target_rate_share[b]=f.readUint16()}this.maximum_bitrate=f.readUint32(),this.minimum_bitrate=f.readUint32(),this.discard_priority=f.readUint8()}}),E.createSampleGroupCtor("roll",function(f){this.roll_distance=f.readInt16()}),E.SampleGroupEntry.prototype.parse=function(f){ie.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=f.readUint8Array(this.description_length)},E.createSampleGroupCtor("scif",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("scnm",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("seig",function(f){this.reserved=f.readUint8();var b=f.readUint8();this.crypt_byte_block=b>>4,this.skip_byte_block=15&b,this.isProtected=f.readUint8(),this.Per_Sample_IV_Size=f.readUint8(),this.KID=E.parseHex16(f),this.constant_IV_size=0,this.constant_IV=0,1===this.isProtected&&0===this.Per_Sample_IV_Size&&(this.constant_IV_size=f.readUint8(),this.constant_IV=f.readUint8Array(this.constant_IV_size))}),E.createSampleGroupCtor("stsa",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("sync",function(f){var b=f.readUint8();this.NAL_unit_type=63&b}),E.createSampleGroupCtor("tele",function(f){var b=f.readUint8();this.level_independently_decodable=b>>7}),E.createSampleGroupCtor("tsas",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("tscl",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createSampleGroupCtor("vipr",function(f){ie.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),E.createFullBoxCtor("sbgp",function(f){this.grouping_type=f.readString(4),this.grouping_type_parameter=1===this.version?f.readUint32():0,this.entries=[];for(var b=f.readUint32(),w=0;w<b;w++){var T={};this.entries.push(T),T.sample_count=f.readInt32(),T.group_description_index=f.readInt32()}}),E.createFullBoxCtor("schm",function(f){this.scheme_type=f.readString(4),this.scheme_version=f.readUint32(),1&this.flags&&(this.scheme_uri=f.readString(this.size-this.hdr_size-8))}),E.createBoxCtor("sdp ",function(f){this.sdptext=f.readString(this.size-this.hdr_size)}),E.createFullBoxCtor("sdtp",function(f){var b,w=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var T=0;T<w;T++)b=f.readUint8(),this.is_leading[T]=b>>6,this.sample_depends_on[T]=b>>4&3,this.sample_is_depended_on[T]=b>>2&3,this.sample_has_redundancy[T]=3&b}),E.createFullBoxCtor("senc"),E.createFullBoxCtor("sgpd",function(f){this.grouping_type=f.readString(4),ie.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.default_length=1===this.version?f.readUint32():0,this.version>=2&&(this.default_group_description_index=f.readUint32()),this.entries=[];for(var b=f.readUint32(),w=0;w<b;w++){var T;T=E[this.grouping_type+"SampleGroupEntry"]?new E[this.grouping_type+"SampleGroupEntry"](this.grouping_type):new E.SampleGroupEntry(this.grouping_type),this.entries.push(T),T.description_length=1===this.version&&0===this.default_length?f.readUint32():this.default_length,T.write===E.SampleGroupEntry.prototype.write&&(ie.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),T.data=f.readUint8Array(T.description_length),f.position-=T.description_length),T.parse(f)}}),E.createFullBoxCtor("sidx",function(f){this.reference_ID=f.readUint32(),this.timescale=f.readUint32(),0===this.version?(this.earliest_presentation_time=f.readUint32(),this.first_offset=f.readUint32()):(this.earliest_presentation_time=f.readUint64(),this.first_offset=f.readUint64()),f.readUint16(),this.references=[];for(var b=f.readUint16(),w=0;w<b;w++){var T={};this.references.push(T);var R=f.readUint32();T.reference_type=R>>31&1,T.referenced_size=2147483647&R,T.subsegment_duration=f.readUint32(),R=f.readUint32(),T.starts_with_SAP=R>>31&1,T.SAP_type=R>>28&7,T.SAP_delta_time=268435455&R}}),E.SingleItemTypeReferenceBox=function(f,b,w,T){E.Box.call(this,f,b),this.hdr_size=w,this.start=T},E.SingleItemTypeReferenceBox.prototype=new E.Box,E.SingleItemTypeReferenceBox.prototype.parse=function(f){this.from_item_ID=f.readUint16();var b=f.readUint16();this.references=[];for(var w=0;w<b;w++)this.references[w]=f.readUint16()},E.SingleItemTypeReferenceBoxLarge=function(f,b,w,T){E.Box.call(this,f,b),this.hdr_size=w,this.start=T},E.SingleItemTypeReferenceBoxLarge.prototype=new E.Box,E.SingleItemTypeReferenceBoxLarge.prototype.parse=function(f){this.from_item_ID=f.readUint32();var b=f.readUint16();this.references=[];for(var w=0;w<b;w++)this.references[w]=f.readUint32()},E.createFullBoxCtor("SmDm",function(f){this.primaryRChromaticity_x=f.readUint16(),this.primaryRChromaticity_y=f.readUint16(),this.primaryGChromaticity_x=f.readUint16(),this.primaryGChromaticity_y=f.readUint16(),this.primaryBChromaticity_x=f.readUint16(),this.primaryBChromaticity_y=f.readUint16(),this.whitePointChromaticity_x=f.readUint16(),this.whitePointChromaticity_y=f.readUint16(),this.luminanceMax=f.readUint32(),this.luminanceMin=f.readUint32()}),E.createFullBoxCtor("smhd",function(f){this.balance=f.readUint16(),f.readUint16()}),E.createFullBoxCtor("ssix",function(f){this.subsegments=[];for(var b=f.readUint32(),w=0;w<b;w++){var T={};this.subsegments.push(T),T.ranges=[];for(var R=f.readUint32(),H=0;H<R;H++){var L={};T.ranges.push(L),L.level=f.readUint8(),L.range_size=f.readUint24()}}}),E.createFullBoxCtor("stco",function(f){var b;if(b=f.readUint32(),this.chunk_offsets=[],0===this.version)for(var w=0;w<b;w++)this.chunk_offsets.push(f.readUint32())}),E.createFullBoxCtor("stdp",function(f){var b=(this.size-this.hdr_size)/2;this.priority=[];for(var w=0;w<b;w++)this.priority[w]=f.readUint16()}),E.createFullBoxCtor("sthd"),E.createFullBoxCtor("stri",function(f){this.switch_group=f.readUint16(),this.alternate_group=f.readUint16(),this.sub_track_id=f.readUint32();var b=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var w=0;w<b;w++)this.attribute_list[w]=f.readUint32()}),E.createFullBoxCtor("stsc",function(f){var b,w;if(b=f.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],0===this.version)for(w=0;w<b;w++)this.first_chunk.push(f.readUint32()),this.samples_per_chunk.push(f.readUint32()),this.sample_description_index.push(f.readUint32())}),E.createFullBoxCtor("stsd",function(f){var b,w,T,R;for(this.entries=[],T=f.readUint32(),b=1;b<=T;b++){if((w=E.parseOneBox(f,!0,this.size-(f.getPosition()-this.start))).code!==E.OK)return;E[w.type+"SampleEntry"]?((R=new E[w.type+"SampleEntry"](w.size)).hdr_size=w.hdr_size,R.start=w.start):(ie.warn("BoxParser","Unknown sample entry type: "+w.type),R=new E.SampleEntry(w.type,w.size,w.hdr_size,w.start)),R.write===E.SampleEntry.prototype.write&&(ie.info("BoxParser","SampleEntry "+R.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),R.parseDataAndRewind(f)),R.parse(f),this.entries.push(R)}}),E.createFullBoxCtor("stsg",function(f){this.grouping_type=f.readUint32();var b=f.readUint16();this.group_description_index=[];for(var w=0;w<b;w++)this.group_description_index[w]=f.readUint32()}),E.createFullBoxCtor("stsh",function(f){var b,w;if(b=f.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],0===this.version)for(w=0;w<b;w++)this.shadowed_sample_numbers.push(f.readUint32()),this.sync_sample_numbers.push(f.readUint32())}),E.createFullBoxCtor("stss",function(f){var b,w;if(w=f.readUint32(),0===this.version)for(this.sample_numbers=[],b=0;b<w;b++)this.sample_numbers.push(f.readUint32())}),E.createFullBoxCtor("stsz",function(f){var b;if(this.sample_sizes=[],0===this.version)for(this.sample_size=f.readUint32(),this.sample_count=f.readUint32(),b=0;b<this.sample_count;b++)0===this.sample_size?this.sample_sizes.push(f.readUint32()):this.sample_sizes[b]=this.sample_size}),E.createFullBoxCtor("stts",function(f){var b,w,T;if(b=f.readUint32(),this.sample_counts=[],this.sample_deltas=[],0===this.version)for(w=0;w<b;w++)this.sample_counts.push(f.readUint32()),(T=f.readInt32())<0&&(ie.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),T=1),this.sample_deltas.push(T)}),E.createFullBoxCtor("stvi",function(f){var b=f.readUint32();this.single_view_allowed=3&b,this.stereo_scheme=f.readUint32();var T,R,w=f.readUint32();for(this.stereo_indication_type=f.readString(w),this.boxes=[];f.getPosition()<this.start+this.size;){if((T=E.parseOneBox(f,!1,this.size-(f.getPosition()-this.start))).code!==E.OK)return;this.boxes.push(R=T.box),this[R.type]=R}}),E.createBoxCtor("styp",function(f){E.ftypBox.prototype.parse.call(this,f)}),E.createFullBoxCtor("stz2",function(f){var b,T;if(this.sample_sizes=[],0===this.version)if(this.reserved=f.readUint24(),this.field_size=f.readUint8(),T=f.readUint32(),4===this.field_size)for(b=0;b<T;b+=2){var R=f.readUint8();this.sample_sizes[b]=R>>4&15,this.sample_sizes[b+1]=15&R}else if(8===this.field_size)for(b=0;b<T;b++)this.sample_sizes[b]=f.readUint8();else if(16===this.field_size)for(b=0;b<T;b++)this.sample_sizes[b]=f.readUint16();else ie.error("BoxParser","Error in length field in stz2 box")}),E.createFullBoxCtor("subs",function(f){var b,w,T,R;for(T=f.readUint32(),this.entries=[],b=0;b<T;b++){var H={};if(this.entries[b]=H,H.sample_delta=f.readUint32(),H.subsamples=[],(R=f.readUint16())>0)for(w=0;w<R;w++){var L={};H.subsamples.push(L),L.size=1==this.version?f.readUint32():f.readUint16(),L.priority=f.readUint8(),L.discardable=f.readUint8(),L.codec_specific_parameters=f.readUint32()}}}),E.createFullBoxCtor("tenc",function(f){if(f.readUint8(),0===this.version)f.readUint8();else{var b=f.readUint8();this.default_crypt_byte_block=b>>4&15,this.default_skip_byte_block=15&b}this.default_isProtected=f.readUint8(),this.default_Per_Sample_IV_Size=f.readUint8(),this.default_KID=E.parseHex16(f),1===this.default_isProtected&&0===this.default_Per_Sample_IV_Size&&(this.default_constant_IV_size=f.readUint8(),this.default_constant_IV=f.readUint8Array(this.default_constant_IV_size))}),E.createFullBoxCtor("tfdt",function(f){this.baseMediaDecodeTime=1==this.version?f.readUint64():f.readUint32()}),E.createFullBoxCtor("tfhd",function(f){var b=0;this.track_id=f.readUint32(),this.size-this.hdr_size>b&&this.flags&E.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=f.readUint64(),b+=8):this.base_data_offset=0,this.size-this.hdr_size>b&&this.flags&E.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=f.readUint32(),b+=4):this.default_sample_description_index=0,this.size-this.hdr_size>b&&this.flags&E.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=f.readUint32(),b+=4):this.default_sample_duration=0,this.size-this.hdr_size>b&&this.flags&E.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=f.readUint32(),b+=4):this.default_sample_size=0,this.size-this.hdr_size>b&&this.flags&E.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=f.readUint32(),b+=4):this.default_sample_flags=0}),E.createFullBoxCtor("tfra",function(f){this.track_ID=f.readUint32(),f.readUint24();var b=f.readUint8();this.length_size_of_traf_num=b>>4&3,this.length_size_of_trun_num=b>>2&3,this.length_size_of_sample_num=3&b,this.entries=[];for(var w=f.readUint32(),T=0;T<w;T++)1===this.version?(this.time=f.readUint64(),this.moof_offset=f.readUint64()):(this.time=f.readUint32(),this.moof_offset=f.readUint32()),this.traf_number=f["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=f["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=f["readUint"+8*(this.length_size_of_sample_num+1)]()}),E.createFullBoxCtor("tkhd",function(f){1==this.version?(this.creation_time=f.readUint64(),this.modification_time=f.readUint64(),this.track_id=f.readUint32(),f.readUint32(),this.duration=f.readUint64()):(this.creation_time=f.readUint32(),this.modification_time=f.readUint32(),this.track_id=f.readUint32(),f.readUint32(),this.duration=f.readUint32()),f.readUint32Array(2),this.layer=f.readInt16(),this.alternate_group=f.readInt16(),this.volume=f.readInt16()>>8,f.readUint16(),this.matrix=f.readInt32Array(9),this.width=f.readUint32(),this.height=f.readUint32()}),E.createBoxCtor("tmax",function(f){this.time=f.readUint32()}),E.createBoxCtor("tmin",function(f){this.time=f.readUint32()}),E.createBoxCtor("totl",function(f){this.bytessent=f.readUint32()}),E.createBoxCtor("tpay",function(f){this.bytessent=f.readUint32()}),E.createBoxCtor("tpyl",function(f){this.bytessent=f.readUint64()}),E.TrackGroupTypeBox.prototype.parse=function(f){this.parseFullHeader(f),this.track_group_id=f.readUint32()},E.createTrackGroupCtor("msrc"),E.TrackReferenceTypeBox=function(f,b,w,T){E.Box.call(this,f,b),this.hdr_size=w,this.start=T},E.TrackReferenceTypeBox.prototype=new E.Box,E.TrackReferenceTypeBox.prototype.parse=function(f){this.track_ids=f.readUint32Array((this.size-this.hdr_size)/4)},E.trefBox.prototype.parse=function(f){for(var b,w;f.getPosition()<this.start+this.size;){if((b=E.parseOneBox(f,!0,this.size-(f.getPosition()-this.start))).code!==E.OK)return;(w=new E.TrackReferenceTypeBox(b.type,b.size,b.hdr_size,b.start)).write===E.Box.prototype.write&&"mdat"!==w.type&&(ie.info("BoxParser","TrackReference "+w.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),w.parseDataAndRewind(f)),w.parse(f),this.boxes.push(w)}},E.createFullBoxCtor("trep",function(f){for(this.track_ID=f.readUint32(),this.boxes=[];f.getPosition()<this.start+this.size;){if(ret=E.parseOneBox(f,!1,this.size-(f.getPosition()-this.start)),ret.code!==E.OK)return;box=ret.box,this.boxes.push(box)}}),E.createFullBoxCtor("trex",function(f){this.track_id=f.readUint32(),this.default_sample_description_index=f.readUint32(),this.default_sample_duration=f.readUint32(),this.default_sample_size=f.readUint32(),this.default_sample_flags=f.readUint32()}),E.createBoxCtor("trpy",function(f){this.bytessent=f.readUint64()}),E.createFullBoxCtor("trun",function(f){var b=0;if(this.sample_count=f.readUint32(),this.size-this.hdr_size>(b+=4)&&this.flags&E.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=f.readInt32(),b+=4):this.data_offset=0,this.size-this.hdr_size>b&&this.flags&E.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=f.readUint32(),b+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>b)for(var w=0;w<this.sample_count;w++)this.flags&E.TRUN_FLAGS_DURATION&&(this.sample_duration[w]=f.readUint32()),this.flags&E.TRUN_FLAGS_SIZE&&(this.sample_size[w]=f.readUint32()),this.flags&E.TRUN_FLAGS_FLAGS&&(this.sample_flags[w]=f.readUint32()),this.flags&E.TRUN_FLAGS_CTS_OFFSET&&(this.sample_composition_time_offset[w]=0===this.version?f.readUint32():f.readInt32())}),E.createFullBoxCtor("tsel",function(f){this.switch_group=f.readUint32();var b=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var w=0;w<b;w++)this.attribute_list[w]=f.readUint32()}),E.createFullBoxCtor("txtC",function(f){this.config=f.readCString()}),E.createFullBoxCtor("url ",function(f){1!==this.flags&&(this.location=f.readCString())}),E.createFullBoxCtor("urn ",function(f){this.name=f.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=f.readCString())}),E.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66",!0,!1,function(f){this.LiveServerManifest=f.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),E.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3",!0,!1,function(f){this.system_id=E.parseHex16(f);var b=f.readUint32();b>0&&(this.data=f.readUint8Array(b))}),E.createUUIDBox("a2394f525a9b4f14a2446c427c648df4",!0,!1),E.createUUIDBox("8974dbce7be74c5184f97148f9882554",!0,!1,function(f){this.default_AlgorithmID=f.readUint24(),this.default_IV_size=f.readUint8(),this.default_KID=E.parseHex16(f)}),E.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f",!0,!1,function(f){this.fragment_count=f.readUint8(),this.entries=[];for(var b=0;b<this.fragment_count;b++){var w={},T=0,R=0;1===this.version?(T=f.readUint64(),R=f.readUint64()):(T=f.readUint32(),R=f.readUint32()),w.absolute_time=T,w.absolute_duration=R,this.entries.push(w)}}),E.createUUIDBox("6d1d9b0542d544e680e2141daff757b2",!0,!1,function(f){1===this.version?(this.absolute_time=f.readUint64(),this.duration=f.readUint64()):(this.absolute_time=f.readUint32(),this.duration=f.readUint32())}),E.createFullBoxCtor("vmhd",function(f){this.graphicsmode=f.readUint16(),this.opcolor=f.readUint16Array(3)}),E.createFullBoxCtor("vpcC",function(f){var b;1===this.version?(this.profile=f.readUint8(),this.level=f.readUint8(),b=f.readUint8(),this.bitDepth=b>>4,this.chromaSubsampling=b>>1&7,this.videoFullRangeFlag=1&b,this.colourPrimaries=f.readUint8(),this.transferCharacteristics=f.readUint8(),this.matrixCoefficients=f.readUint8(),this.codecIntializationDataSize=f.readUint16(),this.codecIntializationData=f.readUint8Array(this.codecIntializationDataSize)):(this.profile=f.readUint8(),this.level=f.readUint8(),b=f.readUint8(),this.bitDepth=b>>4&15,this.colorSpace=15&b,b=f.readUint8(),this.chromaSubsampling=b>>4&15,this.transferFunction=b>>1&7,this.videoFullRangeFlag=1&b,this.codecIntializationDataSize=f.readUint16(),this.codecIntializationData=f.readUint8Array(this.codecIntializationDataSize))}),E.createBoxCtor("vttC",function(f){this.text=f.readString(this.size-this.hdr_size)}),E.createFullBoxCtor("vvcC",function(f){var b,w,T={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(De){this.held_bits=De.readUint8(),this.num_held_bits=8},stream_read_2_bytes:function(De){this.held_bits=De.readUint16(),this.num_held_bits=16},extract_bits:function(De){var $=this.held_bits>>this.num_held_bits-De&(1<<De)-1;return this.num_held_bits-=De,$}};if(T.stream_read_1_bytes(f),T.extract_bits(5),this.lengthSizeMinusOne=T.extract_bits(2),this.ptl_present_flag=T.extract_bits(1),this.ptl_present_flag){if(T.stream_read_2_bytes(f),this.ols_idx=T.extract_bits(9),this.num_sublayers=T.extract_bits(3),this.constant_frame_rate=T.extract_bits(2),this.chroma_format_idc=T.extract_bits(2),T.stream_read_1_bytes(f),this.bit_depth_minus8=T.extract_bits(3),T.extract_bits(5),T.stream_read_2_bytes(f),T.extract_bits(2),this.num_bytes_constraint_info=T.extract_bits(6),this.general_profile_idc=T.extract_bits(7),this.general_tier_flag=T.extract_bits(1),this.general_level_idc=f.readUint8(),T.stream_read_1_bytes(f),this.ptl_frame_only_constraint_flag=T.extract_bits(1),this.ptl_multilayer_enabled_flag=T.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(b=0;b<this.num_bytes_constraint_info-1;b++){var R=T.extract_bits(6);T.stream_read_1_bytes(f);var H=T.extract_bits(2);this.general_constraint_info[b]=R<<2|H}this.general_constraint_info[this.num_bytes_constraint_info-1]=T.extract_bits(6)}else T.extract_bits(6);for(T.stream_read_1_bytes(f),this.ptl_sublayer_present_mask=0,w=this.num_sublayers-2;w>=0;--w){var L=T.extract_bits(1);this.ptl_sublayer_present_mask|=L<<w}for(w=this.num_sublayers;w<=8&&this.num_sublayers>1;++w)T.extract_bits(1);for(w=this.num_sublayers-2;w>=0;--w)this.ptl_sublayer_present_mask&1<<w&&(this.sublayer_level_idc[w]=f.readUint8());if(this.ptl_num_sub_profiles=f.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(b=0;b<this.ptl_num_sub_profiles;b++)this.general_sub_profile_idc.push(f.readUint32());this.max_picture_width=f.readUint16(),this.max_picture_height=f.readUint16(),this.avg_frame_rate=f.readUint16()}this.nalu_arrays=[];var we=f.readUint8();for(b=0;b<we;b++){var de=[];this.nalu_arrays.push(de),T.stream_read_1_bytes(f),de.completeness=T.extract_bits(1),T.extract_bits(2),de.nalu_type=T.extract_bits(5);var ke=1;for(13!=de.nalu_type&&12!=de.nalu_type&&(ke=f.readUint16()),w=0;w<ke;w++){var ae=f.readUint16();de.push({data:f.readUint8Array(ae),length:ae})}}}),E.createFullBoxCtor("vvnC",function(f){var b=strm.readUint8();this.lengthSizeMinusOne=3&b}),E.SampleEntry.prototype.isVideo=function(){return!1},E.SampleEntry.prototype.isAudio=function(){return!1},E.SampleEntry.prototype.isSubtitle=function(){return!1},E.SampleEntry.prototype.isMetadata=function(){return!1},E.SampleEntry.prototype.isHint=function(){return!1},E.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},E.SampleEntry.prototype.getWidth=function(){return""},E.SampleEntry.prototype.getHeight=function(){return""},E.SampleEntry.prototype.getChannelCount=function(){return""},E.SampleEntry.prototype.getSampleRate=function(){return""},E.SampleEntry.prototype.getSampleSize=function(){return""},E.VisualSampleEntry.prototype.isVideo=function(){return!0},E.VisualSampleEntry.prototype.getWidth=function(){return this.width},E.VisualSampleEntry.prototype.getHeight=function(){return this.height},E.AudioSampleEntry.prototype.isAudio=function(){return!0},E.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},E.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},E.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},E.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},E.MetadataSampleEntry.prototype.isMetadata=function(){return!0},E.decimalToHex=function(f,b){var w=Number(f).toString(16);for(b=typeof b>"u"||null===b?b=2:b;w.length<b;)w="0"+w;return w},E.avc1SampleEntry.prototype.getCodec=E.avc2SampleEntry.prototype.getCodec=E.avc3SampleEntry.prototype.getCodec=E.avc4SampleEntry.prototype.getCodec=function(){var f=E.SampleEntry.prototype.getCodec.call(this);return this.avcC?f+"."+E.decimalToHex(this.avcC.AVCProfileIndication)+E.decimalToHex(this.avcC.profile_compatibility)+E.decimalToHex(this.avcC.AVCLevelIndication):f},E.hev1SampleEntry.prototype.getCodec=E.hvc1SampleEntry.prototype.getCodec=function(){var f,b=E.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(b+=".",this.hvcC.general_profile_space){case 0:b+="";break;case 1:b+="A";break;case 2:b+="B";break;case 3:b+="C"}b+=this.hvcC.general_profile_idc,b+=".";var w=this.hvcC.general_profile_compatibility,T=0;for(f=0;f<32&&(T|=1&w,31!=f);f++)T<<=1,w>>=1;b+=E.decimalToHex(T,0),b+=".",b+=0===this.hvcC.general_tier_flag?"L":"H",b+=this.hvcC.general_level_idc;var R=!1,H="";for(f=5;f>=0;f--)(this.hvcC.general_constraint_indicator[f]||R)&&(H="."+E.decimalToHex(this.hvcC.general_constraint_indicator[f],0)+H,R=!0);b+=H}return b},E.vvc1SampleEntry.prototype.getCodec=E.vvi1SampleEntry.prototype.getCodec=function(){var f,b=E.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){b+="."+this.vvcC.general_profile_idc,b+=this.vvcC.general_tier_flag?".H":".L",b+=this.vvcC.general_level_idc;var w="";if(this.vvcC.general_constraint_info){var H,T=[],R=0;for(R|=this.vvcC.ptl_frame_only_constraint<<7,R|=this.vvcC.ptl_multilayer_enabled<<6,f=0;f<this.vvcC.general_constraint_info.length;++f)T.push(R|=this.vvcC.general_constraint_info[f]>>2&63),R&&(H=f),R=this.vvcC.general_constraint_info[f]>>2&3;if(void 0===H)w=".CA";else{w=".C";var L="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",oe=0,ve=0;for(f=0;f<=H;++f)for(oe=oe<<8|T[f],ve+=8;ve>=5;)w+=L[oe>>ve-5&31],oe&=(1<<(ve-=5))-1;ve&&(w+=L[31&(oe<<=5-ve)])}}b+=w}return b},E.mp4aSampleEntry.prototype.getCodec=function(){var f=E.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var b=this.esds.esd.getOTI(),w=this.esds.esd.getAudioConfig();return f+"."+E.decimalToHex(b)+(w?"."+w:"")}return f},E.stxtSampleEntry.prototype.getCodec=function(){var f=E.SampleEntry.prototype.getCodec.call(this);return this.mime_format?f+"."+this.mime_format:f},E.vp08SampleEntry.prototype.getCodec=E.vp09SampleEntry.prototype.getCodec=function(){var f=E.SampleEntry.prototype.getCodec.call(this),b=this.vpcC.level;0==b&&(b="00");var w=this.vpcC.bitDepth;return 8==w&&(w="08"),f+".0"+this.vpcC.profile+"."+b+"."+w},E.av01SampleEntry.prototype.getCodec=function(){var w,f=E.SampleEntry.prototype.getCodec.call(this),b=this.av1C.seq_level_idx_0;return b<10&&(b="0"+b),2===this.av1C.seq_profile&&1===this.av1C.high_bitdepth?w=1===this.av1C.twelve_bit?"12":"10":this.av1C.seq_profile<=2&&(w=1===this.av1C.high_bitdepth?"10":"08"),f+"."+this.av1C.seq_profile+"."+b+(this.av1C.seq_tier_0?"H":"M")+"."+w},E.Box.prototype.writeHeader=function(f,b){this.size+=8,this.size>J&&(this.size+=8),"uuid"===this.type&&(this.size+=16),ie.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+f.getPosition()+(b||"")),this.size>J?f.writeUint32(1):(this.sizePosition=f.getPosition(),f.writeUint32(this.size)),f.writeString(this.type,null,4),"uuid"===this.type&&f.writeUint8Array(this.uuid),this.size>J&&f.writeUint64(this.size)},E.FullBox.prototype.writeHeader=function(f){this.size+=4,E.Box.prototype.writeHeader.call(this,f," v="+this.version+" f="+this.flags),f.writeUint8(this.version),f.writeUint24(this.flags)},E.Box.prototype.write=function(f){"mdat"===this.type?this.data&&(this.size=this.data.length,this.writeHeader(f),f.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(f),this.data&&f.writeUint8Array(this.data))},E.ContainerBox.prototype.write=function(f){this.size=0,this.writeHeader(f);for(var b=0;b<this.boxes.length;b++)this.boxes[b]&&(this.boxes[b].write(f),this.size+=this.boxes[b].size);ie.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),f.adjustUint32(this.sizePosition,this.size)},E.TrackReferenceTypeBox.prototype.write=function(f){this.size=4*this.track_ids.length,this.writeHeader(f),f.writeUint32Array(this.track_ids)},E.avcCBox.prototype.write=function(f){var b;for(this.size=7,b=0;b<this.SPS.length;b++)this.size+=2+this.SPS[b].length;for(b=0;b<this.PPS.length;b++)this.size+=2+this.PPS[b].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(f),f.writeUint8(this.configurationVersion),f.writeUint8(this.AVCProfileIndication),f.writeUint8(this.profile_compatibility),f.writeUint8(this.AVCLevelIndication),f.writeUint8(this.lengthSizeMinusOne+252),f.writeUint8(this.SPS.length+224),b=0;b<this.SPS.length;b++)f.writeUint16(this.SPS[b].length),f.writeUint8Array(this.SPS[b].nalu);for(f.writeUint8(this.PPS.length),b=0;b<this.PPS.length;b++)f.writeUint16(this.PPS[b].length),f.writeUint8Array(this.PPS[b].nalu);this.ext&&f.writeUint8Array(this.ext)},E.co64Box.prototype.write=function(f){var b;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(f),f.writeUint32(this.chunk_offsets.length),b=0;b<this.chunk_offsets.length;b++)f.writeUint64(this.chunk_offsets[b])},E.cslgBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=20,this.writeHeader(f),f.writeInt32(this.compositionToDTSShift),f.writeInt32(this.leastDecodeToDisplayDelta),f.writeInt32(this.greatestDecodeToDisplayDelta),f.writeInt32(this.compositionStartTime),f.writeInt32(this.compositionEndTime)},E.cttsBox.prototype.write=function(f){var b;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(f),f.writeUint32(this.sample_counts.length),b=0;b<this.sample_counts.length;b++)f.writeUint32(this.sample_counts[b]),1===this.version?f.writeInt32(this.sample_offsets[b]):f.writeUint32(this.sample_offsets[b])},E.drefBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=4,this.writeHeader(f),f.writeUint32(this.entries.length);for(var b=0;b<this.entries.length;b++)this.entries[b].write(f),this.size+=this.entries[b].size;ie.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),f.adjustUint32(this.sizePosition,this.size)},E.elngBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(f),f.writeString(this.extended_language)},E.elstBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(f),f.writeUint32(this.entries.length);for(var b=0;b<this.entries.length;b++){var w=this.entries[b];f.writeUint32(w.segment_duration),f.writeInt32(w.media_time),f.writeInt16(w.media_rate_integer),f.writeInt16(w.media_rate_fraction)}},E.emsgBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=16+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(f),f.writeCString(this.scheme_id_uri),f.writeCString(this.value),f.writeUint32(this.timescale),f.writeUint32(this.presentation_time_delta),f.writeUint32(this.event_duration),f.writeUint32(this.id),f.writeUint8Array(this.message_data)},E.ftypBox.prototype.write=function(f){this.size=8+4*this.compatible_brands.length,this.writeHeader(f),f.writeString(this.major_brand,null,4),f.writeUint32(this.minor_version);for(var b=0;b<this.compatible_brands.length;b++)f.writeString(this.compatible_brands[b],null,4)},E.hdlrBox.prototype.write=function(f){this.size=20+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(f),f.writeUint32(0),f.writeString(this.handler,null,4),f.writeUint32(0),f.writeUint32(0),f.writeUint32(0),f.writeCString(this.name)},E.kindBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(f),f.writeCString(this.schemeURI),f.writeCString(this.value)},E.mdhdBox.prototype.write=function(f){this.size=20,this.flags=0,this.version=0,this.writeHeader(f),f.writeUint32(this.creation_time),f.writeUint32(this.modification_time),f.writeUint32(this.timescale),f.writeUint32(this.duration),f.writeUint16(this.language),f.writeUint16(0)},E.mehdBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=4,this.writeHeader(f),f.writeUint32(this.fragment_duration)},E.mfhdBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=4,this.writeHeader(f),f.writeUint32(this.sequence_number)},E.mvhdBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=96,this.writeHeader(f),f.writeUint32(this.creation_time),f.writeUint32(this.modification_time),f.writeUint32(this.timescale),f.writeUint32(this.duration),f.writeUint32(this.rate),f.writeUint16(this.volume<<8),f.writeUint16(0),f.writeUint32(0),f.writeUint32(0),f.writeUint32Array(this.matrix),f.writeUint32(0),f.writeUint32(0),f.writeUint32(0),f.writeUint32(0),f.writeUint32(0),f.writeUint32(0),f.writeUint32(this.next_track_id)},E.SampleEntry.prototype.writeHeader=function(f){this.size=8,E.Box.prototype.writeHeader.call(this,f),f.writeUint8(0),f.writeUint8(0),f.writeUint8(0),f.writeUint8(0),f.writeUint8(0),f.writeUint8(0),f.writeUint16(this.data_reference_index)},E.SampleEntry.prototype.writeFooter=function(f){for(var b=0;b<this.boxes.length;b++)this.boxes[b].write(f),this.size+=this.boxes[b].size;ie.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),f.adjustUint32(this.sizePosition,this.size)},E.SampleEntry.prototype.write=function(f){this.writeHeader(f),f.writeUint8Array(this.data),this.size+=this.data.length,ie.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),f.adjustUint32(this.sizePosition,this.size)},E.VisualSampleEntry.prototype.write=function(f){this.writeHeader(f),this.size+=70,f.writeUint16(0),f.writeUint16(0),f.writeUint32(0),f.writeUint32(0),f.writeUint32(0),f.writeUint16(this.width),f.writeUint16(this.height),f.writeUint32(this.horizresolution),f.writeUint32(this.vertresolution),f.writeUint32(0),f.writeUint16(this.frame_count),f.writeUint8(Math.min(31,this.compressorname.length)),f.writeString(this.compressorname,null,31),f.writeUint16(this.depth),f.writeInt16(-1),this.writeFooter(f)},E.AudioSampleEntry.prototype.write=function(f){this.writeHeader(f),this.size+=20,f.writeUint32(0),f.writeUint32(0),f.writeUint16(this.channel_count),f.writeUint16(this.samplesize),f.writeUint16(0),f.writeUint16(0),f.writeUint32(this.samplerate<<16),this.writeFooter(f)},E.stppSampleEntry.prototype.write=function(f){this.writeHeader(f),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,f.writeCString(this.namespace),f.writeCString(this.schema_location),f.writeCString(this.auxiliary_mime_types),this.writeFooter(f)},E.SampleGroupEntry.prototype.write=function(f){f.writeUint8Array(this.data)},E.sbgpBox.prototype.write=function(f){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(f),f.writeString(this.grouping_type,null,4),f.writeUint32(this.grouping_type_parameter),f.writeUint32(this.entries.length);for(var b=0;b<this.entries.length;b++){var w=this.entries[b];f.writeInt32(w.sample_count),f.writeInt32(w.group_description_index)}},E.sgpdBox.prototype.write=function(f){var b,w;for(this.flags=0,this.size=12,b=0;b<this.entries.length;b++)w=this.entries[b],1===this.version&&(0===this.default_length&&(this.size+=4),this.size+=w.data.length);for(this.writeHeader(f),f.writeString(this.grouping_type,null,4),1===this.version&&f.writeUint32(this.default_length),this.version>=2&&f.writeUint32(this.default_sample_description_index),f.writeUint32(this.entries.length),b=0;b<this.entries.length;b++)w=this.entries[b],1===this.version&&0===this.default_length&&f.writeUint32(w.description_length),w.write(f)},E.sidxBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=20+12*this.references.length,this.writeHeader(f),f.writeUint32(this.reference_ID),f.writeUint32(this.timescale),f.writeUint32(this.earliest_presentation_time),f.writeUint32(this.first_offset),f.writeUint16(0),f.writeUint16(this.references.length);for(var b=0;b<this.references.length;b++){var w=this.references[b];f.writeUint32(w.reference_type<<31|w.referenced_size),f.writeUint32(w.subsegment_duration),f.writeUint32(w.starts_with_SAP<<31|w.SAP_type<<28|w.SAP_delta_time)}},E.smhdBox.prototype.write=function(f){this.version=0,this.flags=1,this.size=4,this.writeHeader(f),f.writeUint16(this.balance),f.writeUint16(0)},E.stcoBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(f),f.writeUint32(this.chunk_offsets.length),f.writeUint32Array(this.chunk_offsets)},E.stscBox.prototype.write=function(f){var b;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(f),f.writeUint32(this.first_chunk.length),b=0;b<this.first_chunk.length;b++)f.writeUint32(this.first_chunk[b]),f.writeUint32(this.samples_per_chunk[b]),f.writeUint32(this.sample_description_index[b])},E.stsdBox.prototype.write=function(f){var b;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(f),f.writeUint32(this.entries.length),this.size+=4,b=0;b<this.entries.length;b++)this.entries[b].write(f),this.size+=this.entries[b].size;ie.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),f.adjustUint32(this.sizePosition,this.size)},E.stshBox.prototype.write=function(f){var b;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(f),f.writeUint32(this.shadowed_sample_numbers.length),b=0;b<this.shadowed_sample_numbers.length;b++)f.writeUint32(this.shadowed_sample_numbers[b]),f.writeUint32(this.sync_sample_numbers[b])},E.stssBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(f),f.writeUint32(this.sample_numbers.length),f.writeUint32Array(this.sample_numbers)},E.stszBox.prototype.write=function(f){var b,w=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(b=0;b+1<this.sample_sizes.length;){if(this.sample_sizes[b+1]!==this.sample_sizes[0]){w=!1;break}b++}else w=!1;this.size=8,w||(this.size+=4*this.sample_sizes.length),this.writeHeader(f),f.writeUint32(w?this.sample_sizes[0]:0),f.writeUint32(this.sample_sizes.length),w||f.writeUint32Array(this.sample_sizes)},E.sttsBox.prototype.write=function(f){var b;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(f),f.writeUint32(this.sample_counts.length),b=0;b<this.sample_counts.length;b++)f.writeUint32(this.sample_counts[b]),f.writeUint32(this.sample_deltas[b])},E.tfdtBox.prototype.write=function(f){var b=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>b?1:0,this.flags=0,this.size=4,1===this.version&&(this.size+=4),this.writeHeader(f),1===this.version?f.writeUint64(this.baseMediaDecodeTime):f.writeUint32(this.baseMediaDecodeTime)},E.tfhdBox.prototype.write=function(f){this.version=0,this.size=4,this.flags&E.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&E.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&E.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&E.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&E.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(f),f.writeUint32(this.track_id),this.flags&E.TFHD_FLAG_BASE_DATA_OFFSET&&f.writeUint64(this.base_data_offset),this.flags&E.TFHD_FLAG_SAMPLE_DESC&&f.writeUint32(this.default_sample_description_index),this.flags&E.TFHD_FLAG_SAMPLE_DUR&&f.writeUint32(this.default_sample_duration),this.flags&E.TFHD_FLAG_SAMPLE_SIZE&&f.writeUint32(this.default_sample_size),this.flags&E.TFHD_FLAG_SAMPLE_FLAGS&&f.writeUint32(this.default_sample_flags)},E.tkhdBox.prototype.write=function(f){this.version=0,this.size=80,this.writeHeader(f),f.writeUint32(this.creation_time),f.writeUint32(this.modification_time),f.writeUint32(this.track_id),f.writeUint32(0),f.writeUint32(this.duration),f.writeUint32(0),f.writeUint32(0),f.writeInt16(this.layer),f.writeInt16(this.alternate_group),f.writeInt16(this.volume<<8),f.writeUint16(0),f.writeInt32Array(this.matrix),f.writeUint32(this.width),f.writeUint32(this.height)},E.trexBox.prototype.write=function(f){this.version=0,this.flags=0,this.size=20,this.writeHeader(f),f.writeUint32(this.track_id),f.writeUint32(this.default_sample_description_index),f.writeUint32(this.default_sample_duration),f.writeUint32(this.default_sample_size),f.writeUint32(this.default_sample_flags)},E.trunBox.prototype.write=function(f){this.version=0,this.size=4,this.flags&E.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&E.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&E.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&E.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&E.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&E.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(f),f.writeUint32(this.sample_count),this.flags&E.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=f.getPosition(),f.writeInt32(this.data_offset)),this.flags&E.TRUN_FLAGS_FIRST_FLAG&&f.writeUint32(this.first_sample_flags);for(var b=0;b<this.sample_count;b++)this.flags&E.TRUN_FLAGS_DURATION&&f.writeUint32(this.sample_duration[b]),this.flags&E.TRUN_FLAGS_SIZE&&f.writeUint32(this.sample_size[b]),this.flags&E.TRUN_FLAGS_FLAGS&&f.writeUint32(this.sample_flags[b]),this.flags&E.TRUN_FLAGS_CTS_OFFSET&&(0===this.version?f.writeUint32(this.sample_composition_time_offset[b]):f.writeInt32(this.sample_composition_time_offset[b]))},E["url Box"].prototype.write=function(f){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(f),this.location&&f.writeCString(this.location)},E["urn Box"].prototype.write=function(f){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(f),f.writeCString(this.name),this.location&&f.writeCString(this.location)},E.vmhdBox.prototype.write=function(f){this.version=0,this.flags=1,this.size=8,this.writeHeader(f),f.writeUint16(this.graphicsmode),f.writeUint16Array(this.opcolor)},E.cttsBox.prototype.unpack=function(f){var b,w,T;for(T=0,b=0;b<this.sample_counts.length;b++)for(w=0;w<this.sample_counts[b];w++)f[T].pts=f[T].dts+this.sample_offsets[b],T++},E.sttsBox.prototype.unpack=function(f){var b,w,T;for(T=0,b=0;b<this.sample_counts.length;b++)for(w=0;w<this.sample_counts[b];w++)f[T].dts=0===T?0:f[T-1].dts+this.sample_deltas[b],T++},E.stcoBox.prototype.unpack=function(f){var b;for(b=0;b<this.chunk_offsets.length;b++)f[b].offset=this.chunk_offsets[b]},E.stscBox.prototype.unpack=function(f){var b,w,T,R,H;for(R=0,H=0,b=0;b<this.first_chunk.length;b++)for(w=0;w<(b+1<this.first_chunk.length?this.first_chunk[b+1]:1/0);w++)for(H++,T=0;T<this.samples_per_chunk[b];T++){if(!f[R])return;f[R].description_index=this.sample_description_index[b],f[R].chunk_index=H,R++}},E.stszBox.prototype.unpack=function(f){var b;for(b=0;b<this.sample_sizes.length;b++)f[b].size=this.sample_sizes[b]},E.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],E.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],E.boxEqualFields=function(f,b){if(f&&!b)return!1;var w;for(w in f)if(!(E.DIFF_BOXES_PROP_NAMES.indexOf(w)>-1)){if(f[w]instanceof E.Box||b[w]instanceof E.Box)continue;if(typeof f[w]>"u"||typeof b[w]>"u")continue;if("function"==typeof f[w]||"function"==typeof b[w])continue;if(f.subBoxNames&&f.subBoxNames.indexOf(w.slice(0,4))>-1||b.subBoxNames&&b.subBoxNames.indexOf(w.slice(0,4))>-1)continue;if("data"===w||"start"===w||"size"===w||"creation_time"===w||"modification_time"===w)continue;if(E.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(w)>-1)continue;if(f[w]!==b[w])return!1}return!0},E.boxEqual=function(f,b){if(!E.boxEqualFields(f,b))return!1;for(var w=0;w<E.DIFF_BOXES_PROP_NAMES.length;w++){var T=E.DIFF_BOXES_PROP_NAMES[w];if(f[T]&&b[T]&&!E.boxEqual(f[T],b[T]))return!1}return!0};var pe=function(){};pe.prototype.parseSample=function(f){var b,w,T=new ce(f.buffer);for(b=[];!T.isEos();)(w=E.parseOneBox(T,!1)).code===E.OK&&"vttc"===w.box.type&&b.push(w.box);return b},pe.prototype.getText=function(f,b,w){function T(we,de,ke){return ke=ke||"0",(we+="").length>=de?we:new Array(de-we.length+1).join(ke)+we}function R(we){var de=Math.floor(we/3600),ke=Math.floor((we-3600*de)/60),ae=Math.floor(we-3600*de-60*ke),De=Math.floor(1e3*(we-3600*de-60*ke-ae));return T(de,2)+":"+T(ke,2)+":"+T(ae,2)+"."+T(De,3)}for(var H=this.parseSample(w),L="",oe=0;oe<H.length;oe++){var ve=H[oe];L+=R(f)+" --\x3e "+R(b)+"\r\n",L+=ve.payl.text}return L};var Z=function(){};Z.prototype.parseSample=function(f){return new ce(f.data.buffer).readString(f.data.length)},Z.prototype.parseConfig=function(f){var w=new ce(f.buffer);return w.readUint32(),w.readCString()};var Y=function(f){this.stream=f||new K,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.onSidx=null,this.sidxSent=!1};Y.prototype.setSegmentOptions=function(f,b,w){var T=this.getTrackById(f);if(T){var R={};this.fragmentedTracks.push(R),R.id=f,R.user=b,R.trak=T,T.nextSample=0,R.segmentStream=null,R.nb_samples=1e3,R.rapAlignement=!0,w&&(w.nbSamples&&(R.nb_samples=w.nbSamples),w.rapAlignement&&(R.rapAlignement=w.rapAlignement))}},Y.prototype.unsetSegmentOptions=function(f){for(var b=-1,w=0;w<this.fragmentedTracks.length;w++)this.fragmentedTracks[w].id==f&&(b=w);b>-1&&this.fragmentedTracks.splice(b,1)},Y.prototype.setExtractionOptions=function(f,b,w){var T=this.getTrackById(f);if(T){var R={};this.extractedTracks.push(R),R.id=f,R.user=b,R.trak=T,T.nextSample=0,R.nb_samples=1e3,R.samples=[],w&&w.nbSamples&&(R.nb_samples=w.nbSamples)}},Y.prototype.unsetExtractionOptions=function(f){for(var b=-1,w=0;w<this.extractedTracks.length;w++)this.extractedTracks[w].id==f&&(b=w);b>-1&&this.extractedTracks.splice(b,1)},Y.prototype.parse=function(){var b,w;if(!this.restoreParsePosition||this.restoreParsePosition())for(;;){if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}if(this.saveParsePosition&&this.saveParsePosition(),(b=E.parseOneBox(this.stream,!1)).code===E.ERR_NOT_ENOUGH_DATA){if(this.processIncompleteBox){if(this.processIncompleteBox(b))continue;return}return}var R;switch(R="uuid"!==(w=b.box).type?w.type:w.uuid,this.boxes.push(w),R){case"mdat":this.mdats.push(w);break;case"moof":this.moofs.push(w);break;case"moov":this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0);default:void 0!==this[R]&&ie.warn("ISOFile","Duplicate Box of type: "+R+", overriding previous occurrence"),this[R]=w}this.updateUsedBytes&&this.updateUsedBytes(w,b)}},Y.prototype.checkBuffer=function(f){if(null==f)throw"Buffer must be defined and non empty";if(void 0===f.fileStart)throw"Buffer must have a fileStart property";return 0===f.byteLength?(ie.warn("ISOFile","Ignoring empty buffer (fileStart: "+f.fileStart+")"),this.stream.logBufferLevel(),!1):(ie.info("ISOFile","Processing buffer (fileStart: "+f.fileStart+")"),f.usedBytes=0,this.stream.insertBuffer(f),this.stream.logBufferLevel(),!!this.stream.initialized()||(ie.warn("ISOFile","Not ready to start parsing"),!1))},Y.prototype.appendBuffer=function(f,b){var w;if(this.checkBuffer(f))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(b),this.nextSeekPosition?(w=this.nextSeekPosition,this.nextSeekPosition=void 0):w=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(w=this.stream.getEndFilePositionAfter(w))):w=this.nextParsePosition?this.nextParsePosition:0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(ie.info("ISOFile","Done processing buffer (fileStart: "+f.fileStart+") - next buffer to fetch should have a fileStart position of "+w),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),ie.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),w},Y.prototype.getInfo=function(){var f,b,T,R,H,L,w={},oe=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(w.hasMoov=!0,w.duration=this.moov.mvhd.duration,w.timescale=this.moov.mvhd.timescale,w.isFragmented=null!=this.moov.mvex,w.isFragmented&&this.moov.mvex.mehd&&(w.fragment_duration=this.moov.mvex.mehd.fragment_duration),w.isProgressive=this.isProgressive,w.hasIOD=null!=this.moov.iods,w.brands=[],w.brands.push(this.ftyp.major_brand),w.brands=w.brands.concat(this.ftyp.compatible_brands),w.created=new Date(oe+1e3*this.moov.mvhd.creation_time),w.modified=new Date(oe+1e3*this.moov.mvhd.modification_time),w.tracks=[],w.audioTracks=[],w.videoTracks=[],w.subtitleTracks=[],w.metadataTracks=[],w.hintTracks=[],w.otherTracks=[],f=0;f<this.moov.traks.length;f++){if(L=(T=this.moov.traks[f]).mdia.minf.stbl.stsd.entries[0],w.tracks.push(R={}),R.id=T.tkhd.track_id,R.name=T.mdia.hdlr.name,R.references=[],T.tref)for(b=0;b<T.tref.boxes.length;b++)R.references.push(H={}),H.type=T.tref.boxes[b].type,H.track_ids=T.tref.boxes[b].track_ids;T.edts&&(R.edits=T.edts.elst.entries),R.created=new Date(oe+1e3*T.tkhd.creation_time),R.modified=new Date(oe+1e3*T.tkhd.modification_time),R.movie_duration=T.tkhd.duration,R.movie_timescale=w.timescale,R.layer=T.tkhd.layer,R.alternate_group=T.tkhd.alternate_group,R.volume=T.tkhd.volume,R.matrix=T.tkhd.matrix,R.track_width=T.tkhd.width/65536,R.track_height=T.tkhd.height/65536,R.timescale=T.mdia.mdhd.timescale,R.cts_shift=T.mdia.minf.stbl.cslg,R.duration=T.mdia.mdhd.duration,R.samples_duration=T.samples_duration,R.codec=L.getCodec(),R.kind=T.udta&&T.udta.kinds.length?T.udta.kinds[0]:{schemeURI:"",value:""},R.language=T.mdia.elng?T.mdia.elng.extended_language:T.mdia.mdhd.languageString,R.nb_samples=T.samples.length,R.size=T.samples_size,R.bitrate=8*R.size*R.timescale/R.samples_duration,L.isAudio()?(R.type="audio",w.audioTracks.push(R),R.audio={},R.audio.sample_rate=L.getSampleRate(),R.audio.channel_count=L.getChannelCount(),R.audio.sample_size=L.getSampleSize()):L.isVideo()?(R.type="video",w.videoTracks.push(R),R.video={},R.video.width=L.getWidth(),R.video.height=L.getHeight()):L.isSubtitle()?(R.type="subtitles",w.subtitleTracks.push(R)):L.isHint()?(R.type="metadata",w.hintTracks.push(R)):L.isMetadata()?(R.type="metadata",w.metadataTracks.push(R)):(R.type="metadata",w.otherTracks.push(R))}else w.hasMoov=!1;if(w.mime="",w.hasMoov&&w.tracks){for(w.mime+=w.videoTracks&&w.videoTracks.length>0?'video/mp4; codecs="':w.audioTracks&&w.audioTracks.length>0?'audio/mp4; codecs="':'application/mp4; codecs="',f=0;f<w.tracks.length;f++)0!==f&&(w.mime+=","),w.mime+=w.tracks[f].codec;w.mime+='"; profiles="',w.mime+=this.ftyp.compatible_brands.join(),w.mime+='"'}return w},Y.prototype.processSamples=function(f){var b,w;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&null!==this.onSegment)for(b=0;b<this.fragmentedTracks.length;b++){var T=this.fragmentedTracks[b];for(w=T.trak;w.nextSample<w.samples.length&&this.sampleProcessingStarted;){ie.debug("ISOFile","Creating media fragment on track #"+T.id+" for sample "+w.nextSample);var R=this.createFragment(T.id,w.nextSample,T.segmentStream);if(!R)break;if(T.segmentStream=R,w.nextSample++,(w.nextSample%T.nb_samples==0||f||w.nextSample>=w.samples.length)&&(ie.info("ISOFile","Sending fragmented data on track #"+T.id+" for samples ["+Math.max(0,w.nextSample-T.nb_samples)+","+(w.nextSample-1)+"]"),ie.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(T.id,T.user,T.segmentStream.buffer,w.nextSample,f||w.nextSample>=w.samples.length),T.segmentStream=null,T!==this.fragmentedTracks[b]))break}}if(null!==this.onSamples)for(b=0;b<this.extractedTracks.length;b++){var H=this.extractedTracks[b];for(w=H.trak;w.nextSample<w.samples.length&&this.sampleProcessingStarted;){ie.debug("ISOFile","Exporting on track #"+H.id+" sample #"+w.nextSample);var L=this.getSample(w,w.nextSample);if(!L)break;if(w.nextSample++,H.samples.push(L),(w.nextSample%H.nb_samples==0||w.nextSample>=w.samples.length)&&(ie.debug("ISOFile","Sending samples on track #"+H.id+" for sample "+w.nextSample),this.onSamples&&this.onSamples(H.id,H.user,H.samples),H.samples=[],H!==this.extractedTracks[b]))break}}}},Y.prototype.getBox=function(f){var b=this.getBoxes(f,!0);return b.length?b[0]:null},Y.prototype.getBoxes=function(f,b){var w=[];return Y._sweep.call(this,f,w,b),w},Y._sweep=function(f,b,w){for(var T in this.type&&this.type==f&&b.push(this),this.boxes){if(b.length&&w)return;Y._sweep.call(this.boxes[T],f,b,w)}},Y.prototype.getTrackSamplesInfo=function(f){var b=this.getTrackById(f);if(b)return b.samples},Y.prototype.getTrackSample=function(f,b){var w=this.getTrackById(f);return this.getSample(w,b)},Y.prototype.releaseUsedSamples=function(f,b){var w=0,T=this.getTrackById(f);T.lastValidSample||(T.lastValidSample=0);for(var R=T.lastValidSample;R<b;R++)w+=this.releaseSample(T,R);ie.info("ISOFile","Track #"+f+" released samples up to "+b+" (released size: "+w+", remaining: "+this.samplesDataSize+")"),T.lastValidSample=b},Y.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},Y.prototype.stop=function(){this.sampleProcessingStarted=!1},Y.prototype.flush=function(){ie.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},Y.prototype.seekTrack=function(f,b,w){var T,R,H,ve,L=0,oe=0;if(0===w.samples.length)return ie.info("ISOFile","No sample in track, cannot seek! Using time "+ie.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(T=0;T<w.samples.length;T++){if(R=w.samples[T],0===T)oe=0,ve=R.timescale;else if(R.cts>f*R.timescale){oe=T-1;break}b&&R.is_sync&&(L=T)}for(b&&(oe=L),f=w.samples[oe].cts,w.nextSample=oe;w.samples[oe].alreadyRead===w.samples[oe].size&&w.samples[oe+1];)oe++;return H=w.samples[oe].offset+w.samples[oe].alreadyRead,ie.info("ISOFile","Seeking to "+(b?"RAP":"")+" sample #"+w.nextSample+" on track "+w.tkhd.track_id+", time "+ie.getDurationString(f,ve)+" and offset: "+H),{offset:H,time:f/ve}},Y.prototype.seek=function(f,b){var R,H,w=this.moov,L={offset:1/0,time:1/0};if(this.moov){for(H=0;H<w.traks.length;H++)(R=this.seekTrack(f,b,w.traks[H])).offset<L.offset&&(L.offset=R.offset),R.time<L.time&&(L.time=R.time);return ie.info("ISOFile","Seeking at time "+ie.getDurationString(L.time,1)+" needs a buffer with a fileStart position of "+L.offset),L.offset===1/0?L={offset:this.nextParsePosition,time:0}:L.offset=this.stream.getEndFilePositionAfter(L.offset),ie.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+L.offset),L}throw"Cannot seek: moov not received!"},Y.prototype.equal=function(f){for(var b=0;b<this.boxes.length&&b<f.boxes.length;){if(!E.boxEqual(this.boxes[b],f.boxes[b]))return!1;b++}return!0},Y.prototype.lastBoxStartPosition=0,Y.prototype.parsingMdat=null,Y.prototype.nextParsePosition=0,Y.prototype.discardMdatData=!1,Y.prototype.processIncompleteBox=function(f){var b;return"mdat"===f.type?(b=new E[f.type+"Box"](f.size),this.parsingMdat=b,this.boxes.push(b),this.mdats.push(b),b.start=f.start,b.hdr_size=f.hdr_size,this.stream.addUsedBytes(b.hdr_size),this.lastBoxStartPosition=b.start+b.size,this.stream.seek(b.start+b.size,!1,this.discardMdatData)?(this.parsingMdat=null,!0):(this.nextParsePosition=this.moovStartFound?this.stream.findEndContiguousBuf():b.start+b.size,!1)):("moov"===f.type&&(this.moovStartFound=!0,0===this.mdats.length&&(this.isProgressive=!0)),this.stream.mergeNextBuffer&&this.stream.mergeNextBuffer()?(this.nextParsePosition=this.stream.getEndPosition(),!0):(this.nextParsePosition=f.type?this.moovStartFound?this.stream.getEndPosition():this.stream.getPosition()+f.size:this.stream.getEndPosition(),!1))},Y.prototype.hasIncompleteMdat=function(){return null!==this.parsingMdat},Y.prototype.processIncompleteMdat=function(){var f;return this.stream.seek((f=this.parsingMdat).start+f.size,!1,this.discardMdatData)?(ie.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},Y.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},Y.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},Y.prototype.updateUsedBytes=function(f,b){this.stream.addUsedBytes&&("mdat"===f.type?(this.stream.addUsedBytes(f.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(f.size-f.hdr_size)):this.stream.addUsedBytes(f.size))},Y.prototype.add=E.Box.prototype.add,Y.prototype.addBox=E.Box.prototype.addBox,Y.prototype.init=function(f){var b=f||{},T=(this.add("ftyp").set("major_brand",b.brands&&b.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",b.brands||["iso4"]),this.add("moov"));return T.add("mvhd").set("timescale",b.timescale||600).set("rate",b.rate||65536).set("creation_time",0).set("modification_time",0).set("duration",b.duration||0).set("volume",b.width?0:256).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("next_track_id",1),T.add("mvex"),this},Y.prototype.addTrack=function(f){this.moov||this.init(f);var b=f||{};b.width=b.width||320,b.height=b.height||320,b.id=b.id||this.moov.mvhd.next_track_id,b.type=b.type||"avc1";var w=this.moov.add("trak");this.moov.mvhd.next_track_id=b.id+1,w.add("tkhd").set("flags",E.TKHD_FLAG_ENABLED|E.TKHD_FLAG_IN_MOVIE|E.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",b.id).set("duration",b.duration||0).set("layer",b.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[0,0,0,0,0,0,0,0,0]).set("width",b.width<<16).set("height",b.height<<16);var T=w.add("mdia");T.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",b.timescale||1).set("duration",b.media_duration||0).set("language",b.language||"und"),T.add("hdlr").set("handler",b.hdlr||"vide").set("name",b.name||"Track created with MP4Box.js"),T.add("elng").set("extended_language",b.language||"fr-FR");var R=T.add("minf");if(void 0!==E[b.type+"SampleEntry"]){var H=new E[b.type+"SampleEntry"];H.data_reference_index=1;var L="";for(var oe in E.sampleEntryCodes)for(var ve=E.sampleEntryCodes[oe],we=0;we<ve.length;we++)if(ve.indexOf(b.type)>-1){L=oe;break}switch(L){case"Visual":if(R.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),H.set("width",b.width).set("height",b.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",b.type+" Compressor").set("depth",24),b.avcDecoderConfigRecord){var de=new E.avcCBox,ke=new ce(b.avcDecoderConfigRecord);de.parse(ke),H.addBox(de)}break;case"Audio":R.add("smhd").set("balance",b.balance||0),H.set("channel_count",b.channel_count||2).set("samplesize",b.samplesize||16).set("samplerate",b.samplerate||65536);break;case"Hint":R.add("hmhd");break;case"Subtitle":"stpp"===(R.add("sthd"),b.type)&&H.set("namespace",b.namespace||"nonamespace").set("schema_location",b.schema_location||"").set("auxiliary_mime_types",b.auxiliary_mime_types||"");break;default:R.add("nmhd")}b.description&&H.addBox(b.description),b.description_boxes&&b.description_boxes.forEach(function(De){H.addBox(De)}),R.add("dinf").add("dref").addEntry((new E["url Box"]).set("flags",1));var ae=R.add("stbl");return ae.add("stsd").addEntry(H),ae.add("stts").set("sample_counts",[]).set("sample_deltas",[]),ae.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),ae.add("stco").set("chunk_offsets",[]),ae.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",b.id).set("default_sample_description_index",b.default_sample_description_index||1).set("default_sample_duration",b.default_sample_duration||0).set("default_sample_size",b.default_sample_size||0).set("default_sample_flags",b.default_sample_flags||0),this.buildTrakSampleLists(w),b.id}},E.Box.prototype.computeSize=function(f){var b=f||new j;b.endianness=j.BIG_ENDIAN,this.write(b)},Y.prototype.addSample=function(f,b,w){var T=w||{},R={},H=this.getTrackById(f);if(null!==H){R.number=H.samples.length,R.track_id=H.tkhd.track_id,R.timescale=H.mdia.mdhd.timescale,R.description_index=T.sample_description_index?T.sample_description_index-1:0,R.description=H.mdia.minf.stbl.stsd.entries[R.description_index],R.data=b,R.size=b.byteLength,R.alreadyRead=R.size,R.duration=T.duration||1,R.cts=T.cts||0,R.dts=T.dts||0,R.is_sync=T.is_sync||!1,R.is_leading=T.is_leading||0,R.depends_on=T.depends_on||0,R.is_depended_on=T.is_depended_on||0,R.has_redundancy=T.has_redundancy||0,R.degradation_priority=T.degradation_priority||0,R.offset=0,R.subsamples=T.subsamples,H.samples.push(R),H.samples_size+=R.size,H.samples_duration+=R.duration,H.first_dts||(H.first_dts=T.dts),this.processSamples();var L=this.createSingleSampleMoof(R);return this.addBox(L),L.computeSize(),L.trafs[0].truns[0].data_offset=L.size+8,this.add("mdat").data=new Uint8Array(b),R}},Y.prototype.createSingleSampleMoof=function(f){var b;b=f.is_sync?1<<25:65536;var w=new E.moofBox;w.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var T=w.add("traf"),R=this.getTrackById(f.track_id);return T.add("tfhd").set("track_id",f.track_id).set("flags",E.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),T.add("tfdt").set("baseMediaDecodeTime",f.dts-(R.first_dts||0)),T.add("trun").set("flags",E.TRUN_FLAGS_DATA_OFFSET|E.TRUN_FLAGS_DURATION|E.TRUN_FLAGS_SIZE|E.TRUN_FLAGS_FLAGS|E.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[f.duration]).set("sample_size",[f.size]).set("sample_flags",[b]).set("sample_composition_time_offset",[f.cts-f.dts]),w},Y.prototype.lastMoofIndex=0,Y.prototype.samplesDataSize=0,Y.prototype.resetTables=function(){var f,b,T,H,L;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,f=0;f<this.moov.traks.length;f++){(b=this.moov.traks[f]).tkhd.duration=0,b.mdia.mdhd.duration=0,(b.mdia.minf.stbl.stco||b.mdia.minf.stbl.co64).chunk_offsets=[],(T=b.mdia.minf.stbl.stsc).first_chunk=[],T.samples_per_chunk=[],T.sample_description_index=[],(b.mdia.minf.stbl.stsz||b.mdia.minf.stbl.stz2).sample_sizes=[],(H=b.mdia.minf.stbl.stts).sample_counts=[],H.sample_deltas=[],(L=b.mdia.minf.stbl.ctts)&&(L.sample_counts=[],L.sample_offsets=[]);var ve=b.mdia.minf.stbl.boxes.indexOf(b.mdia.minf.stbl.stss);-1!=ve&&(b.mdia.minf.stbl.boxes[ve]=null)}},Y.initSampleGroups=function(f,b,w,T,R){var H,L,ve,we;function de(ke,ae,De){this.grouping_type=ke,this.grouping_type_parameter=ae,this.sbgp=De,this.last_sample_in_run=-1,this.entry_index=-1}for(b&&(b.sample_groups_info=[]),f.sample_groups_info||(f.sample_groups_info=[]),L=0;L<w.length;L++){for(we=w[L].grouping_type+"/"+w[L].grouping_type_parameter,ve=new de(w[L].grouping_type,w[L].grouping_type_parameter,w[L]),b&&(b.sample_groups_info[we]=ve),f.sample_groups_info[we]||(f.sample_groups_info[we]=ve),H=0;H<T.length;H++)T[H].grouping_type===w[L].grouping_type&&(ve.description=T[H],ve.description.used=!0);if(R)for(H=0;H<R.length;H++)R[H].grouping_type===w[L].grouping_type&&(ve.fragment_description=R[H],ve.fragment_description.used=!0,ve.is_fragment=!0)}if(b){if(R)for(L=0;L<R.length;L++)!R[L].used&&R[L].version>=2&&(we=R[L].grouping_type+"/0",(ve=new de(R[L].grouping_type,0)).is_fragment=!0,b.sample_groups_info[we]||(b.sample_groups_info[we]=ve))}else for(L=0;L<T.length;L++)!T[L].used&&T[L].version>=2&&(we=T[L].grouping_type+"/0",ve=new de(T[L].grouping_type,0),f.sample_groups_info[we]||(f.sample_groups_info[we]=ve))},Y.setSampleGroupProperties=function(f,b,w,T){var R,H;for(R in b.sample_groups=[],T)if(b.sample_groups[R]={},b.sample_groups[R].grouping_type=T[R].grouping_type,b.sample_groups[R].grouping_type_parameter=T[R].grouping_type_parameter,w>=T[R].last_sample_in_run&&(T[R].last_sample_in_run<0&&(T[R].last_sample_in_run=0),T[R].entry_index++,T[R].entry_index<=T[R].sbgp.entries.length-1&&(T[R].last_sample_in_run+=T[R].sbgp.entries[T[R].entry_index].sample_count)),b.sample_groups[R].group_description_index=T[R].entry_index<=T[R].sbgp.entries.length-1?T[R].sbgp.entries[T[R].entry_index].group_description_index:-1,0!==b.sample_groups[R].group_description_index){var L;L=T[R].fragment_description?T[R].fragment_description:T[R].description,b.sample_groups[R].group_description_index>0?(H=b.sample_groups[R].group_description_index>65535?(b.sample_groups[R].group_description_index>>16)-1:b.sample_groups[R].group_description_index-1,L&&H>=0&&(b.sample_groups[R].description=L.entries[H])):L&&L.version>=2&&L.default_group_description_index>0&&(b.sample_groups[R].description=L.entries[L.default_group_description_index-1])}},Y.process_sdtp=function(f,b,w){!b||(f?(b.is_leading=f.is_leading[w],b.depends_on=f.sample_depends_on[w],b.is_depended_on=f.sample_is_depended_on[w],b.has_redundancy=f.sample_has_redundancy[w]):(b.is_leading=0,b.depends_on=0,b.is_depended_on=0,b.has_redundancy=0))},Y.prototype.buildSampleLists=function(){var f;for(f=0;f<this.moov.traks.length;f++)this.buildTrakSampleLists(this.moov.traks[f])},Y.prototype.buildTrakSampleLists=function(f){var b,T,R,H,L,oe,ve,we,de,ke,ae,De,$,Ee,ht,Be,kt,Ve,pt,ze,Ge,Jt,Le,Di;if(f.samples=[],f.samples_duration=0,f.samples_size=0,T=f.mdia.minf.stbl.stco||f.mdia.minf.stbl.co64,R=f.mdia.minf.stbl.stsc,H=f.mdia.minf.stbl.stsz||f.mdia.minf.stbl.stz2,L=f.mdia.minf.stbl.stts,oe=f.mdia.minf.stbl.ctts,ve=f.mdia.minf.stbl.stss,we=f.mdia.minf.stbl.stsd,de=f.mdia.minf.stbl.subs,De=f.mdia.minf.stbl.stdp,Ve=-1,pt=-1,ze=-1,Ge=-1,Jt=0,Le=0,Di=0,Y.initSampleGroups(f,null,ke=f.mdia.minf.stbl.sbgps,ae=f.mdia.minf.stbl.sgpds),!(typeof H>"u")){for(b=0;b<H.sample_sizes.length;b++){var dn={};dn.number=b,dn.track_id=f.tkhd.track_id,dn.timescale=f.mdia.mdhd.timescale,dn.alreadyRead=0,f.samples[b]=dn,dn.size=H.sample_sizes[b],f.samples_size+=dn.size,0===b?($=0,dn.chunk_index=Ee=1,dn.chunk_run_index=$,kt=R.samples_per_chunk[$],Be=0,ht=$+1<R.first_chunk.length?R.first_chunk[$+1]-1:1/0):b<kt?(dn.chunk_index=Ee,dn.chunk_run_index=$):(Ee++,dn.chunk_index=Ee,Be=0,Ee<=ht||(ht=1+ ++$<R.first_chunk.length?R.first_chunk[$+1]-1:1/0),dn.chunk_run_index=$,kt+=R.samples_per_chunk[$]),dn.description_index=R.sample_description_index[dn.chunk_run_index]-1,dn.description=we.entries[dn.description_index],dn.offset=T.chunk_offsets[dn.chunk_index-1]+Be,Be+=dn.size,b>Ve&&(pt++,Ve<0&&(Ve=0),Ve+=L.sample_counts[pt]),b>0?(f.samples[b-1].duration=L.sample_deltas[pt],f.samples_duration+=f.samples[b-1].duration,dn.dts=f.samples[b-1].dts+f.samples[b-1].duration):dn.dts=0,oe?(b>=ze&&(Ge++,ze<0&&(ze=0),ze+=oe.sample_counts[Ge]),dn.cts=f.samples[b].dts+oe.sample_offsets[Ge]):dn.cts=dn.dts,ve?(b==ve.sample_numbers[Jt]-1?(dn.is_sync=!0,Jt++):(dn.is_sync=!1,dn.degradation_priority=0),de&&de.entries[Le].sample_delta+Di==b+1&&(dn.subsamples=de.entries[Le].subsamples,Di+=de.entries[Le].sample_delta,Le++)):dn.is_sync=!0,Y.process_sdtp(f.mdia.minf.stbl.sdtp,dn,dn.number),dn.degradation_priority=De?De.priority[b]:0,de&&de.entries[Le].sample_delta+Di==b&&(dn.subsamples=de.entries[Le].subsamples,Di+=de.entries[Le].sample_delta),(ke.length>0||ae.length>0)&&Y.setSampleGroupProperties(f,dn,b,f.sample_groups_info)}b>0&&(f.samples[b-1].duration=Math.max(f.mdia.mdhd.duration-f.samples[b-1].dts,0),f.samples_duration+=f.samples[b-1].duration)}},Y.prototype.updateSampleLists=function(){var f,b,w,T,R,H,L,oe,ve,we,de,ke,ae,De,$;if(void 0!==this.moov)for(;this.lastMoofIndex<this.moofs.length;)if(ve=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,"moof"==ve.type)for(we=ve,f=0;f<we.trafs.length;f++){for(ke=this.getTrackById((de=we.trafs[f]).tfhd.track_id),ae=this.getTrexById(de.tfhd.track_id),T=de.tfhd.flags&E.TFHD_FLAG_SAMPLE_DESC?de.tfhd.default_sample_description_index:ae?ae.default_sample_description_index:1,R=de.tfhd.flags&E.TFHD_FLAG_SAMPLE_DUR?de.tfhd.default_sample_duration:ae?ae.default_sample_duration:0,H=de.tfhd.flags&E.TFHD_FLAG_SAMPLE_SIZE?de.tfhd.default_sample_size:ae?ae.default_sample_size:0,L=de.tfhd.flags&E.TFHD_FLAG_SAMPLE_FLAGS?de.tfhd.default_sample_flags:ae?ae.default_sample_flags:0,de.sample_number=0,de.sbgps.length>0&&Y.initSampleGroups(ke,de,de.sbgps,ke.mdia.minf.stbl.sgpds,de.sgpds),b=0;b<de.truns.length;b++){var Ee=de.truns[b];for(w=0;w<Ee.sample_count;w++){(De={}).moof_number=this.lastMoofIndex,De.number_in_traf=de.sample_number,de.sample_number++,De.number=ke.samples.length,de.first_sample_index=ke.samples.length,ke.samples.push(De),De.track_id=ke.tkhd.track_id,De.timescale=ke.mdia.mdhd.timescale,De.description_index=T-1,De.description=ke.mdia.minf.stbl.stsd.entries[De.description_index],De.size=H,Ee.flags&E.TRUN_FLAGS_SIZE&&(De.size=Ee.sample_size[w]),ke.samples_size+=De.size,De.duration=R,Ee.flags&E.TRUN_FLAGS_DURATION&&(De.duration=Ee.sample_duration[w]),ke.samples_duration+=De.duration,ke.first_traf_merged||w>0?De.dts=ke.samples[ke.samples.length-2].dts+ke.samples[ke.samples.length-2].duration:(De.dts=de.tfdt?de.tfdt.baseMediaDecodeTime:0,ke.first_traf_merged=!0),De.cts=De.dts,Ee.flags&E.TRUN_FLAGS_CTS_OFFSET&&(De.cts=De.dts+Ee.sample_composition_time_offset[w]),$=L,Ee.flags&E.TRUN_FLAGS_FLAGS?$=Ee.sample_flags[w]:0===w&&Ee.flags&E.TRUN_FLAGS_FIRST_FLAG&&($=Ee.first_sample_flags),De.is_sync=!($>>16&1),De.is_leading=$>>26&3,De.depends_on=$>>24&3,De.is_depended_on=$>>22&3,De.has_redundancy=$>>20&3,De.degradation_priority=65535&$;var Ve;Ve=de.tfhd.flags&E.TFHD_FLAG_BASE_DATA_OFFSET?de.tfhd.base_data_offset:de.tfhd.flags&E.TFHD_FLAG_DEFAULT_BASE_IS_MOOF||0===b?we.start:oe,De.offset=0===b&&0===w?Ee.flags&E.TRUN_FLAGS_DATA_OFFSET?Ve+Ee.data_offset:Ve:oe,oe=De.offset+De.size,(de.sbgps.length>0||de.sgpds.length>0||ke.mdia.minf.stbl.sbgps.length>0||ke.mdia.minf.stbl.sgpds.length>0)&&Y.setSampleGroupProperties(ke,De,De.number_in_traf,de.sample_groups_info)}}if(de.subs){ke.has_fragment_subsamples=!0;var pt=de.first_sample_index;for(b=0;b<de.subs.entries.length;b++)(De=ke.samples[(pt+=de.subs.entries[b].sample_delta)-1]).subsamples=de.subs.entries[b].subsamples}}},Y.prototype.getSample=function(f,b){var w,T=f.samples[b];if(!this.moov)return null;if(T.data){if(T.alreadyRead==T.size)return T}else T.data=new Uint8Array(T.size),T.alreadyRead=0,this.samplesDataSize+=T.size,ie.debug("ISOFile","Allocating sample #"+b+" on track #"+f.tkhd.track_id+" of size "+T.size+" (total: "+this.samplesDataSize+")");for(;;){var R=this.stream.findPosition(!0,T.offset+T.alreadyRead,!1);if(!(R>-1))return null;var H=(w=this.stream.buffers[R]).byteLength-(T.offset+T.alreadyRead-w.fileStart);if(T.size-T.alreadyRead<=H)return ie.debug("ISOFile","Getting sample #"+b+" data (alreadyRead: "+T.alreadyRead+" offset: "+(T.offset+T.alreadyRead-w.fileStart)+" read size: "+(T.size-T.alreadyRead)+" full size: "+T.size+")"),j.memcpy(T.data.buffer,T.alreadyRead,w,T.offset+T.alreadyRead-w.fileStart,T.size-T.alreadyRead),w.usedBytes+=T.size-T.alreadyRead,this.stream.logBufferLevel(),T.alreadyRead=T.size,T;if(0===H)return null;ie.debug("ISOFile","Getting sample #"+b+" partial data (alreadyRead: "+T.alreadyRead+" offset: "+(T.offset+T.alreadyRead-w.fileStart)+" read size: "+H+" full size: "+T.size+")"),j.memcpy(T.data.buffer,T.alreadyRead,w,T.offset+T.alreadyRead-w.fileStart,H),T.alreadyRead+=H,w.usedBytes+=H,this.stream.logBufferLevel()}},Y.prototype.releaseSample=function(f,b){var w=f.samples[b];return w.data?(this.samplesDataSize-=w.size,w.data=null,w.alreadyRead=0,w.size):0},Y.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},Y.prototype.getCodecs=function(){var f,b="";for(f=0;f<this.moov.traks.length;f++)f>0&&(b+=","),b+=this.moov.traks[f].mdia.minf.stbl.stsd.entries[0].getCodec();return b},Y.prototype.getTrexById=function(f){var b;if(!this.moov||!this.moov.mvex)return null;for(b=0;b<this.moov.mvex.trexs.length;b++){var w=this.moov.mvex.trexs[b];if(w.track_id==f)return w}return null},Y.prototype.getTrackById=function(f){if(void 0===this.moov)return null;for(var b=0;b<this.moov.traks.length;b++){var w=this.moov.traks[b];if(w.tkhd.track_id==f)return w}return null},Y.prototype.items=[],Y.prototype.itemsDataSize=0,Y.prototype.flattenItemInfo=function(){var b,w,T,f=this.items,R=this.meta;if(null!=R&&void 0!==R.hdlr&&void 0!==R.iinf){for(b=0;b<R.iinf.item_infos.length;b++)(T={}).id=R.iinf.item_infos[b].item_ID,f[T.id]=T,T.ref_to=[],T.name=R.iinf.item_infos[b].item_name,R.iinf.item_infos[b].protection_index>0&&(T.protection=R.ipro.protections[R.iinf.item_infos[b].protection_index-1]),T.type=R.iinf.item_infos[b].item_type?R.iinf.item_infos[b].item_type:"mime",T.content_type=R.iinf.item_infos[b].content_type,T.content_encoding=R.iinf.item_infos[b].content_encoding;if(R.iloc)for(b=0;b<R.iloc.items.length;b++){var L=R.iloc.items[b];switch(T=f[L.item_ID],0!==L.data_reference_index&&(ie.warn("Item storage with reference to other files: not supported"),T.source=R.dinf.boxes[L.data_reference_index-1]),L.construction_method){case 0:break;case 1:case 2:ie.warn("Item storage with construction_method : not supported")}for(T.extents=[],T.size=0,w=0;w<L.extents.length;w++)T.extents[w]={},T.extents[w].offset=L.extents[w].extent_offset+L.base_offset,T.extents[w].length=L.extents[w].extent_length,T.extents[w].alreadyRead=0,T.size+=T.extents[w].length}if(R.pitm&&(f[R.pitm.item_id].primary=!0),R.iref)for(b=0;b<R.iref.references.length;b++){var oe=R.iref.references[b];for(w=0;w<oe.references.length;w++)f[oe.from_item_ID].ref_to.push({type:oe.type,id:oe.references[w]})}if(R.iprp)for(var ve=0;ve<R.iprp.ipmas.length;ve++){var we=R.iprp.ipmas[ve];for(b=0;b<we.associations.length;b++){var de=we.associations[b];for(void 0===(T=f[de.id]).properties&&(T.properties={},T.properties.boxes=[]),w=0;w<de.props.length;w++){var ke=de.props[w];if(ke.property_index>0&&ke.property_index-1<R.iprp.ipco.boxes.length){var ae=R.iprp.ipco.boxes[ke.property_index-1];T.properties[ae.type]=ae,T.properties.boxes.push(ae)}}}}}},Y.prototype.getItem=function(f){var b,w;if(!this.meta)return null;if(!(w=this.items[f]).data&&w.size)w.data=new Uint8Array(w.size),w.alreadyRead=0,this.itemsDataSize+=w.size,ie.debug("ISOFile","Allocating item #"+f+" of size "+w.size+" (total: "+this.itemsDataSize+")");else if(w.alreadyRead===w.size)return w;for(var T=0;T<w.extents.length;T++){var R=w.extents[T];if(R.alreadyRead!==R.length){var H=this.stream.findPosition(!0,R.offset+R.alreadyRead,!1);if(!(H>-1))return null;var L=(b=this.stream.buffers[H]).byteLength-(R.offset+R.alreadyRead-b.fileStart);if(!(R.length-R.alreadyRead<=L))return ie.debug("ISOFile","Getting item #"+f+" extent #"+T+" partial data (alreadyRead: "+R.alreadyRead+" offset: "+(R.offset+R.alreadyRead-b.fileStart)+" read size: "+L+" full extent size: "+R.length+" full item size: "+w.size+")"),j.memcpy(w.data.buffer,w.alreadyRead,b,R.offset+R.alreadyRead-b.fileStart,L),R.alreadyRead+=L,w.alreadyRead+=L,b.usedBytes+=L,this.stream.logBufferLevel(),null;ie.debug("ISOFile","Getting item #"+f+" extent #"+T+" data (alreadyRead: "+R.alreadyRead+" offset: "+(R.offset+R.alreadyRead-b.fileStart)+" read size: "+(R.length-R.alreadyRead)+" full extent size: "+R.length+" full item size: "+w.size+")"),j.memcpy(w.data.buffer,w.alreadyRead,b,R.offset+R.alreadyRead-b.fileStart,R.length-R.alreadyRead),b.usedBytes+=R.length-R.alreadyRead,this.stream.logBufferLevel(),w.alreadyRead+=R.length-R.alreadyRead,R.alreadyRead=R.length}}return w.alreadyRead===w.size?w:null},Y.prototype.releaseItem=function(f){var b=this.items[f];if(b.data){this.itemsDataSize-=b.size,b.data=null,b.alreadyRead=0;for(var w=0;w<b.extents.length;w++)b.extents[w].alreadyRead=0;return b.size}return 0},Y.prototype.processItems=function(f){for(var b in this.items){var w=this.items[b];this.getItem(w.id),f&&!w.sent&&(f(w),w.sent=!0,w.data=null)}},Y.prototype.hasItem=function(f){for(var b in this.items){var w=this.items[b];if(w.name===f)return w.id}return-1},Y.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},Y.prototype.getPrimaryItem=function(){return this.meta&&this.meta.pitm?this.getItem(this.meta.pitm.item_id):null},Y.prototype.itemToFragmentedTrackFile=function(f){var w,b=f||{};if(null==(w=b.itemId?this.getItem(b.itemId):this.getPrimaryItem()))return null;var T=new Y;T.discardMdatData=!1;var R={type:w.type,description_boxes:w.properties.boxes};w.properties.ispe&&(R.width=w.properties.ispe.image_width,R.height=w.properties.ispe.image_height);var H=T.addTrack(R);return H?(T.addSample(H,w.data),T):null},Y.prototype.write=function(f){for(var b=0;b<this.boxes.length;b++)this.boxes[b].write(f)},Y.prototype.createFragment=function(f,b,w){var T=this.getTrackById(f),R=this.getSample(T,b);if(null==R)return R=T.samples[b],this.nextSeekPosition=this.nextSeekPosition?Math.min(R.offset+R.alreadyRead,this.nextSeekPosition):T.samples[b].offset+R.alreadyRead,null;var H=w||new j;H.endianness=j.BIG_ENDIAN;var L=this.createSingleSampleMoof(R);L.write(H),L.trafs[0].truns[0].data_offset=L.size+8,ie.debug("MP4Box","Adjusting data_offset with new value "+L.trafs[0].truns[0].data_offset),H.adjustUint32(L.trafs[0].truns[0].data_offset_position,L.trafs[0].truns[0].data_offset);var oe=new E.mdatBox;return oe.data=R.data,oe.write(H),H},Y.writeInitializationSegment=function(f,b,w,T){var R;ie.debug("ISOFile","Generating initialization segment");var we=new j;we.endianness=j.BIG_ENDIAN,f.write(we);var de=b.add("mvex");for(w&&de.add("mehd").set("fragment_duration",w),R=0;R<b.traks.length;R++)de.add("trex").set("track_id",b.traks[R].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",T).set("default_sample_size",0).set("default_sample_flags",65536);return b.write(we),we.buffer},Y.prototype.save=function(f){var b=new j;b.endianness=j.BIG_ENDIAN,this.write(b),b.save(f)},Y.prototype.getBuffer=function(){var f=new j;return f.endianness=j.BIG_ENDIAN,this.write(f),f.buffer},Y.prototype.initializeSegmentation=function(){var f,T,R,H;for(null===this.onSegment&&ie.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),T=[],f=0;f<this.fragmentedTracks.length;f++){var L=new E.moovBox;L.mvhd=this.moov.mvhd,L.boxes.push(L.mvhd),R=this.getTrackById(this.fragmentedTracks[f].id),L.boxes.push(R),L.traks.push(R),(H={}).id=R.tkhd.track_id,H.user=this.fragmentedTracks[f].user,H.buffer=Y.writeInitializationSegment(this.ftyp,L,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[f].samples.length>0?this.moov.traks[f].samples[0].duration:0),T.push(H)}return T},E.Box.prototype.printHeader=function(f){this.size+=8,this.size>J&&(this.size+=8),"uuid"===this.type&&(this.size+=16),f.log(f.indent+"size:"+this.size),f.log(f.indent+"type:"+this.type)},E.FullBox.prototype.printHeader=function(f){this.size+=4,E.Box.prototype.printHeader.call(this,f),f.log(f.indent+"version:"+this.version),f.log(f.indent+"flags:"+this.flags)},E.Box.prototype.print=function(f){this.printHeader(f)},E.ContainerBox.prototype.print=function(f){this.printHeader(f);for(var b=0;b<this.boxes.length;b++)if(this.boxes[b]){var w=f.indent;f.indent+=" ",this.boxes[b].print(f),f.indent=w}},Y.prototype.print=function(f){f.indent="";for(var b=0;b<this.boxes.length;b++)this.boxes[b]&&this.boxes[b].print(f)},E.mvhdBox.prototype.print=function(f){E.FullBox.prototype.printHeader.call(this,f),f.log(f.indent+"creation_time: "+this.creation_time),f.log(f.indent+"modification_time: "+this.modification_time),f.log(f.indent+"timescale: "+this.timescale),f.log(f.indent+"duration: "+this.duration),f.log(f.indent+"rate: "+this.rate),f.log(f.indent+"volume: "+(this.volume>>8)),f.log(f.indent+"matrix: "+this.matrix.join(", ")),f.log(f.indent+"next_track_id: "+this.next_track_id)},E.tkhdBox.prototype.print=function(f){E.FullBox.prototype.printHeader.call(this,f),f.log(f.indent+"creation_time: "+this.creation_time),f.log(f.indent+"modification_time: "+this.modification_time),f.log(f.indent+"track_id: "+this.track_id),f.log(f.indent+"duration: "+this.duration),f.log(f.indent+"volume: "+(this.volume>>8)),f.log(f.indent+"matrix: "+this.matrix.join(", ")),f.log(f.indent+"layer: "+this.layer),f.log(f.indent+"alternate_group: "+this.alternate_group),f.log(f.indent+"width: "+this.width),f.log(f.indent+"height: "+this.height)};var z_createFile=function(f,b){var w=void 0===f||f,T=new Y(b);return T.discardMdatData=!w,T};ye.cn=z_createFile},340:(cn,ye,Re)=>{var ie=Re(471),ce=Re(992),j=Re(657),J=Re(583),K=Re(929),xe=Re(83),E=Re(818);E.alea=ie,E.xor128=ce,E.xorwow=j,E.xorshift7=J,E.xor4096=K,E.tychei=xe,cn.exports=E},471:function(cn,ye,Re){var ie;!function(ce,j,J){function K(te){var Z=this,Y=function pe(){var te=4022871197;return function(Y){Y=Y.toString();for(var z=0;z<Y.length;z++){var f=.02519603282416938*(te+=Y.charCodeAt(z));f-=te=f>>>0,te=(f*=te)>>>0,te+=4294967296*(f-=te)}return 2.3283064365386963e-10*(te>>>0)}}();Z.next=function(){var z=2091639*Z.s0+2.3283064365386963e-10*Z.c;return Z.s0=Z.s1,Z.s1=Z.s2,Z.s2=z-(Z.c=0|z)},Z.c=1,Z.s0=Y(" "),Z.s1=Y(" "),Z.s2=Y(" "),Z.s0-=Y(te),Z.s0<0&&(Z.s0+=1),Z.s1-=Y(te),Z.s1<0&&(Z.s1+=1),Z.s2-=Y(te),Z.s2<0&&(Z.s2+=1),Y=null}function xe(te,Z){return Z.c=te.c,Z.s0=te.s0,Z.s1=te.s1,Z.s2=te.s2,Z}function E(te,Z){var Y=new K(te),z=Z&&Z.state,f=Y.next;return f.int32=function(){return 4294967296*Y.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,z&&("object"==typeof z&&xe(z,Y),f.state=function(){return xe(Y,{})}),f}j&&j.exports?j.exports=E:Re.amdD&&Re.amdO?void 0!==(ie=function(){return E}.call(ye,Re,ye,j))&&(j.exports=ie):this.alea=E}(0,cn=Re.nmd(cn))},83:function(cn,ye,Re){var ie;!function(ce,j,J){function K(pe){var te=this,Z="";te.next=function(){var z=te.b,f=te.c,b=te.d,w=te.a;return z=z<<25^z>>>7^f,f=f-b|0,b=b<<24^b>>>8^w,w=w-z|0,te.b=z=z<<20^z>>>12^f,te.c=f=f-b|0,te.d=b<<16^f>>>16^w,te.a=w-z|0},te.a=0,te.b=0,te.c=-1640531527,te.d=1367130551,pe===Math.floor(pe)?(te.a=pe/4294967296|0,te.b=0|pe):Z+=pe;for(var Y=0;Y<Z.length+20;Y++)te.b^=0|Z.charCodeAt(Y),te.next()}function xe(pe,te){return te.a=pe.a,te.b=pe.b,te.c=pe.c,te.d=pe.d,te}function E(pe,te){var Z=new K(pe),Y=te&&te.state,z=function(){return(Z.next()>>>0)/4294967296};return z.double=function(){do{var w=((Z.next()>>>11)+(Z.next()>>>0)/4294967296)/(1<<21)}while(0===w);return w},z.int32=Z.next,z.quick=z,Y&&("object"==typeof Y&&xe(Y,Z),z.state=function(){return xe(Z,{})}),z}j&&j.exports?j.exports=E:Re.amdD&&Re.amdO?void 0!==(ie=function(){return E}.call(ye,Re,ye,j))&&(j.exports=ie):this.tychei=E}(0,cn=Re.nmd(cn))},992:function(cn,ye,Re){var ie;!function(ce,j,J){function K(pe){var te=this,Z="";te.x=0,te.y=0,te.z=0,te.w=0,te.next=function(){var z=te.x^te.x<<11;return te.x=te.y,te.y=te.z,te.z=te.w,te.w^=te.w>>>19^z^z>>>8},pe===(0|pe)?te.x=pe:Z+=pe;for(var Y=0;Y<Z.length+64;Y++)te.x^=0|Z.charCodeAt(Y),te.next()}function xe(pe,te){return te.x=pe.x,te.y=pe.y,te.z=pe.z,te.w=pe.w,te}function E(pe,te){var Z=new K(pe),Y=te&&te.state,z=function(){return(Z.next()>>>0)/4294967296};return z.double=function(){do{var w=((Z.next()>>>11)+(Z.next()>>>0)/4294967296)/(1<<21)}while(0===w);return w},z.int32=Z.next,z.quick=z,Y&&("object"==typeof Y&&xe(Y,Z),z.state=function(){return xe(Z,{})}),z}j&&j.exports?j.exports=E:Re.amdD&&Re.amdO?void 0!==(ie=function(){return E}.call(ye,Re,ye,j))&&(j.exports=ie):this.xor128=E}(0,cn=Re.nmd(cn))},929:function(cn,ye,Re){var ie;!function(ce,j,J){function K(pe){var te=this;te.next=function(){var b,w,Y=te.w,z=te.X,f=te.i;return te.w=Y=Y+1640531527|0,w=z[f+34&127],b=z[f=f+1&127],w^=w<<13,b^=b<<17,w=z[f]=(w^=w>>>15)^(b^=b>>>12),te.i=f,w+(Y^Y>>>16)|0},function Z(Y,z){var f,b,w,T,R,H=[],L=128;for(z===(0|z)?(b=z,z=null):(z+="\0",b=0,L=Math.max(L,z.length)),w=0,T=-32;T<L;++T)z&&(b^=z.charCodeAt((T+32)%z.length)),0===T&&(R=b),b^=b<<10,b^=b>>>15,b^=b<<4,b^=b>>>13,T>=0&&(w=0==(f=H[127&T]^=b+(R=R+1640531527|0))?w+1:0);for(w>=128&&(H[127&(z&&z.length||0)]=-1),w=127,T=512;T>0;--T)b=H[w+34&127],f=H[w=w+1&127],b^=b<<13,f^=f<<17,H[w]=(b^=b>>>15)^(f^=f>>>12);Y.w=R,Y.X=H,Y.i=w}(te,pe)}function xe(pe,te){return te.i=pe.i,te.w=pe.w,te.X=pe.X.slice(),te}function E(pe,te){null==pe&&(pe=+new Date);var Z=new K(pe),Y=te&&te.state,z=function(){return(Z.next()>>>0)/4294967296};return z.double=function(){do{var w=((Z.next()>>>11)+(Z.next()>>>0)/4294967296)/(1<<21)}while(0===w);return w},z.int32=Z.next,z.quick=z,Y&&(Y.X&&xe(Y,Z),z.state=function(){return xe(Z,{})}),z}j&&j.exports?j.exports=E:Re.amdD&&Re.amdO?void 0!==(ie=function(){return E}.call(ye,Re,ye,j))&&(j.exports=ie):this.xor4096=E}(0,cn=Re.nmd(cn))},583:function(cn,ye,Re){var ie;!function(ce,j,J){function K(pe){var te=this;te.next=function(){var f,b,Y=te.x,z=te.i;return f=Y[z],b=(f^=f>>>7)^f<<24,b^=(f=Y[z+1&7])^f>>>10,b^=(f=Y[z+3&7])^f>>>3,b^=(f=Y[z+4&7])^f<<7,f=Y[z+7&7],Y[z]=b^=(f^=f<<13)^f<<9,te.i=z+1&7,b},function Z(Y,z){var f,w=[];if(z===(0|z))w[0]=z;else for(z=""+z,f=0;f<z.length;++f)w[7&f]=w[7&f]<<15^z.charCodeAt(f)+w[f+1&7]<<13;for(;w.length<8;)w.push(0);for(f=0;f<8&&0===w[f];++f);for(8==f&&(w[7]=-1),Y.x=w,Y.i=0,f=256;f>0;--f)Y.next()}(te,pe)}function xe(pe,te){return te.x=pe.x.slice(),te.i=pe.i,te}function E(pe,te){null==pe&&(pe=+new Date);var Z=new K(pe),Y=te&&te.state,z=function(){return(Z.next()>>>0)/4294967296};return z.double=function(){do{var w=((Z.next()>>>11)+(Z.next()>>>0)/4294967296)/(1<<21)}while(0===w);return w},z.int32=Z.next,z.quick=z,Y&&(Y.x&&xe(Y,Z),z.state=function(){return xe(Z,{})}),z}j&&j.exports?j.exports=E:Re.amdD&&Re.amdO?void 0!==(ie=function(){return E}.call(ye,Re,ye,j))&&(j.exports=ie):this.xorshift7=E}(0,cn=Re.nmd(cn))},657:function(cn,ye,Re){var ie;!function(ce,j,J){function K(pe){var te=this,Z="";te.next=function(){var z=te.x^te.x>>>2;return te.x=te.y,te.y=te.z,te.z=te.w,te.w=te.v,(te.d=te.d+362437|0)+(te.v=te.v^te.v<<4^z^z<<1)|0},te.x=0,te.y=0,te.z=0,te.w=0,te.v=0,pe===(0|pe)?te.x=pe:Z+=pe;for(var Y=0;Y<Z.length+64;Y++)te.x^=0|Z.charCodeAt(Y),Y==Z.length&&(te.d=te.x<<10^te.x>>>4),te.next()}function xe(pe,te){return te.x=pe.x,te.y=pe.y,te.z=pe.z,te.w=pe.w,te.v=pe.v,te.d=pe.d,te}function E(pe,te){var Z=new K(pe),Y=te&&te.state,z=function(){return(Z.next()>>>0)/4294967296};return z.double=function(){do{var w=((Z.next()>>>11)+(Z.next()>>>0)/4294967296)/(1<<21)}while(0===w);return w},z.int32=Z.next,z.quick=z,Y&&("object"==typeof Y&&xe(Y,Z),z.state=function(){return xe(Z,{})}),z}j&&j.exports?j.exports=E:Re.amdD&&Re.amdO?void 0!==(ie=function(){return E}.call(ye,Re,ye,j))&&(j.exports=ie):this.xorwow=E}(0,cn=Re.nmd(cn))},818:(cn,ye,Re)=>{var ie;!function(ce,j){var f,J=this,K=256,te=j.pow(K,6),Z=j.pow(2,52),Y=2*Z,z=255;function b(ve,we,de){var ke=[],ae=H(R((we=1==we?{entropy:!0}:we||{}).entropy?[ve,oe(ce)]:ve??function L(){try{var ve;return f&&(ve=f.randomBytes)?ve=ve(K):(ve=new Uint8Array(K),(J.crypto||J.msCrypto).getRandomValues(ve)),oe(ve)}catch{var we=J.navigator,de=we&&we.plugins;return[+new Date,J,de,J.screen,oe(ce)]}}(),3),ke),De=new w(ke),$=function(){for(var Ee=De.g(6),ht=te,Be=0;Ee<Z;)Ee=(Ee+Be)*K,ht*=K,Be=De.g(1);for(;Ee>=Y;)Ee/=2,ht/=2,Be>>>=1;return(Ee+Be)/ht};return $.int32=function(){return 0|De.g(4)},$.quick=function(){return De.g(4)/4294967296},$.double=$,H(oe(De.S),ce),(we.pass||de||function(Ee,ht,Be,kt){return kt&&(kt.S&&T(kt,De),Ee.state=function(){return T(De,{})}),Be?(j.random=Ee,ht):Ee})($,ae,"global"in we?we.global:this==j,we.state)}function w(ve){var we,de=ve.length,ke=this,ae=0,De=ke.i=ke.j=0,$=ke.S=[];for(de||(ve=[de++]);ae<K;)$[ae]=ae++;for(ae=0;ae<K;ae++)$[ae]=$[De=z&De+ve[ae%de]+(we=$[ae])],$[De]=we;(ke.g=function(Ee){for(var ht,Be=0,kt=ke.i,Ve=ke.j,pt=ke.S;Ee--;)ht=pt[kt=z&kt+1],Be=Be*K+pt[z&(pt[kt]=pt[Ve=z&Ve+ht])+(pt[Ve]=ht)];return ke.i=kt,ke.j=Ve,Be})(K)}function T(ve,we){return we.i=ve.i,we.j=ve.j,we.S=ve.S.slice(),we}function R(ve,we){var ae,de=[],ke=typeof ve;if(we&&"object"==ke)for(ae in ve)try{de.push(R(ve[ae],we-1))}catch{}return de.length?de:"string"==ke?ve:ve+"\0"}function H(ve,we){for(var ke,de=ve+"",ae=0;ae<de.length;)we[z&ae]=z&(ke^=19*we[z&ae])+de.charCodeAt(ae++);return oe(we)}function oe(ve){return String.fromCharCode.apply(0,ve)}if(j.seedrandom=b,H(j.random(),ce),cn.exports){cn.exports=b;try{f=Re(42)}catch{}}else void 0!==(ie=function(){return b}.call(ye,Re,ye,cn))&&(cn.exports=ie)}([],Math)},902:()=>{},522:()=>{},753:()=>{},802:()=>{},633:()=>{},688:()=>{},42:()=>{}},cn=>{cn(cn.s=208)}]);